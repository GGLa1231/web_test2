<!DOCTYPE html>
<html data-init="no-js">
<head>
<meta charset="UTF-8" />
<title>Battle Quest</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!--

SugarCube (v2.36.1): A free (gratis and libre) story format.

Copyright © 2013–2021 Thomas Michael Edwards <thomasmedwards@gmail.com>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<script id="script-libraries" type="text/javascript">
if(document.head&&document.addEventListener&&document.querySelector&&Object.create&&Object.freeze&&JSON){document.documentElement.setAttribute("data-init", "loading");
/*! @source http://purl.eligrey.com/github/classList.js/blob/1.2.20171210/classList.js */
"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||!function(t){"use strict";if("Element"in t){var e="classList",n="prototype",i=t.Element[n],s=Object,r=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},c=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},a=function(t,e){if(""===e)throw new c("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(e))throw new c("INVALID_CHARACTER_ERR","The token must not contain space characters.");return o.call(t,e)},l=function(t){for(var e=r.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],i=0,s=n.length;s>i;i++)this.push(n[i]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},u=l[n]=[],h=function(){return new l(this)};if(c[n]=Error[n],u.item=function(t){return this[t]||null},u.contains=function(t){return~a(this,t+"")},u.add=function(){var t,e=arguments,n=0,i=e.length,s=!1;do t=e[n]+"",~a(this,t)||(this.push(t),s=!0);while(++n<i);s&&this._updateClassName()},u.remove=function(){var t,e,n=arguments,i=0,s=n.length,r=!1;do for(t=n[i]+"",e=a(this,t);~e;)this.splice(e,1),r=!0,e=a(this,t);while(++i<s);r&&this._updateClassName()},u.toggle=function(t,e){var n=this.contains(t),i=n?e!==!0&&"remove":e!==!1&&"add";return i&&this[i](t),e===!0||e===!1?e:!n},u.replace=function(t,e){var n=a(t+"");~n&&(this.splice(n,1,e),this._updateClassName())},u.toString=function(){return this.join(" ")},s.defineProperty){var f={get:h,enumerable:!0,configurable:!0};try{s.defineProperty(i,e,f)}catch(p){void 0!==p.number&&-2146823252!==p.number||(f.enumerable=!1,s.defineProperty(i,e,f))}}else s[n].__defineGetter__&&i.__defineGetter__(e,h)}}(self),function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,i=arguments.length;for(n=0;i>n;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(t,e){var n=this.toString().split(" "),i=n.indexOf(t+"");~i&&(n=n.slice(i),this.remove.apply(this,n),this.add(e),this.add.apply(this,n.slice(1)))}),t=null}());
/*!
 * https://github.com/es-shims/es5-shim
 * @license es5-shim Copyright 2009-2020 by contributors, MIT License
 * see https://github.com/es-shims/es5-shim/blob/v4.5.14/LICENSE
 */
(function(t,r){"use strict";if(typeof define==="function"&&define.amd){define(r)}else if(typeof exports==="object"){module.exports=r()}else{t.returnExports=r()}})(this,function(){var t=Array;var r=t.prototype;var e=Object;var n=e.prototype;var i=Function;var a=i.prototype;var o=String;var f=o.prototype;var u=Number;var l=u.prototype;var s=r.slice;var c=r.splice;var v=r.push;var h=r.unshift;var p=r.concat;var y=r.join;var d=a.call;var g=a.apply;var w=Math.max;var b=Math.min;var T=n.toString;var m=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";var D;var S=Function.prototype.toString,x=/^\s*class /,O=function isES6ClassFn(t){try{var r=S.call(t);var e=r.replace(/\/\/.*\n/g,"");var n=e.replace(/\/\*[.\s\S]*\*\//g,"");var i=n.replace(/\n/gm," ").replace(/ {2}/g," ");return x.test(i)}catch(a){return false}},E=function tryFunctionObject(t){try{if(O(t)){return false}S.call(t);return true}catch(r){return false}},j="[object Function]",I="[object GeneratorFunction]",D=function isCallable(t){if(!t){return false}if(typeof t!=="function"&&typeof t!=="object"){return false}if(m){return E(t)}if(O(t)){return false}var r=T.call(t);return r===j||r===I};var M;var U=RegExp.prototype.exec,$=function tryRegexExec(t){try{U.call(t);return true}catch(r){return false}},F="[object RegExp]";M=function isRegex(t){if(typeof t!=="object"){return false}return m?$(t):T.call(t)===F};var N;var C=String.prototype.valueOf,k=function tryStringObject(t){try{C.call(t);return true}catch(r){return false}},A="[object String]";N=function isString(t){if(typeof t==="string"){return true}if(typeof t!=="object"){return false}return m?k(t):T.call(t)===A};var R=e.defineProperty&&function(){try{var t={};e.defineProperty(t,"x",{enumerable:false,value:t});for(var r in t){return false}return t.x===t}catch(n){return false}}();var P=function(t){var r;if(R){r=function(t,r,n,i){if(!i&&r in t){return}e.defineProperty(t,r,{configurable:true,enumerable:false,writable:true,value:n})}}else{r=function(t,r,e,n){if(!n&&r in t){return}t[r]=e}}return function defineProperties(e,n,i){for(var a in n){if(t.call(n,a)){r(e,a,n[a],i)}}}}(n.hasOwnProperty);var J=function isPrimitive(t){var r=typeof t;return t===null||r!=="object"&&r!=="function"};var Y=u.isNaN||function isActualNaN(t){return t!==t};var z={ToInteger:function ToInteger(t){var r=+t;if(Y(r)){r=0}else if(r!==0&&r!==1/0&&r!==-(1/0)){r=(r>0||-1)*Math.floor(Math.abs(r))}return r},ToPrimitive:function ToPrimitive(t){var r,e,n;if(J(t)){return t}e=t.valueOf;if(D(e)){r=e.call(t);if(J(r)){return r}}n=t.toString;if(D(n)){r=n.call(t);if(J(r)){return r}}throw new TypeError},ToObject:function(t){if(t==null){throw new TypeError("can't convert "+t+" to object")}return e(t)},ToUint32:function ToUint32(t){return t>>>0}};var Z=function Empty(){};P(a,{bind:function bind(t){var r=this;if(!D(r)){throw new TypeError("Function.prototype.bind called on incompatible "+r)}var n=s.call(arguments,1);var a;var o=function(){if(this instanceof a){var i=g.call(r,this,p.call(n,s.call(arguments)));if(e(i)===i){return i}return this}else{return g.call(r,t,p.call(n,s.call(arguments)))}};var f=w(0,r.length-n.length);var u=[];for(var l=0;l<f;l++){v.call(u,"$"+l)}a=i("binder","return function ("+y.call(u,",")+"){ return binder.apply(this, arguments); }")(o);if(r.prototype){Z.prototype=r.prototype;a.prototype=new Z;Z.prototype=null}return a}});var G=d.bind(n.hasOwnProperty);var H=d.bind(n.toString);var W=d.bind(s);var B=g.bind(s);if(typeof document==="object"&&document&&document.documentElement){try{W(document.documentElement.childNodes)}catch(X){var L=W;var q=B;W=function arraySliceIE(t){var r=[];var e=t.length;while(e-- >0){r[e]=t[e]}return q(r,L(arguments,1))};B=function arraySliceApplyIE(t,r){return q(W(t),r)}}}var K=d.bind(f.slice);var Q=d.bind(f.split);var V=d.bind(f.indexOf);var _=d.bind(v);var tt=d.bind(n.propertyIsEnumerable);var rt=d.bind(r.sort);var et=t.isArray||function isArray(t){return H(t)==="[object Array]"};var nt=[].unshift(0)!==1;P(r,{unshift:function(){h.apply(this,arguments);return this.length}},nt);P(t,{isArray:et});var it=e("a");var at=it[0]!=="a"||!(0 in it);var ot=function properlyBoxed(t){var r=true;var e=true;var n=false;if(t){try{t.call("foo",function(t,e,n){if(typeof n!=="object"){r=false}});t.call([1],function(){"use strict";e=typeof this==="string"},"x")}catch(i){n=true}}return!!t&&!n&&r&&e};P(r,{forEach:function forEach(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=-1;var i=z.ToUint32(e.length);var a;if(arguments.length>1){a=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.forEach callback must be a function")}while(++n<i){if(n in e){if(typeof a==="undefined"){t(e[n],n,r)}else{t.call(a,e[n],n,r)}}}}},!ot(r.forEach));P(r,{map:function map(r){var e=z.ToObject(this);var n=at&&N(this)?Q(this,""):e;var i=z.ToUint32(n.length);var a=t(i);var o;if(arguments.length>1){o=arguments[1]}if(!D(r)){throw new TypeError("Array.prototype.map callback must be a function")}for(var f=0;f<i;f++){if(f in n){if(typeof o==="undefined"){a[f]=r(n[f],f,e)}else{a[f]=r.call(o,n[f],f,e)}}}return a}},!ot(r.map));P(r,{filter:function filter(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i=[];var a;var o;if(arguments.length>1){o=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.filter callback must be a function")}for(var f=0;f<n;f++){if(f in e){a=e[f];if(typeof o==="undefined"?t(a,f,r):t.call(o,a,f,r)){_(i,a)}}}return i}},!ot(r.filter));P(r,{every:function every(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.every callback must be a function")}for(var a=0;a<n;a++){if(a in e&&!(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return false}}return true}},!ot(r.every));P(r,{some:function some(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.some callback must be a function")}for(var a=0;a<n;a++){if(a in e&&(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return true}}return false}},!ot(r.some));var ft=false;if(r.reduce){ft=typeof r.reduce.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduce:function reduce(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduce callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduce of empty array with no initial value")}var i=0;var a;if(arguments.length>=2){a=arguments[1]}else{do{if(i in e){a=e[i++];break}if(++i>=n){throw new TypeError("reduce of empty array with no initial value")}}while(true)}for(;i<n;i++){if(i in e){a=t(a,e[i],i,r)}}return a}},!ft);var ut=false;if(r.reduceRight){ut=typeof r.reduceRight.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduceRight:function reduceRight(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduceRight callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduceRight of empty array with no initial value")}var i;var a=n-1;if(arguments.length>=2){i=arguments[1]}else{do{if(a in e){i=e[a--];break}if(--a<0){throw new TypeError("reduceRight of empty array with no initial value")}}while(true)}if(a<0){return i}do{if(a in e){i=t(i,e[a],a,r)}}while(a--);return i}},!ut);var lt=r.indexOf&&[0,1].indexOf(1,2)!==-1;P(r,{indexOf:function indexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=0;if(arguments.length>1){n=z.ToInteger(arguments[1])}n=n>=0?n:w(0,e+n);for(;n<e;n++){if(n in r&&r[n]===t){return n}}return-1}},lt);var st=r.lastIndexOf&&[0,1].lastIndexOf(0,-3)!==-1;P(r,{lastIndexOf:function lastIndexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=e-1;if(arguments.length>1){n=b(n,z.ToInteger(arguments[1]))}n=n>=0?n:e-Math.abs(n);for(;n>=0;n--){if(n in r&&t===r[n]){return n}}return-1}},st);var ct=function(){var t=[1,2];var r=t.splice();return t.length===2&&et(r)&&r.length===0}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}else{return c.apply(this,arguments)}}},!ct);var vt=function(){var t={};r.splice.call(t,0,0,1);return t.length===1}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}var e=arguments;this.length=w(z.ToInteger(this.length),0);if(arguments.length>0&&typeof r!=="number"){e=W(arguments);if(e.length<2){_(e,this.length-t)}else{e[1]=z.ToInteger(r)}}return c.apply(this,e)}},!vt);var ht=function(){var r=new t(1e5);r[8]="x";r.splice(1,1);return r.indexOf("x")===7}();var pt=function(){var t=256;var r=[];r[t]="a";r.splice(t+1,0,"b");return r[t]==="a"}();P(r,{splice:function splice(t,r){var e=z.ToObject(this);var n=[];var i=z.ToUint32(e.length);var a=z.ToInteger(t);var f=a<0?w(i+a,0):b(a,i);var u=arguments.length===0?0:arguments.length===1?i-f:b(w(z.ToInteger(r),0),i-f);var l=0;var s;while(l<u){s=o(f+l);if(G(e,s)){n[l]=e[s]}l+=1}var c=W(arguments,2);var v=c.length;var h;if(v<u){l=f;var p=i-u;while(l<p){s=o(l+u);h=o(l+v);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l+=1}l=i;var y=i-u+v;while(l>y){delete e[l-1];l-=1}}else if(v>u){l=i-u;while(l>f){s=o(l+u-1);h=o(l+v-1);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l-=1}}l=f;for(var d=0;d<c.length;++d){e[l]=c[d];l+=1}e.length=i-u+v;return n}},!ht||!pt);var yt=r.join;var dt;try{dt=Array.prototype.join.call("123",",")!=="1,2,3"}catch(X){dt=true}if(dt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(N(this)?Q(this,""):this,r)}},dt)}var gt=[1,2].join(undefined)!=="1,2";if(gt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(this,r)}},gt)}var wt=function push(t){var r=z.ToObject(this);var e=z.ToUint32(r.length);var n=0;while(n<arguments.length){r[e+n]=arguments[n];n+=1}r.length=e+n;return e+n};var bt=function(){var t={};var r=Array.prototype.push.call(t,undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:function push(t){if(et(this)){return v.apply(this,arguments)}return wt.apply(this,arguments)}},bt);var Tt=function(){var t=[];var r=t.push(undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:wt},Tt);P(r,{slice:function(t,r){var e=N(this)?Q(this,""):this;return B(e,arguments)}},at);var mt=function(){try{[1,2].sort(null)}catch(t){try{[1,2].sort({})}catch(r){return false}}return true}();var Dt=function(){try{[1,2].sort(/a/);return false}catch(t){}return true}();var St=function(){try{[1,2].sort(undefined);return true}catch(t){}return false}();P(r,{sort:function sort(t){if(typeof t==="undefined"){return rt(this)}if(!D(t)){throw new TypeError("Array.prototype.sort callback must be a function")}return rt(this,t)}},mt||!St||!Dt);var xt=!tt({toString:null},"toString");var Ot=tt(function(){},"prototype");var Et=!G("x","0");var jt=function(t){var r=t.constructor;return r&&r.prototype===t};var It={$applicationCache:true,$console:true,$external:true,$frame:true,$frameElement:true,$frames:true,$innerHeight:true,$innerWidth:true,$onmozfullscreenchange:true,$onmozfullscreenerror:true,$outerHeight:true,$outerWidth:true,$pageXOffset:true,$pageYOffset:true,$parent:true,$scrollLeft:true,$scrollTop:true,$scrollX:true,$scrollY:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true,$width:true,$height:true,$top:true,$localStorage:true};var Mt=function(){if(typeof window==="undefined"){return false}for(var t in window){try{if(!It["$"+t]&&G(window,t)&&window[t]!==null&&typeof window[t]==="object"){jt(window[t])}}catch(r){return true}}return false}();var Ut=function(t){if(typeof window==="undefined"||!Mt){return jt(t)}try{return jt(t)}catch(r){return false}};var $t=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var Ft=$t.length;var Nt=function isArguments(t){return H(t)==="[object Arguments]"};var Ct=function isArguments(t){return t!==null&&typeof t==="object"&&typeof t.length==="number"&&t.length>=0&&!et(t)&&D(t.callee)};var kt=Nt(arguments)?Nt:Ct;P(e,{keys:function keys(t){var r=D(t);var e=kt(t);var n=t!==null&&typeof t==="object";var i=n&&N(t);if(!n&&!r&&!e){throw new TypeError("Object.keys called on a non-object")}var a=[];var f=Ot&&r;if(i&&Et||e){for(var u=0;u<t.length;++u){_(a,o(u))}}if(!e){for(var l in t){if(!(f&&l==="prototype")&&G(t,l)){_(a,o(l))}}}if(xt){var s=Ut(t);for(var c=0;c<Ft;c++){var v=$t[c];if(!(s&&v==="constructor")&&G(t,v)){_(a,v)}}}return a}});var At=e.keys&&function(){return e.keys(arguments).length===2}(1,2);var Rt=e.keys&&function(){var t=e.keys(arguments);return arguments.length!==1||t.length!==1||t[0]!==1}(1);var Pt=e.keys;P(e,{keys:function keys(t){if(kt(t)){return Pt(W(t))}else{return Pt(t)}}},!At||Rt);var Jt=new Date(-0xc782b5b342b24).getUTCMonth()!==0;var Yt=new Date(-0x55d318d56a724);var zt=new Date(14496624e5);var Zt=Yt.toUTCString()!=="Mon, 01 Jan -45875 11:59:59 GMT";var Gt;var Ht;var Wt=Yt.getTimezoneOffset();if(Wt<-720){Gt=Yt.toDateString()!=="Tue Jan 02 -45875";Ht=!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}else{Gt=Yt.toDateString()!=="Mon Jan 01 -45875";Ht=!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}var Bt=d.bind(Date.prototype.getFullYear);var Xt=d.bind(Date.prototype.getMonth);var Lt=d.bind(Date.prototype.getDate);var qt=d.bind(Date.prototype.getUTCFullYear);var Kt=d.bind(Date.prototype.getUTCMonth);var Qt=d.bind(Date.prototype.getUTCDate);var Vt=d.bind(Date.prototype.getUTCDay);var _t=d.bind(Date.prototype.getUTCHours);var tr=d.bind(Date.prototype.getUTCMinutes);var rr=d.bind(Date.prototype.getUTCSeconds);var er=d.bind(Date.prototype.getUTCMilliseconds);var nr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var ir=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var ar=function daysInMonth(t,r){return Lt(new Date(r,t,0))};P(Date.prototype,{getFullYear:function getFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);if(t<0&&Xt(this)>11){return t+1}return t},getMonth:function getMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);if(t<0&&r>11){return 0}return r},getDate:function getDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);var e=Lt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e},getUTCFullYear:function getUTCFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);if(t<0&&Kt(this)>11){return t+1}return t},getUTCMonth:function getUTCMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);if(t<0&&r>11){return 0}return r},getUTCDate:function getUTCDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);var e=Qt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e}},Jt);P(Date.prototype,{toUTCString:function toUTCString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Vt(this);var r=Qt(this);var e=Kt(this);var n=qt(this);var i=_t(this);var a=tr(this);var o=rr(this);return nr[t]+", "+(r<10?"0"+r:r)+" "+ir[e]+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"}},Jt||Zt);P(Date.prototype,{toDateString:function toDateString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n}},Jt||Gt);if(Jt||Ht){Date.prototype.toString=function toString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();var i=this.getHours();var a=this.getMinutes();var o=this.getSeconds();var f=this.getTimezoneOffset();var u=Math.floor(Math.abs(f)/60);var l=Math.floor(Math.abs(f)%60);return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"+(f>0?"-":"+")+(u<10?"0"+u:u)+(l<10?"0"+l:l)};if(R){e.defineProperty(Date.prototype,"toString",{configurable:true,enumerable:false,writable:true})}}var or=-621987552e5;var fr="-000001";var ur=Date.prototype.toISOString&&new Date(or).toISOString().indexOf(fr)===-1;var lr=Date.prototype.toISOString&&new Date(-1).toISOString()!=="1969-12-31T23:59:59.999Z";var sr=d.bind(Date.prototype.getTime);P(Date.prototype,{toISOString:function toISOString(){if(!isFinite(this)||!isFinite(sr(this))){throw new RangeError("Date.prototype.toISOString called on non-finite value.")}var t=qt(this);var r=Kt(this);t+=Math.floor(r/12);r=(r%12+12)%12;var e=[r+1,Qt(this),_t(this),tr(this),rr(this)];t=(t<0?"-":t>9999?"+":"")+K("00000"+Math.abs(t),0<=t&&t<=9999?-4:-6);for(var n=0;n<e.length;++n){e[n]=K("00"+e[n],-2)}return t+"-"+W(e,0,2).join("-")+"T"+W(e,2).join(":")+"."+K("000"+er(this),-3)+"Z"}},ur||lr);var cr=function(){try{return Date.prototype.toJSON&&new Date(NaN).toJSON()===null&&new Date(or).toJSON().indexOf(fr)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return true}})}catch(t){return false}}();if(!cr){Date.prototype.toJSON=function toJSON(t){var r=e(this);var n=z.ToPrimitive(r);if(typeof n==="number"&&!isFinite(n)){return null}var i=r.toISOString;if(!D(i)){throw new TypeError("toISOString property is not callable")}return i.call(r)}}var vr=Date.parse("+033658-09-27T01:46:40.000Z")===1e15;var hr=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));var pr=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(pr||hr||!vr){var yr=Math.pow(2,31)-1;var dr=Y(new Date(1970,0,1,0,0,0,yr+1).getTime());Date=function(t){var r=function Date(e,n,i,a,f,u,l){var s=arguments.length;var c;if(this instanceof t){var v=u;var h=l;if(dr&&s>=7&&l>yr){var p=Math.floor(l/yr)*yr;var y=Math.floor(p/1e3);v+=y;h-=y*1e3}c=s===1&&o(e)===e?new t(r.parse(e)):s>=7?new t(e,n,i,a,f,v,h):s>=6?new t(e,n,i,a,f,v):s>=5?new t(e,n,i,a,f):s>=4?new t(e,n,i,a):s>=3?new t(e,n,i):s>=2?new t(e,n):s>=1?new t(e instanceof t?+e:e):new t}else{c=t.apply(this,arguments)}if(!J(c)){P(c,{constructor:r},true)}return c};var e=new RegExp("^"+"(\\d{4}|[+-]\\d{6})"+"(?:-(\\d{2})"+"(?:-(\\d{2})"+"(?:"+"T(\\d{2})"+":(\\d{2})"+"(?:"+":(\\d{2})"+"(?:(\\.\\d{1,}))?"+")?"+"("+"Z|"+"(?:"+"([-+])"+"(\\d{2})"+":(\\d{2})"+")"+")?)?)?)?"+"$");var n=[0,31,59,90,120,151,181,212,243,273,304,334,365];var i=function dayFromMonth(t,r){var e=r>1?1:0;return n[r]+Math.floor((t-1969+e)/4)-Math.floor((t-1901+e)/100)+Math.floor((t-1601+e)/400)+365*(t-1970)};var a=function toUTC(r){var e=0;var n=r;if(dr&&n>yr){var i=Math.floor(n/yr)*yr;var a=Math.floor(i/1e3);e+=a;n-=a*1e3}return u(new t(1970,0,1,0,0,e,n))};for(var f in t){if(G(t,f)){r[f]=t[f]}}P(r,{now:t.now,UTC:t.UTC},true);r.prototype=t.prototype;P(r.prototype,{constructor:r},true);var l=function parse(r){var n=e.exec(r);if(n){var o=u(n[1]),f=u(n[2]||1)-1,l=u(n[3]||1)-1,s=u(n[4]||0),c=u(n[5]||0),v=u(n[6]||0),h=Math.floor(u(n[7]||0)*1e3),p=Boolean(n[4]&&!n[8]),y=n[9]==="-"?1:-1,d=u(n[10]||0),g=u(n[11]||0),w;var b=c>0||v>0||h>0;if(s<(b?24:25)&&c<60&&v<60&&h<1e3&&f>-1&&f<12&&d<24&&g<60&&l>-1&&l<i(o,f+1)-i(o,f)){w=((i(o,f)+l)*24+s+d*y)*60;w=((w+c+g*y)*60+v)*1e3+h;if(p){w=a(w)}if(-864e13<=w&&w<=864e13){return w}}return NaN}return t.parse.apply(this,arguments)};P(r,{parse:l});return r}(Date)}if(!Date.now){Date.now=function now(){return(new Date).getTime()}}var gr=l.toFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||(1000000000000000128).toFixed(0)!=="1000000000000000128");var wr={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function multiply(t,r){var e=-1;var n=r;while(++e<wr.size){n+=t*wr.data[e];wr.data[e]=n%wr.base;n=Math.floor(n/wr.base)}},divide:function divide(t){var r=wr.size;var e=0;while(--r>=0){e+=wr.data[r];wr.data[r]=Math.floor(e/t);e=e%t*wr.base}},numToString:function numToString(){var t=wr.size;var r="";while(--t>=0){if(r!==""||t===0||wr.data[t]!==0){var e=o(wr.data[t]);if(r===""){r=e}else{r+=K("0000000",0,7-e.length)+e}}}return r},pow:function pow(t,r,e){return r===0?e:r%2===1?pow(t,r-1,e*t):pow(t*t,r/2,e)},log:function log(t){var r=0;var e=t;while(e>=4096){r+=12;e/=4096}while(e>=2){r+=1;e/=2}return r}};var br=function toFixed(t){var r,e,n,i,a,f,l,s;r=u(t);r=Y(r)?0:Math.floor(r);if(r<0||r>20){throw new RangeError("Number.toFixed called with invalid number of decimals")}e=u(this);if(Y(e)){return"NaN"}if(e<=-1e21||e>=1e21){return o(e)}n="";if(e<0){n="-";e=-e}i="0";if(e>1e-21){a=wr.log(e*wr.pow(2,69,1))-69;f=a<0?e*wr.pow(2,-a,1):e/wr.pow(2,a,1);f*=4503599627370496;a=52-a;if(a>0){wr.multiply(0,f);l=r;while(l>=7){wr.multiply(1e7,0);l-=7}wr.multiply(wr.pow(10,l,1),0);l=a-1;while(l>=23){wr.divide(1<<23);l-=23}wr.divide(1<<l);wr.multiply(1,1);wr.divide(2);i=wr.numToString()}else{wr.multiply(0,f);wr.multiply(1<<-a,0);i=wr.numToString()+K("0.00000000000000000000",2,2+r)}}if(r>0){s=i.length;if(s<=r){i=n+K("0.0000000000000000000",0,r-s+2)+i}else{i=n+K(i,0,s-r)+"."+K(i,s-r)}}else{i=n+i}return i};P(l,{toFixed:br},gr);var Tr=function(){try{return 1..toPrecision(undefined)==="1"}catch(t){return true}}();var mr=l.toPrecision;P(l,{toPrecision:function toPrecision(t){return typeof t==="undefined"?mr.call(this):mr.call(this,t)}},Tr);if("ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1){(function(){var t=typeof/()??/.exec("")[1]==="undefined";var r=Math.pow(2,32)-1;f.split=function(e,n){var i=String(this);if(typeof e==="undefined"&&n===0){return[]}if(!M(e)){return Q(this,e,n)}var a=[];var o=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,u,l,s,c;var h=new RegExp(e.source,o+"g");if(!t){u=new RegExp("^"+h.source+"$(?!\\s)",o)}var p=typeof n==="undefined"?r:z.ToUint32(n);l=h.exec(i);while(l){s=l.index+l[0].length;if(s>f){_(a,K(i,f,l.index));if(!t&&l.length>1){l[0].replace(u,function(){for(var t=1;t<arguments.length-2;t++){if(typeof arguments[t]==="undefined"){l[t]=void 0}}})}if(l.length>1&&l.index<i.length){v.apply(a,W(l,1))}c=l[0].length;f=s;if(a.length>=p){break}}if(h.lastIndex===l.index){h.lastIndex++}l=h.exec(i)}if(f===i.length){if(c||!h.test("")){_(a,"")}}else{_(a,K(i,f))}return a.length>p?W(a,0,p):a}})()}else if("0".split(void 0,0).length){f.split=function split(t,r){if(typeof t==="undefined"&&r===0){return[]}return Q(this,t,r)}}var Dr=f.replace;var Sr=function(){var t=[];"x".replace(/x(.)?/g,function(r,e){_(t,e)});return t.length===1&&typeof t[0]==="undefined"}();if(!Sr){f.replace=function replace(t,r){var e=D(r);var n=M(t)&&/\)[*?]/.test(t.source);if(!e||!n){return Dr.call(this,t,r)}else{var i=function(e){var n=arguments.length;var i=t.lastIndex;t.lastIndex=0;var a=t.exec(e)||[];t.lastIndex=i;_(a,arguments[n-2],arguments[n-1]);return r.apply(this,a)};return Dr.call(this,t,i)}}}var xr=f.substr;var Or="".substr&&"0b".substr(-1)!=="b";P(f,{substr:function substr(t,r){var e=t;if(t<0){e=w(this.length+t,0)}return xr.call(this,e,r)}},Or);var Er="\t\n\x0B\f\r \xa0\u1680\u2000\u2001\u2002\u2003"+"\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028"+"\u2029\ufeff";var jr="\u200b";var Ir="["+Er+"]";var Mr=new RegExp("^"+Ir+Ir+"*");var Ur=new RegExp(Ir+Ir+"*$");var $r=f.trim&&(Er.trim()||!jr.trim());P(f,{trim:function trim(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}return o(this).replace(Mr,"").replace(Ur,"")}},$r);var Fr=d.bind(String.prototype.trim);var Nr=f.lastIndexOf&&"abc\u3042\u3044".lastIndexOf("\u3042\u3044",2)!==-1;P(f,{lastIndexOf:function lastIndexOf(t){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var r=o(this);var e=o(t);var n=arguments.length>1?u(arguments[1]):NaN;var i=Y(n)?Infinity:z.ToInteger(n);var a=b(w(i,0),r.length);var f=e.length;var l=a+f;while(l>0){l=w(0,l-f);var s=V(K(r,l,a+f),e);if(s!==-1){return l+s}}return-1}},Nr);var Cr=f.lastIndexOf;P(f,{lastIndexOf:function lastIndexOf(t){return Cr.apply(this,arguments)}},f.lastIndexOf.length!==1);if(parseInt(Er+"08")!==8||parseInt(Er+"0x16")!==22){parseInt=function(t){var r=/^[-+]?0[xX]/;return function parseInt(e,n){if(typeof e==="symbol"){""+e}var i=Fr(String(e));var a=u(n)||(r.test(i)?16:10);return t(i,a)}}(parseInt)}if(1/parseFloat("-0")!==-Infinity){parseFloat=function(t){return function parseFloat(r){var e=Fr(String(r));var n=t(e);return n===0&&K(e,0,1)==="-"?-0:n}}(parseFloat)}if(String(new RangeError("test"))!=="RangeError: test"){var kr=function toString(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var t=this.name;if(typeof t==="undefined"){t="Error"}else if(typeof t!=="string"){t=o(t)}var r=this.message;if(typeof r==="undefined"){r=""}else if(typeof r!=="string"){r=o(r)}if(!t){return r}if(!r){return t}return t+": "+r};Error.prototype.toString=kr}if(R){var Ar=function(t,r){if(tt(t,r)){var e=Object.getOwnPropertyDescriptor(t,r);if(e.configurable){e.enumerable=false;Object.defineProperty(t,r,e)}}};Ar(Error.prototype,"message");if(Error.prototype.message!==""){Error.prototype.message=""}Ar(Error.prototype,"name")}if(String(/a/gim)!=="/a/gim"){var Rr=function toString(){var t="/"+this.source+"/";if(this.global){t+="g"}if(this.ignoreCase){t+="i"}if(this.multiline){t+="m"}return t};RegExp.prototype.toString=Rr}});
/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.4/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(t){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var u=o(i);var f=function(){return!i(function(){return Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var m={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var O=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){m.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=O(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.shift);var A=Math.max;var R=Math.min;var _=Math.floor;var k=Math.abs;var L=Math.exp;var F=Math.log;var D=Math.sqrt;var z=Function.call.bind(Object.prototype.hasOwnProperty);var q;var W=function(){};var G=S.Map;var H=G&&G.prototype["delete"];var V=G&&G.prototype.get;var B=G&&G.prototype.has;var U=G&&G.prototype.set;var $=S.Symbol||{};var J=$.species||"@@species";var X=Number.isNaN||function isNaN(e){return e!==e};var K=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Z=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(X(t)){return t}return t<0?-1:1};var Y=function log1p(e){var t=Number(e);if(t<-1||X(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(F(1+t)/(1+t-1))};var Q=function isArguments(e){return g(e)==="[object Arguments]"};var ee=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var te=Q(arguments)?Q:ee;var re={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var ne=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);m.preserveToString(e[t],n)};var oe=typeof $==="function"&&typeof $["for"]==="function"&&re.symbol($());var ie=re.symbol($.iterator)?$.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){ie="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ae=S.Reflect;var ue=String;var fe=typeof document==="undefined"||!document?null:document.all;var se=fe==null?function isNullOrUndefined(e){return e==null}:function isNullOrUndefinedAndNotDocumentAll(e){return e==null&&e!==fe};var ce={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!ce.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(se(e)){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"||e===fe},ToObject:function(e,t){return Object(ce.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return ce.IsCallable(e)},ToInt32:function(e){return ce.ToNumber(e)>>0},ToUint32:function(e){return ce.ToNumber(e)>>>0},ToNumber:function(e){if(g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=ce.ToNumber(e);if(X(t)){return 0}if(t===0||!K(t)){return t}return(t>0?1:-1)*_(k(t))},ToLength:function(e){var t=ce.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return X(e)&&X(t)},SameValueZero:function(e,t){return e===t||X(e)&&X(t)},IsIterable:function(e){return ce.TypeIsObject(e)&&(typeof e[ie]!=="undefined"||te(e))},GetIterator:function(e){if(te(e)){return new q(e,"value")}var t=ce.GetMethod(e,ie);if(!ce.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=ce.Call(t,e);if(!ce.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=ce.ToObject(e)[t];if(se(r)){return void 0}if(!ce.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=ce.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=ce.Call(r,e)}catch(i){o=i}if(t){return}if(o){throw o}if(!ce.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!ce.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=ce.IteratorNext(e);var r=ce.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ae.construct){return ae.construct(e,t,o)}var i=o.prototype;if(!ce.TypeIsObject(i)){i=Object.prototype}var a=O(i);var u=ce.Call(e,a,t);return ce.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!ce.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[J];if(se(n)){return t}if(!ce.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=ce.ToString(e);var i="<"+t;if(r!==""){var a=ce.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!ce.TypeIsObject(e)){return false}var t=e[$.match];if(typeof t!=="undefined"){return!!t}return re.regex(e)},ToString:function ToString(e){return ue(e)}};if(s&&oe){var le=function defineWellKnownSymbol(e){if(re.symbol($[e])){return $[e]}var t=$["for"]("Symbol."+e);Object.defineProperty($,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!re.symbol($.search)){var pe=le("search");var ve=String.prototype.search;h(RegExp.prototype,pe,function search(e){return ce.Call(ve,e,[this])});var ye=function search(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,pe);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(ve,t,[ce.ToString(e)])};ne(String.prototype,"search",ye)}if(!re.symbol($.replace)){var he=le("replace");var be=String.prototype.replace;h(RegExp.prototype,he,function replace(e,t){return ce.Call(be,e,[this,t])});var ge=function replace(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,he);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(be,r,[ce.ToString(e),t])};ne(String.prototype,"replace",ge)}if(!re.symbol($.split)){var de=le("split");var me=String.prototype.split;h(RegExp.prototype,de,function split(e,t){return ce.Call(me,e,[this,t])});var Oe=function split(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,de);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(me,r,[ce.ToString(e),t])};ne(String.prototype,"split",Oe)}var we=re.symbol($.match);var je=we&&function(){var e={};e[$.match]=function(){return 42};return"a".match(e)!==42}();if(!we||je){var Se=le("match");var Te=String.prototype.match;h(RegExp.prototype,Se,function match(e){return ce.Call(Te,e,[this])});var Ie=function match(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,Se);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(Te,t,[ce.ToString(e)])};ne(String.prototype,"match",Ie)}}var Ee=function wrapConstructor(e,t,r){m.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in W||r[n]){return}m.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in W||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;m.redefine(e.prototype,"constructor",t)};var Pe=function(){return this};var Ce=function(e){if(s&&!z(e,J)){m.getter(e,J,Pe)}};var Me=function(e,t){var r=t||function iterator(){return this};h(e,ie,r);if(!e[ie]&&re.symbol(ie)){e[ie]=r}};var xe=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var Ne=function createDataPropertyOrThrow(e,t,r){xe(e,t,r);if(!ce.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var Ae=function(e,t,r,n){if(!ce.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!ce.TypeIsObject(o)){o=r}var i=O(o);for(var a in n){if(z(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var Re=String.fromCodePoint;ne(String,"fromCodePoint",function fromCodePoint(e){return ce.Call(Re,this,arguments)})}var _e={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!ce.SameValue(r,ce.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return t.join("")},raw:function raw(e){var t=ce.ToObject(e,"bad callSite");var r=ce.ToObject(t.raw,"bad raw value");var n=r.length;var o=ce.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=ce.ToString(a);s=ce.ToString(r[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=ce.ToString(f);M(i,c);a+=1}return i.join("")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){ne(String,"raw",_e.raw)}b(String,_e);var ke=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var Le=Infinity;var Fe={repeat:function repeat(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);if(r<0||r>=Le){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return ke(t,r)},startsWith:function startsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=ce.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=A(ce.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=ce.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:ce.ToInteger(o);var a=R(A(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(ce.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=ce.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){ne(String.prototype,"includes",Fe.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var De=i(function(){return"/a/".startsWith(/a/)});var ze=a(function(){return"abc".startsWith("a",Infinity)===false});if(!De||!ze){ne(String.prototype,"startsWith",Fe.startsWith);ne(String.prototype,"endsWith",Fe.endsWith)}}if(oe){var qe=a(function(){var e=/a/;e[$.match]=false;return"/a/".startsWith(e)});if(!qe){ne(String.prototype,"startsWith",Fe.startsWith)}var We=a(function(){var e=/a/;e[$.match]=false;return"/a/".endsWith(e)});if(!We){ne(String.prototype,"endsWith",Fe.endsWith)}var Ge=a(function(){var e=/a/;e[$.match]=false;return"/a/".includes(e)});if(!Ge){ne(String.prototype,"includes",Fe.includes)}}b(String.prototype,Fe);var He=["\t\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var Ve=new RegExp("(^["+He+"]+)|(["+He+"]+$)","g");var Be=function trim(){return ce.ToString(ce.RequireObjectCoercible(this)).replace(Ve,"")};var Ue=["\x85","\u200b","\ufffe"].join("");var $e=new RegExp("["+Ue+"]","g");var Je=/^[-+]0x[0-9a-f]+$/i;var Xe=Ue.trim().length!==Ue.length;h(String.prototype,"trim",Be,Xe);var Ke=function(e){return{value:e,done:arguments.length===0}};var Ze=function(e){ce.RequireObjectCoercible(e);this._s=ce.ToString(e);this._i=0};Ze.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Ke()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Ke(e.substr(t,o))};Me(Ze.prototype);Me(String.prototype,function(){return new Ze(this)});var Ye={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!ce.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(te(e)||ce.GetMethod(e,ie))!=="undefined";var u,f,s;if(a){f=ce.IsConstructor(r)?Object(new r):[];var c=ce.GetIterator(e);var l,p;s=0;while(true){l=ce.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(v){ce.IteratorClose(c,true);throw v}s+=1}u=s}else{var y=ce.ToObject(e);u=ce.ToLength(y.length);f=ce.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(s=0;s<u;++s){h=y[s];if(o){h=typeof i==="undefined"?n(h,s):t(n,i,h,s)}Ne(f,s,h)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!ce.IsCallable(t)?new Array(e):ce.Construct(t,[e]);for(var o=0;o<e;++o){Ne(n,o,arguments[o])}n.length=e;return n}};b(Array,Ye);Ce(Array);q=function(e,t){this.i=0;this.array=e;this.kind=t};b(q.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof q)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=ce.ToLength(t.length);for(;e<r;e++){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Ke(o)}}this.array=void 0;return Ke()}});Me(q.prototype);var Qe=Array.of===Ye.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!Qe){ne(Array,"of",Ye.of)}var et={copyWithin:function copyWithin(e,t){var r=ce.ToObject(this);var n=ce.ToLength(r.length);var o=ce.ToInteger(e);var i=ce.ToInteger(t);var a=o<0?A(n+o,0):R(o,n);var u=i<0?A(n+i,0):R(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:ce.ToInteger(f);var c=s<0?A(n+s,0):R(s,n);var l=R(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=ce.ToObject(this);var o=ce.ToLength(n.length);t=ce.ToInteger(typeof t==="undefined"?0:t);r=ce.ToInteger(typeof r==="undefined"?o:r);var i=t<0?A(o+t,0):R(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new q(this,"key")},values:function values(){return new q(this,"value")},entries:function entries(){return new q(this,"entry")}};if(Array.prototype.keys&&!ce.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!ce.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ie]){b(Array.prototype,{values:Array.prototype[ie]});if(re.symbol($.unscopables)){Array.prototype[$.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var tt=Array.prototype.values;ne(Array.prototype,"values",function values(){return ce.Call(tt,this,arguments)});h(Array.prototype,ie,Array.prototype.values,true)}b(Array.prototype,et);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}Me(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){Me(Object.getPrototypeOf([].values()))}var rt=function(){return a(function(){return Array.from({length:-1}).length===0})}();var nt=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!rt||!nt){ne(Array,"from",Ye.from)}var ot=function(){return a(function(){return Array.from([0],void 0)})}();if(!ot){var it=Array.from;ne(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return ce.Call(it,this,arguments)}else{return t(it,this,e)}})}var at=-(Math.pow(2,32)-1);var ut=function(e,r){var n={length:at};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!ut(Array.prototype.forEach)){var ft=Array.prototype.forEach;ne(Array.prototype,"forEach",function forEach(e){return ce.Call(ft,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.map)){var st=Array.prototype.map;ne(Array.prototype,"map",function map(e){return ce.Call(st,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.filter)){var ct=Array.prototype.filter;ne(Array.prototype,"filter",function filter(e){return ce.Call(ct,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.some)){var lt=Array.prototype.some;ne(Array.prototype,"some",function some(e){return ce.Call(lt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.every)){var pt=Array.prototype.every;ne(Array.prototype,"every",function every(e){return ce.Call(pt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduce)){var vt=Array.prototype.reduce;ne(Array.prototype,"reduce",function reduce(e){return ce.Call(vt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduceRight,true)){var yt=Array.prototype.reduceRight;ne(Array.prototype,"reduceRight",function reduceRight(e){return ce.Call(yt,this.length>=0?this:[],arguments)},true)}var ht=Number("0o10")!==8;var bt=Number("0b10")!==2;var gt=y(Ue,function(e){return Number(e+0+e)===0});if(ht||bt||gt){var dt=Number;var mt=/^0b[01]+$/i;var Ot=/^0o[0-7]+$/i;var wt=mt.test.bind(mt);var jt=Ot.test.bind(Ot);var St=function(e){var t;if(typeof e.valueOf==="function"){t=e.valueOf();if(re.primitive(t)){return t}}if(typeof e.toString==="function"){t=e.toString();if(re.primitive(t)){return t}}throw new TypeError("No default value")};var Tt=$e.test.bind($e);var It=Je.test.bind(Je);var Et=function(){var e=function Number(t){var r;if(arguments.length>0){r=re.primitive(t)?t:St(t,"number")}else{r=0}if(typeof r==="string"){r=ce.Call(Be,r);if(wt(r)){r=parseInt(C(r,2),2)}else if(jt(r)){r=parseInt(C(r,2),8)}else if(Tt(r)||It(r)){r=NaN}}var n=this;var o=a(function(){dt.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new dt(r)}return dt(r)};return e}();Ee(dt,Et,{});b(Et,{NaN:dt.NaN,MAX_VALUE:dt.MAX_VALUE,MIN_VALUE:dt.MIN_VALUE,NEGATIVE_INFINITY:dt.NEGATIVE_INFINITY,POSITIVE_INFINITY:dt.POSITIVE_INFINITY});Number=Et;m.redefine(S,"Number",Et)}var Pt=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Pt,MIN_SAFE_INTEGER:-Pt,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:K,isInteger:function isInteger(e){return K(e)&&ce.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&k(e)<=Number.MAX_SAFE_INTEGER},isNaN:X});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if([,1].find(function(){return true})===1){ne(Array.prototype,"find",et.find)}if([,1].findIndex(function(){return true})!==0){ne(Array.prototype,"findIndex",et.findIndex)}var Ct=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Mt=function ensureEnumerable(e,t){if(s&&Ct(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var xt=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var Nt=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var At=function(e,t){var r=n(Object(t));var o;if(ce.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),Ct(t))}return p(P(r,o||[]),Nt(t),e)};var Rt={assign:function(e,t){var r=ce.ToObject(e,"Cannot convert undefined or null to object");return p(ce.Call(xt,1,arguments),At,r)},is:function is(e,t){return ce.SameValue(e,t)}};var _t=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(_t){ne(Object,"assign",Rt.assign)}b(Object,Rt);if(s){var kt={setPrototypeOf:function(e,r){var n;var o=function(e,t){if(!ce.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||ce.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var i=function(e,r){o(e,r);t(n,e,r);return e};try{n=e.getOwnPropertyDescriptor(e.prototype,r).set;t(n,{},null)}catch(a){if(e.prototype!=={}[r]){return}n=function(e){this[r]=e};i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};b(Object,kt)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Lt=!i(function(){return Object.keys("foo")});if(!Lt){var Ft=Object.keys;ne(Object,"keys",function keys(e){return Ft(ce.ToObject(e))});n=Object.keys}var Dt=i(function(){return Object.keys(/a/g)});if(Dt){var zt=Object.keys;ne(Object,"keys",function keys(e){if(re.regex(e)){var t=[];for(var r in e){if(z(e,r)){M(t,r)}}return t}return zt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var qt=!i(function(){return Object.getOwnPropertyNames("foo")});if(!qt){var Wt=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Gt=Object.getOwnPropertyNames;ne(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=ce.ToObject(e);if(g(t)==="[object Window]"){try{return Gt(t)}catch(r){return P([],Wt)}}return Gt(t)})}}if(Object.getOwnPropertyDescriptor){var Ht=!i(function(){return Object.getOwnPropertyDescriptor("foo","bar")});if(!Ht){var Vt=Object.getOwnPropertyDescriptor;ne(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Vt(ce.ToObject(e),t)})}}if(Object.seal){var Bt=!i(function(){return Object.seal("foo")});if(!Bt){var Ut=Object.seal;ne(Object,"seal",function seal(e){if(!ce.TypeIsObject(e)){return e}return Ut(e)})}}if(Object.isSealed){var $t=!i(function(){return Object.isSealed("foo")});if(!$t){var Jt=Object.isSealed;ne(Object,"isSealed",function isSealed(e){if(!ce.TypeIsObject(e)){return true}return Jt(e)})}}if(Object.freeze){var Xt=!i(function(){return Object.freeze("foo")});if(!Xt){var Kt=Object.freeze;ne(Object,"freeze",function freeze(e){if(!ce.TypeIsObject(e)){return e}return Kt(e)})}}if(Object.isFrozen){var Zt=!i(function(){return Object.isFrozen("foo")});if(!Zt){var Yt=Object.isFrozen;ne(Object,"isFrozen",function isFrozen(e){if(!ce.TypeIsObject(e)){return true}return Yt(e)})}}if(Object.preventExtensions){var Qt=!i(function(){return Object.preventExtensions("foo")});if(!Qt){var er=Object.preventExtensions;ne(Object,"preventExtensions",function preventExtensions(e){if(!ce.TypeIsObject(e)){return e}return er(e)})}}if(Object.isExtensible){var tr=!i(function(){return Object.isExtensible("foo")});if(!tr){var rr=Object.isExtensible;ne(Object,"isExtensible",function isExtensible(e){if(!ce.TypeIsObject(e)){return false}return rr(e)})}}if(Object.getPrototypeOf){var nr=!i(function(){return Object.getPrototypeOf("foo")});if(!nr){var or=Object.getPrototypeOf;ne(Object,"getPrototypeOf",function getPrototypeOf(e){return or(ce.ToObject(e))})}}var ir=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&ce.IsCallable(e.get)}();if(s&&!ir){var ar=function flags(){if(!ce.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};m.getter(RegExp.prototype,"flags",ar)}var ur=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var fr=oe&&s&&function(){var e=/./;e[$.match]=false;return RegExp(e)===e}();var sr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var cr=sr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!sr||!cr){var lr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=ce.RequireObjectCoercible(this);if(re.regex(e)){return t(lr,e)}var r=ue(e.source);var n=ue(e.flags);return"/"+r+"/"+n},true);m.preserveToString(RegExp.prototype.toString,lr)}if(s&&(!ur||fr)){var pr=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var vr=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var yr=function(){return this.source};var hr=ce.IsCallable(vr.get)?vr.get:yr;var br=RegExp;var gr=function(){return function RegExp(e,t){var r=ce.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(re.regex(e)){o=ce.Call(hr,e);i=typeof t==="undefined"?ce.Call(pr,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new br(e,t)}}();Ee(br,gr,{$input:true});RegExp=gr;m.redefine(S,"RegExp",gr)}if(s){var dr={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(dr),function(e){if(e in RegExp&&!(dr[e]in RegExp)){m.getter(RegExp,dr[e],function get(){return RegExp[e]})}})}Ce(RegExp);var mr=1/Number.EPSILON;var Or=function roundTiesToEven(e){return e+mr-mr};var wr=Math.pow(2,-23);var jr=Math.pow(2,127)*(2-wr);var Sr=Math.pow(2,-126);var Tr=Math.E;var Ir=Math.LOG2E;var Er=Math.LOG10E;var Pr=Number.prototype.clz;delete Number.prototype.clz;var Cr={acosh:function acosh(e){var t=Number(e);if(X(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}var r=1/(t*t);if(t<2){return Y(t-1+D(1-r)*t)}var n=t/2;return Y(n+D(1-r)*n-1)+1/Ir},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}var r=k(t);var n=r*r;var o=Z(t);if(r<1){return o*Y(r+n/(D(n+1)+1))}return o*(Y(r/2+D(1+1/n)*r/2-1)+1/Ir)},atanh:function atanh(e){var t=Number(e);if(t===0){return t}if(t===-1){return-Infinity}if(t===1){return Infinity}if(X(t)||t<-1||t>1){return NaN}var r=k(t);return Z(t)*Y(2*r/(1-r))/2},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=L(F(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=ce.ToUint32(t);if(r===0){return 32}return Pr?ce.Call(Pr,r):31-_(F(r+.5)*Ir)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(X(t)){return NaN}if(!T(t)){return Infinity}var r=L(k(t)-1);return(r+1/(r*Tr*Tr))*(Tr/2)},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(k(t)>.5){return L(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=k(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*D(r)},log2:function log2(e){return F(e)*Ir},log10:function log10(e){return F(e)*Er},log1p:Y,sign:Z,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}var r=k(t);if(r<1){var n=Math.expm1(r);return Z(t)*n*(1+1/(n+1))/2}var o=L(r-1);return Z(t)*(o-1/(o*Tr*Tr))*(Tr/2)},tanh:function tanh(e){var t=Number(e);if(X(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(L(t)+L(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-_(-t):_(t)},imul:function imul(e,t){var r=ce.ToUint32(e);var n=ce.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||X(t)){return t}var r=Z(t);var n=k(t);if(n<Sr){return r*Or(n/Sr/wr)*Sr*wr}var o=(1+wr/Number.EPSILON)*n;var i=o-(o-n);if(i>jr||X(i)){return r*Infinity}return r*i}};var Mr=function withinULPDistance(e,t,r){return k(1-e/t)/Number.EPSILON<(r||8)};b(Math,Cr);h(Math,"sinh",Cr.sinh,Math.sinh(710)===Infinity);h(Math,"cosh",Cr.cosh,Math.cosh(710)===Infinity);h(Math,"log1p",Cr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",Cr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));h(Math,"asinh",Cr.asinh,Math.asinh(1e300)===Infinity);h(Math,"atanh",Cr.atanh,Math.atanh(1e-300)===0);h(Math,"tanh",Cr.tanh,Math.tanh(-2e-17)!==-2e-17);
h(Math,"acosh",Cr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"acosh",Cr.acosh,!Mr(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON)));h(Math,"cbrt",Cr.cbrt,!Mr(Math.cbrt(1e-300),1e-100));h(Math,"sinh",Cr.sinh,Math.sinh(-2e-17)!==-2e-17);var xr=Math.expm1(10);h(Math,"expm1",Cr.expm1,xr>22025.465794806718||xr<22025.465794806718);var Nr=Math.round;var Ar=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var Rr=mr+1;var _r=2*mr-1;var kr=[Rr,_r].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=_(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!Ar||!kr);m.preserveToString(Math.round,Nr);var Lr=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=Cr.imul;m.preserveToString(Math.imul,Lr)}if(Math.imul.length!==2){ne(Math,"imul",function imul(e,t){return ce.Call(Lr,Math,arguments)})}var Fr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}ce.IsPromise=function(e){if(!ce.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!ce.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(ce.IsCallable(t.resolve)&&ce.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&ce.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=N(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=ce.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(ce.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(i){n=i;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var m=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var O=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return m(e,new TypeError("Self resolution"))}if(!ce.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(o){return m(e,o)}if(!ce.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return m(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=O(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(a){i(a)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!ce.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=Ae(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=O(r);var o=n.reject;try{t(n.resolve,o)}catch(i){o(i)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=ce.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(s){e.done=true;throw s}o[f]=void 0;var c=t.resolve(u);var l=P(f,o,r,i);i.count+=1;w(c.then,c,l,r.reject);f+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=ce.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},race:function race(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},reject:function reject(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(ce.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{"catch":function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!ce.IsPromise(n)){throw new TypeError("not a promise")}var o=ce.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=ce.IsCallable(e)?e:a;var d=ce.IsCallable(t)?t:u;var m=n._promise;var O;if(m.state===f){if(m.reactionLength===0){m.fulfillReactionHandler0=g;m.rejectReactionHandler0=d;m.reactionCapability0=i}else{var w=3*(m.reactionLength-1);m[w+l]=g;m[w+p]=d;m[w+v]=i}m.reactionLength+=1}else if(m.state===s){O=m.result;h(g,i,O)}else if(m.state===c){O=m.result;h(d,i,O)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof Fr==="function"){b(S,{Promise:Fr});var Dr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var zr=!i(function(){return S.Promise.reject(42).then(null,5).then(null,W)});var qr=i(function(){return S.Promise.call(3,W)});var Wr=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,W).then(null,W)}catch(n){return true}return t===r}(S.Promise);var Gr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var Hr=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};Hr.prototype=Promise.prototype;Hr.all=Promise.all;var Vr=a(function(){return!!Hr.all([1,2])});if(!Dr||!zr||!qr||Wr||!Gr||Vr){Promise=Fr;ne(S,"Promise",Fr)}if(Promise.all.length!==1){var Br=Promise.all;ne(Promise,"all",function all(e){return ce.Call(Br,this,arguments)})}if(Promise.race.length!==1){var Ur=Promise.race;ne(Promise,"race",function race(e){return ce.Call(Ur,this,arguments)})}if(Promise.resolve.length!==1){var $r=Promise.resolve;ne(Promise,"resolve",function resolve(e){return ce.Call($r,this,arguments)})}if(Promise.reject.length!==1){var Jr=Promise.reject;ne(Promise,"reject",function reject(e){return ce.Call(Jr,this,arguments)})}Mt(Promise,"all");Mt(Promise,"race");Mt(Promise,"resolve");Mt(Promise,"reject");Ce(Promise)}var Xr=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Kr=Xr(["z","a","bb"]);var Zr=Xr(["z",1,"a","3",2]);if(s){var Yr=function fastkey(e,t){if(!t&&!Kr){return null}if(se(e)){return"^"+ce.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Zr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var Qr=function emptyObject(){return Object.create?Object.create(null):{}};var en=function addIterableToMap(e,n,o){if(r(o)||re.string(o)){l(o,function(e){if(!ce.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(!se(o)){a=n.set;if(!ce.IsCallable(a)){throw new TypeError("bad map")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!ce.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(s){ce.IteratorClose(i,true);throw s}}}}};var tn=function addIterableToSet(e,n,o){if(r(o)||re.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(!se(o)){a=n.add;if(!ce.IsCallable(a)){throw new TypeError("bad set")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(s){ce.IteratorClose(i,true);throw s}}}}};var rn={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!ce.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+ce.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");this.head=e._head;this.i=this.head;this.kind=t};i.prototype={isMapIterator:true,next:function next(){if(!this.isMapIterator){throw new TypeError("Not a MapIterator")}var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Ke()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Ke(n)}}this.i=void 0;return Ke()}};Me(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=Ae(this,Map,a,{_es6map:true,_head:null,_map:G?new G:null,_size:0,_storage:Qr()});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){en(Map,e,arguments[0])}return e};a=u.prototype;m.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t;var r=Yr(e,true);if(r!==null){t=this._storage[r];if(t){return t.value}else{return}}if(this._map){t=V.call(this._map,e);if(t){return t.value}else{return}}var n=this._head;var i=n;while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=Yr(e,true);if(t!==null){return typeof this._storage[t]!=="undefined"}if(this._map){return B.call(this._map,e)}var r=this._head;var n=r;while((n=n.next)!==r){if(ce.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=Yr(e,true);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}else{a=this._storage[u]=new r(e,t);i=n.prev}}else if(this._map){if(B.call(this._map,e)){V.call(this._map,e).value=t}else{a=new r(e,t);U.call(this._map,e,a);i=n.prev}}while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(ce.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head;var n=r;var i=Yr(t,true);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}else if(this._map){if(!B.call(this._map,t)){return false}n=V.call(this._map,t).prev;H.call(this._map,t)}while((n=n.next)!==r){if(ce.SameValueZero(n.key,t)){n.key=e;n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._map=G?new G:null;this._size=0;this._storage=Qr();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=e;r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});Me(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!ce.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+ce.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=Ae(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:Qr()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){tn(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}else{var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=new rn.Map;e["[[SetData]]"]=t;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};m.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=Yr(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=Yr(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=Yr(e))!==null){var n=z(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=Qr()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return new f(this["[[SetData]]"].values())},entries:function entries(){r(this,"entries");u(this);return new f(this["[[SetData]]"].entries())},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);Me(i.prototype,i.prototype.values);var f=function SetIterator(e){this.it=e};f.prototype={isSetIterator:true,next:function next(){if(!this.isSetIterator){throw new TypeError("Not a SetIterator")}return this.it.next()}};Me(f.prototype);return i}()};var nn=S.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys);if(nn){S.Set=rn.Set}if(S.Map||S.Set){var on=a(function(){return new Map([[1,2]]).get(1)===2});if(!on){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=O(G.prototype);h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var an=new Map;var un=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var fn=an.set(1,2)===an;if(!un||!fn){ne(Map.prototype,"set",function set(e,r){t(U,this,e===0?0:e,r);return this})}if(!un){b(Map.prototype,{get:function get(e){return t(V,this,e===0?0:e)},has:function has(e){return t(B,this,e===0?0:e)}},true);m.preserveToString(Map.prototype.get,V);m.preserveToString(Map.prototype.has,B)}var sn=new Set;var cn=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(e){e["delete"](0);e.add(-0);return!e.has(0)}(sn);var ln=sn.add(1)===sn;if(!cn||!ln){var pn=Set.prototype.add;Set.prototype.add=function add(e){t(pn,this,e===0?0:e);return this};m.preserveToString(Set.prototype.add,pn)}if(!cn){var vn=Set.prototype.has;Set.prototype.has=function has(e){return t(vn,this,e===0?0:e)};m.preserveToString(Set.prototype.has,vn);var yn=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(yn,this,e===0?0:e)};m.preserveToString(Set.prototype["delete"],yn)}var hn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var bn=Object.setPrototypeOf&&!hn;var gn=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||bn||!gn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=G.prototype;h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var dn=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var mn=Object.setPrototypeOf&&!dn;var On=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||mn||!On){var wn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new wn;if(arguments.length>0){tn(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=wn.prototype;h(S.Set.prototype,"constructor",S.Set,true);m.preserveToString(S.Set,wn)}var jn=new S.Map;var Sn=!a(function(){return jn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||jn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof jn.keys().next!=="function"||Sn||!hn){b(S,{Map:rn.Map,Set:rn.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}Me(Object.getPrototypeOf((new S.Map).keys()));Me(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var Tn=S.Set.prototype.has;ne(S.Set.prototype,"has",function has(e){return t(Tn,this,e)})}}b(S,rn);Ce(S.Map);Ce(S.Set)}var In=function throwUnlessTargetIsObject(e){if(!ce.TypeIsObject(e)){throw new TypeError("target must be an object")}};var En={apply:function apply(){return ce.Call(ce.Call,null,arguments)},construct:function construct(e,t){if(!ce.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!ce.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return ce.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){In(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){In(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(En,{ownKeys:function ownKeys(e){In(e);var t=Object.getOwnPropertyNames(e);if(ce.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var Pn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(En,{isExtensible:function isExtensible(e){In(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){In(e);return Pn(function(){return Object.preventExtensions(e)})}})}if(s){var Cn=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return Cn(o,t,r)}if("value"in n){return n.value}if(n.get){return ce.Call(n.get,r)}return void 0};var Mn=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return Mn(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!ce.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ae.defineProperty(o,r,{value:n})}else{return ae.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}}if(i.set){t(i.set,o,n);return true}return false};Object.assign(En,{defineProperty:function defineProperty(e,t,r){In(e);return Pn(function(){return Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){In(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){In(e);var r=arguments.length>2?arguments[2]:e;return Cn(e,t,r)},set:function set(e,t,r){In(e);var n=arguments.length>3?arguments[3]:e;return Mn(e,t,r,n)}})}if(Object.getPrototypeOf){var xn=Object.getPrototypeOf;En.getPrototypeOf=function getPrototypeOf(e){In(e);return xn(e)}}if(Object.setPrototypeOf&&En.getPrototypeOf){var Nn=function(e,t){var r=t;while(r){if(e===r){return true}r=En.getPrototypeOf(r)}return false};Object.assign(En,{setPrototypeOf:function setPrototypeOf(e,t){In(e);if(t!==null&&!ce.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ae.getPrototypeOf(e)){return true}if(ae.isExtensible&&!ae.isExtensible(e)){return false}if(Nn(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var An=function(e,t){if(!ce.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){ne(S.Reflect,e,t)}}};Object.keys(En).forEach(function(e){An(e,En[e])});var Rn=S.Reflect.getPrototypeOf;if(c&&Rn&&Rn.name!=="getPrototypeOf"){ne(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(Rn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){ne(S.Reflect,"setPrototypeOf",En.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){ne(S.Reflect,"defineProperty",En.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){ne(S.Reflect,"construct",En.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var _n=Date.prototype.toString;var kn=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return ce.Call(_n,this)};ne(Date.prototype,"toString",kn)}var Ln={anchor:function anchor(e){return ce.CreateHTML(this,"a","name",e)},big:function big(){return ce.CreateHTML(this,"big","","")},blink:function blink(){return ce.CreateHTML(this,"blink","","")},bold:function bold(){return ce.CreateHTML(this,"b","","")},fixed:function fixed(){return ce.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return ce.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return ce.CreateHTML(this,"font","size",e)},italics:function italics(){return ce.CreateHTML(this,"i","","")},link:function link(e){return ce.CreateHTML(this,"a","href",e)},small:function small(){return ce.CreateHTML(this,"small","","")},strike:function strike(){return ce.CreateHTML(this,"strike","","")},sub:function sub(){return ce.CreateHTML(this,"sub","","")},sup:function sub(){return ce.CreateHTML(this,"sup","","")}};l(Object.keys(Ln),function(e){var r=String.prototype[e];var n=false;if(ce.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){ne(String.prototype,e,Ln[e])}});var Fn=function(){if(!oe){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e($())!=="undefined"){return true}if(e([$()])!=="[null]"){return true}var t={a:$()};t[$()]=true;if(e(t)!=="{}"){return true}return false}();var Dn=a(function(){if(!oe){return true}return JSON.stringify(Object($()))==="{}"&&JSON.stringify([Object($())])==="[{}]"});if(Fn||!Dn){var zn=JSON.stringify;ne(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=ce.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(re.symbol(n)){return Nt({})(n)}else{return n}}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return zn.apply(this,o)})}return S});
/*! jQuery v3.6.0 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(C,e){"use strict";var t=[],r=Object.getPrototypeOf,s=t.slice,g=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,n={},o=n.toString,v=n.hasOwnProperty,a=v.toString,l=a.call(Object),y={},m=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},x=function(e){return null!=e&&e===e.window},E=C.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||E).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[o.call(e)]||"object":typeof e}var f="3.6.0",S=function(e,t){return new S.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!m(e)&&!x(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:f,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(S.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||S.isPlainObject(n)?n:{},i=!1,a[t]=S.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},S.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==o.call(e))&&(!(t=r(e))||"function"==typeof(n=v.call(t,"constructor")&&t.constructor)&&a.call(n)===l)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(p(Object(e))?S.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:y}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var d=function(n){var e,d,b,o,i,h,f,g,w,u,l,T,C,a,E,v,s,c,y,S="sizzle"+1*new Date,p=n.document,k=0,r=0,m=ue(),x=ue(),A=ue(),N=ue(),j=function(e,t){return e===t&&(l=!0),0},D={}.hasOwnProperty,t=[],q=t.pop,L=t.push,H=t.push,O=t.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",B=new RegExp(M+"+","g"),$=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(t=O.call(p.childNodes),p.childNodes),t[p.childNodes.length].nodeType}catch(e){H={apply:t.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,E)){if(11!==p&&(u=Z.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&y(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return H.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return H.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!N[t+" "]&&(!v||!v.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(U.test(t)||z.test(t))){(f=ee.test(t)&&ye(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(re,ie):e.setAttribute("id",s=S)),o=(l=h(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+xe(l[o]);c=l.join(",")}try{return H.apply(n,f.querySelectorAll(c)),n}catch(e){N(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return g(t.replace($,"$1"),e,n,r)}function ue(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function le(e){return e[S]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){var n=e.split("|"),r=n.length;while(r--)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ve(a){return le(function(o){return o=+o,le(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ye(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},T=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:p;return r!=C&&9===r.nodeType&&r.documentElement&&(a=(C=r).documentElement,E=!i(C),p!=C&&(n=C.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",oe,!1):n.attachEvent&&n.attachEvent("onunload",oe)),d.scope=ce(function(e){return a.appendChild(e).appendChild(C.createElement("div")),"undefined"!=typeof e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),d.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ce(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=K.test(C.getElementsByClassName),d.getById=ce(function(e){return a.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),d.getById?(b.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(te,ne);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=d.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&E)return t.getElementsByClassName(e)},s=[],v=[],(d.qsa=K.test(C.querySelectorAll))&&(ce(function(e){var t;a.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+S+"-]").length||v.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||v.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]"),e.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(d.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce(function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",F)}),v=v.length&&new RegExp(v.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),y=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},j=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==p&&y(p,e)?-1:t==C||t.ownerDocument==p&&y(p,t)?1:u?P(u,e)-P(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?P(u,e)-P(u,t):0;if(i===o)return pe(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?pe(a[r],s[r]):a[r]==p?-1:s[r]==p?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&E&&!N[t+" "]&&(!s||!s.test(t))&&(!v||!v.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){N(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),y(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],r=n&&D.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==r?r:d.attributes||!E?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(j),l){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else while(t=e[r++])n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=m[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&m(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=se.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(B," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,v){var y="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===v?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=y!==m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(y){while(l){a=e;while(a=a[l])if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){d=(s=(r=(i=(o=(a=c)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if((x?a.nodeName.toLowerCase()===f:1===a.nodeType)&&++d&&(p&&((i=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a===e))break;return(d-=v)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=P(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:le(function(e){var r=[],i=[],s=f(e.replace($,"$1"));return s[S]?le(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:le(function(t){return function(e){return 0<se(t,e).length}}),contains:le(function(t){return t=t.replace(te,ne),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:le(function(n){return V.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(te,ne).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve(function(){return[0]}),last:ve(function(e,t){return[t-1]}),eq:ve(function(e,t,n){return[n<0?n+t:n]}),even:ve(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ve(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ve(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:ve(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(s,e,t){var u=e.dir,l=e.next,c=l||u,f=t&&"parentNode"===c,p=r++;return e.first?function(e,t,n){while(e=e[u])if(1===e.nodeType||f)return s(e,t,n);return!1}:function(e,t,n){var r,i,o,a=[k,p];if(n){while(e=e[u])if((1===e.nodeType||f)&&s(e,t,n))return!0}else while(e=e[u])if(1===e.nodeType||f)if(i=(o=e[S]||(e[S]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[u]||e;else{if((r=i[c])&&r[0]===k&&r[1]===p)return a[2]=r[2];if((i[c]=a)[2]=s(e,t,n))return!0}return!1}}function we(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(d,h,g,v,y,e){return v&&!v[S]&&(v=Ce(v)),y&&!y[S]&&(y=Ce(y,e)),le(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:Te(c,s,d,n,r),p=g?y||(e?d:l||v)?[]:t:f;if(g&&g(f,p,n,r),v){i=Te(p,u),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a))}if(e){if(y||d){if(y){i=[],o=p.length;while(o--)(a=p[o])&&i.push(f[o]=a);y(null,p=[],i,r)}o=p.length;while(o--)(a=p[o])&&-1<(i=y?P(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=Te(p===t?p.splice(l,p.length):p),y?y(null,t,p,r):H.apply(t,p)})}function Ee(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=be(function(e){return e===i},a,!0),l=be(function(e){return-1<P(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!==w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[be(we(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return Ce(1<s&&we(c),1<s&&xe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace($,"$1"),t,s<n&&Ee(e.slice(s,n)),n<r&&Ee(e=e.slice(n)),n<r&&xe(e))}c.push(t)}return we(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=x[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=_.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=z.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace($," ")}),a=a.slice(n.length)),b.filter)!(r=G[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):x(e,s).slice(0)},f=se.compile=function(e,t){var n,v,y,m,x,r,i=[],o=[],a=A[e+" "];if(!a){t||(t=h(e)),n=t.length;while(n--)(a=Ee(t[n]))[S]?i.push(a):o.push(a);(a=A(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==C||(T(o),n=!E);while(s=v[a++])if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=q.call(r));f=Te(f)}H.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c},m?le(r):r))).selector=e}return a},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(te,ne),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=G.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(te,ne),ee.test(o[0].type)&&ye(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return H.apply(n,r),n;break}}}return(l||f(e,c))(r,t,!E,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},d.sortStable=S.split("").sort(j).join("")===S,d.detectDuplicates=!!l,T(),d.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(C);S.find=d,S.expr=d.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=d.uniqueSort,S.text=d.getText,S.isXMLDoc=d.isXML,S.contains=d.contains,S.escapeSelector=d.escape;var h=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=S.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,n,r){return m(n)?S.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?S.grep(e,function(e){return e===n!==r}):"string"!=typeof n?S.grep(e,function(e){return-1<i.call(n,e)!==r}):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,function(e){return 1===e.nodeType}))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&k.test(e)?S(e):e||[],!1).length}});var D,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),N.test(r[1])&&S.isPlainObject(t))for(r in t)m(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=E.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):m(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this)}).prototype=S.fn,D=S(E);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){while((e=e[t])&&1!==e.nodeType);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&S(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(S(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h(e,"parentNode")},parentsUntil:function(e,t,n){return h(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return h(e,"nextSibling")},prevAll:function(e){return h(e,"previousSibling")},nextUntil:function(e,t,n){return h(e,"nextSibling",n)},prevUntil:function(e,t,n){return h(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(H[r]||S.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&m(i=e.promise)?i.call(e).done(t).fail(n):e&&m(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(P)||[],function(e,t){n[t]=!0}),n):S.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){S.each(e,function(e,t){m(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==w(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return S.each(arguments,function(e,t){var n;while(-1<(n=S.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<S.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(o,function(e,t){var n=m(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&m(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,m(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),C.setTimeout(t))}}return S.Deferred(function(e){o[0][3].add(l(0,e,m(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,m(t)?t:R)),o[2][3].add(l(0,e,m(n)?n:M))}).promise()},promise:function(e){return null!=e?S.extend(e,a):a}},s={};return S.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=S.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(I(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||m(i[t]&&i[t].then)))return o.then();while(t--)I(i[t],a(t),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&W.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){C.setTimeout(function(){throw e})};var F=S.Deferred();function B(){E.removeEventListener("DOMContentLoaded",B),C.removeEventListener("load",B),S.ready()}S.fn.ready=function(e){return F.then(e)["catch"](function(e){S.readyException(e)}),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||F.resolveWith(E,[S])}}),S.ready.then=F.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?C.setTimeout(S.ready):(E.addEventListener("DOMContentLoaded",B),C.addEventListener("load",B));var $=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===w(n))for(s in i=!0,n)$(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(S(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;while(n--)delete r[t[n]]}(void 0===t||S.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){Q.set(this,n)}):$(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=Q.get(o,n))?t:void 0!==(t=Z(o,n))?t:void 0;this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){S.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:S.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=E.documentElement,ie=function(e){return S.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===S.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},u=s(),l=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==l&&+u)&&te.exec(S.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)S.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,S.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ae(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ue[s])||(o=a.body.appendChild(a.createElement(s)),u=S.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ue[s]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}S.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?S(this).show():S(this).hide()})}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=E.createDocumentFragment().appendChild(E.createElement("div")),(fe=E.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),y.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",y.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?S.merge([e],n):n}function ye(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,y.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===w(o))S.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+S.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;S.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<S.inArray(o,r))i&&i.push(o);else if(l=ie(o),a=ve(f.appendChild(o),"script"),l&&ye(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}var be=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function Te(){return!1}function Ce(e,t){return e===function(){try{return E.activeElement}catch(e){}}()==("focus"===t)}function Ee(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Ee(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Te;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return S().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),e.each(function(){S.event.add(this,t,i,r,n)})}function Se(e,i,o){o?(Y.set(e,i,!1),S.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(S.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(Y.set(this,i,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&S.event.add(e,i,we)}S.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.get(t);if(V(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(re,i),n.guid||(n.guid=S.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;while(l--)d=g=(s=be.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=S.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=S.event.special[d]||{},c=S.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),S.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.hasData(e)&&Y.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(P)||[""]).length;while(l--)if(d=g=(s=be.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=S.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||S.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)S.event.remove(e,d+t[l],n,r,!0);S.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=S.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=S.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=S.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((S.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<S(i,this).index(l):S.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click",we),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?we:Te,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=we,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=we,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=we,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(e,t){S.event.special[e]={setup:function(){return Se(this,e,Ce),!1},trigger:function(){return Se(this,e),!0},_default:function(){return!0},delegateType:t}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){S.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),S.fn.extend({on:function(e,t,n,r){return Ee(this,e,t,n,r)},one:function(e,t,n,r){return Ee(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Te),this.each(function(){S.event.remove(this,e,n,t)})}});var ke=/<script|<style|<link/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,Ne=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function je(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function De(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function qe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Le(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)S.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=S.extend({},o),Q.set(t,a))}}function He(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=m(d);if(h||1<f&&"string"==typeof d&&!y.checkClone&&Ae.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),He(t,r,i,o)});if(f&&(t=(e=xe(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=S.map(ve(e,"script"),De)).length;c<f;c++)u=e,c!==p&&(u=S.clone(u,!0,!0),s&&S.merge(a,ve(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,S.map(a,qe),c=0;c<s;c++)u=a[c],he.test(u.type||"")&&!Y.access(u,"globalEval")&&S.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?S._evalUrl&&!u.noModule&&S._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(Ne,""),u,l))}return n}function Oe(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(ve(r)),r.parentNode&&(n&&ie(r)&&ye(ve(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=ve(c),r=0,i=(o=ve(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ve(e),a=a||ve(c),r=0,i=o.length;r<i;r++)Le(o[r],a[r]);else Le(e,c);return 0<(a=ve(c,"script")).length&&ye(a,!f&&ve(e,"script")),c},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Oe(this,e,!0)},remove:function(e){return Oe(this,e)},text:function(e){return $(this,function(e){return void 0===e?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return He(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||je(this,e).appendChild(e)})},prepend:function(){return He(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=je(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return S.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ke.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return He(this,arguments,function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(ve(this)),t&&t.replaceChild(e,this))},n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){S.fn[e]=function(e){for(var t,n=[],r=S(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),S(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}});var Pe=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Re=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},Me=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ie=new RegExp(ne.join("|"),"i");function We(e,t,n){var r,i,o,a,s=e.style;return(n=n||Re(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||ie(e)||(a=S.style(e,t)),!y.pixelBoxStyles()&&Pe.test(a)&&Ie.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function Fe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(u).appendChild(l);var e=C.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),re.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=E.createElement("div"),l=E.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===l.style.backgroundClip,S.extend(y,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=E.createElement("table"),t=E.createElement("tr"),n=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",re.appendChild(e).appendChild(t).appendChild(n),r=C.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,re.removeChild(e)),a}}))}();var Be=["Webkit","Moz","ms"],$e=E.createElement("div").style,_e={};function ze(e){var t=S.cssProps[e]||_e[e];return t||(e in $e?e:_e[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=Be.length;while(n--)if((e=Be[n]+t)in $e)return e}(e)||e)}var Ue=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ve={position:"absolute",visibility:"hidden",display:"block"},Ge={letterSpacing:"0",fontWeight:"400"};function Ye(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Qe(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=S.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=S.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=S.css(e,"border"+ne[a]+"Width",!0,i))):(u+=S.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=S.css(e,"border"+ne[a]+"Width",!0,i):s+=S.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Je(e,t,n){var r=Re(e),i=(!y.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,a=We(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Pe.test(a)){if(!n)return a;a="auto"}return(!y.boxSizingReliable()&&i||!y.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Qe(e,t,n||(i?"border":"content"),o,r,a)+"px"}function Ke(e,t,n,r,i){return new Ke.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=We(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Xe.test(t),l=e.style;if(u||(t=ze(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(S.cssNumber[s]?"":"px")),y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Xe.test(t)||(t=ze(s)),(a=S.cssHooks[t]||S.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=We(e,t,r)),"normal"===i&&t in Ge&&(i=Ge[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),S.each(["height","width"],function(e,u){S.cssHooks[u]={get:function(e,t,n){if(t)return!Ue.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Je(e,u,n):Me(e,Ve,function(){return Je(e,u,n)})},set:function(e,t,n){var r,i=Re(e),o=!y.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===S.css(e,"boxSizing",!1,i),s=n?Qe(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-Qe(e,u,"border",!1,i)-.5)),s&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=S.css(e,u)),Ye(0,t,s)}}}),S.cssHooks.marginLeft=Fe(y.reliableMarginLeft,function(e,t){if(t)return(parseFloat(We(e,"marginLeft"))||e.getBoundingClientRect().left-Me(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(i,o){S.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(S.cssHooks[i+o].set=Ye)}),S.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Re(e),i=t.length;a<i;a++)o[t[a]]=S.css(e,t[a],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)},e,t,1<arguments.length)}}),((S.Tween=Ke).prototype={constructor:Ke,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=Ke.propHooks[this.prop];return e&&e.get?e.get(this):Ke.propHooks._default.get(this)},run:function(e){var t,n=Ke.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ke.propHooks._default.set(this),this}}).init.prototype=Ke.prototype,(Ke.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=S.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[ze(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=Ke.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=Ke.prototype.init,S.fx.step={};var Ze,et,tt,nt,rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function ot(){et&&(!1===E.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(ot):C.setTimeout(ot,S.fx.interval),S.fx.tick())}function at(){return C.setTimeout(function(){Ze=void 0}),Ze=Date.now()}function st(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ut(e,t,n){for(var r,i=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function lt(o,e,t){var n,a,r=0,i=lt.prefilters.length,s=S.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=Ze||at(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:Ze||at(),duration:t.duration,tweens:[],createTween:function(e,t){var n=S.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=lt.prefilters[r].call(l,o,c,l.opts))return m(n.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return S.map(c,ut,l),m(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){m(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),v=Y.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],rt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||S.style(e,r)}if((u=!S.isEmptyObject(t))||!S.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=Y.get(e,"display")),"none"===(c=S.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=S.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===S.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=Y.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&le([e],!0),p.done(function(){for(r in g||le([e]),Y.remove(e,"fxshow"),d)S.style(e,r,d[r])})),u=ut(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||m(e)&&e,duration:e,easing:n&&t||t&&!m(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=S.isEmptyObject(t),o=S.speed(e,n,r),a=function(){var e=lt(this,S.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=S.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&it.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||S.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=S.timers,o=n?n.length:0;for(t.finish=!0,S.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),S.each(["toggle","show","hide"],function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(st(r,!0),e,t,n)}}),S.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(Ze=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),Ze=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){et||(et=!0,ot())},S.fx.stop=function(){et=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},tt=E.createElement("input"),nt=E.createElement("select").appendChild(E.createElement("option")),tt.type="checkbox",y.checkOn=""!==tt.value,y.optSelected=nt.selected,(tt=E.createElement("input")).value="t",tt.type="radio",y.radioValue="t"===tt.value;var ct,ft=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return $(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?ct:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!y.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),ct={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var a=ft[t]||S.find.attr;ft[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=ft[o],ft[o]=r,r=null!=a(e,t,n)?o:null,ft[o]=i),r}});var pt=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;function ht(e){return(e.match(P)||[]).join(" ")}function gt(e){return e.getAttribute&&e.getAttribute("class")||""}function vt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}S.fn.extend({prop:function(e,t){return $(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):pt.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),y.optSelected||(S.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).addClass(t.call(this,e,gt(this)))});if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).removeClass(t.call(this,e,gt(this)))});if(!arguments.length)return this.attr("class","");if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])while(-1<r.indexOf(" "+o+" "))r=r.replace(" "+o+" "," ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},toggleClass:function(i,t){var o=typeof i,a="string"===o||Array.isArray(i);return"boolean"==typeof t&&a?t?this.addClass(i):this.removeClass(i):m(i)?this.each(function(e){S(this).toggleClass(i.call(this,e,gt(this),t),t)}):this.each(function(){var e,t,n,r;if(a){t=0,n=S(this),r=vt(i);while(e=r[t++])n.hasClass(e)?n.removeClass(e):n.addClass(e)}else void 0!==i&&"boolean"!==o||((e=gt(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===i?"":Y.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+ht(gt(n))+" ").indexOf(t))return!0;return!1}});var yt=/\r/g;S.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=m(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,S(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=S.map(t,function(e){return null==e?"":e+""})),(r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(yt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:ht(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=S(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=S.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<S.inArray(S.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},y.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),y.focusin="onfocusin"in C;var mt=/^(?:focusinfocus|focusoutblur)$/,xt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||E],d=v.call(e,"type")?e.type:e,h=v.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||E,3!==n.nodeType&&8!==n.nodeType&&!mt.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[S.expando]?e:new S.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),c=S.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!x(n)){for(s=c.delegateType||d,mt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||E)&&p.push(a.defaultView||a.parentWindow||C)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&V(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!V(n)||u&&m(n[d])&&!x(n)&&((a=n[u])&&(n[u]=null),S.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,xt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,xt),S.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(r,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),y.focusin||S.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){S.event.simulate(r,e.target,S.event.fix(e))};S.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}});var bt=C.location,wt={guid:Date.now()},Tt=/\?/;S.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||S.error("Invalid XML: "+(n?S.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Ct=/\[\]$/,Et=/\r?\n/g,St=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;function At(n,e,r,i){var t;if(Array.isArray(e))S.each(e,function(e,t){r||Ct.test(n)?i(n,t):At(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==w(e))i(n,e);else for(t in e)At(n+"["+t+"]",e[t],r,i)}S.param=function(e,t){var n,r=[],i=function(e,t){var n=m(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,function(){i(this.name,this.value)});else for(n in e)At(n,e[n],t,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&kt.test(this.nodeName)&&!St.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(e){return{name:t.name,value:e.replace(Et,"\r\n")}}):{name:t.name,value:n.replace(Et,"\r\n")}}).get()}});var Nt=/%20/g,jt=/#.*$/,Dt=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Lt=/^(?:GET|HEAD)$/,Ht=/^\/\//,Ot={},Pt={},Rt="*/".concat("*"),Mt=E.createElement("a");function It(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(m(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Wt(t,i,o,a){var s={},u=t===Pt;function l(e){var r;return s[e]=!0,S.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Ft(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&S.extend(!0,e,r),e}Mt.href=bt.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ft(Ft(e,S.ajaxSettings),t):Ft(S.ajaxSettings,e)},ajaxPrefilter:It(Ot),ajaxTransport:It(Pt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=S.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?S(y):S.event,x=S.Deferred(),b=S.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=qt.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||bt.href)+"").replace(Ht,bt.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(P)||[""],null==v.crossDomain){r=E.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Mt.protocol+"//"+Mt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=S.param(v.data,v.traditional)),Wt(Ot,v,t,T),h)return T;for(i in(g=S.event&&v.global)&&0==S.active++&&S.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Lt.test(v.type),f=v.url.replace(jt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Nt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(Tt.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(Dt,"$1"),o=(Tt.test(f)?"&":"?")+"_="+wt.guid+++o),v.url=f+o),v.ifModified&&(S.lastModified[f]&&T.setRequestHeader("If-Modified-Since",S.lastModified[f]),S.etag[f]&&T.setRequestHeader("If-None-Match",S.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+Rt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Wt(Pt,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=C.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&C.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<S.inArray("script",v.dataTypes)&&S.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(S.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(S.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--S.active||S.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],function(e,i){S[i]=function(e,t,n,r){return m(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}}),S.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){var t;return this[0]&&(m(e)&&(e=e.call(this[0])),t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return m(n)?this.each(function(e){S(this).wrapInner(n.call(this,e))}):this.each(function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=m(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var Bt={0:200,1223:204},$t=S.ajaxSettings.xhr();y.cors=!!$t&&"withCredentials"in $t,y.ajax=$t=!!$t,S.ajaxTransport(function(i){var o,a;if(y.cors||$t&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Bt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),S.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=S("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),E.head.appendChild(r[0])},abort:function(){i&&i()}}});var _t,zt=[],Ut=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=zt.pop()||S.expando+"_"+wt.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Ut.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ut.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ut,"$1"+r):!1!==e.jsonp&&(e.url+=(Tt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){void 0===i?S(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,zt.push(r)),o&&m(i)&&i(o[0]),o=i=void 0}),"script"}),y.createHTMLDocument=((_t=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===_t.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(y.createHTMLDocument?((r=(t=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,t.head.appendChild(r)):t=E),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&S(o).remove(),S.merge([],i.childNodes)));var r,i,o},S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=ht(e.slice(s)),e=e.slice(0,s)),m(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length},S.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=S.css(e,"position"),c=S(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=S.css(e,"top"),u=S.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(t)&&(t=t.call(e,n,S.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){S.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===S.css(e,"position"))e=e.offsetParent;return e||re})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return $(this,function(e,t,n){var r;if(x(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),S.each(["top","left"],function(e,n){S.cssHooks[n]=Fe(y.pixelPosition,function(e,t){if(t)return t=We(e,n),Pe.test(t)?S(e).position()[n]+"px":t})}),S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return $(this,function(e,t,n){var r;return x(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?S.css(e,t,i):S.style(e,t,n,i)},s,n?e:void 0,n)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}}),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var Xt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),m(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||S.guid++,i},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=A,S.isFunction=m,S.isWindow=x,S.camelCase=X,S.type=w,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(Xt,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var Vt=C.jQuery,Gt=C.$;return S.noConflict=function(e){return C.$===S&&(C.$=Gt),e&&C.jQuery===S&&(C.jQuery=Vt),S},"undefined"==typeof e&&(C.jQuery=C.$=S),S});
/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,j,i){var h,d=0;if(typeof f!=="boolean"){i=j;j=f;f=c}function g(){var o=this,m=+new Date()-d,n=arguments;function l(){d=+new Date();j.apply(o,n)}function k(){h=c}if(i&&!h){l()}h&&clearTimeout(h);if(i===c&&m>e){l()}else{if(f!==true){h=setTimeout(i?k:l,i===c?e-m:e)}}}if($.guid){g.guid=j.guid=j.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);
/*!
 * imagesLoaded PACKAGED v4.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
!function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==typeof module&&module.exports?module.exports=t():e.EvEmitter=t()}("undefined"!=typeof window?window:this,function(){function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var i=this._events=this._events||{},n=i[e]=i[e]||[];return n.indexOf(t)==-1&&n.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var i=this._onceEvents=this._onceEvents||{},n=i[e]=i[e]||{};return n[t]=!0,this}},t.off=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){var n=i.indexOf(t);return n!=-1&&i.splice(n,1),this}},t.emitEvent=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){i=i.slice(0),t=t||[];for(var n=this._onceEvents&&this._onceEvents[e],o=0;o<i.length;o++){var r=i[o],s=n&&n[r];s&&(this.off(e,r),delete n[r]),r.apply(this,t)}return this}},t.allOff=function(){delete this._events,delete this._onceEvents},e}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return t(e,i)}):"object"==typeof module&&module.exports?module.exports=t(e,require("ev-emitter")):e.imagesLoaded=t(e,e.EvEmitter)}("undefined"!=typeof window?window:this,function(e,t){function i(e,t){for(var i in t)e[i]=t[i];return e}function n(e){if(Array.isArray(e))return e;var t="object"==typeof e&&"number"==typeof e.length;return t?d.call(e):[e]}function o(e,t,r){if(!(this instanceof o))return new o(e,t,r);var s=e;return"string"==typeof e&&(s=document.querySelectorAll(e)),s?(this.elements=n(s),this.options=i({},this.options),"function"==typeof t?r=t:i(this.options,t),r&&this.on("always",r),this.getImages(),h&&(this.jqDeferred=new h.Deferred),void setTimeout(this.check.bind(this))):void a.error("Bad element for imagesLoaded "+(s||e))}function r(e){this.img=e}function s(e,t){this.url=e,this.element=t,this.img=new Image}var h=e.jQuery,a=e.console,d=Array.prototype.slice;o.prototype=Object.create(t.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),this.options.background===!0&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&u[t]){for(var i=e.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var r=e.querySelectorAll(this.options.background);for(n=0;n<r.length;n++){var s=r[n];this.addElementBackgroundImages(s)}}}};var u={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(t.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,e),n=i.exec(t.backgroundImage)}},o.prototype.addImage=function(e){var t=new r(e);this.images.push(t)},o.prototype.addBackground=function(e,t){var i=new s(e,t);this.images.push(i)},o.prototype.check=function(){function e(e,i,n){setTimeout(function(){t.progress(e,i,n)})}var t=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(t){t.once("progress",e),t.check()}):void this.complete()},o.prototype.progress=function(e,t,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,e,t)},o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},r.prototype=Object.create(t.prototype),r.prototype.check=function(){var e=this.getIsImageComplete();return e?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},r.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},r.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},r.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype=Object.create(r.prototype),s.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var e=this.getIsImageComplete();e&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},s.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},o.makeJQueryPlugin=function(t){t=t||e.jQuery,t&&(h=t,h.fn.imagesLoaded=function(e,t){var i=new o(this,e,t);return i.jqDeferred.promise(h(this))})},o.makeJQueryPlugin(),o});
/*! lz-string-1.3.3-min.js | (c) 2013 Pieroxy | Licensed under a WTFPL license */
var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(e==null)return"";var t="";var n,r,i,s,o,u,a;var f=0;e=LZString.compress(e);while(f<e.length*2){if(f%2==0){n=e.charCodeAt(f/2)>>8;r=e.charCodeAt(f/2)&255;if(f/2+1<e.length)i=e.charCodeAt(f/2+1)>>8;else i=NaN}else{n=e.charCodeAt((f-1)/2)&255;if((f+1)/2<e.length){r=e.charCodeAt((f+1)/2)>>8;i=e.charCodeAt((f+1)/2)&255}else r=i=NaN}f+=3;s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+LZString._keyStr.charAt(s)+LZString._keyStr.charAt(o)+LZString._keyStr.charAt(u)+LZString._keyStr.charAt(a)}return t},decompressFromBase64:function(e){if(e==null)return"";var t="",n=0,r,i,s,o,u,a,f,l,c=0,h=LZString._f;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<e.length){u=LZString._keyStr.indexOf(e.charAt(c++));a=LZString._keyStr.indexOf(e.charAt(c++));f=LZString._keyStr.indexOf(e.charAt(c++));l=LZString._keyStr.indexOf(e.charAt(c++));i=u<<2|a>>4;s=(a&15)<<4|f>>2;o=(f&3)<<6|l;if(n%2==0){r=i<<8;if(f!=64){t+=h(r|s)}if(l!=64){r=o<<8}}else{t=t+h(r|i);if(f!=64){r=s<<8}if(l!=64){t+=h(r|o)}}n+=3}return LZString.decompress(t)},compressToUTF16:function(e){if(e==null)return"";var t="",n,r,i,s=0,o=LZString._f;e=LZString.compress(e);for(n=0;n<e.length;n++){r=e.charCodeAt(n);switch(s++){case 0:t+=o((r>>1)+32);i=(r&1)<<14;break;case 1:t+=o(i+(r>>2)+32);i=(r&3)<<13;break;case 2:t+=o(i+(r>>3)+32);i=(r&7)<<12;break;case 3:t+=o(i+(r>>4)+32);i=(r&15)<<11;break;case 4:t+=o(i+(r>>5)+32);i=(r&31)<<10;break;case 5:t+=o(i+(r>>6)+32);i=(r&63)<<9;break;case 6:t+=o(i+(r>>7)+32);i=(r&127)<<8;break;case 7:t+=o(i+(r>>8)+32);i=(r&255)<<7;break;case 8:t+=o(i+(r>>9)+32);i=(r&511)<<6;break;case 9:t+=o(i+(r>>10)+32);i=(r&1023)<<5;break;case 10:t+=o(i+(r>>11)+32);i=(r&2047)<<4;break;case 11:t+=o(i+(r>>12)+32);i=(r&4095)<<3;break;case 12:t+=o(i+(r>>13)+32);i=(r&8191)<<2;break;case 13:t+=o(i+(r>>14)+32);i=(r&16383)<<1;break;case 14:t+=o(i+(r>>15)+32,(r&32767)+32);s=0;break}}return t+o(i+32)},decompressFromUTF16:function(e){if(e==null)return"";var t="",n,r,i=0,s=0,o=LZString._f;while(s<e.length){r=e.charCodeAt(s)-32;switch(i++){case 0:n=r<<1;break;case 1:t+=o(n|r>>14);n=(r&16383)<<2;break;case 2:t+=o(n|r>>13);n=(r&8191)<<3;break;case 3:t+=o(n|r>>12);n=(r&4095)<<4;break;case 4:t+=o(n|r>>11);n=(r&2047)<<5;break;case 5:t+=o(n|r>>10);n=(r&1023)<<6;break;case 6:t+=o(n|r>>9);n=(r&511)<<7;break;case 7:t+=o(n|r>>8);n=(r&255)<<8;break;case 8:t+=o(n|r>>7);n=(r&127)<<9;break;case 9:t+=o(n|r>>6);n=(r&63)<<10;break;case 10:t+=o(n|r>>5);n=(r&31)<<11;break;case 11:t+=o(n|r>>4);n=(r&15)<<12;break;case 12:t+=o(n|r>>3);n=(r&7)<<13;break;case 13:t+=o(n|r>>2);n=(r&3)<<14;break;case 14:t+=o(n|r>>1);n=(r&1)<<15;break;case 15:t+=o(n|r);i=0;break}s++}return LZString.decompress(t)},compress:function(e){if(e==null)return"";var t,n,r={},i={},s="",o="",u="",a=2,f=3,l=2,c="",h=0,p=0,d,v=LZString._f;for(d=0;d<e.length;d+=1){s=e.charAt(d);if(!Object.prototype.hasOwnProperty.call(r,s)){r[s]=f++;i[s]=true}o=u+s;if(Object.prototype.hasOwnProperty.call(r,o)){u=o}else{if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}r[o]=f++;u=String(s)}}if(u!==""){if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}}n=2;for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}while(true){h=h<<1;if(p==15){c+=v(h);break}else p++}return c},decompress:function(e){if(e==null)return"";if(e=="")return null;var t=[],n,r=4,i=4,s=3,o="",u="",a,f,l,c,h,p,d,v=LZString._f,m={string:e,val:e.charCodeAt(0),position:32768,index:1};for(a=0;a<3;a+=1){t[a]=a}l=0;h=Math.pow(2,2);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(n=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 2:return""}t[3]=d;f=u=d;while(true){if(m.index>m.string.length){return""}l=0;h=Math.pow(2,s);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(d=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 2:return u}if(r==0){r=Math.pow(2,s);s++}if(t[d]){o=t[d]}else{if(d===i){o=f+f.charAt(0)}else{return null}}u+=o;t[i++]=f+o.charAt(0);r--;f=o;if(r==0){r=Math.pow(2,s);s++}}}};if(typeof module!=="undefined"&&module!=null){module.exports=LZString}
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/dist/FileSaver.js */
(function(a,b){if("function"==typeof define&&define.amd)define([],b);else if("undefined"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){"use strict";function b(a,b){return"undefined"==typeof b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="blob",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error("could not download file")},d.send()}function d(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(c){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g=g||b.name||"download",j.download=g,j.rel="noopener","string"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,h){if(g=g||f.name||"download","string"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement("a");i.href=f,i.target="_blank",setTimeout(function(){e(i)})}}:function(b,d,e,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof b)return c(b,d,e);var h="application/octet-stream"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&"undefined"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout(function(){l.revokeObjectURL(m)},4E4)}});f.saveAs=g.saveAs=g,"undefined"!=typeof module&&(module.exports=g)});
/*! seedrandom.js v2.3.3 | (c) 2013 David Bau, all rights reserved. | Licensed under a BSD-style license */
!function(a,b,c,d,e,f,g,h,i){function j(a){var b,c=a.length,e=this,f=0,g=e.i=e.j=0,h=e.S=[];for(c||(a=[c++]);d>f;)h[f]=f++;for(f=0;d>f;f++)h[f]=h[g=r&g+a[f%c]+(b=h[f])],h[g]=b;(e.g=function(a){for(var b,c=0,f=e.i,g=e.j,h=e.S;a--;)b=h[f=r&f+1],c=c*d+h[r&(h[f]=h[g=r&g+b])+(h[g]=b)];return e.i=f,e.j=g,c})(d)}function k(a,b){var c,d=[],e=typeof a;if(b&&"object"==e)for(c in a)try{d.push(k(a[c],b-1))}catch(f){}return d.length?d:"string"==e?a:a+"\0"}function l(a,b){for(var c,d=a+"",e=0;e<d.length;)b[r&e]=r&(c^=19*b[r&e])+d.charCodeAt(e++);return n(b)}function m(c){try{return a.crypto.getRandomValues(c=new Uint8Array(d)),n(c)}catch(e){return[+new Date,a,(c=a.navigator)&&c.plugins,a.screen,n(b)]}}function n(a){return String.fromCharCode.apply(0,a)}var o=c.pow(d,e),p=c.pow(2,f),q=2*p,r=d-1,s=c["seed"+i]=function(a,f,g){var h=[],r=l(k(f?[a,n(b)]:null==a?m():a,3),h),s=new j(h);return l(n(s.S),b),(g||function(a,b,d){return d?(c[i]=a,b):a})(function(){for(var a=s.g(e),b=o,c=0;p>a;)a=(a+c)*d,b*=d,c=s.g(1);for(;a>=q;)a/=2,b/=2,c>>>=1;return(a+c)/b},r,this==c)};l(c[i](),b),g&&g.exports?g.exports=s:h&&h.amd&&h(function(){return s})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random");
/*! console_hack.js | (c) 2015 Thomas Michael Edwards | Licensed under SugarCube's Simple BSD license */
!function(){for(var methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],length=methods.length,noop=function(){},console=window.console=window.console||{};length--;){var method=methods[length];console[method]||(console[method]=noop)}}();
}else{document.documentElement.setAttribute("data-init", "lacking");}
</script>
<style id="style-normalize" type="text/css">/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}</style>
<style id="style-init-screen" type="text/css">@-webkit-keyframes init-loading-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes init-loading-spin{0%{-o-transform:rotate(0);transform:rotate(0)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes init-loading-spin{0%{-webkit-transform:rotate(0);-o-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}#init-screen{display:none;z-index:500000;position:fixed;top:0;left:0;height:100%;width:100%;font:28px/1 Helmet,Freesans,sans-serif;font-weight:700;color:#eee;background-color:#111;text-align:center}#init-screen>div{display:none;position:relative;margin:0 auto;max-width:1136px;top:25%}html[data-init=lacking] #init-screen,html[data-init=loading] #init-screen,html[data-init=no-js] #init-screen{display:block}html[data-init=lacking] #init-lacking,html[data-init=no-js] #init-no-js{display:block;padding:0 1em}html[data-init=no-js] #init-no-js{color:red}html[data-init=loading] #init-loading{display:block;border:24px solid transparent;border-radius:50%;border-top-color:#7f7f7f;border-bottom-color:#7f7f7f;width:100px;height:100px;-webkit-animation:init-loading-spin 2s linear infinite;-o-animation:init-loading-spin 2s linear infinite;animation:init-loading-spin 2s linear infinite}html[data-init=loading] #init-loading>div{text-indent:9999em;overflow:hidden;white-space:nowrap}html[data-init=loading] #passages,html[data-init=loading] #ui-bar{display:none}</style>
<style id="style-font" type="text/css">@font-face{font-family:tme-fa-icons;src:url('data:application/octet-stream;base64,d09GRgABAAAAADLAAA8AAAAAWHgAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABWAAAADsAAABUIIslek9TLzIAAAGUAAAAQwAAAFY+IEkIY21hcAAAAdgAAAG8AAAF3rob9jFjdnQgAAADlAAAABMAAAAgBtX/BGZwZ20AAAOoAAAFkAAAC3CKkZBZZ2FzcAAACTgAAAAIAAAACAAAABBnbHlmAAAJQAAAI6gAADv+gJOpzGhlYWQAACzoAAAAMwAAADYY1IZaaGhlYQAALRwAAAAgAAAAJAfCBClobXR4AAAtPAAAAJEAAAFMBfb/0WxvY2EAAC3QAAAAqAAAAKhjiHI5bWF4cAAALngAAAAgAAAAIAFjDA9uYW1lAAAumAAAAY0AAAL94+zEpHBvc3QAADAoAAACHAAAA11cG/YjcHJlcAAAMkQAAAB6AAAAhuVBK7x4nGNgZGBg4GIwYLBjYHJx8wlh4MtJLMljkGJgYYAAkDwymzEnMz2RgQPGA8qxgGkOIGaDiAIAJjsFSAB4nGNgZNZgnMDAysDAVMW0h4GBoQdCMz5gMGRkAooysDIzYAUBaa4pDA4vGF4EMgf9z2KIYg5imAYUZgTJAQDSIQumAHic7dTVbltRAETR7dpNCikzQ8rMzMxt/M39mHnsU1/TfZz5jFpaV7pXJunMDLAZmOqaZjD5y4Tx+uPTyeL5lG2L5zN+L94zG8+ztr7ulXH1fra4bvK9M79xiWW2sNXPbWeFHexkF7vZw172sZ8DHOQQhznCUY5xnBOc5BSnOcNZVjnHeS5wkUtc5gpX/f3r3OAmt7jNHe5yj/s84CGPeMwTnvKM57zgJa94zRve8o73fOAjn/jMF77yje/84Ce/WGPun1zi/2tlXKbp3Xyc44bFyZanSWokJDXOOjXSk/LUSXn+pEwCKTNBaqQqZU5IjX+XMjukTBEp80TKZJEyY6RMGylzR8oEkjKLpEwlKfNJyqSSMrOkTC8pc0zKRJMy26RMOSnzTsrkk7IDpGwDKXtByoaQsiukbA0p+0PKJpGyU6RsFyl7RmosQcrukbKFpOwjKZtJyo6Ssq2k7C0pG0zKLpOy1aTsNymbTsrOk7L9pNwBUi4CKbeBlCtByr0g5XKQckNIuSak3BVSLgwpt4aUq0PK/SHlEpFyk0i5TqTcKVIuFim3i5QrRso9I+WykXLjXOYNzP8BuAPUwHicY2BAAxIQyBz0PwuEARJsA90AeJytVml300YUHXlJnIQsJQstamHExGmwRiZswYAJQbJjIF2crZWgixQ76b7xid/gX/Nk2nPoN35a7xsvJJC053Cak6N3583VzNtlElqS2AvrkZSbL8XU1iaN7DwJ6YZNy1F8KDt7IWWKyd8FURCtltq3HYdERCJQta6wRBD7HlmaZHzoUUbLtqRXTcotPekuW+NBvVXffho6yrE7oaRmM3RoPbIlVRhVokimPVLSpmWo+itJK7y/wsxXzVDCiE4iabwZxtBI3htntMpoNbbjKIpsstwoUiSa4UEUeZTVEufkigkMygfNkPLKpxHlw/yIrNijnFawS7bT/L4vead3OT+xX29RtuRAH8iO7ODsdCVfhFtbYdy0k+0oVBF213dCbNnsVP9mj/KaRgO3KzK90IxgqXyFECs/ocz+IVktnE/5kkejWrKRE0HrZU7sSz6B1uOIKXHNGFnQ3dEJEdT9kjMM9pg+Hvzx3imWCxMCeBzLekclnAgTKWFzNEnaMHJgJWWLKqn1rpg45XVaxFvCfu3a0ZfOaONQd2I8Ww8dWzlRyfFoUqeZTJ3aSc2jKQ2ilHQmeMyvAyg/oklebWM1iZVH0zhmxoREIgIt3EtTQSw7saQpBM2jGb25G6a5di1apMkD9dyj9/TmVri501PaDvSzRn9Wp2I62AvT6WnkL/Fp2uUiRen66Rl+TOJB1gIykS02w5SDB2/9DtLL15YchdcG2O7t8yuofdZE8KQB+xvQHk/VKQlMhZhViFZAYq1rWZbJ1awWqcjUd0OaVr6s0wSKchwXx76Mcf1fMzOWmBK+34nTsyMuPXPtSwjTHHybdT2a16nFcgFxZnlOp1mW7+s0x/IDneZZntfpCEtbp6MsP9RpgeVHOh1jeUELmnTfwZCLMOQCDpAwhKUDQ1hegiEsFQxhuQhDWBZhCMslGMLyYxjCchmGsLysZdXUU0nj2plYBmxCYGKOHrnMReVqKrlUQrtoVGpDnhJulVQUz6p/ZaBePPKGObAWSJfIml8xzpWPRuX41hUtbxo7V8Cx6m8fjvY58VLWi4U/Bf/V1lQlvWLNw5Or8BuGnmwnqjapeHRNl89VPbr+X1RUWAv0G0iFWCjKsmxwZyKEjzqdhmqglUPMbMw8tOt1y5qfw/03MUIWUP34NxQaC9yDTllJWe3grNXX27LcO4NyOBMsSTE38/pW+CIjs9J+kVnKno98HnAFjEpl2GoDrRW82ScxD5neJM8EcVtRNkja2M4EiQ0c84B5850EJmHqqg3kTuGGDfgFYW7BeSdconqjLIfuRezzKKT8W6fiRPaoaIzAs9kbYa/vQspvcQwkNPmlfgxUFaGpGDUV0DRSbqgGX8bZum1Cxg70Iyp2w7Ks4sPHFveVkm0ZhHykiNWjo5/WXqJOqtx+ZhSX752+BcEgNTF/e990cZDKu1rJMkdtA1O3GpVT15pD41WH6uZR9b3j7BM5a5puuiceel/TqtvBxVwssPZtDtJSJhfU9WGFDaLLxaVQ6mU0Se+4BxgWGNDvUIqN/6v62HyeK1WF0XEk307Ut9HnYAz8D9h/R/UD0Pdj6HINLs/3mhOfbvThbJmuohfrp+g3MGutuVm6BtzQdAPiIUetjrjKDXynBnF6pLkc6SHgY90V4gHAJoDF4BPdtYzmUwCj+Yw5PsDnzGHQZA6DLeYw2GbOGsAOcxjsMofBHnMYfMGcdYAvmcMgZA6DiDkMnjAnAHjKHAZfMYfB18xh8A1z7gN8yxwGMXMYJMxhsK/p1jDMLV7QXaC2QVWgA1NPWNzD4lBTZcj+jheG/b1BzP7BIKb+qOn2kPoTLwz1Z4OY+otBTP1V050h9TdeGOrvBjH1D4OY+ky/GMtlBr+MfJcKB5RdbD7n74n3D9vFQLkAAQAB//8AD3icrXsLcFzlleZ//v+++nb37dfte/VotVrdrW5JltuKpO6WJVluPyXbsmOEbGRjO4KVjWPZlsM4QIU4IYGlgCE2yxqKIQkJg2GreKQCTCZb1CZkiswjzOwOmSTATNVWTZLdDUwSMrVDsomD23vOf69assFAqgbk+773P4//nPOdc/5mwNjFl8WjosbaWblmxiOmIlTGYXzb11M7Z2ohAMbZCcZ5iG9prZl4whfwGju05xtttitUdwXYEUgkbQtWga5lC+XBaqJI285qpb8dVEc8Gnm5L5QM/f58yAlB399a7dD0mWAmdAqaMvBmKPKX9TdDwSjod9yhx03FAPcvI6Gk2lV33XoXUtKgL8C6Wa0WSzXbVjhg6JoqIPShCK0FOvOuE48K1V4B1VUQAVevugmP7Fz2CmTzW5/8+ZGP/+Kp7h/8oI4MuOZ7M5B9IvujH2Wf+PnCAjzn8ZK6AieMKRcvXnxWWSWCzGARlPcqtqs21WZzEBFgYIVDAYWzVJIrXBlH+hXGlWNM00GAJmYZ8sKBzTJFVZVppijqDFMVdTIWLa0o5JrdaHusPZGIG1IjFhQGK2mAZEe56kJnR1bTY7ZT7eivFGODBTdma3pHtlCNDVbwmgMHx/aO4R8ffeet5/ZCG6TfuV03IaSJU3oIzKsGO9+5PV+BwU5xqnOQx1aO8fW71yvD9fPn55/fA22PmsaFvfSgwZ8wzPiFvZ2DUMnzJ2hHVDMmHucPsSRrq7UQo4DMAV/AW7CANw/Zru3NIx20bBEpXwukArlxxOPReibaG63/SyQyiftzcBy3k1HuOHgjEgFHnkYfh4VodDJC4138Ff8hv5PlWbrWmm2O6grNEgGNCWGnbFtRm1Z04gzQPPWvkqMWF4eWU8DB267Df+gNe84bBvfRpfNI5Ny5yAmHDh5/PPLuByMlekDS9DsRR73nWHetwBShSO5PqCBQONO4E2wGlSvYZG6gMzeQ09SWFZC0tWION3oOVVXGTbGM+hrAzQj0O25yoN8R8YzzRsaZdzLwhpsGPEm783hAJ9+kq286eDX5pn/VydDjvk7i8EuchU21JJ3DNOqFzeABmywPcNXxhu/wB+3whrqwVw7Cn1j8vPfdDH6O7PR3fDV/Cb85wua/waSit309grZJHHOhHEQ9CA7zTGVCUb0ZvXzc1lrRe5Af+4An0aSL9op0IU9y6vRFtAYGKy7KJGFbQrdg2dXqGAwWilld0zUy9xLqd6A/zeFuy7gzYFmBOwOhZ6NNhZakm8YTI7S1pyM1mM032V26qevXGlzZ8+TKvROlB/BBkO9ACDalB7OZuBnuC5tRcAItpalENNOfhajVH1A2a1HjbHZ4N4r54oWLz4qPoe4jrMo2sonapm5QRQBQ3XycKVxwRRxjQuVCnWc6mrzOZ5FvBiraOmia5FubYRpok8n0ioRTKOQMNbWiszxYWAFZrQ1sB+dDJTFYghzyiBN3oB857ndIAha4Se/+YGUtjAkXXUO2xPE2eoe3TWPeMOXmzNi+j9w1HghvVbSAmu4c6nFac6MgbzXFU2baDr1241+98TfHtU/9t7df+MzU4msmfPYj06Wbw8Gqohda0/FkSyiyvtPGG/FsMKq1pLqmPvndkye/+y+08eYIHEJZpFmJra2Nop/VWuKcCwPvgRhnGlOFps6iIdAEmFVAKh53jblZyBU6nAFdbfX03tGwioZ9oGnEyDSWTQCyFzhoR+s/jdjgWLmc3L2K21zEmXCsM5aDm4g9Ny5v0PZVb+dY9Rcd/sl5eTiPj0nTaeiU+BhhW2qbuzJcUy2Nc2gCrjBkxWCqZiArGgOuwSzjAlDb5L91XfpvfYbpij6ZRIUWYoVcLqC2+UqNLddsMrekY3GZztVl2uQjpl4xjedIM+Uybc/r5viShuHgcgXuwQtpuoMHz8utCe/s8S+Y/7xMaYu2DX1yDrez3lp3cyyKdop+HLcLi878Uh9SKOSlj73cOIUFRVKVKHhaSS9JP452RCcYoJ3w85bz8Ckp9VN4xeZj9atpH4FnPCV4OtiDNIVYCrWwsbauK81VxUlaQnA+riFBisoUsiU0LbQpASCmmRAwg1MNJoH19uQ6WpriUV1jIQjphA5QjosiTfiy1tF+kPJKMTFYpAu6lkx40odnTv7VjYtC/QtTJyGH9HmMnKamGrcaqmaagRsMUwR9WeLmwsQREvIRevSvYa8uVFXo9Sc0w5A8/Rp5+jcxhXLuYAOIx/pbY+ggFp0FV8lNoLNAEQvyDkwBZR9T1ZC6xR0qFgsybix3DJcR7iIGwCsCHHQM0nYKVSBXQZPnqG7KDZiqrn8K524gpN9ghAx42k4GsvF3nohnA0kbnglkC9mrl7h4Db2TommKcVE1QOPRd97K5WJxsKO5nIjHbHtx/og3kK8iWys1he/EkKlqCbFOB6iKQp5Q5Yp6DB0AsjmPvHEFSGsoFraPaVpI2zLc2lmudErjJ/eeQwbKPoRBZulcwhwXYc6i1SdiEpiCF+KrFOIrAzKaHdhQ79tw4MAGuJv4rt8sQQu80jloGnnDfNVJBa+vn1WjSg1d8NHrg44FbTgdJ5+T77yy/gDI5wY7633yTbI7+CdyMDyEL2paDd0BvZjyfIYXH2/H+aqjDfXUisgnk3rFYMePoyZBegWanQpM5hKdlUSU1JnoQH2iG1d90IYADi0JPV2/oxMEeB7apm+aBngFw/ObMjzHzv7dgzyOh48fHZnmO9c8Wv+2RAGwHiP20UNnzx46mvYxyaMixDpZX22lQqQgRDqG4kYcMo92cpypAOo0Ti+iSYXJRGc5l8wvQhPfqpE0SYa7nDwkeQyh26OOlbecqVumoCwJ8+mDm+9/5T4eOyOt+4wk8WjavYTIG+7nD5Li2cWv8zGkMYoz51q2u3Y1JQSwfcumSn9JUxW0CZIWQ5isqKCo8zoGFPybx/lyHD2w4AaCBw7Ap1HIxAaHyZlr1tXG1owMt7h5Ox5QmxF4Iv6vDhaQoTFAYADuYIlnLa7b7RwtiOBDtVK1dbyCMXXxn5azOIIKfLFKaQP9K3HKIMYEQosvhkIWH23TQ9wIpCq9M4WxycnJsQIUYrEJ/bPGuOZohfHVzdmMaAmHm418c7DU3xdoyYPebFktPJtpHu7fefjw4R0VHiNTa06ZUTPe09a1sdTUVNrYtbo3nth11VW7tBa1d/U1a1t71rdG2u1IJNkWDYdbUs0pnnFT+OloWzISsdsjqVpvy9prqrNjed41POfPx2+J7TIXaWP5Wgf5bvToBEvpppQYOXPOJoda4gTQE6TsNK8sAvUSSHBFygfnfM9wL+8aK/Bddv0tZ8SufyKZ7ml7s20iCWdsPpPu4YVaXuur/2M6WX8riReTE21vtPUAnn4iyTxdf0vJ+/QM0pwsUL4D5BmUBQEeXpaU4W6RtExzN1In7eT9qHPpIoUdqAzSrdyHIPo1JNRps1uioCWJyIm2U/JG8oO4aZMXozF8b4RupRd5JJv7Nn8ZeUyxjlrakhJHcwO2gHMUDgGLR0MmS0GrIoMRWos0K81LUnPZYgmkw6sM8HtCoQTaT9y0Wu3f/MZuCYfijhMPhUVQNdL2hY8kMroS/8UvEqqeSfC/xzPV07k3vsqyrL+2ykYnhJjEz45OLIdbu4ncrbrWhImzltU7oqqaXAEdMWiHxPsSdvuF70K6/xf6FejjL13YBvFVP+UXrkwnyelZjBcltoLypQIoEmsoiDUw4C2QFS/I/J6yx5ybWOOqaMad0kJlKo+ElAdLqvRTMqOsgucuM64j3hgHU1H1mIkQ084Oje3eXT1lZwL1nwaD0BZMNfFTcHpv+sf7v6LEo4oZMlRbFNqH9tb60nEN0UkQ0mYawZNpR878eFuD1lWsl/Jb9J5iMbPlDKnkh3raBmS66U1M9Jm5rKUmMel1dKLOcxrVSgf5dJqU4o0g0pJyTlV37x4bytpCATOG8VUT4+m9cPoURiakE34ZMes/wbB0Roun+2p7h9oLSlwzQqZq2eIr+xe2/Rhp5QF8hHn5Hh/FfM9ibs32UrNG+l22ZbrnJ8N+fERAcD6YCp6nuPc2Aq/vWXiMfzKaye/BDfzTLPwe33MT8ns4P/y0uiLBdyZw3qRvNvGZegjF6H+escXvreOnkD7zm7IkADTbJEkU4sdw1jmwzpTj42smHLB82ijenjfx9YsXkccR+B5+I1azGtQk+4maTpnLlsBL75E7O1IPea+mzfPmUwQt00FJoG+nPxN/zruZzZprTljyx2GpXiHdYWBZtcINeB+2xVP16/GT9euDwf00TbqgK5gK7QvCmfp/wPn15WDa3BcM1l/Hy8F9wZQ31nf4Q2IjjrXyG+BnzXnMmqXiTuB5CLa01gINjvb8mesSTwHuSAEtzm8anp+uvwbdprkfhUs0wCNIxH6TP1l/vf6aPDThK0TXI5I+tjj+SX/8wIcaPxWX4y+CqsCiEIiAIzhsKrgfh+6qv+4L4RETPl6/zqMKukki9AA96OseZb3Zk7UKVKxZKt65tpR1J9p1sTGgP5Z4ah+KEzl73R/xEfr+I8H5fchlN/Jr0n0c3fSGkrz+vbhd5m2ZWltThDeKUaKh3WTZXWauS+WomBdMkjGvOCRuT9YfcIZxk0x24/5cT3q8redxe8TpTsLn03b9LIaFo/I0eQ7uxtjQm6rffI4elnTcJfbwX/qRFyG+Vw+SaJdyFIpugk0WXCcnaZFo1323viNAWHZPvk1+ugfjTf2sbcPR5LDT442bhwPj6Z5z9qi9wr8B85Ji51yXb3tISxlpSUtaZEYnFX8ZbHI6C8vk4ll2h5/YdRQbM0CUbSmXHsd5rH5zWz7fBnc/5iA1NLANwyQZ2+5JjiYfQ4mle+BxJA1prT9g+770dv4zTz9RnTPp+JlY4DJKoroOucmyT4fnsGIeFC3H9EtmB+qnGyP6413tPvs4BhIwipskDKakeIg+KKTgbl92JBkkHn1J3c8t+9ia2vBKhMFkGBJtEjrGDIzKE1SeAgTJiDAVRYpKmSGwMlksJor5gUWgjKlXYS0gurS4neaYflXJnaWBUjDKNAVhkWoF1WhHz7uJ2PapE8NHJkulySPD62/qVmLapMq10a997JqvnphQarc8dO3UQ2smYr38pfOWszK6fTs+eBKfHy4j8t2uWNrWnbDx5CNfe+TkxrHVE/EEW4ynxM9H2FhtpAeE2tnGFUH1J4xXChxD5hACLNXbLgOA3WU353rI37Y44SipbwdxwED/mEC0rOmuIzmlGkw7SBzNxZ6NN3519+zXRhV1Uosp3TdtGD68s4eXJo8uzHVtjyXc85gC9MYmRh+euuaRk+vhAG43Tm3RLGW7Clp52Oesq3N7dKVjnW9KxCdWjyFvi/nUs+Ja5CnPxtn+2t4NnVwLrELw76JqDMz1MacMGJoR0I5RVsA1lR/DLEdonLJLQWnOMcSamKlrszLnWWZ3mzcVOjsrnYWynTfVNmQ6aQFxrWtL9SQtgjqsojbxf5lp+qquSF1rVGyk02qZZEEKRkPdlv9ff3LVQ6MTFMas8xSft3fNVbd+vqg1KaF5w7RwBsirUye24UVXDS3oIcj/nz+56mF6qQlUAQ++gGoNytcxFG7P98DWMXMoHIL/6l/Z7p1riv8ko2oiyiru129WsSrmUjO1XdtWc0Pr7miOoWOV9YUQ07WQPmsCisWYDge5puAUAI3NIk6EQACmaQ+BGRaAwOSemV1TH90+vnlDrZBNFOi/nEUlLL96lYx5VZLqB5zDQLFQzGm6KuUX89L6YqxRuaPsCwXYTlJE1EVJt9ycWTo8bereoW7Wv38ewfOzmgI/N42Kn53LatjTxUCv85zbEyg+Y5hTcDddq99M2ysc8/51lABfjZ++8KvSxvUlnpCj7U+mIG3vR8yhXSbXEbaB3cDmatdds4lrhi9Z8hskNo2hkI+RQHWN6fMIUwKGFZiNhDmCNq6BoR1gejCoTzNdD86woB6cPDh33YFr91w99dHJLePr1tp525NylKZkzJtthLplN+ADzhOxjpiN1trRPwb/vhKfqIcMg8Mr3DDqd38o4cM36y9KWa+Tsn7v4/ocj134Vcg2TZsf/ABFKH4tYwrtObZYYxoF3QiQC+PjATwUho5+W8MkQlOOqUDxnlMNjZpsfB8zjJCxZe2afKeTjXeuboqT2XcOlsACB6XROFhWch7AeNy/VsZfx4fO5Aj8EjTVRPjLdtrmTS1NX7Azce6kmjZnnHf+1iuBiG0duzsmQTiZPzfjEoTGAqZ7xqt/nmmai8gXOWb0/sG9z8vyyPNOZjKDf9DlRgmQR93keVlHOU/9RTkfH8W8ieTQzWpsc21DGRM0Xw4soAUWDEDPtMB0oS9I5qeXC0PhMySPyTWjuYFctn9JEgWLp6FSXdz71TeSgzuQBmnXVHPXGqWhIhXkF+H2lQXxVqiSO5OthN9CQQSazmBOhdycwSgoZRJvQ28Yz8SVltDiwd3PUxMLN9De1dWehinH5783RvA9xhpyoHgnWAfGvE3sqtqOFT25rGIoMB4GBa0NAaepg2KYyiwVijQqFKGtopEeUFFYgQCboj0jZ8cCk7U1Q2W3MBBLjMRi0SCKxO0od6gD6Muon6Q35JGLDZS9DEpfLNZTA4aqrmrD0rwHCAO8Cs/Ur4a3J0Lql9WU4RfBJiYySfg+cviqaczLvipt59LuhbjXflPdSuRLUUd/9VV422jRv6SF/NbehYrcQ1p2AZ6jd80L5+kSRwE3WV+OVGTs9GvnU6yLDbJsrZ2aE+iijskqPtuHgTAktgz0r+xtaUaslZRRH6FKlRJrBwO9bK+lef8YXipg7j8GSJjM+GRPmSApRv6n//T4VrH3qqbRaNxoqoxSNMfwD6MV18yPulftrX+xZ7gXeka7vMCPgf2aQ8+N4bPuaKz7lg2LIGjjTT3x4T4jvubPYKL+cFtPTxscwm0DA+yVNaMjbFNt/cE9k+sUpoxgas8Gu1qjhG7GqUu+oAFel8B2gTDcgt+54If2XXv1VVsmVvRkM4m4TnnrYCGLtt5foc4F2rWO/NrIbxENvBHUy0WJBYqEg8hbyklAxoATvupfHMCZ3wAHaASEAFz/Y7pUPh+ZumWK7z65G1KGftgMJro0NbIzrOvbm1sCuhL9tBGKtrof1aLaZkdRjS4zYhzSDTDVw4bldnrPGtubWgKGiH0adR1JuR9VI/qErSgB72HMk0emp2+anr6F7kfTydZ+zdKSO0EdDRuTqaip3xAIjapaLa1aWqg/kmqNQEiXzza3ZFbqId3euezR4Iiqbkj5j7ZEIeTX7X4n9vLvLmKL2mAXILVUp0WPoyLCVJVGQ+/yNlGhjP8PNLq4y9vNy9rPrn+eW36OaPmdX0nTF7EIpu9XPlvW1XMgOiHbSHIL1ji1nsbpBdbAyXtlTRwjSHuCqyJvkjfAVEiMe317oeLEURlNKa/CI7tfVLxLp5qb4tFwUFVYJ3R6/STHqy1Xi1R9RLvvd6lSPIba14rZoo6zwa3w/7L18OGzRwC+N7B52+HD2zYPfA8OP3iIH9kyjkd4Fdwj9x85skUPzfXhQd9cSN96mB+97yjgoYUXvZ7kxYu/UW7mL7Eo+rwKK9byTKWsSWWz6N8VBaZxB5ShgDJZHerscm0J6L1at2fNGPH4CqQNZ+gAGTeaPZVNBB52IJ7nt/uI3N/B0707Do+8vmEH37rpdTLX8eEDd47Xr564Y3aIj+67azM8Q4dwYHjpHbJoOu1/8OkH++lk4s59Y2Lo+tsevG1ukA/N3uHb9f9TbkFebNRET61I/GEuOEtdCkxKcdfISpPptmSn01kdVNF4Y4NjHF1rWnh0cxWZKImsJdKcKPPIkZR5RIoYkcJ7dh665dDOHqV/4jgc2ILXkYz77zgwypGsH1zKst/L+ir6nJVsPdtR2zaC4aQTZC9CR4p0jigDQ6gmexJcUeeXdbS0xY7WslzDdpPF8uryAPX0L+tqoVNFD5QrFi7rbKGXwYnkJGCpwra4XMZe1th6JZcOCL0VgV445HepqL+l5jVdKMHP1VeH89a/WtYaK2/9Z/g4noyFYduzjf6WpSS0FIKDRovrC4aaQ9ZArQ9b1r/K58P0Yhi/4Msl4WPhFbUuzCTBb1OitsjmCVsAn+Qs3eokTJ1FeEQlI1nGXNlfnbS8tcc/sYz4wU8vsbd+lr/UII5u7mncOYBJ+WKc+5jsETe/L03AXCfmN4IlTVnCOYiVSxyWr5h45up7d/Lpu568c7ey4zRcu6yjzk9P3Xvu3im5qb9yaf98ab2AwZIsy0Zrq6nXxkG22zi121ScGiC71IoiZwcZqlAmzUCmvaU5GgkkzaQfoNCjlKimWnxvGhtR5b4r0roYFX59BZLFsvVB5NMRIVAGQ65bJoBsRuaFbLJM/0n3nZCLlZaWYKj+efWy88WezKv+yiG5dKnN23mX2uUJbi5bY+Rc4XgxBrHXGnlYb637gwLPEuXVBmD1ViiIyzgRfl5f9NddvfoB9NDxw0clWD9KV0FbdhMMjzfc+H7uJXEG8fo6Ns4O1q5fU+KCCq16PhXG3JuJcczFw6GwEaLSBXkQwNwF4DgLs1AgHDqA2FToAXEgCDpj+jTudDaDgUmnGsaG9bWx1UOVctJGzBlDf2HJWgZyh1HHkeV53RK5WC6Gc8fr45AzKSByxwlWHShTsxydSgfVLhALUZsXOiS8w0TlVOdJ006bC4ZayA43j7cN9WCqeCgYDTvGJzKnKG0Jn7ou6KSC18Frs8FUk2Jch1frv65/kWLdMMbf2fWfDKac4HFdaYpb8HY9ZDXZhnEylEgHP7t2L6YMcO46M22b111HA113zoFBDJQUpy/WLx6B36K+MxQdmlHBKerm0BIJKqUu68GgoLY0VSpexdChJiDC1WpC9qwK1cQYpS7U0BW0JAzeMrX6P+hRI2Dy4z/hqqmb4gS3jG8GLT77P1Ue5E4wfOFTFoioAS8NYVYZhv9umJapaPV6hct6wHdkHiowcqVYnvUivt5Qa+3vK/X2dBXy2Uy6pclBE4pR4XkwxWHTtq93vH+tv0l2U6pFvbNRePWrv51uBFbBWmgHbw/upXv+0LnRc1AxL/RjLrVgmvx/yP0Fq1KJxarV2A+PHct2HDvWwbvxJIYX60/THfzHrcdGH7shQm/iC2l6E/fXRumtaPU/ybeyx+p34UkVL0LJv9PAUHOomzL1w8q9uZaYoV3SIOoujHBKKii60eKMxhJHXUMgTQW0InVqqErq22AbYN6BHOMkFCMtlpWLDDc/0NM23tYLZ1uGMX5ZrWfPtkQj+chQ61lZiH+gZSiai0Sbz4JhDbeswXd2PSVr8E/twqtr8KXdu690Q2KpI6jHMMuhBjdRdbG9iQslEae6YVhDV7gBdOiHgK4iKtSERkv4yOpAP8ZMpimmNqtSRuUFG50FDD2AeaYRNrasGS0P2LTwuGDncpRJNtZ5Fpev85SVhMY6T3ewBJrtjAFIs8XZi95eSXOXLJkW75wKaXmE7afkst1TsjBDJxP3v3I//kG6Z9R+ce7WnfcfrvHRo6fPnT46CpteTMJZ7yXKMb2XTlHieMpspgUYLz+k3UsJV/LFTWNH7vvT08eHlfWHHtx+69yLSbZMRhHWhDn2SG0oYCC3qE/B0qAKuZqPg+b5XkErlwWmYkKlMkNY2eLmUAqF3OJinmKjrPIhuK1/W/IJ6z8kh5K1D2aK+/UTWqOzkz1fC4xVOgKKKqgjZqKV9nhTGGOgUGnZjiK4Mq8jJFKOMwJ0UxSLdlO/Ymvrtq8H3/UG+nBNcG0e7Vh79xt/yOf37KklDMPYaeyc3LZ1y8hwT671KoP8BApooL9agOqYUm2FATeRptTcdeQGxexmC3pWyw2u5ZSr4l9xsLCKW+DaaeqxVskXZql+XdTggY9NDrcHk331MoTzqZSj3fGlCe3GxJQT6IsGjeBkQOGQO53v+VKSb9E1EVMQ5vKs2/R7axiimWAmiVCh4/MZ1eYrecvvMWx9oa71KppmNkVhBs6G6m+veHkw8amOFi0QFY4pTI7RrikRxSd1jgBaCeytDEHmYSsUN/HTEEyqQVQ6ppY4937ER/nPmMXaWK6W8TvQy1cj+s28wcIlS70LHqQsSoS5rB18abP70ubwv0VMqrRhJALnb2SJXZ76vg7pAPc9++oF2+s8XzLyZUMt/3ajhy35encPGy4n+lIy4Xvvou1JERMJFmTa8zqHldSwlaBa9k6VC63heDzM/3cYttfndDMiKlbIwCN7eV2F8FS61toUNZhCzHltUoKChwg/yah6WVnr8jIXJer+ultoizj14CWn/GfvvEU5uIjTdtnx8nw86K1TlzWF5QsXBhYXGlw+3rLk/5IB/G8+gzZuYUagPa8ByoUaWfiRIuA35I4CrJOMVariLtOCaKD+Ryq3gvWTwSDci1AAfVtQi7zzsmWE4F5Vq/+RPKDe8714vX5SVSVGuXjxa2K/iCyN42qyOkbLkXwt6FIjmt5sRsHC11VB2yANZQl1HL+GWjFC9Em4Vx7Q2oKTeB2+oKkeL3xEkBU015zWlri4VEBrpICIlwZ7Eso2mgSVKs8GLeJN5YsLnmn7Lh7/45KS6ncSg5I/Por8NcaWi7UW27Te2JeyTGPqPg3VS9j2CzJyeznjn1qaGXCrpsq8ro655n7+1zi3WwkBRkGuRl5e3eMyi6L0TvDJcnYwTnM14fWG5Xyh5nXVLya56BmNJRUi25oYoiGRJBGXdaO+Rb1Y9R861mlZYzodsf21K8/wZ1mC8I75Hr9viTsF+fsW5BzxTSO1IFQNz6DJvnC/lPv9L6Ab4KcvfJU6gC94y9NfMP31s7i5XY5RIn6LJqKRxjAKDuOVppiQA65ycUhaEvVeQya8dVuF6uCYKClVFADVGd5FyGt9RTWAAgg50ahiNFm2YkcCarHv3QTW/6Jna0TY0VA0FEpnMkbciKJ0RGSrrMN/XzzKfy7p3saOsq21cUl7FVQ2Dboqxg8D38S4hnxooL2bGRU1qurqAtP1Q1M7xzd3Sd4MKlx9aN7cxtWq/1OQAi25ohrK0s0ilVHwbgmKVNGWD1T/IMmcmd2u68h5MhPsLpW6Mf7ZEUPfceC+0zfhdXy9uTm5cQffujnZrMQFzmZdv+n0HyDOnl33Z4RjOcFoIL338N50IIpBxBEd9+2+7fV+vGGHQ5Y18NCTDw1EwkITYRu/JwZe9fPMI+IfxFUsyjbSqvKhAcwt168pdedsTBbTzZxTnRzRxQyV/if8uggP8y2VcpqWw7iyTmgJOy3GuEu5oK35P5xC0L6GZFag308hopD9/6r3KyoE7rKG5Tqi3D9z8s6TM/3+7mEeeCxiPDanxdWDjxmRxwKIeebmVFVePajGtTl5VaWLcGDdLdMVpbTvxD0n9pWUyvQtew1RfioQFOU/1vU/Lotg4KmyMEz9nnuM2OINTVu8ETPuuUeXPuNZUcFYEmd9rFRbYSxfVUjLiN9dFerqyvd2yKWFBEEB548Fup3m1PWnBQHUERnjyKYur0O1v1pBfvl30u2Hnj4EwydOw/CBOyd23vd4+YefpuUbvHb84elmO9HXD1P3Tq1f48YM5VZ17msH5/d1fPtmWQndeOwTd1EnZNeXbtwsoBRbcbJ29T3T0GbGDO+3J95aen6KxViWDVCHL8i5wsPAxPLfE1FDb55RmQnmCYgrEoijOyX+6KeDoE66Tt5ONjkSgheKBA9LqL6qpqchU0E7QaSYtJ3+irSVimrrmpLJU3ej0gsK6vTRXbdlEXtnb9u17Z9B+Un9m9Hg5rmoE93YF4zCPwZ31H9b/6f6b3cEgzvAgAIYO4IwfMe64Q03nOX3fXzD8Lo7brzrLtiCz85tCkajwb6N0b9LJD738MOfSxTs2x7mj3yGsEgjzzBYB9Xw2hGCYAZOzYWG2uR6nFlvxlJeEZfO732ziNsX84be4ffMGz7/gRmQb1dyTX8Q/dtArU8Hb8Wybmgod53NBlQOilxbg9mPCIstK3sTAzE7O5BMJuTKkvJgwfulBskXM0CBMymXLQrpkSoDMVmJ6aA2QjGG4SJkRk38g5sd61dtYGoQ4St+jHY+U23r4aVWOEjtseoMnDgvfwCEm2+hp6r/X91AK4zYkU3HMVEaxnR3qBfqPzn+/wHPnsOreJxjYGRgYABi1vIsoXh+m68M3MwvgCIMt5YoxkDp2P9f/2exVDAHAbkcDEwgUQAz1Qu/AHicY2BkYGAO+p/FwMBS9v/r/68sFQxAERQQDACh8QbyeJxdT0sVwzAMy49AkAxAkbT3UQiAITGAISmAYQiA9th4ttUs7Q568UeSlVidiwSkB3PUPg+ESd6ZD/+8v7HyrtzwghY89ZB6BcyrYqc6RZhw48YhaA1Wc/v1PQtdeXJ/HppUmFM597nvBVK7D+Z+E8/uQZLBgDyaz3Llvxx02S3c/Hv813JrznryZP4F+6lSfQAAAAAAAAAAUAC2ATABaAGyAfoCJAKwAzYDmgQSBFwExgUyBbQF/AZOBvwHRAe2B/YISgigCPIJGglCCWQJignACgAKQAp2CroLAAtGC4oL8gxcDPINng5iDuYPag/6EF4RIBGGEeQSShKYEyQTbhOyFAoUYhS+FVoVphYoFooXHBeGGFoYnhjGGOwZChlOGXgZrBneGhwaWhqgGtIbLhvyHHQc2B1QHZ4d/wABAAAAUwBtAAYAAAAAAAIAIAAwAHMAAAB2C3AAAAAAeJx1kN9q2zAUh39q0441YxcbjN3tXJWWEcc1lEGvWkLbXZeSu8JUV/6T2VKQlY48w95ifYa9zt6jd/vFESUUYiP5O5/O8ZEE4AP+QWH9nHKsWeEdozXv4A0uIu/Sf488IN9G3sMQPyLv0/+MfICv+BV5iI/4wz+owVtGM/yNrPBZfYm8g/fqW+Rd+svIA/Jd5D18UovI+/S/Ix9gqp4iD3GoniduvvR1WQU5mhxLlmap3C/FUdVWN6IXoXK+k3MpnA2maVySuza0ZlToUZ07292YctFov6k2eWp8VzsrJ0m6qa+NNV4H87Dq1j2WWQiFFN61chX7yNy7mclDUoUwPxuPN/tjAoc5lvCoUaJCgOCI9pjfDGk/BPfMEGaus2pYaDQ0GgtWVP1Kx/ico2BkaQ0zGnKCnHNL09KNuK451721rLqhLfmfht5vzdrmp7Sr3nUfC07YL92afU1r+wrd7/Dh5WwdHrmLjDawanUK3+9acPXqPML7Wq3NaHL6pL+1QHuGMd8t5/8PvPGO3QAAAHicbZLnlpswEIV9DRiwvZtseu89Ib333vvmBWRZYMVC0pHEEufpg8BO/kTncOfTaLgMOtPr97o17P1/baKPACEiDBAjQYohRhhjDevYhu3YwA7sxC7sxh7sxT7sxwEcxCEcxhEcxTEcxwmcxCmcxhmcxTmcxwVcxCVkuIwruIpruI4buIlbuI07uIt7uI8HeIhHeIwneIpneI4XeIlXeI03eIt3eI8P+IhP+Iwv+Ipv+I5N/OiF1hEz9JKxUrtFrDl1lWF9NR9QIikToRaVjUouKxvOmNBjLxnlhgo2DbnM1djLKrNGnGPScSUzItzGv93yPP2bSQSX84z9cqFQdJ56yZRmMhW8mLlJJSaBI0XYPDaZKDUviZmvr6DrNjJMi0WcK1MTM02mqpbZlJtEsNx5SI238jSodJtoS7qv+BpPw67IY9xU+dg5TXjROTWwdGrIOzWhT+uA0jolxqjaZrSOnCF2Nmq16651EYpMm1fakAul9SJQeR5QVYQlk1VkZ8SwoVNFIVjWnKQrlBGdMToftdoZjrs77DajqXKrS02YEFxbbtdWkG0x44JJVUS5aBqKSlJwmhDrmOF2Hv9Wqsy4TNqoKhfmSrrQKuNSL5nvPG6p0s0AkEWkSWVZMy1Kx3ljk03qLuZ14lTmB8gNGmByGrGfjLrhlhJV2f7SaIneNF1ypQNbybBUSgZswQaWEUNngeay1/sD4l/60HicY/DewXAiKGIjI2Nf5AbGnRwMHAzJBRsZWJ02MTAyaIEYm7mYGDkgLD4GMIvNaRfTAaA0J5DN7rSLwQHCZmZw2ajC2BEYscGhI2Ijc4rLRjUQbxdHAwMji0NHckgESEkkEGzmYWLk0drB+L91A0vvRiYGFwAMdiP0AAA=') format('woff')}</style>
<style id="style-core" type="text/css">html{font:16px/1 Helmet,Freesans,sans-serif}#store-area,tw-storydata{display:none!important;z-index:0}.no-transition{-webkit-transition:none!important;-o-transition:none!important;transition:none!important}:-webkit-full-screen{height:100%;width:100%}:-ms-fullscreen{height:100%;width:100%}:fullscreen{height:100%;width:100%}body::-ms-backdrop{background:0 0}:focus{outline:thin dotted}:disabled{cursor:not-allowed!important}body{color:#eee;background-color:#111;overflow:auto}a{cursor:pointer;color:#68d;text-decoration:none;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}a:hover{color:#8af;text-decoration:underline}a.link-broken{color:#c22}a.link-broken:hover{color:#e44}a[disabled],span.link-disabled{color:#aaa;cursor:not-allowed!important;text-decoration:none}area{cursor:pointer}button{cursor:pointer;color:#eee;background-color:#35a;border:1px solid #57c;line-height:normal;padding:.4em;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}button:hover{background-color:#57c;border-color:#79e}button:disabled{background-color:#444;border:1px solid #666}input,select,textarea{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}select{padding:.34em .4em}input[type=text]{min-width:18em}textarea{min-width:30em;resize:vertical}input[type=checkbox],input[type=file],input[type=radio],select{cursor:pointer}input[type=range]{-webkit-appearance:none;min-height:1.2em}input[type=range]:focus{outline:0}input[type=range]::-webkit-slider-runnable-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;margin-top:-5px;width:33px}input[type=range]:focus::-webkit-slider-runnable-track{background:#222}input[type=range]::-moz-range-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-moz-range-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;width:33px}input[type=range]::-ms-track{background:0 0;border-color:transparent;color:transparent;cursor:pointer;height:10px;width:calc(100% - 1px)}input[type=range]::-ms-fill-lower{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-fill-upper{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:16px;width:33px}input:not(:disabled):focus,input:not(:disabled):hover,select:not(:disabled):focus,select:not(:disabled):hover,textarea:not(:disabled):focus,textarea:not(:disabled):hover{background-color:#333;border-color:#eee}hr{display:block;height:1px;border:none;border-top:1px solid #eee;margin:1em 0;padding:0}audio,canvas,progress,video{max-width:100%;vertical-align:middle}.error-view{background-color:#511;border-left:.5em solid #c22;display:inline-block;margin:.1em;max-width:100%;padding:0 .25em;position:relative}.error-view>.error-toggle{background-color:transparent;border:none;line-height:inherit;left:0;padding:0;position:absolute;top:0;width:1.75em}.error-view>.error{display:inline-block;margin-left:.25em}.error-view>.error-toggle+.error{margin-left:1.5em}.error-view>.error-source[hidden]{display:none}.error-view>.error-source:not([hidden]){background-color:rgba(0,0,0,.2);display:block;margin:0 0 .25em;overflow-x:auto;padding:.25em}.highlight,.marked{color:#ff0;font-weight:700;font-style:italic}.nobr{white-space:nowrap}.error-view>.error-toggle:before,.error-view>.error:before,[data-icon-after]:after,[data-icon-before]:before,[data-icon]:before,a.link-external:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}[data-icon]:before{content:attr(data-icon)}[data-icon-before]:before{content:attr(data-icon-before) "\00a0\00a0"}[data-icon-after]:after{content:"\00a0\00a0" attr(data-icon-after)}.error-view>.error-toggle:before{content:"\e81a"}.error-view>.error-toggle.enabled:before{content:"\e818"}.error-view>.error:before{content:"\e80d\00a0\00a0"}a.link-external:after{content:"\00a0\e80e"}</style>
<style id="style-core-display" type="text/css">#story{z-index:10;margin:2.5em}@media screen and (max-width:1136px){#story{margin-right:1.5em}}#passages{max-width:54em;margin:0 auto}</style>
<style id="style-core-passage" type="text/css">.passage{line-height:1.75;text-align:left;-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.passage-in{opacity:0}.passage ol,.passage ul{margin-left:.5em;padding-left:1.5em}.passage table{margin:1em 0;border-collapse:collapse;font-size:100%}.passage caption,.passage td,.passage th,.passage tr{padding:3px}@media (prefers-reduced-motion:reduce){.passage{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}</style>
<style id="style-core-macro" type="text/css">@-webkit-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@-o-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}.macro-append-insert,.macro-linkappend-insert,.macro-linkprepend-insert,.macro-linkreplace-insert,.macro-prepend-insert,.macro-repeat-insert,.macro-replace-insert,.macro-timed-insert{-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.macro-append-in,.macro-linkappend-in,.macro-linkprepend-in,.macro-linkreplace-in,.macro-prepend-in,.macro-repeat-in,.macro-replace-in,.macro-timed-in{opacity:0}.macro-type-cursor:after{-webkit-animation:cursor-blink 1s infinite;-o-animation:cursor-blink 1s infinite;animation:cursor-blink 1s infinite;content:"\2590";opacity:1}</style>
<style id="style-ui-dialog" type="text/css">html[data-dialog] body{overflow:hidden}#ui-overlay.open{visibility:visible;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-overlay:not(.open){-webkit-transition:visibility .2s step-end,opacity .2s ease-in;-o-transition:visibility .2s step-end,opacity .2s ease-in;transition:visibility .2s step-end,opacity .2s ease-in}#ui-overlay{visibility:hidden;opacity:0;z-index:100000;position:fixed;top:-50%;left:-50%;height:200%;width:200%}#ui-dialog.open{display:block;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-dialog{display:none;opacity:0;z-index:100100;position:fixed;top:50px;margin:0;padding:0}#ui-dialog>*{-webkit-box-sizing:border-box;box-sizing:border-box}#ui-dialog-titlebar{position:relative}#ui-dialog-close{display:block;position:absolute;right:0;top:0;white-space:nowrap}#ui-dialog-body{overflow:auto;min-width:280px;height:92%;height:calc(100% - 2.1em)}@media (prefers-reduced-motion:reduce){#ui-overlay.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-overlay:not(.open){-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-dialog.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}#ui-overlay{background-color:#000}#ui-overlay.open{opacity:.8}#ui-dialog{max-width:66em}#ui-dialog.open{opacity:1}#ui-dialog-titlebar{background-color:#444;min-height:24px}#ui-dialog-title{margin:0;padding:.2em 3.5em .2em .5em;font-size:1.5em;text-align:center;text-transform:uppercase}#ui-dialog-close{cursor:pointer;font-size:120%;margin:0;padding:0;width:3.6em;height:92%;background-color:transparent;border:1px solid transparent;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}#ui-dialog-close:hover{background-color:#b44;border-color:#d66}#ui-dialog-body{background-color:#111;border:1px solid #444;text-align:left;line-height:1.5;padding:1em}#ui-dialog-body>:first-child{margin-top:0}#ui-dialog-body hr{background-color:#444}#ui-dialog-body ul.buttons{margin:0;padding:0;list-style:none}#ui-dialog-body ul.buttons li{display:inline-block;margin:0;padding:.4em .4em 0 0}#ui-dialog-body ul.buttons>li+li>button{margin-left:1em}#ui-dialog-close{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-close{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}</style>
<style id="style-ui" type="text/css">#ui-dialog-body.settings [id|=setting-body]>div:first-child{display:table;width:100%}#ui-dialog-body.settings [id|=setting-label]{display:table-cell;padding:.4em 2em .4em 0}#ui-dialog-body.settings [id|=setting-label]+div{display:table-cell;min-width:8em;text-align:right;vertical-align:middle;white-space:nowrap}#ui-dialog-body.list{padding:0}#ui-dialog-body.list ul{margin:0;padding:0;list-style:none;border:1px solid transparent}#ui-dialog-body.list li{margin:0}#ui-dialog-body.list li:not(:first-child){border-top:1px solid #444}#ui-dialog-body.list li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-decoration:none}#ui-dialog-body.list li a:hover{background-color:#333;border-color:#eee}#ui-dialog-body.saves{padding:0 0 1px}#ui-dialog-body.saves>:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves table{border-spacing:0;width:100%}#ui-dialog-body.saves tr:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves td{padding:.33em .33em}#ui-dialog-body.saves td:first-child{min-width:1.5em;text-align:center}#ui-dialog-body.saves td:nth-child(3){line-height:1.2}#ui-dialog-body.saves td:last-child{text-align:right}#ui-dialog-body.saves .empty{color:#999;speak:none;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves .datestamp{font-size:75%;margin-left:1em}#ui-dialog-body.saves ul.buttons li{padding:.4em}#ui-dialog-body.saves ul.buttons>li+li>button{margin-left:.2em}#ui-dialog-body.saves ul.buttons li:last-child{float:right}#ui-dialog-body.settings div[id|=header-body]{margin:1em 0}#ui-dialog-body.settings div[id|=header-body]:first-child{margin-top:0}#ui-dialog-body.settings div[id|=header-body]:not(:first-child){border-top:1px solid #444;padding-top:1em}#ui-dialog-body.settings div[id|=header-body]>*{margin:0}#ui-dialog-body.settings h2[id|=header-heading]{font-size:1.375em}#ui-dialog-body.settings p[id|=header-desc],#ui-dialog-body.settings p[id|=setting-desc]{font-size:87.5%;margin:0 0 0 .5em}#ui-dialog-body.settings div[id|=setting-body]+div[id|=setting-body]{margin:1em 0}#ui-dialog-body.settings [id|=setting-control]{white-space:nowrap}#ui-dialog-body.settings button[id|=setting-control]{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}#ui-dialog-body.settings button[id|=setting-control]:hover{background-color:#333;border-color:#eee}#ui-dialog-body.settings button[id|=setting-control].enabled{background-color:#282;border-color:#4a4}#ui-dialog-body.settings button[id|=setting-control].enabled:hover{background-color:#4a4;border-color:#6c6}#ui-dialog-body.settings input[type=range][id|=setting-control]{max-width:35vw}#ui-dialog-body.list a,#ui-dialog-body.settings span[id|=setting-input]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves button[id=saves-clear]:before,#ui-dialog-body.saves button[id=saves-export]:before,#ui-dialog-body.saves button[id=saves-import]:before,#ui-dialog-body.settings button[id|=setting-control].enabled:after,#ui-dialog-body.settings button[id|=setting-control]:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-dialog-body.saves button[id=saves-export]:before{content:"\e829\00a0"}#ui-dialog-body.saves button[id=saves-import]:before{content:"\e82a\00a0"}#ui-dialog-body.saves button[id=saves-clear]:before{content:"\e827\00a0"}#ui-dialog-body.settings button[id|=setting-control]:after{content:"\00a0\00a0\e830"}#ui-dialog-body.settings button[id|=setting-control].enabled:after{content:"\00a0\00a0\e831"}</style>
<style id="style-ui-bar" type="text/css">#story{margin-left:20em;-webkit-transition:margin-left .2s ease-in;-o-transition:margin-left .2s ease-in;transition:margin-left .2s ease-in}#ui-bar.stowed~#story{margin-left:4.5em}@media screen and (max-width:1136px){#story{margin-left:19em}#ui-bar.stowed~#story{margin-left:3.5em}}@media screen and (max-width:768px){#story{margin-left:3.5em}}#ui-bar{position:fixed;z-index:50;top:0;left:0;width:17.5em;height:100%;margin:0;padding:0;-webkit-transition:left .2s ease-in;-o-transition:left .2s ease-in;transition:left .2s ease-in}#ui-bar.stowed{left:-15.5em}#ui-bar-tray{position:absolute;top:.2em;left:0;right:0}#ui-bar-body{height:90%;height:calc(100% - 2.5em);margin:2.5em 0;padding:0 1.5em}#ui-bar.stowed #ui-bar-body,#ui-bar.stowed #ui-bar-history{visibility:hidden;-webkit-transition:visibility .2s step-end;-o-transition:visibility .2s step-end;transition:visibility .2s step-end}@media (prefers-reduced-motion:reduce){#story{-webkit-transition:margin-left 0s;-o-transition:margin-left 0s;transition:margin-left 0s}#ui-bar{-webkit-transition:left 0s;-o-transition:left 0s;transition:left 0s}}#ui-bar{background-color:#222;border-right:1px solid #444;text-align:center}#ui-bar a{text-decoration:none}#ui-bar hr{border-color:#444}#ui-bar-history [id|=history],#ui-bar-toggle{font-size:1.2em;line-height:inherit;color:#eee;background-color:transparent;border:1px solid #444}#ui-bar-toggle{display:block;position:absolute;top:0;right:0;border-right:none;padding:.3em .45em .25em}#ui-bar.stowed #ui-bar-toggle{padding:.3em .35em .25em .55em}#ui-bar-toggle:hover{background-color:#444;border-color:#eee}#ui-bar-history{margin:0 auto}#ui-bar-history [id|=history]{padding:.2em .45em .35em}#ui-bar-history #history-jumpto{padding:.2em .665em .35em}#ui-bar-history [id|=history]:not(:first-child){margin-left:1.2em}#ui-bar-history [id|=history]:hover{background-color:#444;border-color:#eee}#ui-bar-history [id|=history]:disabled{color:#444;background-color:transparent;border-color:#444}#ui-bar-body{line-height:1.5;overflow:auto}#ui-bar-body>:not(:first-child){margin-top:2em}#story-title{margin:0;font-size:162.5%}#story-author{margin-top:2em;font-weight:700}#menu ul{margin:1em 0 0;padding:0;list-style:none;border:1px solid #444}#menu ul:empty{display:none}#menu li{margin:0}#menu li:not(:first-child){border-top:1px solid #444}#menu li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-transform:uppercase}#menu li a:hover{background-color:#444;border-color:#eee}#menu a,#ui-bar-history [id|=history],#ui-bar-toggle{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#menu-core li[id|=menu-item] a:before,#ui-bar-history [id|=history],#ui-bar-toggle:before{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-bar-toggle:before{content:"\e81d"}#ui-bar.stowed #ui-bar-toggle:before{content:"\e81e"}#menu-item-saves a:before{content:"\e82b\00a0"}#menu-item-settings a:before{content:"\e82d\00a0"}#menu-item-restart a:before{content:"\e82c\00a0"}#menu-item-share a:before{content:"\e82f\00a0"}</style>
<style id="style-ui-debug" type="text/css">#debug-bar{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:0;margin:0;max-height:75%;padding:.5em;position:fixed;right:0;z-index:99900}#debug-bar>div:not([id])+div{margin-top:.5em}#debug-bar>div>label{margin-right:.5em}#debug-bar>div>input[type=text]{min-width:0;width:8em}#debug-bar>div>select{width:15em}#debug-bar-toggle{color:#eee;background-color:#222;border:1px solid #444;height:101%;height:calc(100% + 1px);left:-2em;left:calc(-2em - 1px);position:absolute;top:-1px;width:2em}#debug-bar-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-hint{bottom:.175em;font-size:4.5em;opacity:.33;pointer-events:none;position:fixed;right:.6em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap}#debug-bar-watch{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:102%;bottom:calc(100% + 1px);font-size:.9em;left:-1px;max-height:650%;max-height:65vh;position:absolute;overflow-x:hidden;overflow-y:scroll;right:0;z-index:99800}#debug-bar-watch[hidden]{display:none}#debug-bar-watch div{color:#999;font-style:italic;margin:1em auto;text-align:center}#debug-bar-watch table{width:100%}#debug-bar-watch tr:nth-child(2n){background-color:rgba(127,127,127,.15)}#debug-bar-watch td{padding:.2em 0}#debug-bar-watch td:first-child+td{padding:.2em .3em .2em .1em}#debug-bar-watch .watch-delete{background-color:transparent;border:none;color:#c00}#debug-bar-watch-all,#debug-bar-watch-none{margin-left:.5em}#debug-bar-views-toggle,#debug-bar-watch-toggle{color:#eee;background-color:transparent;border:1px solid #444;margin-right:1em;padding:.4em}#debug-bar-views-toggle:hover,#debug-bar-watch-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle,html[data-debug-view] #debug-bar-views-toggle{background-color:#282;border-color:#4a4}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle:hover,html[data-debug-view] #debug-bar-views-toggle:hover{background-color:#4a4;border-color:#6c6}#debug-bar-hint:after,#debug-bar-toggle:before,#debug-bar-views-toggle:after,#debug-bar-watch .watch-delete:before,#debug-bar-watch-add:before,#debug-bar-watch-all:before,#debug-bar-watch-none:before,#debug-bar-watch-toggle:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#debug-bar-toggle:before{content:"\e838"}#debug-bar-hint:after{content:"\e838\202f\e822"}#debug-bar-watch .watch-delete:before{content:"\e804"}#debug-bar-watch-add:before{content:"\e805"}#debug-bar-watch-all:before{content:"\e83a"}#debug-bar-watch-none:before{content:"\e827"}#debug-bar-views-toggle:after,#debug-bar-watch-toggle:after{content:"\00a0\00a0\e830"}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle:after,html[data-debug-view] #debug-bar-views-toggle:after{content:"\00a0\00a0\e831"}html[data-debug-view] .debug{padding:.25em;background-color:#234}html[data-debug-view] .debug[title]{cursor:help}html[data-debug-view] .debug.block{display:inline-block;vertical-align:middle}html[data-debug-view] .debug.invalid{text-decoration:line-through}html[data-debug-view] .debug.hidden,html[data-debug-view] .debug.hidden .debug{background-color:#555}html:not([data-debug-view]) .debug.hidden{display:none}html[data-debug-view] .debug[data-name][data-type].nonvoid:after,html[data-debug-view] .debug[data-name][data-type]:before{background-color:rgba(0,0,0,.25);font-family:monospace,monospace;white-space:pre}html[data-debug-view] .debug[data-name][data-type]:before{content:attr(data-name)}html[data-debug-view] .debug[data-name][data-type|=macro]:before{content:"<<" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=macro].nonvoid:after{content:"<</" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=html]:before{content:"<" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type|=html].nonvoid:after{content:"</" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type]:not(:empty):before{margin-right:.25em}html[data-debug-view] .debug[data-name][data-type].nonvoid:not(:empty):after{margin-left:.25em}html[data-debug-view] .debug[data-name][data-type|=special],html[data-debug-view] .debug[data-name][data-type|=special]:before{display:block}</style>
</head>
<body>
	<div id="init-screen">
		<div id="init-no-js"><noscript>JavaScript must be enabled to play.</noscript></div>
		<div id="init-lacking"><p>Browser lacks capabilities required to play.</p><p>Upgrade or switch to another browser.</p></div>
		<div id="init-loading"><div>Loading&hellip;</div></div>
	</div>
	<tw-storydata name="Battle Quest" startnode="48" creator="Twine" creator-version="2.3.16" ifid="29BEB2F6-F628-4D5C-9DD5-2094A2B2C94A" zoom="0.6" format="SugarCube" format-version="2.36.1" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">.dead {
	color: #483D8B;
}

.deathguard {
	color: #008080;
}

.fire {
	color: #FF0000;
}

.female {
	color: #FF69B4;
}

.grey {
	color: #A9A9A9;
}

.gresh {
	color: #FF4500;
}

.king {
	color: #FFD700;
}

.male {
	color: #00FFFF;
}

.merchant {
	color: #FF8C00;
}

.naya {
	color: #EE82EE;
}

.queen {
	color: #800080;
}

.redeemer {
	color: #778899;
}

.ori {
	color: #DAA520;
}

.plant {
	color: #DC143C;
}

.void {
	color: #663399;
}
.water {
	color: #4169E1;
}

.stat-table {
	width: 100%;
}
.stat-table,
.stat-table th,
.stat-table td {
	border: 1px solid #F8F8FF;
  	vertical-align: top
	text-align: left;
}

.small-table {
	width: 50%;
}

.small-table,
.small-table th,
.small-table td {
	border: 1px solid #F8F8FF;
  	vertical-align: top
	text-align: left;
}

.blank-table {
	width: 100%;
}
.blank-table,
.blank-table th,
.blank-table td {
  	vertical-align: top
	text-align: left;
}

.armory-table {
	width: 100%;
}
.armory-table,
.armory-table th,
.armory-table td {
	border: 1px solid #F0F8FF;
  	vertical-align: top
}

.dead-table {
	width: 100%;
}
.dead-table,
.dead-table th,
.dead-table td {
	border: 3px solid #483D8B;
  	vertical-align: top
}

.deathguard-table {
	width: 100%;
}
.deathguard-table,
.deathguard-table th,
.deathguard-table td {
	border: 3px solid #008080;
  	vertical-align: top
}

.fire-table {
	width: 100%;
}
.fire-table,
.fire-table th,
.fire-table td {
	border: 3px solid #FF0000;
  	vertical-align: top
}

.hero-table {
	width: 100%;
}
.hero-table,
.hero-table th,
.hero-table td {
	border: 3px solid #00FFFF;
  	vertical-align: top
}

.herogirl-table {
	width: 100%;
}
.herogirl-table,
.herogirl-table th,
.herogirl-table td {
	border: 3px solid #FF69B4;
  	vertical-align: top
}

.queen-table {
	width: 100%;
}
.queen-table,
.queen-table th,
.queen-table td {
	border: 3px solid #800080;
  	vertical-align: top
}

.void-table {
	width: 100%;
}
.void-table,
.void-table th,
.void-table td {
	border: 3px solid #663399;
  	vertical-align: top
}

.naya-table {
	width: 100%;
}
.naya-table,
.naya-table th,
.naya-table td {
	border: 3px solid #EE82EE;
  	vertical-align: top
}

.gresh-table {
	width: 100%;
}
.gresh-table,
.gresh-table th,
.gresh-table td {
	border: 3px solid #FF4500;
  	vertical-align: top
}

.goblin-table {
	width: 100%;
}
.goblin-table,
.goblin-table th,
.goblin-table td {
	border: 3px solid #006400;
  	vertical-align: top
}

.boar-table {
	width: 100%;
}
.boar-table,
.boar-table th,
.boar-table td {
	border: 3px solid #8B4513;
  	vertical-align: top
}

.merchant-table {
	width: 100%;
}
.merchant-table,
.merchant-table th,
.merchant-table td {
	border: 3px solid #FF8C00;
  	vertical-align: top
}

.ori-table {
	width: 100%;
}
.ori-table,
.ori-table th,
.ori-table td {
	border: 3px solid #DAA520;
  	vertical-align: top
}

.king-table {
	width: 100%;
}
.king-table,
.king-table th,
.king-table td {
	border: 3px solid #FFD700;
  	vertical-align: top
}

.plant-table {
	width: 100%;
}
.plant-table,
.plant-table th,
.plant-table td {
	border: 3px solid #DC143C;
  	vertical-align: top
}

.redeemer-table {
	width: 100%;
}
.redeemer-table,
.redeemer-table th,
.redeemer-table td {
	border: 3px solid #778899;
  	vertical-align: top
}

.shadow-table {
	width: 100%;
}
.shadow-table,
.shadow-table th,
.shadow-table td {
	border: 3px solid #696969;
  	vertical-align: top
}

.water-table {
	width: 100%;
}
.water-table,
.water-table th,
.water-table td {
	border: 3px solid #4169E1;
  	vertical-align: top
}

input[type=range] {
	vertical-align: middle;
}

.delayed {
    opacity: 0;
}

/* hovertip v2.0 - Start */
.hoverTip {
	display: inline-block;
	top: 4px;
	border-width: 0px;
    border-bottom: 2px dotted white;  /* If you want dots under the hoverable text */
}
.hoverTipTxt {
	position: relative;
	vertical-align: text-bottom;
	line-height: initial;
}
.hoverTipTxt .hoverBox {
	position: absolute;
	visibility: hidden;
}
.hoverTipTxt:hover .hoverBox, .hoverTipTxt:focus .hoverBox {
	visibility: visible;
}
.hoverBox {
	padding: 3px 10px;
	width: intrinsic;  /* Safari/WebKit uses a non-standard name */
	width: -webkit-max-content;  /* Chrome */
	width: -moz-max-content;  /* Firefox/Gecko */
	width: max-content;
	max-width: 330px;
	line-height: initial;
	text-align: left;
	color: white;
	background-color: black;
	border: #7f7f7f solid 2px;
	-webkit-border-radius: 6px;
	   -moz-border-radius: 6px;
	        border-radius: 6px;
	-webkit-box-shadow: 0px 0px 12px 2px rgba(0, 0, 0, 0.75);
	   -moz-box-shadow: 0px 0px 12px 2px rgba(0, 0, 0, 0.75);
	        box-shadow: 0px 0px 12px 2px rgba(0, 0, 0, 0.75);
	z-index: 100;
}
.hoverTail::after {
	content: "";
	position: absolute;
	top: 100%;  /* At the bottom of the tooltip */
	left: 50%;
	margin-left: -5px;
	border-width: 8px;
	border-style: solid;
	border-color: #7f7f7f transparent transparent transparent;
	z-index: 100;
}
.hoverBox a {
	-webkit-transition-duration: unset;
	   -moz-transition-duration: unset;
	     -o-transition-duration: unset;
	        transition-duration: unset;
}
#ui-bar .hoverBox {
	max-width: 240px;
}
/* hovertip v2.0 - End */



</style><script role="script" id="twine-user-script" type="text/twine-javascript">setup.Path = "";  // Running in a browser
setup.ImagePath = setup.Path + "Images/";
setup.SoundPath = setup.Path + "Sounds/";

Config.history.maxStates = 10;

Macro.add('PrnTxt', {
	tags: null,
	handler: function () {
		if (this.args.length === 2) {
			$(this.output).wiki(this.args[0] + ' <img src="Images/Character/' + this.args[1] + '"> ' + this.payload[0].contents);
		} else {
			return this.error('PrnTxt needs two arguments passed to it');
		}
	}
});

Macro.add('WeaponImage', {
	tags: null,
	handler: function () {
		if (this.args.length === 2) {
			$(this.output).wiki(' <img src="Images/Weapons/' + this.args[0] + '.jpg" ' + 'width=' + this.args[1] + ' > ');
		} else {
			return this.error('WeaponImage needs two arguments passed to it');
		}
	}
});

Macro.add('ArmorImage', {
	tags: null,
	handler: function () {
		if (this.args.length === 2) {
			$(this.output).wiki(' <img src="Images/Armor/' + this.args[0] + '.jpg" ' + 'width=' + this.args[1] + ' > ');
		} else {
			return this.error('ArmorImage needs two arguments passed to it');
		}
	}
});

Macro.add('ItemImage', {
	tags: null,
	handler: function () {
		if (this.args.length === 2) {
			$(this.output).wiki(' <img src="Images/Items/' + this.args[0] + '.jpg" ' + 'width=' + this.args[1] + ' > ');
		} else {
			return this.error('ItemImage needs two arguments passed to it');
		}
	}
});

Macro.add('AbilityImage', {
	tags: null,
	handler: function () {
		if (this.args.length === 2) {
			$(this.output).wiki(' <img src="Images/Abilities/' + this.args[0] + '.jpg" ' + 'width=' + this.args[1] + ' > ');
		} else {
			return this.error('AbilityImage needs two arguments passed to it');
		}
	}
});

Macro.add('EnemyImage', {
	tags: null,
	handler: function () {
		if (this.args.length === 3) {
			$(this.output).wiki(' <img src="Images/' + this.args[0] + '/' + this.args[1] + '.jpg" ' + 'width=' + this.args[2] + ' > ');
		} else {
			return this.error('EnemyImage needs three arguments passed to it');
		}
	}
});

Macro.add('EnemyAbility', {
	tags: null,
	handler: function () {
		if (this.args.length === 1) {
			$(this.output).wiki('<<' + this.args[0] + '>>');
		} else {
			return this.error('EnemyAbility needs one argument passed to it, and that argument needs to be the name of an enemy abilty widget');
		}
	}
});

Macro.add('AllyAbility', {
	tags: null,
	handler: function () {
		if (this.args.length === 1) {
			$(this.output).wiki('<<' + this.args[0] + '>>');
		} else {
			return this.error('AllyAbility needs one argument passed to it, and that argument needs to be the name of an ally abilty widget');
		}
	}
});

Macro.add('EnemyAbilityImage', {
	tags: null,
	handler: function () {
		if (this.args.length === 2) {
			$(this.output).wiki(' <img src="Images/EnemyAbilities/' + this.args[0] + '.jpg" ' + 'width=' + this.args[1] + ' > ');
		} else {
			return this.error('EnemyAbilityImage needs two arguments passed to it');
		}
	}
});

Macro.add('AllyAbilityImage', {
	tags: null,
	handler: function () {
		if (this.args.length === 2) {
			$(this.output).wiki(' <img src="Images/AllyAbilities/' + this.args[0] + '.jpg" ' + 'width=' + this.args[1] + ' > ');
		} else {
			return this.error('AllyAbilityImage needs two arguments passed to it');
		}
	}
});

Macro.add('Ability', {
	tags: null,
	handler: function () {
		if (this.args.length === 1) {
			$(this.output).wiki('<<' + this.args[0] + '>>');
		} else {
			return this.error('Ability needs one argument passed to it, and that argument needs to be the name of an abilty widget');
		}
	}
});

Macro.add('ItemAbility', {
	tags: null,
	handler: function () {
		if (this.args.length === 1) {
			$(this.output).wiki('<<' + this.args[0] + '>>');
		} else {
			return this.error('ItemAbility needs one argument passed to it, and that argument needs to be the name of an item abilty widget');
		}
	}
});

Macro.add('AbilityImagex', {
	tags: null,
	handler: function () {
		if (this.args.length === 2) {
			$(this.output).wiki(' <img src="Images/Abilities/' + this.args[0] + '.jpg" ' + 'width=' + this.args[1] + ' > ');
		} else {
			return this.error('AbilityImagex needs two arguments passed to it');
		}
	}
});


(function () {
	// Set initial values.
	var options = {
		current  : 50,  // Default volume level.
		rangeMax : 100,
		step	 : 1,
		setting  : true
	};
	Setting.load();
	if (options.setting && settings.volume) {
		options.current = parseInt(settings.volume);
	}
	var vol = {
		last: options.current,
		start: (options.current / options.rangeMax).toFixed(2)
	};

	// Function to update the volume level.
	function setVolume (val) {
		if (typeof val !== 'number') val = Number(val);
		if (Number.isNaN(val) || val < 0) val = 0;
		if (val > 1) val = 1;
		options.current = Math.round(val * options.rangeMax);
		if (options.setting) {
			settings.volume = options.current;
			Setting.save();
		}
		if ($('input[name=volume]').val() != options.current) {
			$('input[name=volume]').val(options.current);
		}
		try {
			if (SimpleAudio) {
				if (typeof SimpleAudio.volume === 'function') {
					SimpleAudio.volume(val);
				} else {
					SimpleAudio.volume = val;
				}
				return val;
			} else {
				throw new Error('Cannot access audio API.');
			}
		} catch (err) {
			// Fall back to the wikifier if we have to.
			console.error(err.message, err);
			$.wiki('<<masteraudio volume ' + val + '>>');
			return val;
		}
	}

	// Fix the initial volume level display.
	postdisplay['volume-task'] = function (taskName) {
		delete postdisplay[taskName];
		setVolume(vol.start);
	};

	// Grab volume level changes from the volume slider.
	$(document).on('input', 'input[name=volume]', function() {
		var change = parseInt($('input[name=volume]').val());
		setVolume(change / options.rangeMax);
		vol.last = change;
	});

	// Create the <<volume>> macro.
	Macro.add('volume', {
		handler : function () {
			var wrapper = $(document.createElement('span'));
			var slider = $(document.createElement('input'));
			var className = 'macro-' + this.name;
			slider.attr({
				id		: 'volume-control',
				type	: 'range',
				name	: 'volume',
				min		: '0',
				max		: options.rangeMax,
				step	: options.step,
				value	: options.current
			});
			// Class '.macro-volume' and ID '#volume-control' for styling the slider
			wrapper.append(slider).addClass(className).appendTo(this.output);
		}
	});

	// Add Setting API integration for SugarCube 2.26 and higher.
	function updateVolume () {
		setVolume(settings.volume / options.rangeMax);
	}
	if (options.setting) {
		if (Setting && Setting.addRange && typeof Setting.addRange === 'function') {
			Setting.addRange('volume', {
				label : 'Volume: ',
				min : 0,
				max : options.rangeMax,
				step : options.step,
				default : options.current,
				onInit : updateVolume,
				onChange : updateVolume
			});
		} else {
			console.error('This version of SugarCube does not include the `Settings.addRange()` method; please try updating to the latest version of SugarCube.');
		}
	}
}());

/* Delayed Text code - Start */
$(document).on(':passagerender', function (ev) {
	// Find all elements containing the delayed class.
	var elems = $(ev.content).find('.delayed');
	// Appearance delay (in milliseconds) between each delayed text block.
	var delay = 1000; // 1 second fade-in
	if (elems.length > 0) {
		elems.each(function (i) {
			$(this)
				.delay(delay * (i + 1))
				.fadeTo(delay, 1);
		});
	}
});
/* Delayed Text code - End */



/* hovertip v2.0 - Start */
window.UpdateHoverTipTxt = function (container) {
	if (Engine.isIdle()) {
		clearInterval(HTTIntervalID);
		if (container === undefined) {
			container = $(document);
		} else {
			container = $(container);
		}
		var i, id, top, left, parent, elementList, element, hoverPos, boxPos, zindex;
		elementList = container.find('span[id^="hoverTipTxt"]');
		for (i = 0; i < elementList.length; i++) {
			element = $(elementList[i]);
			id = elementList[i].id.substring(11);
			/* Find parent hoverTip item on the page. */
			parent = $(container).find("#hoverTip" + (id));
			/* Position bottom of hoverTipTxt just above the parent. */
			top = Math.round(-element.outerHeight() - 6);
			/* Center hoverTipTxt horizontally over parent. */
			left = Math.round((parent.outerWidth() - element.outerWidth()) / 2);
			/* See if the hoverTip is contained by something with a higher z-index. */
			zindex = element.css("z-index");
			if (zindex === "auto") {
				zindex = 0;
			} else {
				zindex = parseInt(zindex, 10);
			}
			while (parent.parent()[0] !== document) {
				if ((parent.parent().css("z-index") !== "auto") && (parseInt(parent.parent().css("z-index"), 10) > zindex)) {
					/* Get container rect. */
					boxPos = parent[0].getBoundingClientRect();
					break;
				}
				parent = parent.parent();
			}
			/* Update position. */
			element.css({ top: top, left: left });
			hoverPos = element[0].getBoundingClientRect();
			/* Make sure the text isn't outside the bottom of the screen. */
			if (hoverPos.top > window.innerHeight - hoverPos.height - 10) {
				top -= hoverPos.top - (window.innerHeight - hoverPos.height - 10);
			}
			/* Make sure the text isn't outside the top of the screen. */
			if (hoverPos.top < 4) {
				top -= hoverPos.top - 4;
			}
			/* Make sure the text isn't outside the right of the screen. */
			if (hoverPos.left > window.innerWidth - hoverPos.width - 26) {
				left -= hoverPos.left - (window.innerWidth - hoverPos.width - 26);
			}
			/* Make sure the text isn't outside the left of the screen. */
			if (hoverPos.left < 4) {
				left -= hoverPos.left - 4;
			}
			/* Update position. */
			element.css({ top: Math.round(top), left: Math.round(left) });
			hoverPos = element[0].getBoundingClientRect();
			if (boxPos) {  /* Fit within dialog boxes and the like. */
				/* Make sure the text isn't outside the bottom of the box. */
				if (hoverPos.top > boxPos.bottom - hoverPos.height - 10) {
					top -= hoverPos.top - (boxPos.bottom - hoverPos.height - 10);
				}
				/* Make sure the text isn't outside the top of the box. */
				if (hoverPos.top < boxPos.top + 4) {
					top -= hoverPos.top - (boxPos.top + 4);
				}
				/* Make sure the text isn't outside the right of the box. */
				if (hoverPos.left > boxPos.right - hoverPos.width - 26) {
					left -= hoverPos.left - (boxPos.right - hoverPos.width - 26);
				}
				/* Make sure the text isn't outside the left of the box. */
				if (hoverPos.left < boxPos.left + 4) {
					left -= hoverPos.left - boxPos.left - 4;
				}
				/* Update position. */
				element.css({ top: Math.round(top), left: Math.round(left) });
			}
		}
	} else {
		clearInterval(HTTIntervalID);
		HTTIntervalID = setInterval(UpdateHoverTipTxt, 300);
	}
};
/*  Waits for passage to be fully rendered before doing anything.  */
var HTTIntervalID = 0;
$(document).on(":passageend", function (ev) {
	UpdateHoverTipTxt();
});
$(window).on("resize scroll", function (ev) {
	clearInterval(HTTIntervalID);
	HTTIntervalID = setInterval(UpdateHoverTipTxt, 300);
});
$("#ui-bar-toggle").on("click", function (ev) {
	clearInterval(HTTIntervalID);
	HTTIntervalID = setInterval(UpdateHoverTipTxt, 300);
});
/* <<hovertip>> macro */
Macro.add("hovertip", {
	tags	 : null,
	handler  : function () {
		if (this.args.length > 0) {
			var mw = "";
			if ((this.args.length > 1) && (!isNaN(parseInt(this.args[1], 10)))) {
				mw = ' style="max-width: ' + parseInt(this.args[1], 10) + 'px;"';
			}
			if (State.temporary.HoverTipCount == undefined) {
				State.temporary.HoverTipCount = 1;
			} else {
				State.temporary.HoverTipCount++;
			}
			while ($("#hoverTip" + State.temporary.HoverTipCount).length) {
				/* Found an existing hoverTip. */
				State.temporary.HoverTipCount++;
			}
			var output = '<span id="hoverTip' + State.temporary.HoverTipCount +
					'" class="hoverTipTxt hoverTip" tabindex="0" ' +
					'onmouseenter="UpdateHoverTipTxt();">' +
					this.payload[0].contents + '<span id="hoverTipTxt' +
					State.temporary.HoverTipCount + '" class="hoverBox hoverTail"' +
					mw + '>' + this.args[0] + '</span></span>';
			$(this.output).wiki(output);
		} else {
			$(this.output).wiki(this.payload[0].contents);
		}
	}
});
/* hovertip v2.0 - End */

/* Keyboard links v1.2 - Start */
var KBIntervalID = 0;
$(document).on(":passagerender", function (ev) {
	clearInterval(KBIntervalID);
	UpdateLinks(ev.content);
	// Search passages for links every 300ms, just in case they get updated, and marks them for key clicks
	KBIntervalID = setInterval(UpdateLinks, 300);
});
// Adds key shortcut indicators to links in passage if there are less than 11 links in the passsage.
function UpdateLinks(Container) {
	// Enables keyboard shortcuts on passages that do not have the "DisableKeyLinks" tag
	if (!tags().includes("DisableKeyLinks")) {
		var Links, i;
		if (typeof Container === "undefined") {
			Container = document;
			Links = $("#passages a").toArray();
		} else {
			Links = $(Container).find("a").toArray();
		}
		if (Links.length > 0) {
			for (i = Links.length - 1; i >= 0; i--) {
				if ($(Links[i]).data("nokeys") || $(Links[i]).parent().data("nokeys")) {
					Links.deleteAt(i);
				}
			}
		}
		if (Links.length === 1) {
			if (!Links[0].id.includes("Link")) {
				Links[0].id = "NextLink";
			}
		} else if (Links.length >= 1 && Links.length <= 50) {
			var n = 1;
			for (i = 0; i < Links.length; i++) {
				if (!Links[i].id.includes("Link")) {
					while ($(Container).find("#Link" + n).length) {
						++n;
						if (n > 10) {
							break;
						}
					}
					if (n < 10) {
						$("<sup>[" + n + "]</sup>").appendTo(Links[i]);
						Links[i].id = "Link" + n;
					} else if (n === 10) {
						$("<sup>[0]</sup>").appendTo(Links[i]);
						Links[i].id = "Link0";
						break;
					} else {
						break;
					}
				}
			}
		}
	}
}
$(document).on("keyup", function (e) {
	// Enables keyboard shortcuts on passages that do not have the "DisableKeyLinks" tag
	if (!tags().includes("DisableKeyLinks") && ($("input:focus").length === 0)) {
		// Trigger next link click on right arrow key or "1" (normal and numpad)
		if (((e.key == "ArrowRight") || (e.key == "1") || (e.keyCode === 97)) && ($("#NextLink").length > 0)) {
			if (!(tags().includes("IgnoreArrowKeys") && (e.key == "ArrowRight"))) {
				e.preventDefault();
				$("#NextLink").click();
				return false;
			}
		} else {
			// Trigger link click on keys "0" through "9"
			if ((e.keyCode > 47) && (e.keyCode < 58)) {
				if ($("#Link" + (e.keyCode - 48)).length) {
					e.preventDefault();
					$("#Link" + (e.keyCode - 48)).click();
					return false;
				}
			}
			// Trigger link click on numpad keys "0" through "9"
			if ((e.keyCode > 95) && (e.keyCode < 106)) {
				if ($("#Link" + (e.keyCode - 96)).length) {
					e.preventDefault();
					$("#Link" + (e.keyCode - 96)).click();
					return false;
				}
			}
		}
		// Trigger random click on "." or "r" key
		if ((e.key == ".") || (e.key == "r")) {
			e.preventDefault();
			var Links = $("#passages a"), n, UsableLinks = [];
			if (Links.length > 0) {
				for (n = 0; n < Links.length; n++) {
					if (!$(Links[n]).data("nokey")) {
						UsableLinks.push(n);
					}
				}
				if (UsableLinks.length > 0) {
					n = random(UsableLinks.length - 1);
					Links[UsableLinks[n]].click();
					return false;
				}
			}
		}
		// Trigger back click on left arrow key or backquote
		if ((e.key == "ArrowLeft") || (e.key == "`")) {
			if ((!tags().includes("IgnoreArrowKeys")) || (e.key != "ArrowLeft")) {
				e.preventDefault();
				Engine.backward();
				return false;
			}
		}
	}
});
/* Keyboard links - End */
































</script><tw-tag name="widget" color="gray"></tw-tag><tw-passagedata pid="1" name="Opening and Name" tags="" position="399,169" size="100,100">&lt;&lt;set $name = &quot;unknown&quot;&gt;&gt;\
\
Welcome to &lt;b&gt;&lt;i&gt;Battle Quest&lt;/i&gt;&lt;/b&gt;!

&lt;img src=&quot;Images/Locations/title1.jpg&quot; width=800 /&gt;

To begin, first select your hero&#39;s name and gender, then click &#39;Continue.&#39;

&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;textbox &quot;$name&quot; &quot;Roland&quot;&gt;&gt; &lt;&lt;textbox &quot;$title&quot; &quot;the Bold&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;textbox &quot;$name&quot; &quot;Anora&quot;&gt;&gt; &lt;&lt;textbox &quot;$title&quot; &quot;the Pure&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;table class=&quot;small-table&quot;&gt;\
&lt;tr&gt;\
&lt;th colspan=&quot;2&quot;&gt;Selected Gender: &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;span class=&quot;male&quot;&gt;$gender&lt;/span&gt;&lt;&lt;else&gt;&gt;&lt;span class=&quot;female&quot;&gt;$gender&lt;/span&gt;&lt;&lt;/if&gt;&gt; &lt;/th&gt;
&lt;/tr&gt;\
&lt;tr&gt;\
&lt;td&gt; &lt;&lt;if $gender eq &quot;female&quot;&gt;&gt;[[Male-&gt;Opening and Name][$gender = &quot;male&quot;]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Male&lt;/span&gt;&lt;&lt;/if&gt;&gt;&lt;/td&gt;
&lt;td&gt; &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;[[Female-&gt;Opening and Name][$gender = &quot;female&quot;]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Female&lt;/span&gt;&lt;&lt;/if&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;\

[[Continue-&gt;Lewd Mode]]

&lt;&lt;if $p eq 0&gt;&gt;
&lt;&lt;audio &quot;main_bgm&quot; volume 0.5 play loop&gt;&gt;

&lt;&lt;set $maxhealth = 100&gt;&gt;\

&lt;&lt;set $intro = 1&gt;&gt;\
&lt;&lt;set $verystart = 0&gt;&gt;
\
&lt;&lt;set $head = &quot;nothing&quot;&gt;&gt;\
&lt;&lt;set $chest = &quot;simple shirt&quot;&gt;&gt;\
&lt;&lt;set $hands = &quot;nothing&quot;&gt;&gt;\
&lt;&lt;set $legs = &quot;simple pants&quot;&gt;&gt;\
&lt;&lt;set $feet = &quot;simple shoes&quot;&gt;&gt;\
\
&lt;&lt;set $weapon = &quot;nothing&quot;&gt;&gt;\
\
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $daynumber = 1&gt;&gt;\
\
\
&lt;&lt;set $head = $nohelm[&quot;name&quot;]&gt;&gt;\
&lt;&lt;set $headstrength = $nohelm[&quot;strength&quot;]&gt;&gt;\
&lt;&lt;set $headagility = $nohelm[&quot;agility&quot;]&gt;&gt;\
&lt;&lt;set $headwillpower = $nohelm[&quot;willpower&quot;]&gt;&gt;\
&lt;&lt;set $headarmor = $nohelm[&quot;armor&quot;]&gt;&gt;\
\
&lt;&lt;set $chest = $simpleshirt[&quot;name&quot;]&gt;&gt;\
&lt;&lt;set $cheststrength = $simpleshirt[&quot;strength&quot;]&gt;&gt;\
&lt;&lt;set $chestagility = $simpleshirt[&quot;agility&quot;]&gt;&gt;\
&lt;&lt;set $chestwillpower = $simpleshirt[&quot;willpower&quot;]&gt;&gt;\
&lt;&lt;set $chestarmor = $simpleshirt[&quot;armor&quot;]&gt;&gt;\
\
&lt;&lt;set $hands = $nogloves[&quot;name&quot;]&gt;&gt;\
&lt;&lt;set $handstrength = $nogloves[&quot;strength&quot;]&gt;&gt;\
&lt;&lt;set $handsagility = $nogloves[&quot;agility&quot;]&gt;&gt;\
&lt;&lt;set $handswillpower = $nogloves[&quot;willpower&quot;]&gt;&gt;\
&lt;&lt;set $handsarmor = $nogloves[&quot;armor&quot;]&gt;&gt;\
\
&lt;&lt;set $legs = $simplepants[&quot;name&quot;]&gt;&gt;\
&lt;&lt;set $legsstrength = $simplepants[&quot;strength&quot;]&gt;&gt;\
&lt;&lt;set $legsagility = $simplepants[&quot;agility&quot;]&gt;&gt;\
&lt;&lt;set $legswillpower = $simplepants[&quot;willpower&quot;]&gt;&gt;\
&lt;&lt;set $legsarmor = $simplepants[&quot;armor&quot;]&gt;&gt;\
\
&lt;&lt;set $feet = $simpleshoes[&quot;name&quot;]&gt;&gt;\
&lt;&lt;set $feetstrength = $simpleshoes[&quot;strength&quot;]&gt;&gt;\
&lt;&lt;set $feetagility = $simpleshoes[&quot;agility&quot;]&gt;&gt;\
&lt;&lt;set $feetwillpower = $simpleshoes[&quot;willpower&quot;]&gt;&gt;\
&lt;&lt;set $feetarmor = $simpleshoes[&quot;armor&quot;]&gt;&gt;\
\
&lt;&lt;set $weapon = $noweapon[&quot;name&quot;]&gt;&gt;\
&lt;&lt;set $weaponstrength = $noweapon[&quot;strength&quot;]&gt;&gt;\
&lt;&lt;set $weaponagility = $noweapon[&quot;agility&quot;]&gt;&gt;\
&lt;&lt;set $weaponwillpower = $noweapon[&quot;willpower&quot;]&gt;&gt;\
&lt;&lt;set $weaponarmor = $noweapon[&quot;armor&quot;]&gt;&gt;\
&lt;&lt;set $mindamage = $noweapon[&quot;mindamage&quot;]&gt;&gt;\
&lt;&lt;set $maxdamage = $noweapon[&quot;maxdamage&quot;]&gt;&gt;\
\
&lt;&lt;set $weaponinventory.push($noweapon)&gt;&gt;\
&lt;&lt;set $weaponinventory.push($rustydagger)&gt;&gt;\
\
&lt;&lt;set $headinventory.push($nohelm)&gt;&gt;\
&lt;&lt;set $chestinventory.push($simpleshirt)&gt;&gt;\
&lt;&lt;set $handsinventory.push($nogloves)&gt;&gt;\
&lt;&lt;set $legsinventory.push($simplepants)&gt;&gt;\
&lt;&lt;set $feetinventory.push($simpleshoes)&gt;&gt;\
\
&lt;&lt;set $iteminventory.push($minorhealthpotion)&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $p = 1&gt;&gt;\</tw-passagedata><tw-passagedata pid="2" name="Class Select" tags="" position="401,294" size="100,100">Now you must choose one of three Classes. What kind of hero are you?

&lt;b&gt;The Paladin&lt;/b&gt;
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;img src=&quot;Images/Character/paladin1.jpg&quot; width=350 /&gt;&lt;&lt;elseif $lewdmode eq 0&gt;&gt;&lt;img src=&quot;Images/Character/paladin3.jpg&quot; width=350 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Character/paladin5.jpg&quot; width=350 /&gt;&lt;&lt;/if&gt;&gt;
A holy warrior, the paladin can make use of a strong will, healing abilities, and divine protection to overcome evil.

&lt;b&gt;Playstyle&lt;/b&gt;: Never back down. The paladin has a variety of ways to survive even the most devastating of attacks, allowing &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;him&lt;&lt;else&gt;&gt;her&lt;&lt;/if&gt;&gt; to outlast &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;his&lt;&lt;else&gt;&gt;her&lt;&lt;/if&gt;&gt; foes.

&lt;b&gt;Difficulty&lt;/b&gt;: Easy. You have multiple ways to stay alive and ignore your enemy&#39;s armor. Stay vigilant with you mana, you will outlast and overcome any foe.

[[Choose the Paladin-&gt;Intro][$class = &quot;paladin&quot;]]

&lt;b&gt;The Soldier&lt;/b&gt;
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;img src=&quot;Images/Character/soldier1.jpg&quot; width=350 /&gt;&lt;&lt;elseif $lewdmode eq 0&gt;&gt;&lt;img src=&quot;Images/Character/soldier3.jpg&quot; width=350 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Character/soldier5.jpg&quot; width=350 /&gt;&lt;&lt;/if&gt;&gt;
A veteran of countless campaigns, the soldier focused on overpowering strength at the cost of health and defense to best &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;his&lt;&lt;else&gt;&gt;her&lt;&lt;/if&gt;&gt; foes.

&lt;b&gt;Playstyle&lt;/b&gt;: High risk, high reward. The soldier generates mana by giving and taking damage, and &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;his&lt;&lt;else&gt;&gt;her&lt;&lt;/if&gt;&gt; abilities can become more powerful when &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;he&lt;&lt;else&gt;&gt;she&lt;&lt;/if&gt;&gt; is nearer to death.

&lt;b&gt;Difficulty&lt;/b&gt;: Medium. Victory will require you to keep your health low - but not too low - to maximize your abilities. Health is a resource - spend it wisely, and you will dominate the battlefield.

[[Choose the Soldier-&gt;Intro][$class = &quot;soldier&quot;]]

&lt;b&gt;The Rogue&lt;/b&gt;
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;img src=&quot;Images/Character/rogue1.jpg&quot; width=350 /&gt;&lt;&lt;elseif $lewdmode eq 0&gt;&gt;&lt;img src=&quot;Images/Character/rogue3.jpg&quot; width=350 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Character/rogue5.jpg&quot; width=350 /&gt;&lt;&lt;/if&gt;&gt;
Nimble and cunning, the rogue relies on speed to dodge &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;his&lt;&lt;else&gt;&gt;her&lt;&lt;/if&gt;&gt; enemies&#39; attacks and respond with lethal blows.

&lt;b&gt;Playstyle&lt;/b&gt;: Careful planning, deadly execution. The rogue can build up Combat Points during a battle, which are then spent on using &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;his&lt;&lt;else&gt;&gt;her&lt;&lt;/if&gt;&gt; most deadly finishing moves.

&lt;b&gt;Difficulty&lt;/b&gt;: Hard. Armor will stifle many of your abilities. You cannot rely on dodging every attack. To succeed, you  will need to master balancing your Combat Points, your damage potential, and your survivability. Every point of experience, and every gear slot, must be carefully considered.

[[Choose the Rogue-&gt;Intro][$class = &quot;rogue&quot;]]
\
\
&lt;&lt;if $gender eq &quot;female&quot;&gt;&gt;\
&lt;&lt;set $head = $nohelmf[&quot;name&quot;]&gt;&gt;\
&lt;&lt;set $headstrength = $nohelmf[&quot;strength&quot;]&gt;&gt;\
&lt;&lt;set $headagility = $nohelmf[&quot;agility&quot;]&gt;&gt;\
&lt;&lt;set $headwillpower = $nohelmf[&quot;willpower&quot;]&gt;&gt;\
&lt;&lt;set $headarmor = $nohelmf[&quot;armor&quot;]&gt;&gt;\
&lt;&lt;set $headinventory = []&gt;&gt;
&lt;&lt;set $headinventory.push($nohelmf)&gt;&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="3" name="Intro" tags="" position="401,415" size="100,100">It has been a week since you left the safety of the City. Since then, you have traveled deep through farmland and countryside on a quest handed to you by the King - to investigate a mysterious, encroaching evil rising in Deep Woods.
&lt;img src=&quot;Images/Locations/kingdom1.jpg&quot; width=600 /&gt;

You will not return to civilization until this threat is uncovered and destroyed. Slowly, the countryside becomes less and less populated. On the last day, you see no one at all. It is just you, a clouded sky, and the empty road. 
&lt;img src=&quot;Images/Locations/woods1.jpg&quot; width=600 &gt;

At last, you arrive at your home for the duration of your quest: an old wooden cabin, on the outskirts of the woods. It is no lavish estate, but it will serve as a useful base of operations. If you get a fire going, you might even push back the clawing chill of the woodland.
&lt;img src=&quot;Images/Locations/cabin1.jpg&quot; width=600 /&gt;

From here, you will go on daily excursions into the unmapped wilds. You may be here for a while. Might as well get comfortable.

[[Enter the cabin-&gt;Cabin]]
\
\
&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt;\
&lt;&lt;set $basestrength += 4&gt;&gt;\
&lt;&lt;set $basewillpower += 2&gt;&gt;\
&lt;&lt;set $baseagility += 0&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;\
&lt;&lt;set $basestrength += 2&gt;&gt;\
&lt;&lt;set $basewillpower += 6&gt;&gt;\
&lt;&lt;set $baseagility -= 2&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt;\
&lt;&lt;set $basestrength += 0&gt;&gt;\
&lt;&lt;set $basewillpower -= 2&gt;&gt;\
&lt;&lt;set $baseagility += 8&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;set $currentmana = $maxmana&gt;&gt;\
\
&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt; &lt;&lt;set $abilityinventory.push($holylight)&gt;&gt; &lt;&lt;set $abilityinventory.push($smite)&gt;&gt;&lt;&lt;/if&gt;&gt; \
&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt; &lt;&lt;set $abilityinventory.push($bloodrage, $burningstrike)&gt;&gt; &lt;&lt;/if&gt;&gt; \
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt; &lt;&lt;set $abilityinventory.push($shadowstrike)&gt;&gt;&lt;&lt;set $abilityinventory.push($surestrike)&gt;&gt; &lt;&lt;/if&gt;&gt; \
\
&lt;&lt;set $abilitytotal = 2&gt;&gt;\
&lt;&lt;set $abilitymax = 7&gt;&gt;\
&lt;&lt;set $potioncount = 0&gt;&gt;\
\
&lt;&lt;if $title eq &quot;the Quick&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Quick&#39; recognized!
The Heirloom Blade has been added to your inventory!&lt;/i&gt;
\
&lt;&lt;set $weaponinventory.push($coolsword)&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Lucky&quot;&gt;&gt;
&lt;i&gt;Special title &#39;the Lucky&#39; recognized!
500 gold has been added to your inventory!&lt;/i&gt;
\
&lt;&lt;set $gold += 500&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Thief&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Thief&#39; recognized!
Leather armor, gloves, and pants have been added to your inventory!&lt;/i&gt;
\
&lt;&lt;set $handsinventory.push($leathergloves)&gt;&gt;\
&lt;&lt;set $chestinventory.push($leathertunic)&gt;&gt;\
&lt;&lt;set $legsinventory.push($leatherpants)&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Scholar&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Scholar&#39; recognized!
You gain 500 exp!&lt;/i&gt;
\
&lt;&lt;set $exp += 500&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Hero of Hadamshal&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Hero of Hadamshal&#39; recognized!
You gain 5 strength, 5 agility, and 5 willpower!&lt;/i&gt;
\
&lt;&lt;set $basestrength += 5&gt;&gt;\
&lt;&lt;set $baseagility += 5&gt;&gt;\
&lt;&lt;set $basewillpower += 5&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Silverblooded&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Silverblooded&#39; recognized!
You gain 20 base armor!&lt;/i&gt;
\
&lt;&lt;set $basearmor += 20&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Hedge Knight&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Hedge Knight&#39; recognized!
You gain a full set of iron armor and an iron sword!&lt;/i&gt;
\
&lt;&lt;set $headinventory.push($ironhelm)&gt;&gt;\
&lt;&lt;set $handsinventory.push($irongloves)&gt;&gt;\
&lt;&lt;set $chestinventory.push($irontunic)&gt;&gt;\
&lt;&lt;set $legsinventory.push($ironpants)&gt;&gt;\
&lt;&lt;set $feetinventory.push($ironboots)&gt;&gt;\
&lt;&lt;set $weaponinventory.push($ironsword)&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Crusader&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Crusader&#39; recognized! Deus Vult!
You gain a full set of blessed armor and a holy weapon!&lt;/i&gt;
\
&lt;&lt;set $headinventory.push($blessedhelm)&gt;&gt;\
&lt;&lt;set $handsinventory.push($blessedgloves)&gt;&gt;\
&lt;&lt;set $chestinventory.push($blessedtunic)&gt;&gt;\
&lt;&lt;set $legsinventory.push($blessedpants)&gt;&gt;\
&lt;&lt;set $feetinventory.push($blessedboots)&gt;&gt;\
&lt;&lt;set $weaponinventory.push($holywarhammer)&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Insane&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Insane&#39; recognized!
You have 25 strength, 25 agility, and 1 willpower! Good luck!&lt;/i&gt;
\
&lt;&lt;set $basestrength = 25&gt;&gt;\
&lt;&lt;set $baseagility = 25&gt;&gt;\
&lt;&lt;set $basewillpower = 1&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Arcane Preserver&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Arcane Preserver&#39; recognized! 
You gain the Arcane Scythe and Cloak of Zyr!&lt;/i&gt;
\
&lt;&lt;set $chestinventory.push($cloakofzyr)&gt;&gt;\
&lt;&lt;set $weaponinventory.push($arcanescythe)&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Bloodborne&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Bloodborne&#39; recognized! 
You gain the legendary weapon, Karhan&#39;s Rebuke!&lt;/i&gt;
\
&lt;&lt;set $weaponinventory.push($karhansrebuke)&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Shadowsong&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Shadowsong&#39; recognized! 
You gain the legendary weapons, Silence and Fury!&lt;/i&gt;
\
&lt;&lt;set $weaponinventory.push($silenceandfury)&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Lightbringer&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Lightbringer&#39; recognized! 
You gain the legendary weapon, Faith&#39;s Promise!&lt;/i&gt;
\
&lt;&lt;set $weaponinventory.push($faithspromise)&gt;&gt;\
\
&lt;&lt;elseif $title eq &quot;the Dragoon&quot;&gt;&gt;\
\
&lt;i&gt;Special title &#39;the Dragoon&#39; recognized! 
You gain a full set of dragon hunting gear!&lt;/i&gt;
\
&lt;&lt;set $handsinventory.push($dragongauntlets)&gt;&gt;\
&lt;&lt;set $chestinventory.push($dragonarmor)&gt;&gt;\
&lt;&lt;set $weaponinventory.push($dragonaxe)&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
\</tw-passagedata><tw-passagedata pid="4" name="Cabin" tags="" position="400,543" size="100,100">You are in your cabin.&lt;&lt;if $time eq &quot;Night&quot;&gt;&gt; It is night. But for your roaring hearthfire, the world is cold and dark. &lt;img src=&quot;Images/Locations/cabin2.jpg&quot; width=600 /&gt;&lt;&lt;else&gt;&gt; It is daytime. With the sun out, the time has come to venture forth into the Deep Woods. &lt;img src=&quot;Images/Locations/cabin3.jpg&quot; width=600 /&gt;
 &lt;&lt;/if&gt;&gt;

&lt;table class=&quot;stat-table&quot;&gt;\
	&lt;tr&gt;\
		&lt;th&gt;Cabin Areas&lt;/th&gt;\
		&lt;th&gt;Actions&lt;/th&gt;\
	&lt;/tr&gt;\
	&lt;tr&gt;\
		&lt;td&gt;\
		[[Access your Armory-&gt;Armory]]
		[[Access your Weapon Vault-&gt;Weapon Vault]]
		[[Access your Item Chest-&gt;Item Chest]]
		[[Access your Library-&gt;Library]]
		&lt;&lt;if $lewdmode eq 1&gt;&gt;[[Look into your mirror-&gt;Mirror]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
		&lt;td&gt;\
		&lt;&lt;if $time eq &quot;Night&quot;&gt;&gt;&lt;i&gt;It&#39;s too late to go outside&lt;/i&gt;&lt;&lt;else&gt;&gt;[[Go outside-&gt;Outside the Cabin]]&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;i&gt;It&#39;s too early to go to bed&lt;/i&gt;&lt;&lt;else&gt;&gt;[[Go to bed-&gt;Sleep]]&lt;&lt;/if&gt;&gt;
		&lt;&lt;if ($lewdmode eq 1) and ($merchantlove eq 18) and ($time neq &quot;Night&quot;)&gt;&gt;&lt;i&gt;It&#39;s too early to bring Babar to your cabin&lt;/i&gt;
		&lt;&lt;elseif ($lewdmode eq 1) and ($merchantlove eq 18)&gt;&gt;[[Invite Babar into your cabin-&gt;Merchant Lewd][$p = 33]] 
		&lt;&lt;elseif ($lewdmode eq 1) and ($merchantlove gte 30) and ($pleasured eq 1)&gt;&gt;&lt;i&gt;You&#39;re not feeling horny&lt;/i&gt;
		&lt;&lt;elseif ($lewdmode eq 1) and ($merchantlove gte 30) and ($pleasured eq 0)&gt;&gt;[[Invite Babar into your cabin-&gt;Merchant Lewd][$p = 72]]
		&lt;&lt;elseif ($lewdmode eq 1) and ($nayalove eq 23) and ($pleasured eq 1)&gt;&gt;&lt;i&gt;You&#39;re not feeling horny&lt;/i&gt;
		&lt;&lt;elseif ($lewdmode eq 1) and ($nayalove eq 23) and ($pleasured eq 0)&gt;&gt;[[Invite Naya into your cabin-&gt;Naya Lewd][$p = 47]]
		&lt;&lt;elseif ($lewdmode eq 1) and ($witchlove gte 22) and ($pleasured eq 1)&gt;&gt;&lt;i&gt;You&#39;re not feeling horny&lt;/i&gt;
		&lt;&lt;elseif ($lewdmode eq 1) and ($witchlove gte 22) and ($pleasured eq 0)&gt;&gt;[[Invite Scyllia into your cabin-&gt;Witch Lewd][$p = 53]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
	&lt;/tr&gt;\
&lt;/table&gt;\
\
&lt;&lt;set $a = 0&gt;&gt;\
&lt;&lt;set $b = 0&gt;&gt;\
&lt;&lt;set $c = 0&gt;&gt;\
&lt;&lt;set $d = 0&gt;&gt;\
&lt;&lt;set $e = 0&gt;&gt;\
&lt;&lt;set $f = 0&gt;&gt;\
&lt;&lt;set $i = 0&gt;&gt;\
&lt;&lt;set $p = 0&gt;&gt;\

</tw-passagedata><tw-passagedata pid="5" name="StoryCaption" tags="" position="202,172" size="100,100">By Lobsterman9999
v 1.02

&lt;&lt;if $verystart eq 1&gt;&gt;&lt;&lt;else&gt;&gt;\
&lt;b&gt;Name&lt;/b&gt;: $name $title
&lt;&lt;if $weapon eq &quot;Whip of Dark Desire&quot;&gt;&gt;&lt;img src=&quot;Images/Other/demon4.jpg&quot; width=200 /&gt;&lt;&lt;elseif $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt; &lt;img src=&quot;Images/Character/paladin2.jpg&quot; width=200 /&gt; &lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt; &lt;img src=&quot;Images/Character/soldier2.jpg&quot; width=200 /&gt; &lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt; &lt;img src=&quot;Images/Character/rogue2.jpg&quot; width=200 /&gt;&lt;&lt;elseif $class eq &quot;merchant&quot;&gt;&gt; &lt;img src=&quot;Images/Character/merchant2.jpg&quot; width=200 /&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;if $class eq &quot;paladin&quot; and ($lewdmode eq 0)&gt;&gt; &lt;img src=&quot;Images/Character/paladin4.jpg&quot; width=200 /&gt;&lt;&lt;elseif ($class eq &quot;paladin&quot;) and ($lewdmode eq 1)&gt;&gt; &lt;img src=&quot;Images/Character/paladin6.jpg&quot; width=200 /&gt; &lt;&lt;elseif ($class eq &quot;soldier&quot;) and ($lewdmode eq 0)&gt;&gt; &lt;img src=&quot;Images/Character/soldier4.jpg&quot; width=200 /&gt;&lt;&lt;elseif ($class eq &quot;soldier&quot;) and ($lewdmode eq 1)&gt;&gt; &lt;img src=&quot;Images/Character/soldier6.jpg&quot; width=200 /&gt; &lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($lewdmode eq 0)&gt;&gt; &lt;img src=&quot;Images/Character/rogue4.jpg&quot; width=200 /&gt;&lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($lewdmode eq 1)&gt;&gt; &lt;img src=&quot;Images/Character/rogue6.jpg&quot; width=200 /&gt;&lt;&lt;elseif $class eq &quot;merchant&quot;&gt;&gt; &lt;img src=&quot;Images/Character/merchant2.jpg&quot; width=200 /&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;b&gt;Class&lt;/b&gt;: &lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;b&gt;Paladin&lt;/b&gt;&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;&lt;b&gt;Soldier&lt;/b&gt;&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;b&gt;Rogue&lt;/b&gt;&lt;&lt;elseif $class eq &quot;merchant&quot;&gt;&gt;&lt;b&gt;Merchant&lt;/b&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;nobr&gt;&gt;&lt;table class=&quot;stat-table&quot;&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:50%&quot;&gt;&lt;b&gt;Health&lt;/b&gt;&lt;/td&gt;
			&lt;td&gt;$currenthealth / $maxhealth&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td colspan=&quot;2&quot; style=&quot;vertical-align:center&quot;&gt;&lt;&lt;HealthBar&gt;&gt;&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:50%&quot;&gt;&lt;b&gt;Mana&lt;/b&gt;&lt;/td&gt;
			&lt;td&gt;$currentmana / $maxmana&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td colspan=&quot;2&quot; style=&quot;vertical-align:center&quot;&gt;&lt;&lt;ManaBar&gt;&gt;&lt;/td&gt;
		&lt;/tr&gt;
&lt;/table&gt;&lt;&lt;/nobr&gt;&gt;

&lt;table class=&quot;stat-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Stats&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;&lt;b&gt;Strength&lt;/b&gt;&lt;/td&gt;
			&lt;td&gt;$strength&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;&lt;b&gt;Agility&lt;/b&gt;&lt;/td&gt;
			&lt;td&gt;$agility&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;&lt;b&gt;Willpower&lt;/b&gt;&lt;/td&gt;
			&lt;td&gt;$willpower&lt;/td&gt;
		&lt;/tr&gt;
&lt;/table&gt;

&lt;table class=&quot;stat-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Equipment&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;&lt;b&gt;Head&lt;/b&gt;&lt;/td&gt;
			&lt;td&gt;$head&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;&lt;b&gt;Chest&lt;/b&gt;&lt;/td&gt;
			&lt;td&gt;$chest&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;&lt;b&gt;Hands&lt;/b&gt;&lt;/td&gt;
			&lt;td&gt;$hands&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;&lt;b&gt;Legs&lt;/b&gt;&lt;/td&gt;
			&lt;td&gt;$legs&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;&lt;b&gt;Feet&lt;/b&gt;&lt;/td&gt;
			&lt;td&gt;$feet&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;&lt;b&gt;Total Armor&lt;/b&gt;&lt;/td&gt;
			&lt;td&gt;$armor&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;\
	
&lt;b&gt;Weapon&lt;/b&gt;: $weapon

&lt;b&gt;Day&lt;/b&gt; $daynumber, $time

&lt;b&gt;Gold Pieces&lt;/b&gt;: $gold
&lt;b&gt;Experience&lt;/b&gt;: $exp

Volume: &lt;&lt;volume&gt;&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="6" name="StoryInit" tags="" position="205,279" size="100,100">MUSIC

&lt;&lt;set _bgm = setup.SoundPath + &quot;MainTheme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;main_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;BabarTheme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;babar_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Battle1Theme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;battle1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Battle2Theme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;battle2_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Battle3Theme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;battle3_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Battle4Theme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;battle4_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Battle5Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;battle5_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Battle6Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;battle6_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Battle7Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;battle7_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Battle8Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;battle8_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Battle9Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;battle9_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;FinalBattleTheme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;final1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Epilogue1Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;epilogue1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;DragonBattle1Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;dragon1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Dark1Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;dark1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Deathguard1Theme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;deathguard1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Frozen1Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;frozen1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Palace1Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;palace1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Victory1Theme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;victory1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;CabinDayTheme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;cabinday_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;CabinNightTheme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;cabinnight_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;ShrineTheme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;shrine_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;MerchantTheme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;merchant_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Naya1Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;naya1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;OutskirtsTheme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;outskirts_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;GoblinCaveTheme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;goblincave_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Redeemer1Theme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;redeemer1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Redeemer2Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;redeemer2_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Tower1Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;tower1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Vale1Theme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;vale1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Witch1Theme.mp4&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;witch1_bgm&quot; _bgm&gt;&gt;

&lt;&lt;set _bgm = setup.SoundPath + &quot;Romance1Theme.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;romance1_bgm&quot; _bgm&gt;&gt;

HELMS

&lt;&lt;set $ironhelm to {&quot;name&quot;: &quot;Iron Helm&quot;, &quot;strength&quot;: 1, &quot;agility&quot;: -1, &quot;willpower&quot;: 1, &quot;armor&quot;: 2, &quot;price&quot;: 100, &quot;sellprice&quot;: 25, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;An iron helmet - makes a ringing noise when struck.&quot;}&gt;&gt;

&lt;&lt;set $blessedhelm to {&quot;name&quot;: &quot;Blessed Helm&quot;,&quot;strength&quot;: -2, &quot;agility&quot;: 0, &quot;willpower&quot;: 4, &quot;armor&quot;: 2, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: &quot;Heal1&quot;, &quot;description&quot;: &quot;A fine helmet often worn by the followers of Iulius - the Paladins. Restores 2 health per turn.&quot;}&gt;&gt;

&lt;&lt;set $gladiatorhelm to {&quot;name&quot;: &quot;Gladiator Helm&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 4, &quot;willpower&quot;: 2, &quot;armor&quot;: -3, &quot;price&quot;: 500, &quot;sellprice&quot;: 125, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: &quot;Bloodlust&quot;, &quot;description&quot;: &quot;A helm used in the gladiator arenas of the far south. Once per battle, if your health falls below 33%, you gain 10 strength.&quot;}&gt;&gt;

&lt;&lt;set $mithrilhelm to {&quot;name&quot;: &quot;Mithril Helm&quot;, &quot;strength&quot;: 4, &quot;agility&quot;: 4, &quot;willpower&quot;: 4, &quot;armor&quot;: 4, &quot;price&quot;: 750, &quot;sellprice&quot;: 175, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A fine helmet made of mithril - light, yet hard as dragonscales.&quot;}&gt;&gt;

&lt;&lt;set $voidhelm to {&quot;name&quot;: &quot;Void Helm&quot;, &quot;strength&quot;: 4, &quot;agility&quot;: 5, &quot;willpower&quot;: 7, &quot;armor&quot;: 5, &quot;price&quot;: 1800, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: &quot;Void1&quot;, &quot;description&quot;: &quot;A magic helmet designed to withstand the Void&#39;s corruption. Restores 2 health and 2 mana per turn.&quot;}&gt;&gt;

&lt;&lt;set $helmofthechampion to {&quot;name&quot;: &quot;Helm of the Champion&quot;, &quot;strength&quot;: 7, &quot;agility&quot;: 3, &quot;willpower&quot;: 7, &quot;armor&quot;: 6, &quot;price&quot;: 1100, &quot;sellprice&quot;: 275, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: &quot;Champion1&quot;, &quot;description&quot;: &quot;A helm once worn by Zabil Ogho, a champion of the Great Occident. Grants 1 strength and 4 health each turn in combat.&quot;}&gt;&gt;

&lt;&lt;set $deathsvisage to {&quot;name&quot;: &quot;Death&#39;s Visage&quot;, &quot;strength&quot;: 20, &quot;agility&quot;: 12, &quot;willpower&quot;: 5, &quot;armor&quot;: 5, &quot;price&quot;: 1500, &quot;sellprice&quot;: 300, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: &quot;Death1&quot;, &quot;description&quot;: &quot;The helm of the vicious Deathguard captain, Domitus. Has a chance to hurt your enemy for 25 damage each turn, and a small chance to hurt you.&quot;}&gt;&gt;

&lt;&lt;set $maskoftheguardian to {&quot;name&quot;: &quot;Mask of the Guardian&quot;, &quot;strength&quot;: 1, &quot;agility&quot;: 2, &quot;willpower&quot;: 3, &quot;armor&quot;: 4, &quot;price&quot;: 1000, &quot;sellprice&quot;: 250, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: &quot;Spring1&quot;, &quot;description&quot;: &quot;This mask is enchanted with the power of the four seasons. Restores 3 health and 3 mana each turn.&quot;}&gt;&gt;

&lt;&lt;set $assassinshood to {&quot;name&quot;: &quot;Assassin&#39;s Hood&quot;, &quot;strength&quot;: 2, &quot;agility&quot;: 8, &quot;willpower&quot;: -3, &quot;armor&quot;: 1, &quot;price&quot;: 600, &quot;sellprice&quot;: 175, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: &quot;AgilityGain1&quot;, &quot;description&quot;: &quot;This hood bestows the wearer with uncanny grace and blinding speed. Grants 1 agility each turn in combat.&quot;}&gt;&gt;

&lt;&lt;set $amuletofvitality to {&quot;name&quot;: &quot;Amulet of Vitality&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 5, &quot;armor&quot;: 0, &quot;price&quot;: 200, &quot;sellprice&quot;: 50, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A blue gem glows from the center of this amulet, suggesting mystic enchantment.&quot;}&gt;&gt;

&lt;&lt;set $amuletofbrutality to {&quot;name&quot;: &quot;Amulet of Brutality&quot;, &quot;strength&quot;: 15, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 750, &quot;sellprice&quot;: 175, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A red gem glows from the center of this amulet, burning with bloodlust.&quot;}&gt;&gt;

&lt;&lt;set $amuletofspeed to {&quot;name&quot;: &quot;Amulet of Speed&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 5, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 200, &quot;sellprice&quot;: 50, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A green gem glows from the center of this amulet, suggesting mystic enchantment.&quot;}&gt;&gt;

&lt;&lt;set $amuletofheroes to {&quot;name&quot;: &quot;Amulet of Heroes&quot;, &quot;strength&quot;: 3, &quot;agility&quot;: 3, &quot;willpower&quot;: 3, &quot;armor&quot;: 0, &quot;price&quot;: 300, &quot;sellprice&quot;: 75, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A diamond shines from the center of this golden amulet. In ages past, these amulets were gifted to aspiring heroes.&quot;}&gt;&gt;

&lt;&lt;set $royalamulet to {&quot;name&quot;: &quot;Royal Amulet&quot;, &quot;strength&quot;: 1, &quot;agility&quot;: 1, &quot;willpower&quot;: 1, &quot;armor&quot;: 0, &quot;price&quot;: 1000, &quot;sellprice&quot;: 250, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: &quot;Royal1&quot;, &quot;description&quot;: &quot;A powerful amulet, blessed by the king himself and given to his most trusted agents. Adds 1 strength, 1 agility, and 1 willpower every turn.&quot;}&gt;&gt;

&lt;&lt;set $hoodofthetrickster to {&quot;name&quot;: &quot;Hood of the Trickster&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 18, &quot;willpower&quot;: 8, &quot;armor&quot;: 6, &quot;price&quot;: 2000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: &quot;Trickster&quot;, &quot;description&quot;: &quot;A legendary hood once worn by the God Sathael. Grants 1 agility per turn. Successful attacks steal 5 mana and 5 health from your enemy. Wearing the full set grants Rogues an additional bonus.&quot;}&gt;&gt;

&lt;&lt;set $helmofthelightbringer to {&quot;name&quot;: &quot;Helm of the Lightbringer&quot;, &quot;strength&quot;: 10, &quot;agility&quot;: 8, &quot;willpower&quot;: 16, &quot;armor&quot;: 12, &quot;price&quot;: 2000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: &quot;Lightbringer&quot;, &quot;description&quot;: &quot;A legendary helmet once worn by the God Iulius. Grants 4 health and 4 mana per turn. Successful attacks grant 1 willpower. Wearing the full set grants Paladins an additional bonus.&quot;}&gt;&gt;

&lt;&lt;set $skullamulet to {&quot;name&quot;: &quot;Skull Amulet&quot;, &quot;strength&quot;: 30, &quot;agility&quot;: 30, &quot;willpower&quot;: -30, &quot;armor&quot;: 0, &quot;price&quot;: 2000, &quot;sellprice&quot;: 300, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;An incredibly powerful amulet that feasts on the soul of its wearer. Do you dare to live dangerously?&quot;}&gt;&gt;

&lt;&lt;set $lovelychoker to {&quot;name&quot;: &quot;Lovely Choker&quot;, &quot;strength&quot;: 3, &quot;agility&quot;: 3, &quot;willpower&quot;: 3, &quot;armor&quot;: 3, &quot;price&quot;: 450, &quot;sellprice&quot;: 125, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: &quot;Naughty2&quot;, &quot;description&quot;: &quot;This choker builds its power from the lust you have for Babar Ogho. Grants 4 gold and 4 exp per turn.&quot;}&gt;&gt;

&lt;&lt;set $nohelm to {&quot;name&quot;: &quot;No Helm&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 0, &quot;sellprice&quot;: 0, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Keeping your head unguarded is good for visibility, but not so good for protection.&quot;}&gt;&gt;

&lt;&lt;set $nohelmf to {&quot;name&quot;: &quot;Helmetless&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 0, &quot;sellprice&quot;: 0, &quot;class&quot;: &quot;head&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Keeping your head unguarded is good for visibility, but not so good for protection.&quot;}&gt;&gt;


CHEST

&lt;&lt;set $irontunic to {&quot;name&quot;: &quot;Iron Tunic&quot;,&quot;strength&quot;: 1, &quot;agility&quot;: -1, &quot;willpower&quot;: 1, &quot;armor&quot;: 4, &quot;price&quot;: 200, &quot;sellprice&quot;: 50, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;This spotted iron tunic has seen battle. Hopefully you do better than its last owner.&quot;}&gt;&gt;

&lt;&lt;set $steeltunic to {&quot;name&quot;: &quot;Steel Tunic&quot;,&quot;strength&quot;: 2, &quot;agility&quot;: -3, &quot;willpower&quot;: 3, &quot;armor&quot;: 5, &quot;price&quot;: 450, &quot;sellprice&quot;: 125, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;This steel armor is well-crafted and offers much protection to the warrior who wears it.&quot;}&gt;&gt;

&lt;&lt;set $mithrilarmor to {&quot;name&quot;: &quot;Mithril Armor&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 5, &quot;willpower&quot;: 5, &quot;armor&quot;: 6, &quot;price&quot;: 750, &quot;sellprice&quot;: 175, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Fine chainmail armor made of mithril - light, yet hard as dragonscales.&quot;}&gt;&gt;

&lt;&lt;set $voidarmor to {&quot;name&quot;: &quot;Void Armor&quot;, &quot;strength&quot;: 6, &quot;agility&quot;: 6, &quot;willpower&quot;: 8, &quot;armor&quot;: 8, &quot;price&quot;: 1800, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;Void1&quot;, &quot;description&quot;: &quot;Magic armor designed to withstand the Void&#39;s corruption. Restores 2 health and 2 mana per turn.&quot;}&gt;&gt;

&lt;&lt;set $assassinsarmor to {&quot;name&quot;: &quot;Assassin&#39;s Armor&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 15, &quot;willpower&quot;: -5, &quot;armor&quot;: 6, &quot;price&quot;: 1100, &quot;sellprice&quot;: 225, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;AgilityGain1&quot;, &quot;description&quot;: &quot;This armor bestows the wearer with uncanny grace and blinding speed. Grants 1 agility each turn in combat.&quot;}&gt;&gt;

&lt;&lt;set $gladiatorarmor to {&quot;name&quot;: &quot;Gladiator Armor&quot;, &quot;strength&quot;: 12, &quot;agility&quot;: 8, &quot;willpower&quot;: 6, &quot;armor&quot;: -7, &quot;price&quot;: 1100, &quot;sellprice&quot;: 225, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;Bloodlust2&quot;, &quot;description&quot;: &quot;Armor used in the gladiator arenas of the far south. Once per battle, if your health falls below 33%, you gain 12 strength.&quot;}&gt;&gt;

&lt;&lt;set $bloodknightarmor to {&quot;name&quot;: &quot;Bloodknight Armor&quot;, &quot;strength&quot;: 8, &quot;agility&quot;: 4, &quot;willpower&quot;: 8, &quot;armor&quot;: 10, &quot;price&quot;: 1100, &quot;sellprice&quot;: 225, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;Restore1&quot;, &quot;description&quot;: &quot;Magic armor that stores the blood of its wearer. Once per battle, if your health falls below 25%, you gain 400 health. Also restores 3 health per turn.&quot;}&gt;&gt;

&lt;&lt;set $blessedtunic to {&quot;name&quot;: &quot;Blessed Tunic&quot;,&quot;strength&quot;: -2, &quot;agility&quot;: -2, &quot;willpower&quot;: 6, &quot;armor&quot;: 5, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;Heal1&quot;, &quot;description&quot;: &quot;Fine armor often worn by the followers of Iulius - the Paladins. Restores 2 health per turn.&quot;}&gt;&gt;

&lt;&lt;set $cloakofzyr to {&quot;name&quot;: &quot;Cloak of Zyr&quot;, &quot;strength&quot;: -2, &quot;agility&quot;: 7, &quot;willpower&quot;: 7, &quot;armor&quot;: 7, &quot;price&quot;: 850, &quot;sellprice&quot;: 200, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;Mana3&quot;, &quot;description&quot;: &quot;A magical cloak found in the ruins of the Tower of Zyr. Said to contain the power of Zyr, the Arcane Librarian. Restores 6 mana per turn.&quot;}&gt;&gt;

&lt;&lt;set $leathertunic to {&quot;name&quot;: &quot;Leather Tunic&quot;,&quot;strength&quot;: -1, &quot;agility&quot;: 4, &quot;willpower&quot;: 1, &quot;armor&quot;: 2, &quot;price&quot;: 200, &quot;sellprice&quot;: 50, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;This simple leather tunic balances protection and flexibility.&quot;}&gt;&gt;

&lt;&lt;set $blackleathertunic to {&quot;name&quot;: &quot;Black Leather Tunic&quot;,&quot;strength&quot;: -2, &quot;agility&quot;: 4, &quot;willpower&quot;: 2, &quot;armor&quot;: 3, &quot;price&quot;: 450, &quot;sellprice&quot;: 125, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A finely made tunic of supple black leather. Often worn by veteran thieves.&quot;}&gt;&gt;

&lt;&lt;set $armorofthegoblinking to {&quot;name&quot;: &quot;Armor of the Goblin King&quot;, &quot;strength&quot;: 4, &quot;agility&quot;: 1, &quot;willpower&quot;: -3, &quot;armor&quot;: 7, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;This armor was once worn by Gresh, the Goblin King.&quot;}&gt;&gt;

&lt;&lt;set $tortoisearmor to {&quot;name&quot;: &quot;Tortoise Armor&quot;, &quot;strength&quot;: 4, &quot;agility&quot;: -4, &quot;willpower&quot;: 10, &quot;armor&quot;: 14, &quot;price&quot;: 850, &quot;sellprice&quot;: 225, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;Tortoise2&quot;, &quot;description&quot;: &quot;A heavy set of armor known for withstanding powerful blows. Gain 2 armor whenever struck&quot;}&gt;&gt;

&lt;&lt;set $dragonarmor to {&quot;name&quot;: &quot;Dragon Armor&quot;, &quot;strength&quot;: 12, &quot;agility&quot;: -8, &quot;willpower&quot;: 8, &quot;armor&quot;: 12, &quot;price&quot;: 1250, &quot;sellprice&quot;: 350, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;Dragon1&quot;, &quot;description&quot;: &quot;A heavy set of armor forged from the scales of Zarathras, the Envious Flame. Gain 2 strength and 2 willpower whenever struck.&quot;}&gt;&gt;

&lt;&lt;set $dreadknightcuirass to {&quot;name&quot;: &quot;Dreadknight Cuirass&quot;, &quot;strength&quot;: -8, &quot;agility&quot;: 15, &quot;willpower&quot;: 8, &quot;armor&quot;: 12, &quot;price&quot;: 1250, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;Dreadknight1&quot;, &quot;description&quot;: &quot;This ancient set of armor absorbed the souls of those slain by Jhuun, the Void Blade. Gain 15 mana whenever you dodge an attack. Successful attacks have a chance to increase your enemy&#39;s stun limit by 1.&quot;}&gt;&gt;

&lt;&lt;set $armorofthelightbringer to {&quot;name&quot;: &quot;Armor of the Lightbringer&quot;, &quot;strength&quot;: 12, &quot;agility&quot;: 6, &quot;willpower&quot;: 14, &quot;armor&quot;: 14, &quot;price&quot;: 3000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;Lightbringer&quot;, &quot;description&quot;: &quot;Legendary armor once worn by the God Iulius. Grants 4 health and 4 mana per turn. Successful attacks grant 1 willpower. Wearing the full set grants Paladins an additional bonus.&quot;}&gt;&gt;

&lt;&lt;set $armorofthevictorious to {&quot;name&quot;: &quot;Armor of the Victorious&quot;, &quot;strength&quot;: 20, &quot;agility&quot;: 10, &quot;willpower&quot;: 10, &quot;armor&quot;: 10, &quot;price&quot;: 2000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;Victorious&quot;, &quot;description&quot;: &quot;Legendary armor once used by the Goddess Myridia. Grants 1 strength and 1 agility per turn. Successful attacks reduce your enemy&#39;s strength by 1. Wearing the full set grants Soldiers an additional bonus.&quot;}&gt;&gt;

&lt;&lt;set $naughtycorset to {&quot;name&quot;: &quot;Naughty Corset&quot;,&quot;strength&quot;: 2, &quot;agility&quot;: 2, &quot;willpower&quot;: 2, &quot;armor&quot;: 2, &quot;price&quot;: 450, &quot;sellprice&quot;: 125, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: &quot;Naughty1&quot;, &quot;description&quot;: &quot;This naughty corset keeps your breasts exposed at all times - even your enemies will shower you with gold in such a slutty outfit. Grants 2 gold and 2 exp per turn.&quot;}&gt;&gt;

&lt;&lt;set $simpleshirt to {&quot;name&quot;: &quot;Simple Shirt&quot;,&quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 10, &quot;sellprice&quot;: 0, &quot;class&quot;: &quot;chest&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A simple shirt, purchased from an ill-mannered tailor.&quot;}&gt;&gt;

GLOVES

&lt;&lt;set $irongloves to {&quot;name&quot;: &quot;Iron Gloves&quot;,&quot;strength&quot;: 1, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 2, &quot;price&quot;: 100, &quot;sellprice&quot;: 25, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Rough gloves of iron - for protecting one&#39;s fingers from thorn, tooth, and blade.&quot;}&gt;&gt;

&lt;&lt;set $leathergloves to {&quot;name&quot;: &quot;Leather Gloves&quot;,&quot;strength&quot;: -1, &quot;agility&quot;: 2, &quot;willpower&quot;: 1, &quot;armor&quot;: 1, &quot;price&quot;: 125, &quot;sellprice&quot;: 25, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Simple leather gloves - a thief&#39;s best friends.&quot;}&gt;&gt;

&lt;&lt;set $mithrilgauntlets to {&quot;name&quot;: &quot;Mithril Gauntlets&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 5, &quot;willpower&quot;: 4, &quot;armor&quot;: 4, &quot;price&quot;: 750, &quot;sellprice&quot;: 175, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Fine gauntlets made of mithril - light, yet hard as dragonscales.&quot;}&gt;&gt;

&lt;&lt;set $voidgauntlets to {&quot;name&quot;: &quot;Void Gauntlets&quot;, &quot;strength&quot;: 6, &quot;agility&quot;: 6, &quot;willpower&quot;: 6, &quot;armor&quot;: 6, &quot;price&quot;: 1800, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: &quot;Void1&quot;, &quot;description&quot;: &quot;Magic gauntlets designed to withstand the Void&#39;s corruption. Restores 2 health and 2 mana per turn.&quot;}&gt;&gt;

&lt;&lt;set $glovesoftylae to {&quot;name&quot;: &quot;Gloves of Tylae&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 2, &quot;willpower&quot;: 8, &quot;armor&quot;: 8, &quot;price&quot;: 850, &quot;sellprice&quot;: 225, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: &quot;Heal3&quot;, &quot;description&quot;: &quot;A pair of finely crafted gauntlets bestowed with Tylae&#39;s grace. Restores 6 health per turn.&quot;}&gt;&gt;

&lt;&lt;set $blackleathergloves to {&quot;name&quot;: &quot;Black Leather Gloves&quot;,&quot;strength&quot;: -2, &quot;agility&quot;: 3, &quot;willpower&quot;: 2, &quot;armor&quot;: 1, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Finely made gloves of supple black leather. Beware any pickpocket wearing these gloves - he clearly knows what he&#39;s doing.&quot;}&gt;&gt;

&lt;&lt;set $blessedgloves to {&quot;name&quot;: &quot;Blessed Gloves&quot;,&quot;strength&quot;: -1, &quot;agility&quot;: -1, &quot;willpower&quot;: 3, &quot;armor&quot;: 3, &quot;price&quot;: 200, &quot;sellprice&quot;: 50, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: &quot;Heal1&quot;, &quot;description&quot;: &quot;A pair of armored gloves often worn by the followers of Iulius - the Paladins. Restores 2 health per turn.&quot;}&gt;&gt;

&lt;&lt;set $sapphiregloves to {&quot;name&quot;: &quot;Sapphire Gloves&quot;,&quot;strength&quot;: 0, &quot;agility&quot;: 6, &quot;willpower&quot;: 0, &quot;armor&quot;: 6, &quot;price&quot;: 600, &quot;sellprice&quot;: 150, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: &quot;Mana2&quot;, &quot;description&quot;: &quot;These gloves empower the wearer with the speed of rushing water and the strength of winter ice. Restores 4 mana per turn.&quot;}&gt;&gt;

&lt;&lt;set $dragongauntlets to {&quot;name&quot;: &quot;Dragon Gauntlets&quot;, &quot;strength&quot;: 2, &quot;agility&quot;: 7, &quot;willpower&quot;: 4, &quot;armor&quot;: 8, &quot;price&quot;: 1250, &quot;sellprice&quot;: 350, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: &quot;Dragon2&quot;, &quot;description&quot;: &quot;A fine set of gauntlets forged from the scales of Zarathras, the Envious Flame. Each successful attack restores 8 mana and 8 health.&quot;}&gt;&gt;

&lt;&lt;set $skullgauntlets to {&quot;name&quot;: &quot;Skull Gauntlets&quot;, &quot;strength&quot;: 10, &quot;agility&quot;: 2, &quot;willpower&quot;: 2, &quot;armor&quot;: 8, &quot;price&quot;: 1250, &quot;sellprice&quot;: 325, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: &quot;Skull1&quot;, &quot;description&quot;: &quot;Powerful gaunlets forged from the skulls of the fallen. At the start of combat, lose 100 health and gain 100 mana (Soldier only).&quot;}&gt;&gt;

&lt;&lt;set $gauntletsofthevictorious to {&quot;name&quot;: &quot;Gauntlets of the Victorious&quot;, &quot;strength&quot;: 18, &quot;agility&quot;: 8, &quot;willpower&quot;: 10, &quot;armor&quot;: 8, &quot;price&quot;: 3000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: &quot;Victorious&quot;, &quot;description&quot;: &quot;Legendary gauntlets once worn by the Goddess Myridia. Grants 1 strength and 1 agility per turn. Successful attacks reduce your enemy&#39;s strength by 1. Wearing the full set grants Soldiers an additional bonus.&quot;}&gt;&gt;

&lt;&lt;set $gripofthetrickster to {&quot;name&quot;: &quot;Grip of the Trickster&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 15, &quot;willpower&quot;: 10, &quot;armor&quot;: 5, &quot;price&quot;: 2000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: &quot;Trickster&quot;, &quot;description&quot;: &quot;Legendary gloves once worn by the God Sathael. Grants 1 agility per turn. Successful attacks steal 5 mana and 5 health from your enemy. Wearing the full set grants Rogues an additional bonus.&quot;}&gt;&gt;

&lt;&lt;set $naughtygloves to {&quot;name&quot;: &quot;Naughty Gloves&quot;,&quot;strength&quot;: 4, &quot;agility&quot;: 4, &quot;willpower&quot;: 4, &quot;armor&quot;: 4, &quot;price&quot;: 750, &quot;sellprice&quot;: 175, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: &quot;Naughty1&quot;, &quot;description&quot;: &quot;These lace gloves curse their wearer with dirty dreams - even your enemies will shower you with gold in such a slutty outfit. Grants 2 gold and 2 exp per turn.&quot;}&gt;&gt;

&lt;&lt;set $nogloves to {&quot;name&quot;: &quot;No Gloves&quot;,&quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 0, &quot;sellprice&quot;: 0, &quot;class&quot;: &quot;hands&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Callouses mark your bare hands - the telltale signs of a past rich in toil and war.&quot;}&gt;&gt;

LEGS

&lt;&lt;set $ironpants to {&quot;name&quot;: &quot;Iron Pants&quot;,&quot;strength&quot;: 2, &quot;agility&quot;: -1, &quot;willpower&quot;: 0, &quot;armor&quot;: 3, &quot;price&quot;: 200, &quot;sellprice&quot;: 50, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Tough pants of iron chain won&#39;t stop a hardy foe, but will at least blunt the impact.&quot;}&gt;&gt;

&lt;&lt;set $steelpants to {&quot;name&quot;: &quot;Steel Pants&quot;,&quot;strength&quot;: 2, &quot;agility&quot;: -2, &quot;willpower&quot;: 2, &quot;armor&quot;: 4, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Fine leg guards formed of steel. Perfect for deflecting arrows and blades.&quot;}&gt;&gt;

&lt;&lt;set $mithrilpants to {&quot;name&quot;: &quot;Mithril Pants&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 4, &quot;willpower&quot;: 5, &quot;armor&quot;: 5, &quot;price&quot;: 750, &quot;sellprice&quot;: 175, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Fine leg guards made of mithril - light, yet hard as dragonscales.&quot;}&gt;&gt;

&lt;&lt;set $voidgreaves to {&quot;name&quot;: &quot;Void Greaves&quot;, &quot;strength&quot;: 6, &quot;agility&quot;: 6, &quot;willpower&quot;: 8, &quot;armor&quot;: 6, &quot;price&quot;: 1800, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: &quot;Void1&quot;, &quot;description&quot;: &quot;Magic greaves designed to withstand the Void&#39;s corruption. Restores 2 health and 2 mana per turn.&quot;}&gt;&gt;

&lt;&lt;set $goldengreaves to {&quot;name&quot;: &quot;Golden Greaves&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 5, &quot;willpower&quot;: 10, &quot;armor&quot;: 15, &quot;price&quot;: 2000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: &quot;Unshakeable&quot;, &quot;description&quot;: &quot;Magic greaves that golden golems gift to their dearest friends. In combat, you cannot be stunned.&quot;}&gt;&gt;

&lt;&lt;set $shadowpants to {&quot;name&quot;: &quot;Shadow Pants&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 10, &quot;willpower&quot;: 5, &quot;armor&quot;: 3, &quot;price&quot;: 850, &quot;sellprice&quot;: 225, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: &quot;Combat1&quot;, &quot;description&quot;: &quot;These pants are woven with threads made from of distilled shadows. Adds one Combat Point at the start of battle.&quot;}&gt;&gt;

&lt;&lt;set $blessedpants to {&quot;name&quot;: &quot;Blessed Pants&quot;,&quot;strength&quot;: -2, &quot;agility&quot;: -2, &quot;willpower&quot;: 5, &quot;armor&quot;: 4, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: &quot;Heal1&quot;, &quot;description&quot;: &quot;A blessed pair of leg guards often worn by the followers of Iulius - the Paladins. Restores 2 health per turn&quot;}&gt;&gt;

&lt;&lt;set $leatherpants to {&quot;name&quot;: &quot;Leather Pants&quot;,&quot;strength&quot;: -1, &quot;agility&quot;: 3, &quot;willpower&quot;: 1, &quot;armor&quot;: 2, &quot;price&quot;: 200, &quot;sellprice&quot;: 50, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Tough pants of leather that don&#39;t just protect - they look good, too.&quot;}&gt;&gt;

&lt;&lt;set $blackleatherpants to {&quot;name&quot;: &quot;Black Leather Pants&quot;,&quot;strength&quot;: -2, &quot;agility&quot;: 4, &quot;willpower&quot;: 2, &quot;armor&quot;: 2, &quot;price&quot;: 425, &quot;sellprice&quot;: 125, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Everyone looks good in black leather pants.&quot;}&gt;&gt;

&lt;&lt;set $celestialgreaves to {&quot;name&quot;: &quot;Celestial Greaves&quot;,&quot;strength&quot;: 10, &quot;agility&quot;: 0, &quot;willpower&quot;: 10, &quot;armor&quot;: 0, &quot;price&quot;: 675, &quot;sellprice&quot;: 150, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: &quot;Recharge&quot;, &quot;description&quot;: &quot;Magical leg guards enfused with the power and fortitude of Ryz, the Arcane Observer. Once per battle, at the start of the fifth turn, you gain 100 mana.&quot;}&gt;&gt;

&lt;&lt;set $greavesofthedeep to {&quot;name&quot;: &quot;Greaves of the Deep&quot;,&quot;strength&quot;: 15, &quot;agility&quot;: 15, &quot;willpower&quot;: -10, &quot;armor&quot;: 5, &quot;price&quot;: 1000, &quot;sellprice&quot;: 225, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: &quot;Madness1&quot;, &quot;description&quot;: &quot;Ancient, cursed leg guards forged by creatures of the deep. Successful attacks lower your enemy&#39;s strength, agility, and willpower by 1.&quot;}&gt;&gt;

&lt;&lt;set $skullgreaves to {&quot;name&quot;: &quot;Skull Greaves&quot;, &quot;strength&quot;: 16, &quot;agility&quot;: 2, &quot;willpower&quot;: 6, &quot;armor&quot;: 10, &quot;price&quot;: 2000, &quot;sellprice&quot;: 325, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: &quot;Skull1&quot;, &quot;description&quot;: &quot;Powerful greaves forged from the skulls of the fallen. At the start of combat, lose 100 health and gain 100 mana (Soldier only).&quot;}&gt;&gt;

&lt;&lt;set $greavesofthelightbringer to {&quot;name&quot;: &quot;Greaves of the Lightbringer&quot;, &quot;strength&quot;: 10, &quot;agility&quot;: 8, &quot;willpower&quot;: 14, &quot;armor&quot;: 14, &quot;price&quot;: 2000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: &quot;Lightbringer&quot;, &quot;description&quot;: &quot;Legendary greaves once worn by the God Iulius. Grants 4 health and 4 mana per turn. Successful attacks grant 1 willpower. Wearing the full set grants Paladins an additional bonus.&quot;}&gt;&gt;

&lt;&lt;set $naughtygarter to {&quot;name&quot;: &quot;Naughty Stockings and Garter&quot;,&quot;strength&quot;: 2, &quot;agility&quot;: 3, &quot;willpower&quot;: 3, &quot;armor&quot;: 2, &quot;price&quot;: 450, &quot;sellprice&quot;: 125, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: &quot;Naughty1&quot;, &quot;description&quot;: &quot;This naughty bit of lingerie will keep your legs on display at all times - even your enemies will shower you with gold in such a slutty outfit. Grants 2 gold and 2 exp per turn.&quot;}&gt;&gt;

&lt;&lt;set $simplepants to {&quot;name&quot;: &quot;Simple Pants&quot;,&quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 10, &quot;sellprice&quot;: 0, &quot;class&quot;: &quot;legs&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A simple pair of pants, patched at the knees.&quot;}&gt;&gt;

BOOTS

&lt;&lt;set $ironboots to {&quot;name&quot;: &quot;Iron Boots&quot;,&quot;strength&quot;: 1, &quot;agility&quot;: -1, &quot;willpower&quot;: 1, &quot;armor&quot;: 2, &quot;price&quot;: 150, &quot;sellprice&quot;: 25, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A little bit heavy, but at least they keep your feet well-guarded.&quot;}&gt;&gt;

&lt;&lt;set $steelboots to {&quot;name&quot;: &quot;Steel Boots&quot;,&quot;strength&quot;: 3, &quot;agility&quot;: -2, &quot;willpower&quot;: 2, &quot;armor&quot;: 3, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Solid boots of steel to keep your feet well-protected.&quot;}&gt;&gt;

&lt;&lt;set $mithrilboots to {&quot;name&quot;: &quot;Mithril Boots&quot;, &quot;strength&quot;: 4, &quot;agility&quot;: 4, &quot;willpower&quot;: 5, &quot;armor&quot;: 4, &quot;price&quot;: 750, &quot;sellprice&quot;: 175, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Fine boots made of mithril - light, yet hard as dragonscales.&quot;}&gt;&gt;

&lt;&lt;set $voidboots to {&quot;name&quot;: &quot;Void Boots&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 5, &quot;willpower&quot;: 7, &quot;armor&quot;: 6, &quot;price&quot;: 1800, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: &quot;Void1&quot;, &quot;description&quot;: &quot;Magic greaves designed to withstand the Void&#39;s corruption. Restores 2 health and 2 mana per turn.&quot;}&gt;&gt;

&lt;&lt;set $serpentboots to {&quot;name&quot;: &quot;Serpent Boots&quot;, &quot;strength&quot;: 3, &quot;agility&quot;: 7, &quot;willpower&quot;: 7, &quot;armor&quot;: 5, &quot;price&quot;: 1800, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: &quot;Serpent1&quot;, &quot;description&quot;: &quot;Fine boots empowered by the Serpents of the Deep. Successful attacks grant 1 strength, agility, or willpower, and reduce your enemy&#39;s strength, agility, or willpower by 1.&quot;}&gt;&gt;

&lt;&lt;set $blessedboots to {&quot;name&quot;: &quot;Blessed Boots&quot;,&quot;strength&quot;: 0, &quot;agility&quot;: -2, &quot;willpower&quot;: 3, &quot;armor&quot;: 3, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: &quot;Heal1&quot;, &quot;description&quot;: &quot;A blessed pair of boots often worn by the followers of Iulius - the Paladins. Restores 2 health per turn.&quot;}&gt;&gt;

&lt;&lt;set $tortoiseboots to {&quot;name&quot;: &quot;Tortoise Boots&quot;, &quot;strength&quot;: 2, &quot;agility&quot;: -3, &quot;willpower&quot;: 7, &quot;armor&quot;: 9, &quot;price&quot;: 800, &quot;sellprice&quot;: 200, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: &quot;Tortoise1&quot;, &quot;description&quot;: &quot;A heavy set of boots known for withstanding powerful blows. Gain 1 armor whenever struck.&quot;}&gt;&gt;

&lt;&lt;set $wingedboots to {&quot;name&quot;: &quot;Winged Boots&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 8, &quot;willpower&quot;: 5, &quot;armor&quot;: 5, &quot;price&quot;: 850, &quot;sellprice&quot;: 225, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: &quot;Wing1&quot;, &quot;description&quot;: &quot;Winged boots that allow the wearer to leap great distances. Adds 20 evade score at the start of battle.&quot;}&gt;&gt;

&lt;&lt;set $dancersboots to {&quot;name&quot;: &quot;Dancer&#39;s Boots&quot;, &quot;strength&quot;: 3, &quot;agility&quot;: 11, &quot;willpower&quot;: 5, &quot;armor&quot;: 4, &quot;price&quot;: 1100, &quot;sellprice&quot;: 275, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: &quot;Combat2&quot;, &quot;description&quot;: &quot;The enchanted boots of an accomplished dancer. Adds 1 Combat Point at the start of battle. The &#39;Riposte&#39; ability increases your evade score by 10 (Rogue only).&quot;}&gt;&gt;

&lt;&lt;set $bootsofshadow to {&quot;name&quot;: &quot;Boots of Shadow&quot;,&quot;strength&quot;: -2, &quot;agility&quot;: 8, &quot;willpower&quot;: 0, &quot;armor&quot;: -2, &quot;price&quot;: 300, &quot;sellprice&quot;: 125, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;These enchanted boots are empowered by the shadows themselves.&quot;}&gt;&gt;

&lt;&lt;set $bootsofthetrickster to {&quot;name&quot;: &quot;Boots of the Trickster&quot;, &quot;strength&quot;: 3, &quot;agility&quot;: 20, &quot;willpower&quot;: 8, &quot;armor&quot;: 6, &quot;price&quot;: 3000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: &quot;Trickster&quot;, &quot;description&quot;: &quot;Legendary boots once worn by the God Sathael. Grants 1 agility per turn. Successful attacks steal 5 mana and 5 health from your enemy. Wearing the full set grants Rogues an additional bonus.&quot;}&gt;&gt;

&lt;&lt;set $bootsofthevictorious to {&quot;name&quot;: &quot;Boots of the Victorious&quot;, &quot;strength&quot;: 16, &quot;agility&quot;: 10, &quot;willpower&quot;: 8, &quot;armor&quot;: 10, &quot;price&quot;: 2000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: &quot;Victorious&quot;, &quot;description&quot;: &quot;Legendary boots once worn by the Goddess Myridia. Grants 1 strength and 1 agility per turn. Successful attacks reduce your enemy&#39;s strength by 1. Wearing the full set grants Soldiers an additional bonus.&quot;}&gt;&gt;

&lt;&lt;set $naughtystilettos to {&quot;name&quot;: &quot;Naughty Stilettos&quot;,&quot;strength&quot;: 4, &quot;agility&quot;: 4, &quot;willpower&quot;: 4, &quot;armor&quot;: 4, &quot;price&quot;: 750, &quot;sellprice&quot;: 175, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: &quot;Naughty1&quot;, &quot;description&quot;: &quot;These naughty stilettos curse their wearer to always want to show off her ass - even your enemies will shower you with gold in such a slutty outfit. Grants 2 gold and 2 exp per turn.&quot;}&gt;&gt;

&lt;&lt;set $simpleshoes to {&quot;name&quot;: &quot;Simple Shoes&quot;,&quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 10, &quot;sellprice&quot;: 0, &quot;class&quot;: &quot;feet&quot;, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A simple pair of shoes. The laces are frayed, but the fit is good.&quot;}&gt;&gt;

WEAPONS

&lt;&lt;set $currentweapon to {&quot;name&quot;: &quot;Current Weapon&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 0, &quot;sellprice&quot;: 0, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 1, &quot;maxdamage&quot;: 2, &quot;ability&quot;: 0, &quot;description&quot;: &quot;This is the blank weapon template. This description should not be seen.&quot;}&gt;&gt;

&lt;&lt;set $rustydagger to {&quot;name&quot;: &quot;Rusty Dagger&quot;, &quot;strength&quot;: 1, &quot;agility&quot;: 1, &quot;willpower&quot;: 1, &quot;armor&quot;: 0, &quot;price&quot;: 50, &quot;sellprice&quot;: 25, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 8, &quot;maxdamage&quot;: 16, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A rusty dagger. Better than nothing.&quot;}&gt;&gt;

&lt;&lt;set $ironsword to {&quot;name&quot;: &quot;Iron Sword&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 1, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 200, &quot;sellprice&quot;: 50, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 11, &quot;maxdamage&quot;: 18, &quot;ability&quot;: 0, &quot;description&quot;: &quot;An iron sword. A bit dull and rusted, but it will get the job done.&quot;}&gt;&gt;

&lt;&lt;set $steelsword to {&quot;name&quot;: &quot;Steel Sword&quot;, &quot;strength&quot;: 8, &quot;agility&quot;: 2, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 18, &quot;maxdamage&quot;: 26, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A steel sword. The archtypical weapon of a rising hero.&quot;}&gt;&gt;

&lt;&lt;set $coolsword to {&quot;name&quot;: &quot;Heirloom Blade&quot;, &quot;strength&quot;: 4, &quot;agility&quot;: 4, &quot;willpower&quot;: 4, &quot;armor&quot;: 4, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 15, &quot;maxdamage&quot;: 25, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A fine blade given to you by your father on his deathbed.&quot;}&gt;&gt;

&lt;&lt;set $steelswordandshield to {&quot;name&quot;: &quot;Steel Sword and Shield&quot;, &quot;strength&quot;: 7, &quot;agility&quot;: 0, &quot;willpower&quot;: 2, &quot;armor&quot;: 4, &quot;price&quot;: 450, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 20, &quot;maxdamage&quot;: 24, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A steel sword and shield. Offense and defense in perfect balance.&quot;}&gt;&gt;

&lt;&lt;set $steelgreatsword to {&quot;name&quot;: &quot;Steel Greatsword&quot;, &quot;strength&quot;: 12, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 22, &quot;maxdamage&quot;: 30, &quot;ability&quot;: &quot;StrengthGain1&quot;, &quot;description&quot;: &quot;A steel greatsword. For those who love to hack and slash. Successful attacks grant 1 strength.&quot;}&gt;&gt;

&lt;&lt;set $mithrilsword to {&quot;name&quot;: &quot;Mithril Sword&quot;, &quot;strength&quot;: 10, &quot;agility&quot;: 10, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 750, &quot;sellprice&quot;: 175, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 25, &quot;maxdamage&quot;: 35, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A fine sword made of mithril - light, yet hard as dragonscales.&quot;}&gt;&gt;

&lt;&lt;set $blackdagger to {&quot;name&quot;: &quot;Black Dagger&quot;, &quot;strength&quot;: 3, &quot;agility&quot;: 4, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 200, &quot;sellprice&quot;: 50, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 14, &quot;maxdamage&quot;: 15, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A sharp black dagger. Good for stabbing.&quot;}&gt;&gt;

&lt;&lt;set $ghostblade to {&quot;name&quot;: &quot;Ghostblade&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 15, &quot;willpower&quot;: -4, &quot;armor&quot;: 0, &quot;price&quot;: 600, &quot;sellprice&quot;: 150, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 20, &quot;maxdamage&quot;: 40, &quot;ability&quot;: &quot;GhostBlade&quot;, &quot;description&quot;: &quot;A thin, shimmering blade forged in the world beyond. Once per battle, if you start your turn with 3 combat points, gain 2 combat points (Rogue only).&quot;}&gt;&gt;

&lt;&lt;set $elvendaggers to {&quot;name&quot;: &quot;Elven Daggers&quot;, &quot;strength&quot;: 4, &quot;agility&quot;: 12, &quot;willpower&quot;: 4, &quot;armor&quot;: 0, &quot;price&quot;: 900, &quot;sellprice&quot;: 225, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 28, &quot;maxdamage&quot;: 34, &quot;ability&quot;: &quot;AgilityGain1&quot;, &quot;description&quot;: &quot;A pair of finely crafted and deadly elven daggers, found in the ruins of Hadamshal. Adds 1 agility per turn.&quot;}&gt;&gt;

&lt;&lt;set $ravenblade to {&quot;name&quot;: &quot;Ravenblade&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 18, &quot;willpower&quot;: 5, &quot;armor&quot;: 5, &quot;price&quot;: 1200, &quot;sellprice&quot;: 300, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 40, &quot;maxdamage&quot;: 46, &quot;ability&quot;: &quot;Ravenblade&quot;, &quot;description&quot;: &quot;The elegant blade of Count Barsenes. Successful attacks have a chance of generating 1 Combat Point (Rogue only).&quot;}&gt;&gt;

&lt;&lt;set $cyclonerapier to {&quot;name&quot;: &quot;Cyclone Rapier&quot;, &quot;strength&quot;: -5, &quot;agility&quot;: 30, &quot;willpower&quot;: 5, &quot;armor&quot;: 0, &quot;price&quot;: 2000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 50, &quot;maxdamage&quot;: 55, &quot;ability&quot;: &quot;Cyclone&quot;, &quot;description&quot;: &quot;This elegant blade commands the winds. Grants 1 Combat Point at the start of combat. Successful attacks grant 1 agility and reduce your enemy&#39;s agility by 1.&quot;}&gt;&gt;

&lt;&lt;set $silenceandfury to {&quot;name&quot;: &quot;Silence and Fury&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 25, &quot;willpower&quot;: 5, &quot;armor&quot;: 5, &quot;price&quot;: 1500, &quot;sellprice&quot;: 350, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 60, &quot;maxdamage&quot;: 75, &quot;ability&quot;: &quot;Silence1&quot;, &quot;description&quot;: &quot;The dagger and shortsword of Fen&#39;dir, the fabled Netheryn assassin. Successful attacks break 8 armor. Whenever you dodge an enemy attack you gain a Combat Point (Rogue only).&quot;}&gt;&gt;

&lt;&lt;set $ironmace to {&quot;name&quot;: &quot;Iron Mace&quot;, &quot;strength&quot;: 3, &quot;agility&quot;: -1, &quot;willpower&quot;: 4, &quot;armor&quot;: 1, &quot;price&quot;: 200, &quot;sellprice&quot;: 50, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 12, &quot;maxdamage&quot;: 16, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A heavy iron mace. A blunt instrument for blunt, bloody work.&quot;}&gt;&gt;

&lt;&lt;set $banneroftylae to {&quot;name&quot;: &quot;Banner of Tylae&quot;, &quot;strength&quot;: 4, &quot;agility&quot;: -2, &quot;willpower&quot;: 10, &quot;armor&quot;: 2, &quot;price&quot;: 500, &quot;sellprice&quot;: 125, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 15, &quot;maxdamage&quot;: 26, &quot;ability&quot;: &quot;Heal2&quot;, &quot;description&quot;: &quot;A holy banner of Tylae, the Mother Goddess. It wards its bearer with divine protection. Restores 4 health per turn.&quot;}&gt;&gt;

&lt;&lt;set $holystaff to {&quot;name&quot;: &quot;Holy Staff&quot;, &quot;strength&quot;: -5, &quot;agility&quot;: 0, &quot;willpower&quot;: 30, &quot;armor&quot;: 0, &quot;price&quot;: 2000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 40, &quot;maxdamage&quot;: 55, &quot;ability&quot;: &quot;Holy&quot;, &quot;description&quot;: &quot;A holy staff of Tylae, the Mother Goddess. Restores 10 health per turn. Once per combat, if you fall below 10% health, you gain full health.&quot;}&gt;&gt;

&lt;&lt;set $holywarhammer to {&quot;name&quot;: &quot;Holy Warhammer&quot;, &quot;strength&quot;: 15, &quot;agility&quot;: -10, &quot;willpower&quot;: 15, &quot;armor&quot;: -3, &quot;price&quot;: 1000, &quot;sellprice&quot;: 250, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 20, &quot;maxdamage&quot;: 45, &quot;ability&quot;: &quot;Crush1&quot;, &quot;description&quot;: &quot;A warhammer that glows with divine retribution. Each successful attack lowers your enemy&#39;s armor by 3.&quot;}&gt;&gt;

&lt;&lt;set $faithspromise to {&quot;name&quot;: &quot;Faith&#39;s Promise&quot;, &quot;strength&quot;: 15, &quot;agility&quot;: 5, &quot;willpower&quot;: 20, &quot;armor&quot;: 0, &quot;price&quot;: 1500, &quot;sellprice&quot;: 350, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 1, &quot;maxdamage&quot;: 2, &quot;ability&quot;: &quot;Faith&quot;, &quot;description&quot;: &quot;A broken blade of Iulius that transforms into a weapon formed of holy wrath when wielded by the faithful. This weapon&#39;s max damage is always equal to the wearer&#39;s willpower. Grants 1 willpower per turn. Restores 10 health per turn.&quot;}&gt;&gt;

&lt;&lt;set $swordofjudgement to {&quot;name&quot;: &quot;Sword of Judgement&quot;, &quot;strength&quot;: 18, &quot;agility&quot;: -4, &quot;willpower&quot;: 2, &quot;armor&quot;: 0, &quot;price&quot;: 900, &quot;sellprice&quot;: 225, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 30, &quot;maxdamage&quot;: 45, &quot;ability&quot;: &quot;Judgement1&quot;, &quot;description&quot;: &quot;A magic blade used by high ranking knights of the Deathguard. Once per battle, grants 15 strength when your enemy falls below half health.&quot;}&gt;&gt;

&lt;&lt;set $frostfang to {&quot;name&quot;: &quot;Frostfang&quot;, &quot;strength&quot;: 8, &quot;agility&quot;: 8, &quot;willpower&quot;: 2, &quot;armor&quot;: 6, &quot;price&quot;: 900, &quot;sellprice&quot;: 225, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 35, &quot;maxdamage&quot;: 45, &quot;ability&quot;: &quot;Frostfang&quot;, &quot;description&quot;: &quot;A magic blade once wielded by a peerless knight of Netheryn. Successful attacks have a chance to stun your enemy for one turn.&quot;}&gt;&gt;

&lt;&lt;set $runeblade to {&quot;name&quot;: &quot;Runeblade&quot;, &quot;strength&quot;: 15, &quot;agility&quot;: 8, &quot;willpower&quot;: 10, &quot;armor&quot;: 0, &quot;price&quot;: 2000, &quot;sellprice&quot;: 450, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 75, &quot;maxdamage&quot;: 125, &quot;ability&quot;: &quot;Rune&quot;, &quot;description&quot;: &quot;A powerful sword forged of magic-hungry runes. Successful attacks drain 12 mana.&quot;}&gt;&gt;

&lt;&lt;set $championsblade to {&quot;name&quot;: &quot;Champion&#39;s Blade and Sunsworn Shield&quot;, &quot;strength&quot;: 8, &quot;agility&quot;: 8, &quot;willpower&quot;: 8, &quot;armor&quot;: 8, &quot;price&quot;: 5000, &quot;sellprice&quot;: 0, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 40, &quot;maxdamage&quot;: 50, &quot;ability&quot;: &quot;Sunsworn&quot;, &quot;description&quot;: &quot;The Champion&#39;s Blade and the Sunsworn Shield - two of the most powerful artifacts of the Great Occident. Grants 1 armor per turn. Successful attacks grant 1 strength, agilty, or willpower.&quot;}&gt;&gt;

&lt;&lt;set $dragonaxe to {&quot;name&quot;: &quot;Dragon Axe&quot;, &quot;strength&quot;: 25, &quot;agility&quot;: 12, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 1250, &quot;sellprice&quot;: 275, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 35, &quot;maxdamage&quot;: 85, &quot;ability&quot;: &quot;Dragon3&quot;, &quot;description&quot;: &quot;A bloodthirsty axe forged from the scales of Zaradras, the Envious Flame. Each successful strike damages you based on your strength. Does not cause damage if you are below 25% health.&quot;}&gt;&gt;

&lt;&lt;set $ultraaxe to {&quot;name&quot;: &quot;Ultra Axe&quot;, &quot;strength&quot;: 10, &quot;agility&quot;: 10, &quot;willpower&quot;: 10, &quot;armor&quot;: 10, &quot;price&quot;: 1000, &quot;sellprice&quot;: 250, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 20, &quot;maxdamage&quot;: 35, &quot;ability&quot;: 0, &quot;description&quot;: &quot;The Ultra Axe. Even better than the Super Axe.&quot;}&gt;&gt;

&lt;&lt;set $trollclub to {&quot;name&quot;: &quot;Troll Club&quot;, &quot;strength&quot;: 12, &quot;agility&quot;: -4, &quot;willpower&quot;: -2, &quot;armor&quot;: -4, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 12, &quot;maxdamage&quot;: 30, &quot;ability&quot;: 0, &quot;description&quot;: &quot;A massive club used by a troll. An unwieldly weapon capable of much destruction.&quot;}&gt;&gt;

&lt;&lt;set $karhansrebuke to {&quot;name&quot;: &quot;Karhan&#39;s Rebuke&quot;, &quot;strength&quot;: 30, &quot;agility&quot;: 5, &quot;willpower&quot;: 12, &quot;armor&quot;: -10, &quot;price&quot;: 1500, &quot;sellprice&quot;: 350, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 50, &quot;maxdamage&quot;: 100, &quot;ability&quot;: &quot;Rebuke&quot;, &quot;description&quot;: &quot;When the Aquillian lords offered tribute for peace, the barbarian king Karhan answered with the sharp edge of this massive greatsword. Successful attacks reduce your enemy&#39;s strength and increase your own. The lower your health, the more powerful this effect is.&quot;}&gt;&gt;

&lt;&lt;set $bitingblade to {&quot;name&quot;: &quot;Biting Blade&quot;, &quot;strength&quot;: -5, &quot;agility&quot;: 8, &quot;willpower&quot;: 5, &quot;armor&quot;: 2, &quot;price&quot;: 400, &quot;sellprice&quot;: 100, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 18, &quot;maxdamage&quot;: 22, &quot;ability&quot;: 0, &quot;description&quot;: &quot;The prized steel blade of Gresh, the Goblin King.&quot;}&gt;&gt;

&lt;&lt;set $arcanescythe to {&quot;name&quot;: &quot;Arcane Scythe&quot;, &quot;strength&quot;: 6, &quot;agility&quot;: 6, &quot;willpower&quot;: 6, &quot;armor&quot;: 0, &quot;price&quot;: 1000, &quot;sellprice&quot;: 250, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 24, &quot;maxdamage&quot;: 36, &quot;ability&quot;: &quot;ManaReap1&quot;, &quot;description&quot;: &quot;A deadly scythe that absorbs mana with its attacks. Each successful attack restores 10 mana.&quot;}&gt;&gt;

&lt;&lt;set $staffofwinter to {&quot;name&quot;: &quot;Staff of Winter&quot;, &quot;strength&quot;: 3, &quot;agility&quot;: 6, &quot;willpower&quot;: 3, &quot;armor&quot;: 6, &quot;price&quot;: 1500, &quot;sellprice&quot;: 350, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 20, &quot;maxdamage&quot;: 25, &quot;ability&quot;: &quot;Winter1&quot;, &quot;description&quot;: &quot;A magical staff once wielded by the lord of the Winter Palace. Restores 25 mana per turn. Once per battle, if your health falls below 25%, you gain 200 mana and 30 armor.&quot;}&gt;&gt;

&lt;&lt;set $lilithskiss to {&quot;name&quot;: &quot;Lilith&#39;s Kiss&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: -5, &quot;armor&quot;: -15, &quot;price&quot;: 1500, &quot;sellprice&quot;: 0, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 45, &quot;maxdamage&quot;: 75, &quot;ability&quot;: &quot;Lilith1&quot;, &quot;description&quot;: &quot;A cursed staff that holds a fragment of Lilith&#39;s soul. Restores 20 mana per turn. Restores 20 health per turn. Successful attacks reduce both your and your enemy&#39;s armor by 10. If you are attacked when you have 0 armor, you gain 4 strength, 4 agility, 4 willpower, and 10 armor.&quot;}&gt;&gt;

&lt;&lt;set $noweapon to {&quot;name&quot;: &quot;Bare Hands&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;price&quot;: 10, &quot;sellprice&quot;: 0, &quot;class&quot;: &quot;weapon&quot;, &quot;mindamage&quot;: 5, &quot;maxdamage&quot;: 10, &quot;ability&quot;: 0, &quot;description&quot;: &quot;Your bare, naked hands. Who needs a weapon when you can beat evil to death with your bare hands?&quot;}&gt;&gt;

ITEMS

&lt;&lt;set $minorhealthpotion to {&quot;name&quot;: &quot;Minor Health Potion&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;health&quot;: 50, &quot;mana&quot;: 0, &quot;evadescore&quot;: 0, &quot;price&quot;: 40, &quot;tripleprice&quot;: 120, &quot;sellprice&quot;: 15, &quot;class&quot;: &quot;item&quot;, &quot;quantity&quot;: 1, &quot;description&quot;: &quot;A small healing potion - good for curing minor injuries in the midst of battle. Restores 50 health.&quot;}&gt;&gt;

&lt;&lt;set $minormanapotion to {&quot;name&quot;: &quot;Minor Mana Potion&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;health&quot;: 0, &quot;mana&quot;: 50, &quot;evadescore&quot;: 0, &quot;price&quot;: 40, &quot;tripleprice&quot;: 120, &quot;sellprice&quot;: 15, &quot;class&quot;: &quot;item&quot;, &quot;quantity&quot;: 1, &quot;description&quot;: &quot;A small mana potion - good for gaining a bit of extra mana in the midst of battle. estores 50 mana.&quot;}&gt;&gt;

&lt;&lt;set $minorstrengthpotion to {&quot;name&quot;: &quot;Minor Strength Potion&quot;, &quot;strength&quot;: 5, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;health&quot;: 0, &quot;mana&quot;: 0, &quot;evadescore&quot;: 0, &quot;price&quot;: 65, &quot;tripleprice&quot;: 195, &quot;sellprice&quot;: 20, &quot;class&quot;: &quot;item&quot;, &quot;quantity&quot;: 1, &quot;description&quot;: &quot;A small strength potion - good for enhancing your power in the midst of battle. Grants 5 strength.&quot;}&gt;&gt;

&lt;&lt;set $minoragilitypotion to {&quot;name&quot;: &quot;Minor Agility Potion&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 5, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;health&quot;: 0, &quot;mana&quot;: 0, &quot;evadescore&quot;: 0, &quot;price&quot;: 65, &quot;tripleprice&quot;: 195, &quot;sellprice&quot;: 20, &quot;class&quot;: &quot;item&quot;, &quot;quantity&quot;: 1, &quot;description&quot;: &quot;A small agility potion - good for enhancing your speed in the midst of battle. ants 5 agility.&quot;}&gt;&gt;

&lt;&lt;set $majorhealthpotion to {&quot;name&quot;: &quot;Major Health Potion&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;health&quot;: 100, &quot;mana&quot;: 0, &quot;evadescore&quot;: 0, &quot;price&quot;: 75, &quot;tripleprice&quot;: 225, &quot;sellprice&quot;: 25, &quot;class&quot;: &quot;item&quot;, &quot;quantity&quot;: 1, &quot;description&quot;: &quot;A large healing potion - great for curing injuries in the midst of battle. Restores 100 health.&quot;}&gt;&gt;

&lt;&lt;set $majormanapotion to {&quot;name&quot;: &quot;Major Mana Potion&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;health&quot;: 0, &quot;mana&quot;: 100, &quot;evadescore&quot;: 0, &quot;price&quot;: 75, &quot;tripleprice&quot;: 225, &quot;sellprice&quot;: 25, &quot;class&quot;: &quot;item&quot;, &quot;quantity&quot;: 1, &quot;description&quot;: &quot;A large mana potion - great for gaining  extra mana in the midst of battle. Restores 100 mana.&quot;}&gt;&gt;

&lt;&lt;set $majorstrengthpotion to {&quot;name&quot;: &quot;Major Strength Potion&quot;, &quot;strength&quot;: 10, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;health&quot;: 0, &quot;mana&quot;: 0, &quot;evadescore&quot;: 0, &quot;price&quot;: 100, &quot;tripleprice&quot;: 300, &quot;sellprice&quot;: 30, &quot;class&quot;: &quot;item&quot;, &quot;quantity&quot;: 1, &quot;description&quot;: &quot;A large strength potion - great for enhancing your power in the midst of battle. Grants 10 strength.&quot;}&gt;&gt;

&lt;&lt;set $majoragilitypotion to {&quot;name&quot;: &quot;Major Agility Potion&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 10, &quot;willpower&quot;: 0, &quot;armor&quot;: 0, &quot;health&quot;: 0, &quot;mana&quot;: 0, &quot;evadescore&quot;: 0, &quot;price&quot;: 100, &quot;tripleprice&quot;: 300, &quot;sellprice&quot;: 30, &quot;class&quot;: &quot;item&quot;, &quot;quantity&quot;: 1, &quot;description&quot;: &quot;A large agility potion - great for enhancing your speed in the midst of battle. Grants 10 agility.&quot;}&gt;&gt;

&lt;&lt;set $gracepotion to {&quot;name&quot;: &quot;Potion of Grace&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 5, &quot;health&quot;: 75, &quot;mana&quot;: 75, &quot;evadescore&quot;: 0, &quot;price&quot;: 200, &quot;tripleprice&quot;: 600, &quot;sellprice&quot;: 50, &quot;class&quot;: &quot;item&quot;, &quot;quantity&quot;: 1, &quot;description&quot;: &quot;A potion made of the very same creative energy that Tylae used to form the world. Great for healing, gaining mana, and improving armor in the midst of battle. Restores 75 health and mana, increases armor by 5.&quot;}&gt;&gt;

&lt;&lt;set $goddesspotion to {&quot;name&quot;: &quot;Goddess Potion&quot;, &quot;strength&quot;: 0, &quot;agility&quot;: 0, &quot;willpower&quot;: 0, &quot;armor&quot;: 50, &quot;health&quot;: 500, &quot;mana&quot;: 500, &quot;evadescore&quot;: 0, &quot;price&quot;: 500, &quot;tripleprice&quot;: 1500, &quot;sellprice&quot;: 150, &quot;class&quot;: &quot;item&quot;, &quot;quantity&quot;: 1, &quot;description&quot;: &quot;A potion given to the champion of creation during the final battle. Restores 500 health and mana, increases armor by 50.&quot;}&gt;&gt;

SPECIAL ITEMS

&lt;&lt;set $net to {&quot;name&quot;: &quot;Net&quot;, &quot;price&quot;: 35, &quot;jump&quot;: 15, &quot;class&quot;: &quot;special&quot;, &quot;description&quot;: &quot;A net made from hempen rope. Good for catching goblins.&quot;}&gt;&gt;

&lt;&lt;set $dragonhorn to {&quot;name&quot;: &quot;Dragonhorn&quot;, &quot;price&quot;: 650, &quot;jump&quot;: 29, &quot;class&quot;: &quot;special&quot;, &quot;description&quot;: &quot;A horn crafted by the dragon masters of old. It&#39;s call will sap the energy of nearby dragons and force them from hiding.&quot;}&gt;&gt;

&lt;&lt;set $strangeartifact to {&quot;name&quot;: &quot;Strange Artifact&quot;, &quot;price&quot;: 1000, &quot;jump&quot;: 41, &quot;class&quot;: &quot;special&quot;, &quot;description&quot;: &quot;A strange, magical artifact. Increases the maximum number of abilities you can know by 1.&quot;}&gt;&gt;

&lt;&lt;set $bookofheroes to {&quot;name&quot;: &quot;Book of Heroes&quot;, &quot;price&quot;: 2000, &quot;jump&quot;: 42, &quot;class&quot;: &quot;special&quot;, &quot;description&quot;: &quot;A rare book filled with tales of the heroes of old. Grants 1000 experience.&quot;}&gt;&gt;

&lt;&lt;set $blackrose to {&quot;name&quot;: &quot;Black Rose&quot;, &quot;price&quot;: 300, &quot;jump&quot;: 43, &quot;class&quot;: &quot;special&quot;, &quot;description&quot;: &quot;A black rose with a glowing red center. These roses once grew around the elven city of Hadamshal. Nowadays, they are incredibly rare.&quot;}&gt;&gt;


PALADIN ABILITIES

&lt;&lt;set $holylight to {&quot;name&quot;: &quot;Holy Light&quot;, &quot;widgetname&quot;: &quot;HolyLight&quot;, &quot;mana&quot;: 40, &quot;exp&quot;: 100, &quot;level&quot;: 1, &quot;levelexp&quot;: 250, &quot;levelmana&quot;: 10, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;You fill your soul with holy light, healing yourself for your Willpower value&quot;, &quot;leveldescription&quot;: &quot;Increases the healing done by the spell, but also increases the mana cost&quot;}&gt;&gt;

&lt;&lt;set $smite to {&quot;name&quot;: &quot;Smite&quot;, &quot;widgetname&quot;: &quot;Smite&quot;, &quot;mana&quot;: 30, &quot;exp&quot;: 100, &quot;level&quot;: 1, &quot;levelexp&quot;: 250, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;You attack with holy wrath. You make a normal attack roll. If you hit, half of your willpower value is added to your damage roll, in addition to half your strength value.&quot;, &quot;leveldescription&quot;: &quot;Reduces the mana cost of the spell&quot;}&gt;&gt;

&lt;&lt;set $empower to {&quot;name&quot;: &quot;Empower&quot;, &quot;widgetname&quot;: &quot;Empower&quot;, &quot;mana&quot;: 60, &quot;exp&quot;: 150, &quot;level&quot;: 1, &quot;levelexp&quot;: 300, &quot;levelmana&quot;: 25, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;You empower your weapon with holy fury. Your strength increases by half of your willpower for the duration of combat. Can only be used once per combat.&quot;, &quot;leveldescription&quot;: &quot;Increases the bonus to strength, but also significantly increases the mana cost&quot;}&gt;&gt;

&lt;&lt;set $righteousshield to {&quot;name&quot;: &quot;Righteous Shield&quot;, &quot;widgetname&quot;: &quot;RighteousShield&quot;, &quot;mana&quot;: 50, &quot;exp&quot;: 150, &quot;level&quot;: 1, &quot;levelexp&quot;: 300, &quot;levelmana&quot;: 25, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;Your righteousness forms a shield around your body. Your armor increases by half of your Willpower value. Can only be used once per combat.&quot;, &quot;leveldescription&quot;: &quot;Increases the bonus to armor, but also significantly increases the mana cost&quot;}&gt;&gt;

&lt;&lt;set $judgment to {&quot;name&quot;: &quot;Judgment&quot;, &quot;widgetname&quot;: &quot;Judgment&quot;, &quot;mana&quot;: 40, &quot;exp&quot;: 175, &quot;level&quot;: 1, &quot;levelexp&quot;: 325, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;After being struck by an enemy, you judge them for their deed. The enemy takes your willpower value in damage and is stunned for two turns.&quot;, &quot;leveldescription&quot;: &quot;Reduces the mana cost&quot;}&gt;&gt;

&lt;&lt;set $daybreak to {&quot;name&quot;: &quot;Daybreak&quot;, &quot;widgetname&quot;: &quot;Daybreak&quot;, &quot;mana&quot;: 45, &quot;exp&quot;: 175, &quot;level&quot;: 1, &quot;levelexp&quot;: 325, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;Iulius&#39;s holy light reveals your enemy&#39;s weaknesses, and spurs you to heroic action. Your enemy&#39;s armor is lowered by quarter of your willpower value, and you gain a small amount of agility.&quot;, &quot;leveldescription&quot;: &quot;Reduces the mana cost of the spell&quot;}&gt;&gt;

&lt;&lt;set $divineintervention to {&quot;name&quot;: &quot;Divine Intervention&quot;, &quot;widgetname&quot;: &quot;DivineIntervention&quot;, &quot;mana&quot;: 50, &quot;exp&quot;: 300, &quot;level&quot;: 1, &quot;levelexp&quot;: 400, &quot;levelmana&quot;: -15, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;In your darkest hour, Iulius replenishes your strength and compels you to triumph. You must be below one quarter of your health to use this ability. You gain three times your willpower in health and mana. Your enemy is stunned for two turns. You can use once-per-battle abilities again. This ability can only ever be used once per battle.&quot;, &quot;leveldescription&quot;: &quot;Increases the amount of health and mana restored. Reduces the mana cost.&quot;}&gt;&gt;

&lt;&lt;set $nullify to {&quot;name&quot;: &quot;Nullify&quot;, &quot;widgetname&quot;: &quot;Nullify&quot;, &quot;mana&quot;: 70, &quot;exp&quot;: 250, &quot;level&quot;: 1, &quot;levelexp&quot;: 400, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;You deny your foe the dark energy that fuels their power. Your enemy&#39;s strength, agility, and willpower decrease by a small amount.&quot;, &quot;leveldescription&quot;: &quot;Improves the effect and reduces the mana cost.&quot;}&gt;&gt;

&lt;&lt;set $prayer to {&quot;name&quot;: &quot;Prayer&quot;, &quot;widgetname&quot;: &quot;Prayer&quot;, &quot;mana&quot;: 5, &quot;exp&quot;: 250, &quot;level&quot;: 1, &quot;levelexp&quot;: 350, &quot;levelmana&quot;: 0, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;You fall to your knees and pray. Your mana is restored by three quarters of your willpower. You lose a small amount of armor.&quot;, &quot;leveldescription&quot;: &quot;Increases the amount of mana restored.&quot;}&gt;&gt;

&lt;&lt;set $holyaura to {&quot;name&quot;: &quot;Holy Aura&quot;, &quot;widgetname&quot;: &quot;HolyAura&quot;, &quot;mana&quot;: 120, &quot;exp&quot;: 300, &quot;level&quot;: 1, &quot;levelexp&quot;: 400, &quot;levelmana&quot;: -10, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;A holy aura covers the battlefield. For the rest of combat, you cannot be stunned, and gain a tiny amount of health each turn.&quot;, &quot;leveldescription&quot;: &quot;Increases health gained each turn. Decreases the mana cost.&quot;}&gt;&gt;

&lt;&lt;set $wrathofgod to {&quot;name&quot;: &quot;Wrath of God&quot;, &quot;widgetname&quot;: &quot;WrathOfGod&quot;, &quot;mana&quot;: 200, &quot;exp&quot;: 300, &quot;level&quot;: 1, &quot;levelexp&quot;: 400, &quot;levelmana&quot;: -25, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;You summon the wrath of Iulius to vanquish your foe. Deals massive damage based on the number of times &#39;Prayer&#39; has been used in the battle. &#39;Prayer&#39; must have been used at least three times. Can only be used once per battle. Not effected by &#39;Divine Intervention.&#39;&quot;, &quot;leveldescription&quot;: &quot;Increases damage dealt. Decreases the mana cost.&quot;}&gt;&gt;

&lt;&lt;set $radiantbolt to {&quot;name&quot;: &quot;Radiant Bolt&quot;, &quot;widgetname&quot;: &quot;RadiantBolt&quot;, &quot;mana&quot;: 50, &quot;exp&quot;: 250, &quot;level&quot;: 1, &quot;levelexp&quot;: 300, &quot;levelmana&quot;: -10, &quot;class&quot;: &quot;Paladin&quot;, &quot;description&quot;: &quot;You attack your enemy with a bolt of holy light. If your health is below 50%, the bolt deals damage. If your health is above 50%, the bolt breaks armor.&quot;, &quot;leveldescription&quot;: &quot;Decreases the mana cost&quot;}&gt;&gt;


&lt;&lt;set $paladinabilityinventory = []&gt;&gt;
&lt;&lt;set $paladinabilityinventory.push($empower, $righteousshield, $judgment, $daybreak)&gt;&gt;


SOLDIER ABILITIES

&lt;&lt;set $bloodrage to {&quot;name&quot;: &quot;Blood Rage&quot;, &quot;widgetname&quot;: &quot;BloodRage&quot;, &quot;mana&quot;: 50, &quot;exp&quot;: 100, &quot;level&quot;: 1, &quot;levelexp&quot;: 250, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;You draw strength from your own vitality. You lose Health but gain additional Strength for the duration of the battle&quot;, &quot;leveldescription&quot;: &quot;Reduces the mana cost of the spell.&quot;}&gt;&gt;

&lt;&lt;set $burningstrike to {&quot;name&quot;: &quot;Burning Strike&quot;, &quot;widgetname&quot;: &quot;BurningStrike&quot;, &quot;mana&quot;: 30, &quot;exp&quot;: 100, &quot;level&quot;: 1, &quot;levelexp&quot;: 250, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;You strike with fiery fury. Operates like a regular attack, except it uses your full strength value as a damage bonus (instead of half). Does not bypass armor.&quot;, &quot;leveldescription&quot;: &quot;Reduces the mana cost of the spell.&quot;}&gt;&gt;

&lt;&lt;set $counterstrike to {&quot;name&quot;: &quot;Counterstrike&quot;, &quot;widgetname&quot;: &quot;Counterstrike&quot;, &quot;mana&quot;: 25, &quot;exp&quot;: 150, &quot;level&quot;: 1, &quot;levelexp&quot;: 300, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;You hit back just as hard after being struck. The turn after an enemy hits you with an attack, you do the same damage back to them, plus a portion of your strength.&quot;, &quot;leveldescription&quot;: &quot;Reduces the mana cost of the spell&quot;}&gt;&gt;

&lt;&lt;set $sunderarmor to {&quot;name&quot;: &quot;Sunder Armor&quot;, &quot;widgetname&quot;: &quot;SunderArmor&quot;, &quot;mana&quot;: 45, &quot;exp&quot;: 150, &quot;level&quot;: 1, &quot;levelexp&quot;: 250, &quot;levelmana&quot;: 10, &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;You shatter your enemy&#39;s armor, dealing damage equal to your Strength value and reducing your enemy&#39;s armor by half your Strength value.&quot;, &quot;leveldescription&quot;: &quot;Increases damage dealt and armor reduced but increases mana cost&quot;}&gt;&gt;

&lt;&lt;set $secondwind to {&quot;name&quot;: &quot;Second Wind&quot;, &quot;widgetname&quot;: &quot;SecondWind&quot;, &quot;mana&quot;: 10, &quot;exp&quot;: 175, &quot;level&quot;: 1, &quot;levelexp&quot;: 500, &quot;levelmana&quot;: 0, &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;You access a second well of vigor deep inside, allow you to continue the fight. Gain double your strength value in health and mana. Must be below half health. Can only be used once per battle.&quot;, &quot;leveldescription&quot;: &quot;Second Wind can be used one additional time each battle.&quot;}&gt;&gt;

&lt;&lt;set $devastate to {&quot;name&quot;: &quot;Devastate&quot;, &quot;widgetname&quot;: &quot;Devastate&quot;, &quot;mana&quot;: 45, &quot;exp&quot;: 200, &quot;level&quot;: 1, &quot;levelexp&quot;: 400, &quot;levelmana&quot;: 20,  &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;You deliver a devastating blow at the cost of your strength, dealing triple your strength value in damage but reducing your strength and agility by a quarter of your strength value. Must be below half health.&quot;, &quot;leveldescription&quot;: &quot;Increases the damage caused but increases mana cost&quot;}&gt;&gt;

&lt;&lt;set $blooddrinker to {&quot;name&quot;: &quot;Blood Drinker&quot;, &quot;widgetname&quot;: &quot;BloodDrinker&quot;, &quot;mana&quot;: 40, &quot;exp&quot;: 250, &quot;level&quot;: 1, &quot;levelexp&quot;: 350, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;You strike your foe and feast on the blood spilled. Operates like a regular attack, except you absorb a portion of the damage dealt as health. Does not bypass armor.&quot;, &quot;leveldescription&quot;: &quot;Reduces the mana cost of the spell. Increases health absorbed&quot;}&gt;&gt;

&lt;&lt;set $bonebreaker to {&quot;name&quot;: &quot;Bone Breaker&quot;, &quot;widgetname&quot;: &quot;BoneBreaker&quot;, &quot;mana&quot;: 85, &quot;exp&quot;: 250, &quot;level&quot;: 1, &quot;levelexp&quot;: 350, &quot;levelmana&quot;: -10, &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;You crush your enemy, hurting them, stunning them for one turn, and reducing their strength.&quot;, &quot;leveldescription&quot;: &quot;Reduces the mana cost of the spell.&quot;}&gt;&gt;

&lt;&lt;set $bullrush to {&quot;name&quot;: &quot;Bull Rush&quot;, &quot;widgetname&quot;: &quot;BullRush&quot;, &quot;mana&quot;: 10, &quot;exp&quot;: 300, &quot;level&quot;: 1, &quot;levelexp&quot;: 300, &quot;levelmana&quot;: 0, &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;You charge the enemy, dealing max weapon damage, breaking their armor, stunning them, and gaining mana. Can only be used once per battle.&quot;, &quot;leveldescription&quot;: &quot;Increases mana gained.&quot;}&gt;&gt;

&lt;&lt;set $brashendurance to {&quot;name&quot;: &quot;Brash Endurance&quot;, &quot;widgetname&quot;: &quot;BrashEndurance&quot;, &quot;mana&quot;: 50, &quot;exp&quot;: 300, &quot;level&quot;: 1, &quot;levelexp&quot;: 300, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;After your enemy uses an ability (not a basic attack), stand vigilant and gain health and armor.&quot;, &quot;leveldescription&quot;: &quot;Reduces the mana cost and increases health gained.&quot;}&gt;&gt;

&lt;&lt;set $heroicstrike to {&quot;name&quot;: &quot;Heroic Strike&quot;, &quot;widgetname&quot;: &quot;HeroicStrike&quot;, &quot;mana&quot;: 100, &quot;exp&quot;: 300, &quot;level&quot;: 1, &quot;levelexp&quot;: 350, &quot;levelmana&quot;: -20, &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;You strike with heroic fury. Operates like a regular attack. Does not bypass armor. If it hits and does damage, your stats increase.&quot;, &quot;leveldescription&quot;: &quot;Reduces the mana cost and increases stats gained.&quot;}&gt;&gt;

&lt;&lt;set $momentum to {&quot;name&quot;: &quot;Momentum&quot;, &quot;widgetname&quot;: &quot;Momentum&quot;, &quot;mana&quot;: 25, &quot;exp&quot;: 200, &quot;level&quot;: 1, &quot;levelexp&quot;: 250, &quot;levelmana&quot;: 0, &quot;class&quot;: &quot;Soldier&quot;, &quot;description&quot;: &quot;You crash into your foe, dealing damage. Does not bypass armor. Each consecutive turn this ability is used, it deals more damage.&quot;, &quot;leveldescription&quot;: &quot;Increases damage dealt, and adds a small armor break.&quot;}&gt;&gt;


&lt;&lt;set $soldierabilityinventory = []&gt;&gt;
&lt;&lt;set $soldierabilityinventory.push($counterstrike, $sunderarmor, $secondwind, $devastate)&gt;&gt;


ROGUE ABILITIES

&lt;&lt;set $shadowstrike to {&quot;name&quot;: &quot;Shadow Strike&quot;, &quot;widgetname&quot;: &quot;ShadowStrike&quot;, &quot;combatcost&quot;: 0, &quot;mana&quot;: 15, &quot;exp&quot;: 100, &quot;level&quot;: 1, &quot;levelexp&quot;: 250, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;You strike from the shadows. Operates like a regular attack, except it uses double your agility value as a hit bonus and half your agility value as a damage bonus (instead of strength). Does not bypass armor. Grants 1 Combat Point if it hits.&quot;, &quot;leveldescription&quot;: &quot;Reduces mana cost&quot;}&gt;&gt;

&lt;&lt;set $surestrike to {&quot;name&quot;: &quot;Sure Strike&quot;, &quot;widgetname&quot;: &quot;SureStrike&quot;, &quot;combatcost&quot;: 1, &quot;mana&quot;: 40, &quot;exp&quot;: 100, &quot;level&quot;: 1, &quot;levelexp&quot;: 250, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;You throw your lucky dagger at the enemy - it never misses, and deals double your Agility value in damage. Does not bypass armor. Costs 1 Combat Point&quot;, &quot;leveldescription&quot;: &quot;Reduces mana cost. Adds a small chance to recover the used combat point.&quot;}&gt;&gt;

&lt;&lt;set $riposte to {&quot;name&quot;: &quot;Riposte&quot;, &quot;widgetname&quot;: &quot;Riposte&quot;, &quot;combatcost&quot;: 0, &quot;mana&quot;: 25, &quot;exp&quot;: 150, &quot;level&quot;: 1, &quot;levelexp&quot;: 300, &quot;levelmana&quot;: 10, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;After an enemy misses you, you strike back with a darting thrust. This attack never misses, and does your weapon&#39;s maximum damage plus your Agility value. Does not bypass armor. Grants 1 Combat Point.&quot;, &quot;leveldescription&quot;: &quot;Each riposte slightly increases your agility. Also increases mana cost&quot;}&gt;&gt;

&lt;&lt;set $cloakofshadows to {&quot;name&quot;: &quot;Cloak Of Shadows&quot;, &quot;widgetname&quot;: &quot;CloakOfShadows&quot;, &quot;combatcost&quot;: 0, &quot;mana&quot;: 45, &quot;exp&quot;: 150, &quot;level&quot;: 1, &quot;levelexp&quot;: 300, &quot;levelmana&quot;: 15, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;Shadows wrap around you, making you difficult to land a blow upon. Your base evasion increases by half of your agility value. Does not grant or cost Combat Points&quot;, &quot;leveldescription&quot;: &quot;Your cloak of shadows also slightly increases your armor, based on your willpower. Also increases mana cost&quot;}&gt;&gt;

&lt;&lt;set $outflank to {&quot;name&quot;: &quot;Outflank&quot;, &quot;widgetname&quot;: &quot;Outflank&quot;, &quot;combatcost&quot;: 1, &quot;mana&quot;: 20, &quot;exp&quot;: 175, &quot;level&quot;: 1, &quot;levelexp&quot;: 350, &quot;levelmana&quot;: 10, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;You do your Agility value in damage to an enemy, and lower their armor by 10 plus half your strength value. Only works on enemies with an armor value higher than your strength. Costs 1 Combat Point.&quot;, &quot;leveldescription&quot;: &quot;Your outflank decreases your enemy&#39;s armor by a base amount, in addition to half your strength value&quot;}&gt;&gt;

&lt;&lt;set $assassinate to {&quot;name&quot;: &quot;Assassinate&quot;, &quot;widgetname&quot;: &quot;Assassinate&quot;, &quot;combatcost&quot;: 1, &quot;mana&quot;: 50, &quot;exp&quot;: 200, &quot;level&quot;: 1, &quot;levelexp&quot;: 400, &quot;levelmana&quot;: 25, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;You strike a lethal blow against an enemy with less than half of health, doing your agility value in damage for every Combat Point you have. Bypasses armor. Uses all available Combat Points&quot;, &quot;leveldescription&quot;: &quot;Increases the damage of the spell, but also increases mana cost&quot;}&gt;&gt;

&lt;&lt;set $shadowstep to {&quot;name&quot;: &quot;Shadowstep&quot;, &quot;widgetname&quot;: &quot;Shadowstep&quot;, &quot;combatcost&quot;: 0, &quot;mana&quot;: 25, &quot;exp&quot;: 200, &quot;level&quot;: 1, &quot;levelexp&quot;: 450, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;You slip into the shadows, and ready your next attack. Gain 2 combat points. Only works if you have 0 combat points.&quot;, &quot;leveldescription&quot;: &quot;Reduces mana cost. Adds a small chance to gain a third combat point.&quot;}&gt;&gt;

&lt;&lt;set $consumeshadows to {&quot;name&quot;: &quot;Consume Shadows&quot;, &quot;widgetname&quot;: &quot;ConsumeShadows&quot;, &quot;combatcost&quot;: 1, &quot;mana&quot;: 5, &quot;exp&quot;: 250, &quot;level&quot;: 1, &quot;levelexp&quot;: 400, &quot;levelmana&quot;: 0, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;After dodging an enemy&#39;s attack, you consume the shadow left behind. Restores mana equal 50 plus your willpower. Costs 1 Combat Point&quot;, &quot;leveldescription&quot;: &quot;Increases mana restored.&quot;}&gt;&gt;

&lt;&lt;set $incapacitate to {&quot;name&quot;: &quot;Incapacitate&quot;, &quot;widgetname&quot;: &quot;Incapacitate&quot;, &quot;combatcost&quot;: 2, &quot;mana&quot;: 75, &quot;exp&quot;: 300, &quot;level&quot;: 1, &quot;levelexp&quot;: 400, &quot;levelmana&quot;: -15, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;Stun the enemy for 3 turns. Costs 2 Combat Points&quot;, &quot;leveldescription&quot;: &quot;Reduces mana cost.&quot;}&gt;&gt;

&lt;&lt;set $bladestorm to {&quot;name&quot;: &quot;Blade Storm&quot;, &quot;widgetname&quot;: &quot;BladeStorm&quot;, &quot;combatcost&quot;: 3, &quot;mana&quot;: 65, &quot;exp&quot;: 300, &quot;level&quot;: 1, &quot;levelexp&quot;: 400, &quot;levelmana&quot;: 0, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;Launch three attacks in quick succession. Like Shadow Strike, these attacks use agility for damage. If all attacks land, you gain 1 Combat Point. Costs 3 Combat Points&quot;, &quot;leveldescription&quot;: &quot;Adds another attack.&quot;}&gt;&gt;

&lt;&lt;set $deadlyfocus to {&quot;name&quot;: &quot;Deadly Focus&quot;, &quot;widgetname&quot;: &quot;DeadlyFocus&quot;, &quot;combatcost&quot;: 1, &quot;mana&quot;: 45, &quot;exp&quot;: 300, &quot;level&quot;: 1, &quot;levelexp&quot;: 400, &quot;levelmana&quot;: -10, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;Plan out your next attack, gaining 2 combat points and half your agility in restored health. Cost 1 Combat Point&quot;, &quot;leveldescription&quot;: &quot;Reduces mana cost. Slightly increases health gained.&quot;}&gt;&gt;

&lt;&lt;set $sapwill to {&quot;name&quot;: &quot;Sap Will&quot;, &quot;widgetname&quot;: &quot;SapWill&quot;, &quot;combatcost&quot;: 0, &quot;mana&quot;: 35, &quot;exp&quot;: 250, &quot;level&quot;: 1, &quot;levelexp&quot;: 300, &quot;levelmana&quot;: -5, &quot;class&quot;: &quot;Rogue&quot;, &quot;description&quot;: &quot;Reduce an enemy&#39;s willpower.&quot;, &quot;leveldescription&quot;: &quot;Reduces mana cost, and breaks a small amount of armor.&quot;}&gt;&gt;


&lt;&lt;set $rogueabilityinventory = []&gt;&gt;
&lt;&lt;set $rogueabilityinventory.push($riposte, $cloakofshadows, $outflank, $assassinate)&gt;&gt;


DEFAULT SETTINGS

&lt;&lt;set $p = 0&gt;&gt;
&lt;&lt;set $i = 0&gt;&gt;
&lt;&lt;set $verystart = 1&gt;&gt;

&lt;&lt;set $class = &quot;none&quot;&gt;&gt;

&lt;&lt;set $gender = &quot;male&quot;&gt;&gt;

&lt;&lt;set $basestrength = 10&gt;&gt;
&lt;&lt;set $baseagility = 10&gt;&gt;
&lt;&lt;set $basewillpower = 10&gt;&gt;
&lt;&lt;set $baseevadescore = 50&gt;&gt;
&lt;&lt;set $basearmor = 0&gt;&gt;

&lt;&lt;set $timesincreasedstrength = 0&gt;&gt;
&lt;&lt;set $timesincreasedagility = 0&gt;&gt;
&lt;&lt;set $timesincreasedwillpower = 0&gt;&gt;

&lt;&lt;set $headstrength = 0&gt;&gt;
&lt;&lt;set $headagility = 0&gt;&gt;
&lt;&lt;set $headwillpower = 0&gt;&gt;
&lt;&lt;set $headarmor = 0&gt;&gt;
&lt;&lt;set $headability = 0&gt;&gt;

&lt;&lt;set $cheststrength = 0&gt;&gt;
&lt;&lt;set $chestagility = 0&gt;&gt;
&lt;&lt;set $chestwillpower = 0&gt;&gt;
&lt;&lt;set $chestarmor = 0&gt;&gt;
&lt;&lt;set $chestability = 0&gt;&gt;

&lt;&lt;set $handsstrength = 0&gt;&gt;
&lt;&lt;set $handsagility = 0&gt;&gt;
&lt;&lt;set $handswillpower = 0&gt;&gt;
&lt;&lt;set $handsarmor = 0&gt;&gt;
&lt;&lt;set $handsability = 0&gt;&gt;

&lt;&lt;set $legsstrength = 0&gt;&gt;
&lt;&lt;set $legsagility = 0&gt;&gt;
&lt;&lt;set $legswillpower = 0&gt;&gt;
&lt;&lt;set $legsarmor = 0&gt;&gt;
&lt;&lt;set $legsability = 0&gt;&gt;

&lt;&lt;set $feetstrength = 0&gt;&gt;
&lt;&lt;set $feetagility = 0&gt;&gt;
&lt;&lt;set $feetwillpower = 0&gt;&gt;
&lt;&lt;set $feetarmor = 0&gt;&gt;
&lt;&lt;set $feetability = 0&gt;&gt;

&lt;&lt;set $weaponstrength = 0&gt;&gt;
&lt;&lt;set $weaponagility = 0&gt;&gt;
&lt;&lt;set $weaponwillpower = 0&gt;&gt;
&lt;&lt;set $weaponwillpower = 0&gt;&gt;
&lt;&lt;set $weaponarmor = 0&gt;&gt;
&lt;&lt;set $weaponability = 0&gt;&gt;

&lt;&lt;set $specialstrength = 0&gt;&gt;
&lt;&lt;set $specialagility = 0&gt;&gt;
&lt;&lt;set $specialwillpower = 0&gt;&gt;
&lt;&lt;set $specialarmor = 0&gt;&gt;
&lt;&lt;set $specialevadescore = 0&gt;&gt;

&lt;&lt;set $equipmentstrength = $headstrength + $cheststrength + $handsstrength + $legsstrength + $feetstrength&gt;&gt;
&lt;&lt;set $equipmentagility = $headagility + $chestagility + $handsagility + $legsagility + $feetagility&gt;&gt;
&lt;&lt;set $equipmentwillpower = $headwillpower + $chestwillpower + $handswillpower + $legswillpower + $feetwillpower&gt;&gt;

&lt;&lt;set $armor = $headarmor + $chestarmor + $handsarmor + $legsarmor + $feetarmor + $weaponarmor&gt;&gt;

&lt;&lt;set $strength = $basestrength + $equipmentstrength + $weaponstrength&gt;&gt;
&lt;&lt;set $agility = $baseagility + $equipmentagility + $weaponagility&gt;&gt;
&lt;&lt;set $willpower = $basewillpower + $equipmentwillpower + $weaponwillpower&gt;&gt;

&lt;&lt;set $maxmana = 0&gt;&gt;
&lt;&lt;set $currentmana = 0&gt;&gt;
&lt;&lt;set $abilitymana = 0&gt;&gt;

&lt;&lt;set $gold = 100&gt;&gt;
&lt;&lt;set $exp = 0&gt;&gt;

&lt;&lt;set $event = 0&gt;&gt;

&lt;&lt;set $headinventory = []&gt;&gt;
&lt;&lt;set $chestinventory = []&gt;&gt;
&lt;&lt;set $handsinventory = []&gt;&gt;
&lt;&lt;set $legsinventory = []&gt;&gt;
&lt;&lt;set $feetinventory = []&gt;&gt;
&lt;&lt;set $weaponinventory = []&gt;&gt;
&lt;&lt;set $iteminventory = []&gt;&gt;
&lt;&lt;set $specialinventory = []&gt;&gt;

&lt;&lt;set $merchantweaponinventory = []&gt;&gt;
&lt;&lt;set $merchantarmorinventory = []&gt;&gt;
&lt;&lt;set $merchantiteminventory = []&gt;&gt;

&lt;&lt;set $abilityinventory = []&gt;&gt;
&lt;&lt;set $abilitycount = []&gt;&gt;


&lt;&lt;set $outskirtseventinventory = []&gt;&gt;

&lt;&lt;set $action = 0&gt;&gt;

&lt;&lt;set $merchantgold = 0&gt;&gt;

&lt;&lt;set $outskirtsquest = 0&gt;&gt;
&lt;&lt;set $valequest = 0&gt;&gt;
&lt;&lt;set $frozenquest = 0&gt;&gt;
&lt;&lt;set $finalquest = 0&gt;&gt;
&lt;&lt;set $countdown = 20&gt;&gt;
&lt;&lt;set $witchlives = 1&gt;&gt;
&lt;&lt;set $domituslives = 1&gt;&gt;

&lt;&lt;set $combatpoints = 0&gt;&gt;
&lt;&lt;set $enemystun = 0&gt;&gt;
&lt;&lt;set $stun = 0&gt;&gt;
&lt;&lt;set $secondwinduse = 0&gt;&gt;
&lt;&lt;set $prayercount = 0&gt;&gt;
&lt;&lt;set $aura = 0&gt;&gt;
&lt;&lt;set $startingmaxmana = 100&gt;&gt;
&lt;&lt;set $setbonus = 0&gt;&gt;
&lt;&lt;set $bought3 = 0&gt;&gt;

&lt;&lt;set $activeability = 0&gt;&gt;
&lt;&lt;set $enemyactiveability = 0&gt;&gt;
&lt;&lt;set $epilogue = 0&gt;&gt;\

&lt;&lt;set $witchlove = 10&gt;&gt;
&lt;&lt;set $merchantlove = 10&gt;&gt;
&lt;&lt;set $nayalove = 10&gt;&gt;
&lt;&lt;set $pleasured = 0&gt;&gt;
&lt;&lt;set $lewdshrine = 0&gt;&gt;
&lt;&lt;set $witchawareness = 0&gt;&gt;

&lt;&lt;set $enemystuncount = 0&gt;&gt;
&lt;&lt;set $enemystunlimit = 10&gt;&gt;


















</tw-passagedata><tw-passagedata pid="7" name="Armory" tags="" position="401,776" size="100,100">&lt;&lt;nobr&gt;&gt;

&lt;&lt;if $a neq 0&gt;&gt;
&lt;&lt;set $head = $currentweapon.name&gt;&gt;
&lt;&lt;set $headstrength = $currentweapon.strength&gt;&gt;
&lt;&lt;set $headagility = $currentweapon.agility&gt;&gt;
&lt;&lt;set $headwillpower = $currentweapon.willpower&gt;&gt;
&lt;&lt;set $headarmor = $currentweapon.armor&gt;&gt;
&lt;&lt;set $headability = $currentweapon.ability&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;if $b neq 0&gt;&gt;
&lt;&lt;set $chest = $currentweapon.name&gt;&gt;
&lt;&lt;set $cheststrength = $currentweapon.strength&gt;&gt;
&lt;&lt;set $chestagility = $currentweapon.agility&gt;&gt;
&lt;&lt;set $chestwillpower = $currentweapon.willpower&gt;&gt;
&lt;&lt;set $chestarmor = $currentweapon.armor&gt;&gt;
&lt;&lt;set $chestability = $currentweapon.ability&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;if $c neq 0&gt;&gt;
&lt;&lt;set $hands = $currentweapon.name&gt;&gt;
&lt;&lt;set $handsstrength = $currentweapon.strength&gt;&gt;
&lt;&lt;set $handsagility = $currentweapon.agility&gt;&gt;
&lt;&lt;set $handswillpower = $currentweapon.willpower&gt;&gt;
&lt;&lt;set $handsarmor = $currentweapon.armor&gt;&gt;
&lt;&lt;set $handsability = $currentweapon.ability&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;if $d neq 0&gt;&gt;
&lt;&lt;set $legs = $currentweapon.name&gt;&gt;
&lt;&lt;set $legsstrength = $currentweapon.strength&gt;&gt;
&lt;&lt;set $legsagility = $currentweapon.agility&gt;&gt;
&lt;&lt;set $legswillpower = $currentweapon.willpower&gt;&gt;
&lt;&lt;set $legsarmor = $currentweapon.armor&gt;&gt;
&lt;&lt;set $legsability = $currentweapon.ability&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;if $e neq 0&gt;&gt;
&lt;&lt;set $feet = $currentweapon.name&gt;&gt;
&lt;&lt;set $feetstrength = $currentweapon.strength&gt;&gt;
&lt;&lt;set $feetagility = $currentweapon.agility&gt;&gt;
&lt;&lt;set $feetwillpower = $currentweapon.willpower&gt;&gt;
&lt;&lt;set $feetarmor = $currentweapon.armor&gt;&gt;
&lt;&lt;set $feetability = $currentweapon.ability&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;
You are in your Armory. Here, you can equip new armor you find in the woods. &lt;&lt;if $f eq 0&gt;&gt;&lt;img src=&quot;Images/Locations/armory1.jpg&quot; width=500 /&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $a neq 0&gt;&gt;You equip your $head. $currentweapon.description  &lt;&lt;set $a = 0&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $b neq 0&gt;&gt;You equip your $chest. $currentweapon.description  &lt;&lt;set $b = 0&gt;&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;if $c neq 0&gt;&gt;You equip your $hands. $currentweapon.description  &lt;&lt;set $c = 0&gt;&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;if $d neq 0&gt;&gt;You equip your $legs. $currentweapon.description  &lt;&lt;set $d = 0&gt;&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;if $e neq 0&gt;&gt;You equip your $feet. $currentweapon.description  &lt;&lt;set $e = 0&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if ($currentweapon.name eq &quot;No Helm&quot;) and ($gender eq &quot;female&quot;) and ($i eq 1)&gt;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt; &lt;img src=&quot;Images/Character/paladin4.jpg&quot; width=200 /&gt; &lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt; &lt;img src=&quot;Images/Character/soldier4.jpg&quot; width=200 /&gt; &lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt; &lt;img src=&quot;Images/Character/rogue4.jpg&quot; width=200 /&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;elseif $i eq 1&gt;&gt;&lt;&lt;ArmorImage $currentweapon.name 350&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt;&lt;&lt;/if&gt;&gt;

[[Return-&gt;Cabin]] 

&lt;table class=&quot;armory-table&quot;&gt;
  &lt;tr&gt;
    &lt;th&gt;Helms&lt;/th&gt;
    &lt;th&gt;Chest Pieces&lt;/th&gt;
	&lt;th&gt;Gloves&lt;/th&gt;
    &lt;th&gt;Leg Guards&lt;/th&gt;
	&lt;th&gt;Boots&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;\
	&lt;&lt;for _a to 0; _a lt $headinventory.length; _a++&gt;&gt;
&lt;&lt;print _a + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $headinventory[_a].name&gt;&gt;&lt;/b&gt; 
&lt;&lt;hovertip &#96; &#39;$headinventory[_a].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt; &lt;&lt;hovertip &#96; &#39;&lt;&lt;ArmorImage $headinventory[_a].name 200&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt;&#39;&#96;&gt;&gt;pic&lt;&lt;/hovertip&gt;&gt;
Strength: &lt;&lt;print $headinventory[_a].strength&gt;&gt;
Agility: &lt;&lt;print $headinventory[_a].agility&gt;&gt;
Willpower: &lt;&lt;print $headinventory[_a].willpower&gt;&gt;
Armor: &lt;&lt;print $headinventory[_a].armor&gt;&gt;
&lt;&lt;capture _a&gt;&gt;\
		[[Equip-&gt;Armory][$currentweapon.name = $headinventory[_a].name, $currentweapon.strength = $headinventory[_a].strength, $currentweapon.agility = $headinventory[_a].agility, $currentweapon.willpower = $headinventory[_a].willpower, $currentweapon.armor = $headinventory[_a].armor, $currentweapon.ability = $headinventory[_a].ability, $currentweapon.description = $headinventory[_a].description, $a = 1, $f = 1]]
	&lt;&lt;/capture&gt;&gt;\
	&lt;&lt;/for&gt;&gt;\
	&lt;/td&gt;\
    &lt;td&gt;\
	&lt;&lt;for _b to 0; _b lt $chestinventory.length; _b++&gt;&gt;
&lt;&lt;print _b + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $chestinventory[_b].name&gt;&gt; &lt;/b&gt; 
&lt;&lt;hovertip &#96;&#39;$chestinventory[_b].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt; &lt;&lt;hovertip &#96; &#39;&lt;&lt;ArmorImage $chestinventory[_b].name 200&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt;&#39;&#96;&gt;&gt;pic&lt;&lt;/hovertip&gt;&gt;
Strength: &lt;&lt;print $chestinventory[_b].strength&gt;&gt;
Agility: &lt;&lt;print $chestinventory[_b].agility&gt;&gt;
Willpower: &lt;&lt;print $chestinventory[_b].willpower&gt;&gt;
Armor: &lt;&lt;print $chestinventory[_b].armor&gt;&gt;
&lt;&lt;capture _b&gt;&gt;\
		[[Equip-&gt;Armory][$currentweapon.name = $chestinventory[_b].name, $currentweapon.strength = $chestinventory[_b].strength, $currentweapon.agility = $chestinventory[_b].agility, $currentweapon.willpower = $chestinventory[_b].willpower, $currentweapon.armor = $chestinventory[_b].armor, $currentweapon.ability = $chestinventory[_b].ability, $currentweapon.description = $chestinventory[_b].description, $b = 1, $f = 1]]
	&lt;&lt;/capture&gt;&gt;\
	&lt;&lt;/for&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;\
	&lt;&lt;for _c to 0; _c lt $handsinventory.length; _c++&gt;&gt;
&lt;&lt;print _c + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $handsinventory[_c].name&gt;&gt;&lt;/b&gt; 
&lt;&lt;hovertip &#96;&#39;$handsinventory[_c].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt; &lt;&lt;hovertip &#96; &#39;&lt;&lt;ArmorImage $handsinventory[_c].name 200&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt;&#39;&#96;&gt;&gt;pic&lt;&lt;/hovertip&gt;&gt;
Strength: &lt;&lt;print $handsinventory[_c].strength&gt;&gt;
Agility: &lt;&lt;print $handsinventory[_c].agility&gt;&gt;
Willpower: &lt;&lt;print $handsinventory[_c].willpower&gt;&gt;
Armor: &lt;&lt;print $handsinventory[_c].armor&gt;&gt;
&lt;&lt;capture _c&gt;&gt;\
		[[Equip-&gt;Armory][$currentweapon.name = $handsinventory[_c].name, $currentweapon.strength = $handsinventory[_c].strength, $currentweapon.agility = $handsinventory[_c].agility, $currentweapon.willpower = $handsinventory[_c].willpower, $currentweapon.armor = $handsinventory[_c].armor, $currentweapon.ability = $handsinventory[_c].ability, $currentweapon.description = $handsinventory[_c].description, $c = 1, $f = 1]]
	&lt;&lt;/capture&gt;&gt;\
	&lt;&lt;/for&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;\
	&lt;&lt;for _d to 0; _d lt $legsinventory.length; _d++&gt;&gt;
&lt;&lt;print _d + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $legsinventory[_d].name&gt;&gt; &lt;/b&gt; 
&lt;&lt;hovertip &#96;&#39;$legsinventory[_d].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt; &lt;&lt;hovertip &#96; &#39;&lt;&lt;ArmorImage $legsinventory[_d].name 200&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt;&#39;&#96;&gt;&gt;pic&lt;&lt;/hovertip&gt;&gt;
Strength: &lt;&lt;print $legsinventory[_d].strength&gt;&gt;
Agility: &lt;&lt;print $legsinventory[_d].agility&gt;&gt;
Willpower: &lt;&lt;print $legsinventory[_d].willpower&gt;&gt;
Armor: &lt;&lt;print $legsinventory[_d].armor&gt;&gt;
&lt;&lt;capture _d&gt;&gt;\
		[[Equip-&gt;Armory][$currentweapon.name = $legsinventory[_d].name, $currentweapon.strength = $legsinventory[_d].strength, $currentweapon.agility = $legsinventory[_d].agility, $currentweapon.willpower = $legsinventory[_d].willpower, $currentweapon.armor = $legsinventory[_d].armor, $currentweapon.ability = $legsinventory[_d].ability, $currentweapon.description = $legsinventory[_d].description, $d = 1, $f = 1]]
	&lt;&lt;/capture&gt;&gt;\
	&lt;&lt;/for&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;\
	&lt;&lt;for _e to 0; _e lt $feetinventory.length; _e++&gt;&gt;
&lt;&lt;print _e + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $feetinventory[_e].name&gt;&gt; &lt;/b&gt; 
&lt;&lt;hovertip &#96;&#39;$feetinventory[_e].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt; &lt;&lt;hovertip &#96; &#39;&lt;&lt;ArmorImage $feetinventory[_e].name 200&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt;&#39;&#96;&gt;&gt;pic&lt;&lt;/hovertip&gt;&gt;
Strength: &lt;&lt;print $feetinventory[_e].strength&gt;&gt;
Agility: &lt;&lt;print $feetinventory[_e].agility&gt;&gt;
Willpower: &lt;&lt;print $feetinventory[_e].willpower&gt;&gt;
Armor: &lt;&lt;print $feetinventory[_e].armor&gt;&gt;
&lt;&lt;capture _e&gt;&gt;\
		[[Equip-&gt;Armory][$currentweapon.name = $feetinventory[_e].name, $currentweapon.strength = $feetinventory[_e].strength, $currentweapon.agility = $feetinventory[_e].agility, $currentweapon.willpower = $feetinventory[_e].willpower, $currentweapon.armor = $feetinventory[_e].armor, $currentweapon.ability = $feetinventory[_e].ability, $currentweapon.description = $feetinventory[_e].description, $e = 1, $f = 1]]
	&lt;&lt;/capture&gt;&gt;\
	&lt;&lt;/for&gt;&gt;\
	&lt;/td&gt;\
  &lt;/tr&gt;\
&lt;/table&gt;\

&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;&lt;if ($head eq &quot;Helm of the Lightbringer&quot;) and ($chest eq &quot;Armor of the Lightbringer&quot;) and ($legs eq &quot;Greaves of the Lightbringer&quot;)&gt;&gt; &lt;&lt;set $setbonus = 1&gt;&gt;
&lt;&lt;else&gt;&gt; &lt;&lt;set $setbonus = 0&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt;&lt;&lt;if ($head eq &quot;Hood of the Trickster&quot;) and ($hands eq &quot;Grip of the Trickster&quot;) and ($feet eq &quot;Boots of the Trickster&quot;)&gt;&gt; &lt;&lt;set $setbonus = 2&gt;&gt;\
&lt;&lt;else&gt;&gt; &lt;&lt;set $setbonus = 0&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt;&lt;&lt;if ($chest eq &quot;Armor of the Victorious&quot;) and ($hands eq &quot;Gauntlets of the Victorious&quot;) and ($feet eq &quot;Boots of the Victorious&quot;)&gt;&gt; &lt;&lt;set $setbonus = 3&gt;&gt;\
&lt;&lt;else&gt;&gt; &lt;&lt;set $setbonus = 0&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;set $i = 1&gt;&gt;\
  \
  \
  \
  \</tw-passagedata><tw-passagedata pid="8" name="Weapon Vault" tags="" position="399,664" size="100,100">&lt;&lt;nobr&gt;&gt;

&lt;&lt;if $i neq 0&gt;&gt;
&lt;&lt;set $weapon = $currentweapon.name&gt;&gt;
&lt;&lt;set $weaponstrength = $currentweapon.strength&gt;&gt;
&lt;&lt;set $weaponagility = $currentweapon.agility&gt;&gt;
&lt;&lt;set $weaponwillpower = $currentweapon.willpower&gt;&gt;
&lt;&lt;set $weaponarmor = $currentweapon.armor&gt;&gt;
&lt;&lt;set $mindamage = $currentweapon.mindamage&gt;&gt;
&lt;&lt;set $maxdamage = $currentweapon.maxdamage&gt;&gt;
&lt;&lt;set $weaponability = $currentweapon.ability&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;
\
\
\
You are in your Weapon Vault. Here, you can equip new weapons you find in the woods.

&lt;&lt;if $i neq 0&gt;&gt;$currentweapon.description  
&lt;&lt;WeaponImage $currentweapon.name 350&gt;&gt;&lt;&lt;/WeaponImage&gt;&gt; &lt;&lt;/if&gt;&gt;

[[Return-&gt;Cabin][$i = 0]] 

&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $weaponinventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:80%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $weaponinventory[_i].name&gt;&gt;&lt;/b&gt; &lt;&lt;hovertip &#96;&#39;$weaponinventory[_i].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt; 
	Strength: &lt;&lt;print $weaponinventory[_i].strength&gt;&gt;
	Agility: &lt;&lt;print $weaponinventory[_i].agility&gt;&gt;
	Willpower: &lt;&lt;print $weaponinventory[_i].willpower&gt;&gt;
	Armor: &lt;&lt;print $weaponinventory[_i].armor&gt;&gt;
	Damage: &lt;&lt;print $weaponinventory[_i].mindamage&gt;&gt; - &lt;&lt;print $weaponinventory[_i].maxdamage&gt;&gt;
&lt;&lt;capture _i&gt;&gt;
		[[Equip-&gt;Weapon Vault][$currentweapon.name = $weaponinventory[_i].name, $currentweapon.strength = $weaponinventory[_i].strength, $currentweapon.agility = $weaponinventory[_i].agility, $currentweapon.willpower = $weaponinventory[_i].willpower, $currentweapon.armor = $weaponinventory[_i].armor, $currentweapon.description = $weaponinventory[_i].description, $currentweapon.mindamage = $weaponinventory[_i].mindamage, $currentweapon.maxdamage = $weaponinventory[_i].maxdamage, $currentweapon.ability = $weaponinventory[_i].ability, $i = 1]]
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;WeaponImage $weaponinventory[_i].name 200&gt;&gt;&lt;&lt;/WeaponImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;
&lt;/table&gt;\







</tw-passagedata><tw-passagedata pid="9" name="Outside the Cabin" tags="" position="596,186" size="100,100">You arrive at the clearing just outside your cabin. &lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;From here, you can stage your daily foray into the woods.&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;There is still some light in the sky. Perhaps time for one more foray.&lt;&lt;else&gt;&gt; The hour is late. It&#39;s past time to seek the refuge of your hearth, eat a hearty meal, and lie low until dawn.&lt;&lt;/if&gt;&gt;
&lt;&lt;if $time eq &quot;Night&quot;&gt;&gt;&lt;img src=&quot;Images/Locations/cabin1.jpg&quot; width=600 /&gt;
 &lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Locations/cabin4.jpg&quot; width=600 /&gt; &lt;&lt;/if&gt;&gt;
 
 &lt;table class=&quot;stat-table&quot;&gt;\
	&lt;tr&gt;\
		&lt;th&gt;Local Actions&lt;/th&gt;\
		&lt;th&gt;Deep Woods Areas&lt;/th&gt;\
	&lt;/tr&gt;\
	&lt;tr&gt;\
		&lt;td&gt;\
			[[Enter your cabin-&gt;Cabin]]
			&lt;&lt;if ($outskirtsquest eq 3) and ($time eq &quot;Night&quot;)&gt;&gt;&lt;i&gt;It is too late to build the shrine tonight. Try again tomorrow morning.&lt;/i&gt;&lt;&lt;elseif ($outskirtsquest eq 3)&gt;&gt;[[Build the shrine-&gt;ShrineBuild]] &lt;&lt;elseif $outskirtsquest gte 4&gt;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;[[Visit the shrine-&gt;PaladinShrine]]&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;[[Visit the shrine-&gt;SoldierShrine]]&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;[[Visit the shrine-&gt;RogueShrine]] &lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $merchantstatus gte 1&gt;&gt; [[Visit Babar&#39;s Shop-&gt;Merchant1]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $witchstatus eq 1&gt;&gt; [[Visit Scyllia-&gt;Witch2]]&lt;&lt;elseif $witchstatus eq 2&gt;&gt;[[Visit Scyllia-&gt;Witch3]]&lt;&lt;elseif $witchstatus eq 4&gt;&gt;[[Visit Scyllia-&gt;Witch4]]&lt;&lt;elseif ($witchstatus gte 5) and ($witchlives eq 1)&gt;&gt;[[Visit Scyllia-&gt;Witch5]]&lt;&lt;elseif ($witchstatus gte 5) and ($witchlives eq 0)&gt;&gt;[[Visit Scyllia&#39;s Grave-&gt;Witch6]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $nayastatus eq 10&gt;&gt;[[Visit Naya-&gt;Naya1]]&lt;&lt;elseif $nayastatus gte 20&gt;&gt;[[Visit Naya-&gt;Naya3]]&lt;&lt;elseif ($lewdmode eq 1) and ($nayalove eq 16) and ($gender eq &quot;male&quot;) and ($frozenquest lte 9) and ($time eq &quot;Night&quot;)&gt;&gt;[[You hear strange noises coming from Naya&#39;s tree-&gt;Naya Lewd][$p = 16]]&lt;&lt;elseif $nayastatus gte 11&gt;&gt;[[Visit Naya-&gt;Naya2]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
		&lt;td&gt;\
&lt;&lt;if $time eq &quot;Night&quot;&gt;&gt;&lt;i&gt;It is too late to foray into the Deep Woods. Best to head into the cabin and rest.&lt;/i&gt;&lt;&lt;else&gt;&gt;\
[[Explore the Outskirts-&gt;Outskirts Entry]]
&lt;&lt;if $outskirtsquest gte 16&gt;&gt;[[Explore the Scarlet Vale-&gt;Scarlet Vale Entry]]&lt;&lt;/if&gt;&gt;
&lt;&lt;if $frozenquest gte 1&gt;&gt;[[Explore the Frozen Hills-&gt;Frozen Hills Entry]]&lt;&lt;/if&gt;&gt;
&lt;&lt;if $finalquest gte 1&gt;&gt;[[Explore the Heart of Darkness-&gt;Dark Heart Entry]]&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
	&lt;/tr&gt;\
&lt;/table&gt;\
\
&lt;&lt;set $p = 0&gt;&gt;\
\
&lt;&lt;if ($time eq &quot;Night&quot;) and ($music neq &quot;night&quot;)&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;cabinnight_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $finalquest eq 0&gt;&gt;&lt;&lt;HintRead&gt;&gt;&lt;&lt;elseif $finalquest gte 1&gt;&gt;&lt;&lt;if $countdown gte 2&gt;&gt;&lt;i&gt;There are &lt;b&gt;$countdown&lt;/b&gt; days left until the Dark Portal opens.&lt;/i&gt;&lt;&lt;elseif $countdown eq 1&gt;&gt;&lt;i&gt;The Dark Portal will open tomorrow. You are almost out of time.&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;i&gt;The Dark Portal will open tonight. This is your final chance to save the world.&lt;/i&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if ($finalquest eq 10) and ($blackbastion eq 10) and ($weepingtower eq 10)&gt;&gt; &lt;&lt;set $finalquest = 11&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
\
\
\</tw-passagedata><tw-passagedata pid="10" name="Sleep" tags="" position="405,1163" size="100,100">&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;After a brief prayer to the Gods,&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;After sharpening your weapons and polishing your armor,&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;After carefully preparing your poisons,&lt;&lt;/if&gt;&gt; you crawl into your bedding for a short rest.
&lt;&lt;set $randomset = [1, 2, 3]&gt;&gt;\
&lt;&lt;set $random = $randomset.pluck()&gt;&gt;\
\
&lt;&lt;if $random eq 1&gt;&gt;&lt;img src=&quot;Images/Locations/night1.jpg&quot; width=600 /&gt;\
&lt;&lt;elseif $random eq 2&gt;&gt;&lt;img src=&quot;Images/Locations/night4.jpg&quot; width=600 /&gt;\
&lt;&lt;elseif $random eq 3&gt;&gt;&lt;img src=&quot;Images/Locations/night5.jpg&quot; width=600 /&gt;\
&lt;&lt;/if&gt;&gt;\

Outside, wolves howl, and hidden things scuttle in the dark. &lt;&lt;if $finalquest gte 1&gt;&gt;You fall into a deep sleep, the day&#39;s trials fading away as you slumber.&lt;&lt;else&gt;&gt;Wary of a nighttime attack, you do not fall fully asleep, but instead drop into a healing, meditative state.&lt;&lt;/if&gt;&gt;

&lt;&lt;if $finalquest eq 8&gt;&gt;[[Rest-&gt;Gatekeeper][$p = 30]]&lt;&lt;elseif ($lewdmode eq 1) and ($chestlewd eq 2) and ($penis eq 2) and ($valequest gte 8)&gt;&gt;[[Rest-&gt;Chest Blessing][$p = 0]]&lt;&lt;elseif ($lewdmode eq 1) and ($pussy neq 4) and ($merchantlove lte 24) and ($merchantlove gte 10) and ($head eq &quot;Lovely Choker&quot;)&gt;&gt;[[Rest-&gt;Merchant Dream][$p = 0]]&lt;&lt;elseif ($lewdmode eq 1) and ($nayalove eq 20) and ($frozenquest eq 9)&gt;&gt;[[Something wakes you in the middle of the night-&gt;Naya Lewd][$p = 29]]&lt;&lt;elseif ($fem eq 5) and ($pussy eq 4) and ($witchlove lt 11)&gt;&gt;[[Rest-&gt;Witch Lewd][$p = 6]]&lt;&lt;elseif ($witchlove eq 11) and ($witchawareness eq 1) and ($lewdshrine eq 3)&gt;&gt;[[Rest-&gt;Witch Lewd][$p = 14]]&lt;&lt;elseif ($witchlove eq 13) and ($frozenquest gte 5)&gt;&gt;[[Rest-&gt;Witch Lewd][$p = 26]]&lt;&lt;else&gt;&gt;[[Rest-&gt;Morning]]&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $witchlove eq 15&gt;&gt; &lt;&lt;set $witchlove = 16&gt;&gt; &lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="11" name="Global Widgets" tags="nobr widget" position="201,389" size="100,100">DIALOGUE WIDGETS

&lt;&lt;widget &quot;HeroTalk&quot;&gt;&gt;
	&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;table class=&quot;hero-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;$name $title&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;img src=&quot;Images/Character/paladin2.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;&lt;img src=&quot;Images/Character/soldier2.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;img src=&quot;Images/Character/rogue2.jpg&quot; width=150 /&gt;&lt;&lt;/if&gt;&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($gender eq &quot;female&quot;) and ($lewdmode eq 0)&gt;&gt;&lt;table class=&quot;herogirl-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;$name $title&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;img src=&quot;Images/Character/paladin4.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;&lt;img src=&quot;Images/Character/soldier4.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;img src=&quot;Images/Character/rogue4.jpg&quot; width=150 /&gt;&lt;&lt;/if&gt;&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($gender eq &quot;female&quot;) and ($lewdmode eq 1)&gt;&gt;&lt;table class=&quot;herogirl-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;$name $title&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;img src=&quot;Images/Character/paladin6.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;&lt;img src=&quot;Images/Character/soldier6.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;img src=&quot;Images/Character/rogue6.jpg&quot; width=150 /&gt;&lt;&lt;/if&gt;&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;OldHeroTalk&quot;&gt;&gt;
	&lt;&lt;if $fem eq 1&gt;&gt;&lt;table class=&quot;hero-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;$startingname $startingtitle&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;img src=&quot;Images/Character/paladin2.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;&lt;img src=&quot;Images/Character/soldier2.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;img src=&quot;Images/Character/rogue2.jpg&quot; width=150 /&gt;&lt;&lt;/if&gt;&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($fem eq 5) and ($lewdmode eq 0)&gt;&gt;&lt;table class=&quot;herogirl-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;$startingname $startingtitle&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;img src=&quot;Images/Character/paladin4.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;&lt;img src=&quot;Images/Character/soldier4.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;img src=&quot;Images/Character/rogue4.jpg&quot; width=150 /&gt;&lt;&lt;/if&gt;&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($fem eq 5) and ($lewdmode eq 1)&gt;&gt;&lt;table class=&quot;herogirl-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;$startingname $startingtitle&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;img src=&quot;Images/Character/paladin6.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;&lt;img src=&quot;Images/Character/soldier6.jpg&quot; width=150 /&gt;&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;img src=&quot;Images/Character/rogue6.jpg&quot; width=150 /&gt;&lt;&lt;/if&gt;&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;



&lt;&lt;widget &quot;Alistair1Talk&quot;&gt;&gt;
	&lt;table class=&quot;stat-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;???&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/alistair2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Alistair2Talk&quot;&gt;&gt;
	&lt;table class=&quot;stat-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Alistair, the Red Butcher&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/alistair2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;BloodGolemTalk&quot;&gt;&gt;
	&lt;table class=&quot;plant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Blood Golem&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/golem2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;BoneGolemTalk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Bone Golem&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/golem4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;CountTalk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Count Barsenes&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/count2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ElvenGhostTalk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Elven Ghost&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/ghost2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ElvenLadyGhostTalk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Dancing Ghost&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/ghost4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GhorokTalk&quot;&gt;&gt;
	&lt;table class=&quot;gresh-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Ghorok, the Berserker&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/ghorok2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Ghorok2Talk&quot;&gt;&gt;
	&lt;table class=&quot;gresh-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Ghorok, the Goblin King&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/ghorok2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GreshTalk&quot;&gt;&gt;
	&lt;table class=&quot;gresh-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Gresh, the Goblin King&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/gresh2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GuardianTalk&quot;&gt;&gt;
	&lt;table class=&quot;gresh-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Guardian of the Spring&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/spring8.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GoblinTalk&quot;&gt;&gt;
	&lt;table class=&quot;goblin-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Goblin&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/goblin2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GoblinWhoreTalk&quot;&gt;&gt;
	&lt;table class=&quot;goblin-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Goblin Whore&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Other/goblin3.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GoblinAlchemistTalk&quot;&gt;&gt;
	&lt;table class=&quot;goblin-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Goblin Alchemist&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/goblin8.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GoblinArcherTalk&quot;&gt;&gt;
	&lt;table class=&quot;goblin-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Goblin Archer&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/goblin4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GoblinBruiserTalk&quot;&gt;&gt;
	&lt;table class=&quot;goblin-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Goblin Bruiser&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/goblin6.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;HestusTalk&quot;&gt;&gt;
	&lt;table class=&quot;stat-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Fragment of Hestus&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/hestus2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;KingTalk&quot;&gt;&gt;
	&lt;table class=&quot;king-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;The King&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/king2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;KrakenTalk&quot;&gt;&gt;
	&lt;table class=&quot;water-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Krakenspawn&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/krakenspawn2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;TylaeTalk&quot;&gt;&gt;
	&lt;table class=&quot;king-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Tylae, the Mother Goddess&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Locations/tylae2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;LilithTalk&quot;&gt;&gt;
	&lt;table class=&quot;fire-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Lilith, Goddess of Desire&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Other/lilith2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ZaphiaTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Zaphia, the Hell Slut&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Other/demon4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Disciple1Talk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Young Priestess&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Other/zending14.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Disciple2Talk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;New Priestess&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Other/zending15.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Lich1Talk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;???&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/lich2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Lich2Talk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/lich4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Lich3Talk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Carnax, the Dread Lich&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/lich2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;MessengerTalk&quot;&gt;&gt;
	&lt;table class=&quot;king-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Brunhilde, the King&#39;s Messenger&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/messenger2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;MinotaurTalk&quot;&gt;&gt;
	&lt;table class=&quot;plant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Bloodied Minotaur&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/minotaur2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;KarhanTalk&quot;&gt;&gt;
	&lt;table class=&quot;plant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Karhan the Great&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/minotaur4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;DomedraTalk&quot;&gt;&gt;
	&lt;table class=&quot;queen-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Queen Domedra of Netheryn&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/domedra2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Domedra2Talk&quot;&gt;&gt;
	&lt;table class=&quot;queen-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Domedra, the Mad Queen&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/domedra4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SkeletalSoldierTalk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Skeletal Soldier&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/dead6.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SkeletalArcherTalk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Skeletal Archer&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/dead2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SkeletalKnightTalk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Skeletal Knight&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/dead4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SkeletalMageTalk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Skeletal Mage&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/dead8.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SkeletalDragonTalk&quot;&gt;&gt;
	&lt;table class=&quot;dead-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Nivraxus, the Enslaved&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/dragon8.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ScarletDestroyerTalk&quot;&gt;&gt;
	&lt;table class=&quot;plant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Scarlet Destroyer&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/plant2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ScarletAmbusherTalk&quot;&gt;&gt;
	&lt;table class=&quot;plant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Scarlet Ambusher&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/plant4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;NymphTalk&quot;&gt;&gt;
	&lt;table class=&quot;plant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Forest Nymph&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/nymph2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ShadowNymphTalk&quot;&gt;&gt;
	&lt;table class=&quot;shadow-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Shadow Nymph&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/nymph4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ScarletGuardianTalk&quot;&gt;&gt;
	&lt;table class=&quot;plant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Scarlet Guardian&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/plant6.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ScarletBloodletterTalk&quot;&gt;&gt;
	&lt;table class=&quot;plant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Scarlet Bloodletter&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/plant8.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;DomitusTalk&quot;&gt;&gt;
	&lt;table class=&quot;deathguard-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/deathguard2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;DeathguardTalk&quot;&gt;&gt;
	&lt;table class=&quot;deathguard-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Deathguard Soldier&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/deathguard4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;BoarTalk&quot;&gt;&gt;
	&lt;table class=&quot;boar-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Dire Boar&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/direboar2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;BearTalk&quot;&gt;&gt;
	&lt;table class=&quot;boar-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Dire Bear&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/direbear2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;MerchantTalk&quot;&gt;&gt;
	&lt;table class=&quot;merchant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/merchant4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;OriTalk&quot;&gt;&gt;
	&lt;table class=&quot;ori-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Oriazus the Resplendent&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/ori2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;AvatarTalk&quot;&gt;&gt;
	&lt;table class=&quot;ori-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Fragment of Iulius&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/avatar2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;NayaTalk&quot;&gt;&gt;
	&lt;table class=&quot;naya-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/naya2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Naya2Talk&quot;&gt;&gt;
	&lt;table class=&quot;naya-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Queen Naya of Netheryn&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Epilogue/naya2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Redeemer1Talk&quot;&gt;&gt;
	&lt;table class=&quot;redeemer-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;???&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/redeemer2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Redeemer2Talk&quot;&gt;&gt;
	&lt;table class=&quot;redeemer-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/redeemer2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Redeemer3Talk&quot;&gt;&gt;
	&lt;table class=&quot;redeemer-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/nendel2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Redeemer4Talk&quot;&gt;&gt;
	&lt;table class=&quot;redeemer-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Nendel, the Dark Redeemer&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/redeemer3.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Ryz1Talk&quot;&gt;&gt;
	&lt;table class=&quot;water-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;???&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/ryz2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Ryz2Talk&quot;&gt;&gt;
	&lt;table class=&quot;water-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Ryz, the Arcane Observer&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/ryz2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;TrollTalk&quot;&gt;&gt;
	&lt;table class=&quot;boar-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Troll&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/troll2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;FrostTrollTalk&quot;&gt;&gt;
	&lt;table class=&quot;boar-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Frost Troll&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/frosttroll2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SerpentTalk&quot;&gt;&gt;
	&lt;table class=&quot;boar-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Serpent of the Deeps&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/serpent2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidspawnTalk&quot;&gt;&gt;
	&lt;table class=&quot;shadow-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Voidspawn&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/voidspawn2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidSentinelTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Void Sentinel&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/void2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidGoblinTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Void Goblin&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/void4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidWarriorTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Void Warrior&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/void8.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidSlayerTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Void Slayer&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/void6.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GatekeeperTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;The Gatekeeper&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/greatvoid2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidColossusTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Void Colossus&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/greatvoid4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ZenatarTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Zenatar, the Void General&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/greatvoid6.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;XornTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Xorn, the Void Prophet&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/greatvoid8.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;JhuunTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Jhuun, the Void Blade&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/greatvoid10.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;TreasureTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Hungry Soul&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/misc20.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Treasure2Talk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Netheryn Merchant&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/misc22.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidTalk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Void, God of Destruction&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/voidgem2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Void2Talk&quot;&gt;&gt;
	&lt;table class=&quot;void-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Void, God of Destruction&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/DarkHeart/voidlord2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Witch2Talk&quot;&gt;&gt;
	&lt;table class=&quot;plant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Scyllia, the Undying&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/witch4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;WitchTalk&quot;&gt;&gt;
&lt;&lt;if $finalquest lt 8&gt;&gt;
	&lt;table class=&quot;plant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/witch2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
	&lt;&lt;else&gt;&gt;
		&lt;table class=&quot;plant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Scyllia, the Undying&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/witch4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;WolfTalk&quot;&gt;&gt;
	&lt;table class=&quot;boar-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Dire Wolf&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Outskirts/direwolf2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Water1Talk&quot;&gt;&gt;
	&lt;table class=&quot;water-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;???&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/elemental2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Water2Talk&quot;&gt;&gt;
	&lt;table class=&quot;water-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Water Elemental&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/elemental2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Zabil1Talk&quot;&gt;&gt;
	&lt;table class=&quot;merchant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Zabil the Betrayed&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/zabil3.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Zabil2Talk&quot;&gt;&gt;
	&lt;table class=&quot;merchant-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Zabil the Redeemed&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/Character/zabil4.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ZaradrasTalk&quot;&gt;&gt;
	&lt;table class=&quot;fire-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Zaradras, the Envious Flame&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/FrozenHills/dragon3.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Zyr1Talk&quot;&gt;&gt;
	&lt;table class=&quot;water-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;???&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/zyr2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Zyr2Talk&quot;&gt;&gt;
	&lt;table class=&quot;water-table&quot;&gt;
		 &lt;tr&gt;
    		&lt;th colspan=&quot;2&quot;&gt;&lt;b&gt;Zyr, the Arcane Librarian&lt;/b&gt;&lt;/th&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td style=&quot;width:10%&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;Images/ScarletVale/zyr2.jpg&quot; width=150 /&gt;&lt;/td&gt;
			&lt;td&gt;&quot;$args[0]&quot;&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;



COMBAT WIDGETS

&lt;&lt;widget &quot;EnemyBattleTable&quot;&gt;&gt;
	&lt;table class=&quot;armory-table&quot;&gt;
			&lt;tr&gt;&lt;b&gt;$enemyname&lt;/b&gt;&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;Health: $enemycurrenthealth / $enemymaxhealth&lt;/td&gt;
			&lt;td&gt;Agility: $enemyagility&lt;/td&gt;
			&lt;td&gt;Strength: $enemystrength&lt;/td&gt;
			&lt;td&gt;Armor: $enemyarmor&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
		&lt;td&gt;
		
		&lt;&lt;if $enemycurrenthealth eq $enemymaxhealth&gt;&gt;
		&lt;img src=&quot;Images/Icons/health10.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemycurrenthealth gte ($enemymaxhealth*0.9)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health9.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemycurrenthealth gte ($enemymaxhealth*0.8)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health8.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemycurrenthealth gte ($enemymaxhealth*0.7)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health7.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemycurrenthealth gte ($enemymaxhealth*0.6)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health6.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemycurrenthealth gte ($enemymaxhealth*0.5)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health5.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemycurrenthealth gte ($enemymaxhealth*0.4)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health4.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemycurrenthealth gte ($enemymaxhealth*0.3)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health3.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemycurrenthealth gte ($enemymaxhealth*0.2)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health2.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemycurrenthealth gte ($enemymaxhealth*0.1)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health1.png&quot; width=200 /&gt;
		
		&lt;&lt;else&gt;&gt;
		&lt;img src=&quot;Images/Icons/health0.png&quot; width=200 /&gt;
		
		&lt;&lt;/if&gt;&gt;  
		&lt;/td&gt;
		&lt;td&gt; Base Evasion: $enemybaseevade &lt;/td&gt;
		&lt;td&gt; Willpower: $enemywillpower &lt;/td&gt;
		&lt;td&gt; Stun: $enemystuncount / $enemystunlimit &lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;AllyBattleTable&quot;&gt;&gt;
	&lt;table class=&quot;armory-table&quot;&gt;
		&lt;tr&gt;&lt;b&gt;$allyname&lt;/b&gt;&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;Health: $allycurrenthealth / $allymaxhealth&lt;/td&gt;
			&lt;td&gt;Agility: $allyagility&lt;/td&gt;
			&lt;td&gt;Strength: $allystrength&lt;/td&gt;
			&lt;td&gt;Armor: $allyarmor&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
		&lt;td&gt;
		
		&lt;&lt;if $allycurrenthealth eq $allymaxhealth&gt;&gt;
		&lt;img src=&quot;Images/Icons/health10.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $allycurrenthealth gte ($allymaxhealth*0.9)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health9.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $allycurrenthealth gte ($allymaxhealth*0.8)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health8.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $allycurrenthealth gte ($allymaxhealth*0.7)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health7.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $allycurrenthealth gte ($allymaxhealth*0.6)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health6.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $allycurrenthealth gte ($allymaxhealth*0.5)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health5.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $allycurrenthealth gte ($allymaxhealth*0.4)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health4.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $allycurrenthealth gte ($allymaxhealth*0.3)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health3.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $allycurrenthealth gte ($allymaxhealth*0.2)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health2.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $allycurrenthealth gte ($allymaxhealth*0.1)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health1.png&quot; width=200 /&gt;
		
		&lt;&lt;else&gt;&gt;
		&lt;img src=&quot;Images/Icons/health0.png&quot; width=200 /&gt;
		
		&lt;&lt;/if&gt;&gt;  
		&lt;/td&gt;
		&lt;td&gt; Base Evasion: $allybaseevade &lt;/td&gt;
		&lt;td&gt; Willpower: $allywillpower &lt;/td&gt;
		&lt;td&gt; &lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;EnemyAllyBattleTable&quot;&gt;&gt;
	&lt;table class=&quot;armory-table&quot;&gt;
		&lt;tr&gt;&lt;b&gt;$enemyallyname&lt;/b&gt;&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;Health: $enemyallycurrenthealth / $enemyallymaxhealth&lt;/td&gt;
			&lt;td&gt;Agility: $enemyallyagility&lt;/td&gt;
			&lt;td&gt;Strength: $enemyallystrength&lt;/td&gt;
			&lt;td&gt;Armor: $enemyallyarmor&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
		&lt;td&gt;
		
		&lt;&lt;if $enemyallycurrenthealth eq $enemyallymaxhealth&gt;&gt;
		&lt;img src=&quot;Images/Icons/health10.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemyallycurrenthealth gte ($enemyallymaxhealth*0.9)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health9.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemyallycurrenthealth gte ($enemyallymaxhealth*0.8)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health8.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemyallycurrenthealth gte ($enemyallymaxhealth*0.7)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health7.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemyallycurrenthealth gte ($enemyallymaxhealth*0.6)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health6.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemyallycurrenthealth gte ($enemyallymaxhealth*0.5)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health5.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemyallycurrenthealth gte ($enemyallymaxhealth*0.4)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health4.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemyallycurrenthealth gte ($enemyallymaxhealth*0.3)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health3.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemyallycurrenthealth gte ($enemyallymaxhealth*0.2)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health2.png&quot; width=200 /&gt;
		
		&lt;&lt;elseif $enemyallycurrenthealth gte ($enemyallymaxhealth*0.1)&gt;&gt;
		&lt;img src=&quot;Images/Icons/health1.png&quot; width=200 /&gt;
		
		&lt;&lt;else&gt;&gt;
		&lt;img src=&quot;Images/Icons/health0.png&quot; width=200 /&gt;
		
		&lt;&lt;/if&gt;&gt;  
		&lt;/td&gt;
		&lt;td&gt; Base Evasion: $enemyallybaseevade &lt;/td&gt;
		&lt;td&gt; Willpower: $enemyallywillpower &lt;/td&gt;
		&lt;td&gt; &lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;AttackAttempt&quot;&gt;&gt;
&lt;&lt;set $attackroll = random(1,100)&gt;&gt;
&lt;&lt;set $attackrolltotal = $attackroll + $strength + $agility&gt;&gt;
You rolled $attackroll, which then added to your strength ($strength) and agility ($agility) for an attack roll total of $attackrolltotal &lt;br&gt;
&lt;&lt;if $attackrolltotal gte $enemyevadescore&gt;&gt;Your attack roll total ($attackrolltotal) is greater than your enemy&#39;s evade score ($enemyevadescore) - you hit the $enemyname &lt;&lt;set $action = &quot;attack success&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt; Your attack roll total ($attackrolltotal) is less than your enemy&#39;s evade score ($enemyevadescore) - you miss the $enemyname &lt;&lt;set $action = &quot;attack failure&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;AttackDamage&quot;&gt;&gt;
&lt;&lt;set $damageroll = random($mindamage,$maxdamage)&gt;&gt;
&lt;&lt;set $damagerolltotal = $damageroll + ($strength/2)&gt;&gt;
You rolled $damageroll, which then added to your half your strength ($strength) for a damage roll total of $damagerolltotal &lt;br&gt;
&lt;&lt;set $damagetoenemy = $damagerolltotal - $enemyarmor&gt;&gt;
&lt;&lt;if $damagetoenemy lt 0&gt;&gt; &lt;&lt;set $damagetoenemy = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
The armor of the $enemyname blocked $enemyarmor damage - you deal a total of $damagetoenemy damage to the $enemyname! &lt;br&gt;
&lt;&lt;set $enemycurrenthealth -= $damagetoenemy&gt;&gt;
&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt;&lt;&lt;set $soldiermanaadd = random($mindamage,$maxdamage)*($basestrength)*0.05&gt;&gt;
&lt;&lt;set $soldiermanaadd = Math.round($soldiermanaadd)&gt;&gt;
You gain $soldiermanaadd mana!&lt;br&gt;
&lt;&lt;set $currentmana += $soldiermanaadd&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;AllyAttackAttempt&quot;&gt;&gt;
&lt;&lt;set $attackroll = random(1,100)&gt;&gt;
&lt;&lt;set $attackrolltotal = $attackroll + $allystrength + $allyagility&gt;&gt;
$allyname rolled $attackroll, which then added to $allyname&#39;s strength ($allystrength) and agility ($allyagility) for an attack roll total of $attackrolltotal &lt;br&gt;
&lt;&lt;if $attackrolltotal gte $enemyevadescore&gt;&gt;$allyname&#39;s attack roll total ($attackrolltotal) is greater than the enemy&#39;s evade score ($enemyevadescore) - $allyname hit $enemyname &lt;&lt;set $allyaction = &quot;attack success&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt; $allyname&#39;s attack roll total ($attackrolltotal) is less than the enemy&#39;s evade score ($enemyevadescore) - $allyname misses $enemyname &lt;&lt;set $allyaction = &quot;attack failure&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;AllyAttackDamage&quot;&gt;&gt;
&lt;&lt;set $damageroll = random($allymindamage,$allymaxdamage)&gt;&gt;
&lt;&lt;set $damagerolltotal = $damageroll + ($allystrength/2)&gt;&gt;
$allyname rolled $damageroll, which then added to your half of $allyname&#39;s strength ($allystrength) for a damage roll total of $damagerolltotal &lt;br&gt;
&lt;&lt;set $damagetoenemy = $damagerolltotal - $enemyarmor&gt;&gt;
&lt;&lt;if $damagetoenemy lt 0&gt;&gt; &lt;&lt;set $damagetoenemy = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
The armor of the $enemyname blocked $enemyarmor damage - $allyname deals a total of $damagetoenemy damage to the $enemyname! &lt;br&gt;
&lt;&lt;set $enemycurrenthealth -= $damagetoenemy&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;FleeAttempt&quot;&gt;&gt;
&lt;&lt;set $fleeroll = random(1,100)&gt;&gt;
&lt;&lt;set $fleerolltotal = $fleeroll + $agility&gt;&gt;
You rolled $fleeroll, which then added to your agility ($agility) for a flee roll total of $fleerolltotal &lt;br&gt;
&lt;&lt;if $fleerolltotal gte $enemyevadescore&gt;&gt;Your flee roll total ($fleerolltotal) is greater than your enemy&#39;s evade score ($enemyevadescore) - you escaped the $enemyname! &lt;&lt;set $action = &quot;flee success&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt; Your flee roll total ($fleerolltotal) is less than your enemy&#39;s evade score ($enemyevadescore) - you fail to escape the $enemyname &lt;&lt;set $action = &quot;flee failure&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;EnemyAttackAttempt&quot;&gt;&gt;
&lt;&lt;set $enemyattackroll = random(1,100)&gt;&gt;
&lt;&lt;set $enemyattackrolltotal = $enemyattackroll + $enemystrength + $enemyagility&gt;&gt;
The $enemyname rolled $enemyattackroll, which then added to its strength ($enemystrength) and agility ($enemyagility) for an attack roll total of $enemyattackrolltotal &lt;br&gt;
&lt;&lt;if $enemyattackrolltotal gte $evadescore&gt;&gt;The attack roll total of the $enemyname ($enemyattackrolltotal) is greater than your evade score ($evadescore) - you are hit by the $enemyname &lt;&lt;set $enemyaction = &quot;attack success&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt; The attack roll total of the $enemyname ($enemyattackrolltotal) is less than your evade score ($evadescore) - you dodge the attack! &lt;&lt;set $enemyaction = &quot;attack failure&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;EnemyAttackDamage&quot;&gt;&gt;
&lt;&lt;set $enemydamageroll = random($enemymindamage,$enemymaxdamage)&gt;&gt;
&lt;&lt;set $enemydamagerolltotal = $enemydamageroll + ($enemystrength/2)&gt;&gt;
The $enemyname rolled $enemydamageroll, which then added to half its strength ($enemystrength) for a damage roll total of $enemydamagerolltotal &lt;br&gt;
&lt;&lt;set $damagetoplayer = $enemydamagerolltotal - $armor&gt;&gt;
&lt;&lt;if $damagetoplayer lt 0&gt;&gt; &lt;&lt;set $damagetoplayer = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
Your armor blocked $armor damage - the $enemyname deals a total of $damagetoplayer damage to you! &lt;br&gt;
&lt;&lt;set $currenthealth -= $damagetoplayer&gt;&gt;
&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt;&lt;&lt;set $soldiermanaadd = ($damagetoplayer / 75)*($basestrength)&gt;&gt;
&lt;&lt;set $soldiermanaadd = Math.round($soldiermanaadd)&gt;&gt;
You gain $soldiermanaadd mana!&lt;br&gt;
&lt;&lt;set $currentmana += $soldiermanaadd&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ItemAbilityRun&quot;&gt;&gt;
&lt;&lt;set $itemabilityinventory = []&gt;&gt;
&lt;&lt;if ($headability eq 0) and ($chestability eq 0) and ($handsability eq 0) and ($legsability eq 0) and ($feetability eq 0) and ($weaponability eq 0)&gt;&gt;&lt;&lt;else&gt;&gt; 
&lt;&lt;if $headability neq 0&gt;&gt; &lt;&lt;set $itemabilityinventory.push($headability)&gt;&gt;&lt;&lt;/if&gt;&gt; 
&lt;&lt;if $chestability neq 0&gt;&gt; &lt;&lt;set $itemabilityinventory.push($chestability)&gt;&gt;&lt;&lt;/if&gt;&gt; 
&lt;&lt;if $handsability neq 0&gt;&gt; &lt;&lt;set $itemabilityinventory.push($handsability)&gt;&gt;&lt;&lt;/if&gt;&gt; 
&lt;&lt;if $legsability neq 0&gt;&gt; &lt;&lt;set $itemabilityinventory.push($legsability)&gt;&gt;&lt;&lt;/if&gt;&gt; 
&lt;&lt;if $feetability neq 0&gt;&gt; &lt;&lt;set $itemabilityinventory.push($feetability)&gt;&gt;&lt;&lt;/if&gt;&gt; 
&lt;&lt;if $weaponability neq 0&gt;&gt; &lt;&lt;set $itemabilityinventory.push($weaponability)&gt;&gt;&lt;&lt;/if&gt;&gt; 

&lt;&lt;for _i to 0; _i lt $itemabilityinventory.length; _i++&gt;&gt;
&lt;&lt;capture _i&gt;&gt;
&lt;&lt;ItemAbility $itemabilityinventory[_i]&gt;&gt;&lt;&lt;/ItemAbility&gt;&gt; &lt;br&gt;
&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ItemUse&quot;&gt;&gt;
&lt;&lt;set $currenthealth += $itemhealth&gt;&gt;
&lt;&lt;set $currentmana += $itemmana&gt;&gt;
&lt;&lt;set $specialstrength += $itemstrength&gt;&gt;
&lt;&lt;set $specialagility += $itemagility&gt;&gt;
&lt;&lt;set $specialwillpower += $itemwillpower&gt;&gt;
&lt;&lt;set $specialarmor += $itemarmor&gt;&gt;
&lt;&lt;set $specialevadescore += $itemevadescore&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;EnemyStun&quot;&gt;&gt;
&lt;&lt;if ($enemystun gte 1) and ($enemystuncount gte $enemystunlimit)&gt;&gt; $enemyname can no longer be stunned!
&lt;&lt;set $enemystun = 0&gt;&gt;
&lt;&lt;set $enemyaction = $enemyability.pluck()&gt;&gt;
&lt;&lt;set $enemyability.push($enemyaction)&gt;&gt;
&lt;&lt;elseif $enemystun gte 1&gt;&gt;
&lt;&lt;set $enemyaction = &quot;stun&quot;&gt;&gt;&lt;&lt;set $enemystun -= 1&gt;&gt;&lt;&lt;set $enemystuncount += 1&gt;&gt;The $enemyname is stunned, and cannot take action! &lt;&lt;if $enemystun eq 0&gt;&gt;The $enemyname is recovering from its stunned state and will take action next turn.&lt;&lt;else&gt;&gt;The $enemyname will still be stunned next turn, unless its stun limit has been reached.&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $enemyaction = $enemyability.pluck()&gt;&gt;
&lt;&lt;set $enemyability.push($enemyaction)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;BattleEnd&quot;&gt;&gt;
&lt;&lt;set $specialstrength = 0&gt;&gt;
&lt;&lt;set $specialagility = 0&gt;&gt;
&lt;&lt;set $specialwillpower = 0&gt;&gt;
&lt;&lt;set $specialarmor = 0&gt;&gt;
&lt;&lt;set $specialevadescore = 0&gt;&gt;
&lt;&lt;set $stun = 0&gt;&gt;
&lt;&lt;set $enemyname = &quot;0&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 0&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 0&gt;&gt;
&lt;&lt;set $enemystrength = 0&gt;&gt;
&lt;&lt;set $enemyagility = 0&gt;&gt;
&lt;&lt;set $enemywillpower = 0&gt;&gt;
&lt;&lt;set $enemybaseevade = 0&gt;&gt;
&lt;&lt;set $enemyevadescore = 0&gt;&gt;
&lt;&lt;set $enemyarmor = 0&gt;&gt;
&lt;&lt;set $enemymindamage = 0&gt;&gt;
&lt;&lt;set $enemymaxdamage = 0&gt;&gt;
&lt;&lt;set $enemystun = 0&gt;&gt;
&lt;&lt;set $enemymingold = 0&gt;&gt;
&lt;&lt;set $enemymaxgold = 0&gt;&gt;
&lt;&lt;set $enemyminexp = 0&gt;&gt;
&lt;&lt;set $enemymaxexp = 0&gt;&gt;
&lt;&lt;set $damagetoplayer = 0&gt;&gt;
&lt;&lt;set $enemyaction = &quot;none&quot;&gt;&gt;
&lt;&lt;set $allyname = &quot;0&quot;&gt;&gt;
&lt;&lt;set $allymaxhealth = 0&gt;&gt;
&lt;&lt;set $allycurrenthealth = 0&gt;&gt;
&lt;&lt;set $allystrength = 0&gt;&gt;
&lt;&lt;set $allyagility = 0&gt;&gt;
&lt;&lt;set $allywillpower = 0&gt;&gt;
&lt;&lt;set $allybaseevade = 0&gt;&gt;
&lt;&lt;set $allyevadescore = 0&gt;&gt;
&lt;&lt;set $allyarmor = 0&gt;&gt;
&lt;&lt;set $allymindamage = 0&gt;&gt;
&lt;&lt;set $allymaxdamage = 0&gt;&gt;
&lt;&lt;set $allystun = 0&gt;&gt;
&lt;&lt;set $allymingold = 0&gt;&gt;
&lt;&lt;set $allymaxgold = 0&gt;&gt;
&lt;&lt;set $allyminexp = 0&gt;&gt;
&lt;&lt;set $allymaxexp = 0&gt;&gt;
&lt;&lt;set $enemyallyname = &quot;0&quot;&gt;&gt;
&lt;&lt;set $enemyallymaxhealth = 0&gt;&gt;
&lt;&lt;set $enemyallycurrenthealth = 0&gt;&gt;
&lt;&lt;set $enemyallystrength = 0&gt;&gt;
&lt;&lt;set $enemyallyagility = 0&gt;&gt;
&lt;&lt;set $enemyallywillpower = 0&gt;&gt;
&lt;&lt;set $enemyallybaseevade = 0&gt;&gt;
&lt;&lt;set $enemyallyevadescore = $enemyallyagility + $enemyallybaseevade&gt;&gt;
&lt;&lt;set $enemyallyarmor = 0&gt;&gt;
&lt;&lt;set $enemyallymindamage = 0&gt;&gt;
&lt;&lt;set $enemyallymaxdamage = 0&gt;&gt;
&lt;&lt;set $enemyallymingold = 0&gt;&gt;
&lt;&lt;set $enemyallymaxgold = 0&gt;&gt;
&lt;&lt;set $enemyallyminexp = 0&gt;&gt;
&lt;&lt;set $enemyallymaxexp = 0&gt;&gt;
&lt;&lt;set $enemyallyregion = &quot;0&quot;&gt;&gt;
&lt;&lt;set $enemyallyimage = &quot;0&quot;&gt;&gt;
&lt;&lt;set $enemyallyability = []&gt;&gt;
&lt;&lt;set $enemyallyaction = &quot;none&quot;&gt;&gt;
&lt;&lt;set $allyaction = &quot;none&quot;&gt;&gt;
&lt;&lt;set $action = &quot;none&quot;&gt;&gt;
&lt;&lt;set $secondwinduse = 0&gt;&gt;
&lt;&lt;set $prayercount = 0&gt;&gt;
&lt;&lt;set $aura = 0&gt;&gt;
&lt;&lt;set $momentumcount = 0&gt;&gt;
&lt;&lt;set $momentumcheck = 0&gt;&gt;
&lt;&lt;if $class neq &quot;soldier&quot;&gt;&gt;&lt;&lt;set $currentmana = $maxmana&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt;&lt;&lt;set $currentmana = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $combatpoints = 0&gt;&gt;
&lt;&lt;set $abilitycount = []&gt;&gt;
&lt;&lt;set $itemabilitycount = []&gt;&gt;
&lt;&lt;set $itemability = 0&gt;&gt;
&lt;&lt;set $potioncount = 0&gt;&gt;
&lt;&lt;set $enemycombatpoints = 0&gt;&gt;
&lt;&lt;set $activeability = 0&gt;&gt;
&lt;&lt;set $enemyactiveability = 0&gt;&gt;
&lt;&lt;set $enemystuncount = 0&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;AgilityCheck&quot;&gt;&gt;
&lt;&lt;set $attackroll = random(1,100)&gt;&gt;
&lt;&lt;set $attackrolltotal = $attackroll + $agility&gt;&gt;
You rolled $attackroll, which then added to your agility ($agility) for a total of $attackrolltotal &lt;br&gt;
&lt;&lt;if $attackrolltotal gte $args[0]&gt;&gt;Your roll total ($attackrolltotal) is greater than the skill check difficulty ($args[0]) - success! &lt;&lt;set $action = &quot;success&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt; Your roll total ($attackrolltotal) is less than the skill check difficulty ($args[0]) - failure! &lt;&lt;set $action = &quot;failure&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;StrengthCheck&quot;&gt;&gt;
&lt;&lt;set $attackroll = random(1,100)&gt;&gt;
&lt;&lt;set $attackrolltotal = $attackroll + $strength&gt;&gt;
You rolled $attackroll, which then added to your strength ($strength) for a total of $attackrolltotal &lt;br&gt;
&lt;&lt;if $attackrolltotal gte $args[0]&gt;&gt;Your roll total ($attackrolltotal) is greater than the skill check difficulty ($args[0]) - success! &lt;&lt;set $action = &quot;success&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt; Your roll total ($attackrolltotal) is less than the skill check difficulty ($args[0]) - failure! &lt;&lt;set $action = &quot;failure&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;WillpowerCheck&quot;&gt;&gt;
&lt;&lt;set $attackroll = random(1,100)&gt;&gt;
&lt;&lt;set $attackrolltotal = $attackroll + $willpower&gt;&gt;
You rolled $attackroll, which then added to your willpower ($willpower) for a total of $attackrolltotal &lt;br&gt;
&lt;&lt;if $attackrolltotal gte $args[0]&gt;&gt;Your roll total ($attackrolltotal) is greater than the skill check difficulty ($args[0]) - success! &lt;&lt;set $action = &quot;success&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt; Your roll total ($attackrolltotal) is less than the skill check difficulty ($args[0]) - failure! &lt;&lt;set $action = &quot;failure&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;


DISPLAY WIDGETS

&lt;&lt;widget &quot;HealthBar&quot;&gt;&gt;
&lt;&lt;if $currenthealth eq $maxhealth&gt;&gt;&lt;img src=&quot;Images/Icons/health10.png&quot; width=200 /&gt;&lt;&lt;elseif $currenthealth gte ($maxhealth*0.9)&gt;&gt;&lt;img src=&quot;Images/Icons/health9.png&quot; width=200 /&gt;&lt;&lt;elseif $currenthealth gte ($maxhealth*0.8)&gt;&gt;&lt;img src=&quot;Images/Icons/health8.png&quot; width=200 /&gt;&lt;&lt;elseif $currenthealth gte ($maxhealth*0.7)&gt;&gt;&lt;img src=&quot;Images/Icons/health7.png&quot; width=200 /&gt;&lt;&lt;elseif $currenthealth gte ($maxhealth*0.6)&gt;&gt;&lt;img src=&quot;Images/Icons/health6.png&quot; width=200 /&gt;&lt;&lt;elseif $currenthealth gte ($maxhealth*0.5)&gt;&gt;&lt;img src=&quot;Images/Icons/health5.png&quot; width=200 /&gt;&lt;&lt;elseif $currenthealth gte ($maxhealth*0.4)&gt;&gt;&lt;img src=&quot;Images/Icons/health4.png&quot; width=200 /&gt;&lt;&lt;elseif $currenthealth gte ($maxhealth*0.3)&gt;&gt;&lt;img src=&quot;Images/Icons/health3.png&quot; width=200 /&gt;&lt;&lt;elseif $currenthealth gte ($maxhealth*0.2)&gt;&gt;&lt;img src=&quot;Images/Icons/health2.png&quot; width=200 /&gt;&lt;&lt;elseif $currenthealth gte ($maxhealth*0.1)&gt;&gt;&lt;img src=&quot;Images/Icons/health1.png&quot; width=200 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Icons/health0.png&quot; width=200 /&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ManaBar&quot;&gt;&gt;
&lt;&lt;if $maxmana eq 0&gt;&gt;&lt;&lt;elseif $currentmana eq $maxmana&gt;&gt;&lt;img src=&quot;Images/Icons/mana10.png&quot; width=200 /&gt;&lt;&lt;elseif $currentmana gte ($maxmana*0.9)&gt;&gt;&lt;img src=&quot;Images/Icons/mana9.png&quot; width=200 /&gt;&lt;&lt;elseif $currentmana gte ($maxmana*0.8)&gt;&gt;&lt;img src=&quot;Images/Icons/mana8.png&quot; width=200 /&gt;&lt;&lt;elseif $currentmana gte ($maxmana*0.7)&gt;&gt;&lt;img src=&quot;Images/Icons/mana7.png&quot; width=200 /&gt;&lt;&lt;elseif $currentmana gte ($maxmana*0.6)&gt;&gt;&lt;img src=&quot;Images/Icons/mana6.png&quot; width=200 /&gt;&lt;&lt;elseif $currentmana gte ($maxmana*0.5)&gt;&gt;&lt;img src=&quot;Images/Icons/mana5.png&quot; width=200 /&gt;&lt;&lt;elseif $currentmana gte ($maxmana*0.4)&gt;&gt;&lt;img src=&quot;Images/Icons/mana4.png&quot; width=200 /&gt;&lt;&lt;elseif $currentmana gte ($maxmana*0.3)&gt;&gt;&lt;img src=&quot;Images/Icons/mana3.png&quot; width=200 /&gt;&lt;&lt;elseif $currentmana gte ($maxmana*0.2)&gt;&gt;&lt;img src=&quot;Images/Icons/mana2.png&quot; width=200 /&gt;&lt;&lt;elseif $currentmana gte ($maxmana*0.1)&gt;&gt;&lt;img src=&quot;Images/Icons/mana1.png&quot; width=200 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Icons/mana0.png&quot; width=200 /&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

MERCHANT WIDGETS

&lt;&lt;widget &quot;MerchantInventory1&quot;&gt;&gt;

&lt;&lt;set $merchantweaponinventory = []&gt;&gt;
&lt;&lt;set $merchantarmorinventory = []&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($amuletofvitality)&gt;&gt;
&lt;&lt;if $headinventory.includes($amuletofvitality)&gt;&gt;&lt;&lt;run delete $merchantarmorinventory.$amuletofvitality&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($irontunic)&gt;&gt;
&lt;&lt;if $chestinventory.includes($irontunic)&gt;&gt;&lt;&lt;run delete $merchantarmorinventory.$irontunic&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($leathertunic)&gt;&gt;
&lt;&lt;if $chestinventory.includes($leathertunic)&gt;&gt;&lt;&lt;run delete $merchantarmorinventory.$leathertunic&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($irongloves)&gt;&gt;
&lt;&lt;if $handsinventory.includes($irongloves)&gt;&gt;&lt;&lt;run delete $merchantarmorinventory.$irongloves&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($ironpants)&gt;&gt;
&lt;&lt;if $legsinventory.includes($ironpants)&gt;&gt;&lt;&lt;run delete $merchantarmorinventory.$ironpants&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($leatherpants)&gt;&gt;
&lt;&lt;if $legsinventory.includes($leatherpants)&gt;&gt;&lt;&lt;run delete $merchantarmorinventory.$leatherpants&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($bootsofshadow)&gt;&gt;
&lt;&lt;if $feetinventory.includes($bootsofshadow)&gt;&gt;&lt;&lt;run delete $merchantarmorinventory.$bootsofshadow&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;set $merchantweaponinventory.push($blackdagger)&gt;&gt;
&lt;&lt;if $weaponinventory.includes($blackdagger)&gt;&gt;&lt;&lt;run delete $merchantweaponinventory.$blackdagger&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $merchantweaponinventory.push($ironmace)&gt;&gt;
&lt;&lt;if $weaponinventory.includes($ironmace)&gt;&gt;&lt;&lt;run delete $merchantweaponinventory.$ironmace&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $merchantweaponinventory.push($ironsword)&gt;&gt;
&lt;&lt;if $weaponinventory.includes($ironsword)&gt;&gt;&lt;&lt;run delete $merchantweaponinventory.$ironsword&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;MerchantInventory2&quot;&gt;&gt;

&lt;&lt;set $merchantweaponinventory = []&gt;&gt;
&lt;&lt;set $merchantarmorinventory = []&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($amuletofspeed)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($gladiatorhelm)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($assassinshood)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($blessedhelm)&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($steeltunic)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($blackleathertunic)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($blessedtunic)&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($blackleathergloves)&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($steelpants)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($blessedpants)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($blackleatherpants)&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($steelboots)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($blessedboots)&gt;&gt;

&lt;&lt;set $merchantweaponinventory.push($steelsword)&gt;&gt;
&lt;&lt;set $merchantweaponinventory.push($steelswordandshield)&gt;&gt;

&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;MerchantInventory3&quot;&gt;&gt;

&lt;&lt;set $merchantweaponinventory = []&gt;&gt;
&lt;&lt;set $merchantarmorinventory = []&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($mithrilhelm)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($amuletofbrutality)&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($mithrilarmor)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($tortoisearmor)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($cloakofzyr)&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($mithrilgauntlets)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($glovesoftylae)&gt;&gt;
&lt;&lt;if (($lewdmode eq 1) and ($gender eq &quot;female&quot;)) or (($lewdmode eq 1) and ($penis eq 2))&gt;&gt;&lt;&lt;set $merchantarmorinventory.push($naughtygloves)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($mithrilpants)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($shadowpants)&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($mithrilboots)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($wingedboots)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($tortoiseboots)&gt;&gt;

&lt;&lt;set $merchantweaponinventory.push($mithrilsword)&gt;&gt;
&lt;&lt;set $merchantweaponinventory.push($holywarhammer)&gt;&gt;
&lt;&lt;set $merchantweaponinventory.push($arcanescythe)&gt;&gt;
&lt;&lt;set $merchantweaponinventory.push($elvendaggers)&gt;&gt;

&lt;&lt;set $specialinventory.push($strangeartifact)&gt;&gt;

&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;MerchantInventory4&quot;&gt;&gt;

&lt;&lt;set $merchantweaponinventory = []&gt;&gt;
&lt;&lt;set $merchantarmorinventory = []&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($voidhelm)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($skullamulet)&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($voidarmor)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($armorofthelightbringer)&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($voidgauntlets)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($gauntletsofthevictorious)&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($voidgreaves)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($skullgreaves)&gt;&gt;

&lt;&lt;set $merchantarmorinventory.push($voidboots)&gt;&gt;
&lt;&lt;set $merchantarmorinventory.push($bootsofthetrickster)&gt;&gt;

&lt;&lt;set $merchantweaponinventory.push($cyclonerapier)&gt;&gt;
&lt;&lt;set $merchantweaponinventory.push($runeblade)&gt;&gt;
&lt;&lt;set $merchantweaponinventory.push($holystaff)&gt;&gt;

&lt;&lt;set $specialinventory.push($bookofheroes)&gt;&gt;

&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;MerchantBuyTalk&quot;&gt;&gt;
&lt;&lt;set $randomset = [1, 2, 3, 4, 5, 6]&gt;&gt;
&lt;&lt;set $random = $randomset.pluck()&gt;&gt;

&lt;&lt;if $random eq 1&gt;&gt;
&lt;&lt;MerchantTalk &quot;Another satisfied customer.&quot;&gt;&gt;

&lt;&lt;elseif $random eq 2&gt;&gt;
&lt;&lt;MerchantTalk &quot;Oh, good buy, very good buy, indeed.&quot;&gt;&gt;


&lt;&lt;elseif $random eq 3&gt;&gt;
&lt;&lt;MerchantTalk &quot;I&#39;m sure you&#39;ll up that to good use, $name.&quot;&gt;&gt;

&lt;&lt;elseif $random eq 4&gt;&gt;
&lt;&lt;MerchantTalk &quot;A fair deal for both sides.&quot;&gt;&gt;

&lt;&lt;elseif $random eq 5&gt;&gt;
&lt;&lt;MerchantTalk &quot;Sold! Now, just slide your gold across the counter.&quot;&gt;&gt;

&lt;&lt;elseif $random eq 6&gt;&gt;
&lt;&lt;MerchantTalk &quot;Untold power... at a very reasonable price point.&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;MerchantSellTalk&quot;&gt;&gt;
&lt;&lt;set $randomset = [1, 2, 3, 4, 5, 6]&gt;&gt;
&lt;&lt;set $random = $randomset.pluck()&gt;&gt;

&lt;&lt;if $random eq 1&gt;&gt;
&lt;&lt;MerchantTalk &quot;Yes, I&#39;ll take it!&quot;&gt;&gt;

&lt;&lt;elseif $random eq 2&gt;&gt;
&lt;&lt;MerchantTalk &quot;Oh yes, I can certainly send this back to the city for a tidy profit. A tidy profit, indeed...&quot;&gt;&gt;


&lt;&lt;elseif $random eq 3&gt;&gt;
&lt;&lt;MerchantTalk &quot;By sand and sun - you drive a hard bargain, $name.&quot;&gt;&gt;

&lt;&lt;elseif $random eq 4&gt;&gt;
&lt;&lt;MerchantTalk &quot;Alright, I&#39;ll pay. You&#39;re lucky we&#39;re friends, you know.&quot;&gt;&gt;

&lt;&lt;elseif $random eq 5&gt;&gt;
&lt;&lt;MerchantTalk &quot;It&#39;s not worth nearly this much. Oh, maybe it is. Deal!&quot;&gt;&gt;

&lt;&lt;elseif $random eq 6&gt;&gt;
&lt;&lt;MerchantTalk &quot;Here&#39;s your gold. Now, be sure to spend it back here soon.&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;


OTHER WIDGETS

&lt;&lt;widget &quot;StrengthCost&quot;&gt;&gt;
&lt;&lt;set $totalbasestats = $basestrength + $basewillpower + $baseagility&gt;&gt;
&lt;&lt;set $strengthcost = $basestrength + (5 +$timesincreasedstrength*10)&gt;&gt;
&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt; &lt;&lt;set $strengthcost = $strengthcost*0.8&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $strengthcost = Math.round($strengthcost)&gt;&gt;
&lt;&lt;print $strengthcost&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;AgilityCost&quot;&gt;&gt;
&lt;&lt;set $totalbasestats = $basestrength + $basewillpower + $baseagility&gt;&gt;
&lt;&lt;set $agilitycost = $baseagility + (5 + $timesincreasedagility*10)&gt;&gt;
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt; &lt;&lt;set $agilitycost = $agilitycost*0.8&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $agilitycost = Math.round($agilitycost)&gt;&gt;
&lt;&lt;print $agilitycost&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;WillpowerCost&quot;&gt;&gt;
&lt;&lt;set $totalbasestats = $basestrength + $basewillpower + $baseagility&gt;&gt;
&lt;&lt;set $willpowercost = $basewillpower + (5 + $timesincreasedwillpower*10)&gt;&gt;
&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt; &lt;&lt;set $willpowercost = $willpowercost*0.8&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $willpowercost = Math.round($willpowercost)&gt;&gt;
&lt;&lt;print $willpowercost&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;HeaderFooter&quot;&gt;&gt;
&lt;&lt;set $maxhealth = $willpower*10&gt;&gt;

&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt; &lt;&lt;set $maxmana = $willpower*5&gt;&gt; &lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt; &lt;&lt;set $maxmana = $strength*5&gt;&gt; &lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt; &lt;&lt;set $maxmana = $agility*5&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $currentmana gt $maxmana&gt;&gt; &lt;&lt;set $currentmana = $maxmana&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $currentmana lt 0&gt;&gt; &lt;&lt;set $currentmana = 0&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $currenthealth gt $maxhealth&gt;&gt; &lt;&lt;set $currenthealth = $maxhealth&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;set $equipmentstrength = $headstrength + $cheststrength + $handsstrength + $legsstrength + $feetstrength&gt;&gt;

&lt;&lt;set $equipmentagility = $headagility + $chestagility + $handsagility + $legsagility + $feetagility&gt;&gt;

&lt;&lt;set $equipmentwillpower = $headwillpower + $chestwillpower + $handswillpower + $legswillpower + $feetwillpower&gt;&gt;

&lt;&lt;set $armor = $headarmor + $chestarmor + $handsarmor + $legsarmor + $feetarmor + $weaponarmor + $specialarmor + $basearmor&gt;&gt;
&lt;&lt;if $armor lt 0&gt;&gt; &lt;&lt;set $armor = 0&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if ($armor eq 0) and ($specialarmor lt 0)&gt;&gt; &lt;&lt;set $specialarmor = 0&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;set $strength = $basestrength + $equipmentstrength + $weaponstrength + $specialstrength&gt;&gt;
&lt;&lt;if $strength lt 0&gt;&gt; &lt;&lt;set $strength = 0&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;set $agility = $baseagility + $equipmentagility + $weaponagility + $specialagility&gt;&gt;
&lt;&lt;if $agility lt 0&gt;&gt; &lt;&lt;set $agility = 0&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;set $willpower = $basewillpower + $equipmentwillpower + $weaponwillpower + $specialwillpower&gt;&gt;
&lt;&lt;if $willpower lt 0&gt;&gt; &lt;&lt;set $willpower = 0&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;set $evadescore = $baseevadescore + $agility + $specialevadescore&gt;&gt;
&lt;&lt;if $evadescore lt 0&gt;&gt; &lt;&lt;set $evadescore = 0&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if ($intro eq 1) and ($class neq &quot;soldier&quot;)&gt;&gt; &lt;&lt;set $currenthealth = $maxhealth&gt;&gt; &lt;&lt;set $currentmana = $maxmana&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if ($intro eq 1) and ($class eq &quot;soldier&quot;)&gt;&gt; &lt;&lt;set $currenthealth = $maxhealth&gt;&gt; &lt;&lt;set $currentmana = 0&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if $enemystrength lt 0&gt;&gt; &lt;&lt;set $enemystrength = 0&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if $enemyagility lt 0&gt;&gt; &lt;&lt;set $enemyagility = 0&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if $enemywillpower lt 0&gt;&gt; &lt;&lt;set $enemywillpower = 0&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if $enemyarmor lt 0&gt;&gt; &lt;&lt;set $enemyarmor = 0&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if $allystrength lt 0&gt;&gt; &lt;&lt;set $allystrength = 0&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if $allyagility lt 0&gt;&gt; &lt;&lt;set $allyagility = 0&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if $allywillpower lt 0&gt;&gt; &lt;&lt;set $allywillpower = 0&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if $allyarmor lt 0&gt;&gt; &lt;&lt;set $allyarmor = 0&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if $combatpoints gt 5&gt;&gt; &lt;&lt;set $combatpoints = 5&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;set $enemyarmor = Math.round($enemyarmor)&gt;&gt;
&lt;&lt;set $enemystrength = Math.round($enemystrength)&gt;&gt;
&lt;&lt;set $enemyagility = Math.round($enemyagility)&gt;&gt;
&lt;&lt;set $enemywillpower = Math.round($enemywillpower)&gt;&gt;
&lt;&lt;set $enemycurrenthealth = Math.round($enemycurrenthealth)&gt;&gt;

&lt;&lt;if ndef $lewdmode&gt;&gt; &lt;&lt;set $lewdmode = 0&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if ndef $enemystuncount&gt;&gt; &lt;&lt;set $enemystuncount = 0&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if ndef $enemystunlimit&gt;&gt; &lt;&lt;set $enemystunlimit = 10&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if ndef $startingname&gt;&gt; &lt;&lt;set $startingname = $name&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if ndef $startingtitle&gt;&gt; &lt;&lt;set $startingtitle = $title&gt;&gt; &lt;&lt;/if&gt;&gt;


&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;HeroDisplay&quot;&gt;&gt;
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt; &lt;img src=&quot;Images/Character/paladin1.jpg&quot; width=350 /&gt; &lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt; &lt;img src=&quot;Images/Character/soldier1.jpg&quot; width=350 /&gt; &lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt; &lt;img src=&quot;Images/Character/rogue1.jpg&quot; width=350 /&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;if ($class eq &quot;paladin&quot;) and ($lewdmode eq 0)&gt;&gt; &lt;img src=&quot;Images/Character/paladin3.jpg&quot; width=350 /&gt; &lt;&lt;elseif ($class eq &quot;soldier&quot;) and ($lewdmode eq 0)&gt;&gt; &lt;img src=&quot;Images/Character/soldier3.jpg&quot; width=350 /&gt; &lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($lewdmode eq 0)&gt;&gt; &lt;img src=&quot;Images/Character/rogue3.jpg&quot; width=350 /&gt;&lt;&lt;elseif ($class eq &quot;paladin&quot;) and ($lewdmode eq 1)&gt;&gt; &lt;img src=&quot;Images/Character/paladin5.jpg&quot; width=350 /&gt;&lt;&lt;elseif ($class eq &quot;soldier&quot;) and ($lewdmode eq 1)&gt;&gt; &lt;img src=&quot;Images/Character/soldier5.jpg&quot; width=350 /&gt;&lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($lewdmode eq 1)&gt;&gt; &lt;img src=&quot;Images/Character/rogue5.jpg&quot; width=350 /&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;HintRead&quot;&gt;&gt;&lt;i&gt;
&lt;&lt;if $outskirtsquest eq 3&gt;&gt;You should use your Godshard to build a holy shrine.
&lt;&lt;elseif $outskirtsquest eq 4&gt;&gt;You can now use your shrine to spend your exp on improved stats and new abilities
&lt;&lt;elseif $merchantstatus eq 2&gt;&gt;You should ask Babar for more information about the goblins.
&lt;&lt;elseif $outskirtsquest eq 6&gt;&gt;You should buy a goblin-catching net from Babar.
&lt;&lt;elseif $outskirtsquest eq 7&gt;&gt;You explore the outskirts until you capture and question a goblin.
&lt;&lt;elseif $outskirtsquest eq 8&gt;&gt;Something dangerous is coming. You should learn an ability that reduces enemy armor.
&lt;&lt;elseif $valequest eq 0&gt;&gt;It&#39;s a good idea to save before fighting a boss. Stocking up on health and mana potions helps, too.
&lt;&lt;elseif $valequest eq 3&gt;&gt;Defeating a nymph in combat is fun, but fruitless. Eventually, her game must be played and won.
&lt;&lt;elseif ($merchantstatus eq 5) and ($valequest gte 5)&gt;&gt;Babar wants to speak to you. You should visit him at his shop.
&lt;&lt;elseif $valequest eq 6&gt;&gt;Before you pursue Naya into the Tower of Zyr, a Scarlet Destroyer must be found within the vale, and slain. It will not go down easily.
&lt;&lt;elseif $valequest eq 7&gt;&gt;Give the Crystal Heart to Scyllia. She can be found within her hut.
&lt;&lt;elseif $witchstatus eq 4&gt;&gt;Before entering the Tower of Zyr, be sure to speak to Scyllia. 
&lt;&lt;elseif ($valequest gte 10) and ($frozenquest eq 0)&gt;&gt;Optional boss battles are more difficult than regular ones. There is no shame is skipping an optional fight.
&lt;&lt;elseif $merchantstatus eq 10&gt;&gt;Babar wants to speak to you. You should visit him at his shop.
&lt;&lt;elseif $frozenquest lt 5&gt;&gt;Always remember to visit your Weapon Vault and Armory. You should bring only your strongest equipment into battle. The rest can be sold at Babar&#39;s shop.
&lt;&lt;elseif ($frozenquest gte 5) and ($witchstatus eq 11)&gt;&gt;Scyllia wishes to speak to you. You should visit her at her hut.
&lt;&lt;elseif ($frozenquest eq 10)&gt;&gt;The Winter Palace may prove to be the greatest challenge yet. Having potions on-hand could mean the difference between victory and defeat. 
&lt;&lt;elseif ($frozenquest eq 11)&gt;&gt;Be sure to upgrade your stats and abilities. Exp unspent is exp wasted.
&lt;&lt;elseif ($frozenquest eq 12)&gt;&gt;Unless you remember to equip that shiny new weapon or armor, it&#39;s not going to help you in battle.
&lt;&lt;/if&gt;&gt;&lt;/i&gt;
&lt;&lt;/widget&gt;&gt;








































</tw-passagedata><tw-passagedata pid="12" name="PassageFooter" tags="nobr" position="198,1408" size="100,100">&lt;&lt;HeaderFooter&gt;&gt;</tw-passagedata><tw-passagedata pid="13" name="Game Over" tags="" position="198,33" size="100,100">You have died, another victim of the Deep Woods. 

Such is the fate of so-called heroes.</tw-passagedata><tw-passagedata pid="14" name="PassageHeader" tags="nobr" position="198,1282" size="100,100">&lt;&lt;HeaderFooter&gt;&gt;</tw-passagedata><tw-passagedata pid="15" name="Morning" tags="" position="400,1291" size="100,100">You wake with the dawn. 
&lt;img src=&quot;Images/Locations/morning1.jpg&quot; width=600 /&gt;

With a new day&#39;s beginning comes the promise of adventure and glory unending - for those brave enough to seek it in the dark!

&lt;&lt;if $outskirtsquest eq 8&gt;&gt;&lt;&lt;set $outskirtsquest += 1&gt;&gt;[[Onwards!-&gt;Cabin]] 
&lt;&lt;elseif $outskirtsquest eq 9&gt;&gt;[[There is some kind of commotion outside of the cabin-&gt;TrollAttack][$p = 0]]
&lt;&lt;elseif ($merchantlove eq 14) and ($valequest gte 2)&gt;&gt;[[There&#39;s a knock at your door-&gt;Merchant Lewd][$p = 18]]
&lt;&lt;elseif ($merchantlove eq 19) and ($frozenquest gte 2)&gt;&gt;[[There&#39;s a knock at your door-&gt;Merchant Lewd][$p = 42]]
&lt;&lt;elseif $frozenquest eq 4&gt;&gt;[[Find Naya-&gt;Naya1][$p = 3]]
&lt;&lt;elseif $frozenquest eq 9&gt;&gt;[[Tell Naya the Palace has been found-&gt;Invitations][$p = 0]]
&lt;&lt;elseif $finalquest eq 2&gt;&gt;[[There&#39;s a knock at your door-&gt;Naya3][$p = 8]]
&lt;&lt;elseif $finalquest eq 4&gt;&gt;[[Speak with Naya-&gt;Naya3][$p = 11]]
&lt;&lt;elseif $finalquest eq 6&gt;&gt;[[Speak with Scyllia-&gt;Witch5][$p = 25]]
&lt;&lt;elseif ($merchantlove eq 30) and ($lewdmode eq 1) and ($finalquest gte 7)&gt;&gt;[[Something feels different-&gt;Merchant Lewd][$p = 70]] 
&lt;&lt;elseif ($finalquest gte 1) and ($countdown lte 0)&gt;&gt;[[There&#39;s a terrible noise, coming from outside-&gt;WorldEnds][$p = 0]]
&lt;&lt;else&gt;&gt;[[Onwards!-&gt;Cabin]]&lt;&lt;/if&gt;&gt;

&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
&lt;&lt;if $class neq &quot;soldier&quot;&gt;&gt;&lt;&lt;set $currentmana = $maxmana&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $startingmaxmana = $maxmana&gt;&gt;\
&lt;&lt;set $daynumber += 1&gt;&gt;\
&lt;&lt;set $time = &quot;Morning&quot;&gt;&gt;\
&lt;&lt;if $finalquest gte 1&gt;&gt; &lt;&lt;set $countdown -= 1&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $daynumber eq 2&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;cabinday_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $music eq &quot;redeemer&quot;&gt;&gt; &lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $pleasured = 0&gt;&gt;\
&lt;&lt;set $gloryholed = 0&gt;&gt;\
</tw-passagedata><tw-passagedata pid="16" name="Outskirts Entry" tags="" position="798,182" size="100,100">You arrive on the Outskirts, not far from the cabin.

Here the trees are sparse and thin, and sunlight can still grace the forest floor. As such, whatever evil plagues the Deep Woods has not made much of a foothold in these younger woods. At least, not yet.
&lt;img src=&quot;Images/Outskirts/outskirts1.jpg&quot; width=600 /&gt;

&lt;&lt;if $outskirtsquest gte 16&gt;&gt;Now that the goblins have been dealt with, the Outskirts are secured. Still, there may be treasures hiding among the hills.&lt;&lt;else&gt;&gt;The Outskirts must be secured before deeper forays can be attempted.&lt;&lt;/if&gt;&gt;
\
&lt;&lt;nobr&gt;&gt;

&lt;&lt;set $outskirtseventinventory = []&gt;&gt;

&lt;&lt;if $daynumber eq 2&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;First Day&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $outskirtsquest eq 1&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;SkeletonCliff&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $outskirtsquest eq 2&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;ShrineFind&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($outskirtsquest gte 2) and ($outskirtsquest lte 3)&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;GoblinAttack&quot;, &quot;GoblinAttack&quot;, &quot;WolfAttack&quot;)&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if ($outskirtsquest gte 2) and not hasVisited(&quot;Iron Helm&quot;)&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;Iron Helm&quot;)&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if ($outskirtsquest gte 5) and ($valequest lte 3) and not hasVisited(&quot;WitchIntro&quot;)&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;WitchIntro&quot;)&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if ($outskirtsquest gte 4) and ($outskirtsquest lte 10)&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;WolfAttack&quot;, &quot;GoblinAttack&quot;, &quot;GoblinArcherAttack&quot;)&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if ($outskirtsquest gte 11)&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;WolfAttack&quot;, &quot;GoblinBruiserAttack&quot;, &quot;GoblinArcherAttack&quot;)&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if ($outskirtstreasure lt 2) and ($outskirtsquest gte 4)&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;OutskirtsTreasure&quot;)&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if ($wolfbattle lt 2) and ($outskirtsquest gte 4)&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;WolfBattle&quot;)&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if $outskirtsquest eq 4&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;MerchantMeet&quot;, &quot;MerchantMeet&quot;)&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if ($outskirtsquest gte 4) and not hasVisited(&quot;Ori1&quot;)&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;Ori1&quot;, &quot;Ori1&quot;)&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if ($outskirtsquest eq 6) or ($outskirtsquest eq 7)&gt;&gt; &lt;&lt;set $outskirtseventinventory.push(&quot;GoblinCapture&quot;, &quot;GoblinCapture&quot;)&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;set $event = $outskirtseventinventory.pluck()&gt;&gt;\

&lt;&lt;/nobr&gt;&gt;
\
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $event eq &quot;First Day&quot;&gt;&gt; [[Venture Forth!-&gt;FirstDay]]
&lt;&lt;elseif ($outskirtsquest gte 6) and not hasVisited(&quot;DeathGuardIntro&quot;)&gt;&gt; [[Venture Forth!-&gt;DeathGuardIntro]]
&lt;&lt;elseif ($outskirtsquest gte 7) and ($lewdshrine eq 0) and ($lewdmode eq 1)&gt;&gt; [[Venture Forth!-&gt;LewdShrine1]]
&lt;&lt;elseif ($outskirtsquest gte 3) and ($lewdmode eq 1) and ($gender eq &quot;male&quot;) and not hasVisited(&quot;GoblinProstitute&quot;)&gt;&gt; [[Venture Forth!-&gt;GoblinProstitute]]
&lt;&lt;elseif $event eq &quot;SkeletonCliff&quot;&gt;&gt; [[Venture Forth!-&gt;SkeletonCliff]]
&lt;&lt;elseif $event eq &quot;ShrineFind&quot;&gt;&gt; [[Venture Forth!-&gt;ShrineFind]]
&lt;&lt;elseif $event eq &quot;GoblinAttack&quot;&gt;&gt; [[Venture Forth!-&gt;GoblinAttack]]
&lt;&lt;elseif $event eq &quot;WolfAttack&quot;&gt;&gt; [[Venture Forth!-&gt;WolfAttack]]
&lt;&lt;elseif $event eq &quot;Iron Helm&quot;&gt;&gt; [[Venture Forth!-&gt;Iron Helm]]
&lt;&lt;elseif $event eq &quot;WitchIntro&quot;&gt;&gt; [[Venture Forth!-&gt;WitchIntro]]
&lt;&lt;elseif $event eq &quot;OutskirtsTreasure&quot;&gt;&gt; [[Venture Forth!-&gt;OutskirtsTreasure]]
&lt;&lt;elseif $event eq &quot;WolfBattle&quot;&gt;&gt; [[Venture Forth!-&gt;WolfBattle]]
&lt;&lt;elseif $event eq &quot;GoblinArcherAttack&quot;&gt;&gt; [[Venture Forth!-&gt;GoblinArcherAttack]]
&lt;&lt;elseif $event eq &quot;GoblinBruiserAttack&quot;&gt;&gt; [[Venture Forth!-&gt;GoblinBruiserAttack]]
&lt;&lt;elseif $event eq &quot;MerchantMeet&quot;&gt;&gt; [[Venture Forth!-&gt;MerchantMeet]]
&lt;&lt;elseif $event eq &quot;Ori1&quot;&gt;&gt; [[Venture Forth!-&gt;Ori1]]
&lt;&lt;elseif $event eq &quot;GoblinCapture&quot;&gt;&gt; [[Venture Forth!-&gt;GoblinCapture]]

&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if $outskirtsquest gte 10&gt;&gt;[[Go to the goblin nest-&gt;GoblinNest1]]&lt;&lt;/if&gt;&gt;
[[Back-&gt;Outside the Cabin]] 
\
&lt;&lt;set $p = 0&gt;&gt;\</tw-passagedata><tw-passagedata pid="17" name="FirstDay" tags="" position="799,293" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
You begin your first foray into the Outskirts with cautious optimism. The sun shines above, and trees are young and laden with fruit. No vast evil has yet conquered these woods.
&lt;img src=&quot;Images/Outskirts/outskirts2.jpg&quot; width=500 /&gt;

You can only hope it stays that way.

You spend the day carving runes into the trees every thousand steps, building some sort of mental map of the land by noting the landmarks into your memory. This exercise will serve you well on future ventures into the wilds.

It is an uneventful day, until an odd noise pricks your ears.

An animal, breathing.

&lt;&lt;HeroTalk &quot;Something is behind me...&quot;&gt;&gt;

[[Turn around-&gt;FirstDay][$p = 1]]

&lt;&lt;set $intro = 0&gt;&gt;\
&lt;&lt;set $passage = passage()&gt;&gt;\
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You turn around to see a boar, clearly driven into some sort of bloodlust. It&#39;s about to charge!
&lt;img src=&quot;Images/Outskirts/direboar1.jpg&quot; width=450 /&gt;

&lt;&lt;BoarTalk &quot;RAAAAAH!&quot;&gt;&gt;
\
&lt;&lt;HeroTalk &quot;Come, then - I&#39;ll put you out of your misery!&quot;&gt;&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;BoarStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 10&gt;&gt;\
\
You are fighting a $enemyname!
&lt;img src=&quot;Images/Outskirts/direboar1.jpg&quot; width=300 /&gt;

&lt;b&gt;General Actions&lt;/b&gt;:
[[Attack-&gt;FirstDay][$p = 11, $action = &quot;attack&quot;]]
[[Flee-&gt;FirstDay][$p = 11, $action = &quot;flee&quot;]]

&lt;b&gt;Class Abilities&lt;/b&gt;:
&lt;&lt;for _i to 0; _i lt $abilityinventory.length; _i++&gt;&gt;\
&lt;&lt;print $abilityinventory[_i].name&gt;&gt; (Mana cost: $abilityinventory[_i].mana )\
&lt;&lt;capture _i&gt;&gt;\
		&lt;&lt;if $currentmana lt $abilityinventory[_i].mana&gt;&gt;&lt;i&gt;Not enough mana&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;ability&quot;&gt;&gt; &lt;&lt;set $ability = $abilityinventory[_i].widgetname&gt;&gt;&lt;&lt;set $abilitymana = $abilityinventory[_i].mana&gt;&gt;&lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;\


&lt;b&gt;Items&lt;/b&gt;:
&lt;&lt;for _i to 0; _i lt $iteminventory.length; _i++&gt;&gt;\
&lt;&lt;print $iteminventory[_i].name&gt;&gt; (Quantity :&lt;&lt;print $iteminventory[_i].quantity&gt;&gt;)\
&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $iteminventory[_i].quantity lte 0&gt;&gt;&lt;i&gt;None left&lt;/i&gt;&lt;&lt;else&gt;&gt;\
	&lt;&lt;link &quot;Use&quot; FirstDay&gt;&gt;&lt;&lt;set $p = 11&gt;&gt; &lt;&lt;set $action = &quot;item&quot;&gt;&gt; &lt;&lt;set $item = $iteminventory[_i].name&gt;&gt;\
			&lt;&lt;set $iteminventory[_i].quantity -= 1&gt;&gt;\
			&lt;&lt;set $itemstrength = $iteminventory[_i].strength&gt;&gt;\
			&lt;&lt;set $itemagility = $iteminventory[_i].agility&gt;&gt;\
			&lt;&lt;set $itemwillpower = $iteminventory[_i].willpower&gt;&gt;\
			&lt;&lt;set $itemarmor = $iteminventory[_i].armor&gt;&gt;\
			&lt;&lt;set $itemhealth = $iteminventory[_i].health&gt;&gt;\
			&lt;&lt;set $itemmana = $iteminventory[_i].mana&gt;&gt;\
			&lt;&lt;set $itemevadescore = $iteminventory[_i].evadescore&gt;&gt;\
			&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;\
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;\
\
&lt;&lt;EnemyBattleTable&gt;&gt;
&lt;&lt;set $battlecount += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 11&gt;&gt; 
You are fighting a $enemyname!
&lt;img src=&quot;Images/Outskirts/direboar1.jpg&quot; width=300 /&gt; 

&lt;&lt;if $action eq &quot;attack&quot;&gt;&gt;You attempt to hit the $enemyname with your $weapon!

&lt;&lt;AttackAttempt&gt;&gt;
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;You deal damage to the $enemyname!

&lt;&lt;AttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $action eq &quot;flee&quot;&gt;&gt;You attempt to flee from the $enemyname!

&lt;&lt;FleeAttempt&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;ability&quot;&gt;&gt;&lt;&lt;Ability $ability&gt;&gt;&lt;&lt;/Ability&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $action eq &quot;item&quot;&gt;&gt;You used your $item!
&lt;&lt;ItemImage $item 150&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;
&lt;&lt;ItemUse&gt;&gt;
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth lte 0&gt;&gt;[[The enemy is slain! Victory!-&gt;FirstDay][$p = 20]]&lt;&lt;elseif $action eq &quot;flee success&quot;&gt;&gt;[[You escape!-&gt;FirstDay][$p = 19]]&lt;&lt;else&gt;&gt;[[Enemy turn-&gt;FirstDay][$p = 12]]&lt;&lt;/if&gt;&gt;

&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;elseif $p eq 12&gt;&gt; 
You are fighting a $enemyname!
&lt;img src=&quot;Images/Outskirts/direboar1.jpg&quot; width=300 /&gt; 
\
&lt;&lt;set $enemyaction = &quot;attack&quot;&gt;&gt;\

&lt;&lt;if $enemyaction eq &quot;attack&quot;&gt;&gt;The $enemyname attacks you!

&lt;&lt;EnemyAttackAttempt&gt;&gt;

&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;The $enemyname deals damage to you!

&lt;&lt;EnemyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]]&lt;&lt;else&gt;&gt;[[Player turn-&gt;FirstDay][$p = 10]]&lt;&lt;/if&gt;&gt;

&lt;&lt;EnemyBattleTable&gt;&gt;\
&lt;&lt;elseif $p eq 19&gt;&gt; 
You flee from the $enemyname in shame. 

Having run from your very first battle, you no longer feel the need to do battle any longer. In fact, you don&#39;t think you&#39;ll ever fight an enemy again! There&#39;s more to life!

[[Leave for good-&gt;FirstDay][$p = 21]]

&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Investigate the boar-&gt;FirstDay][$p = 22]] 

&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\

\
&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;\
It&#39;s been years since you left adventuring and the Deep Woods behind. Now you&#39;re a jolly merchant, making gold by buying and selling exotic goods.
&lt;img src=&quot;Images/Character/merchant1.jpg&quot; width=400 /&gt;

Although, sometimes you do wonder what glory you might have gained, had you dared to brave the Deep Woods...

&lt;b&gt;GAME OVER&lt;/b&gt;

&lt;&lt;set $daynumber = 2500&gt;&gt;
&lt;&lt;set $class = &quot;merchant&quot;&gt;&gt;
&lt;&lt;set $gold = 99999&gt;&gt;

&lt;&lt;elseif $p eq 22&gt;&gt;\
After studying the boar&#39;s corpse, you find the cause of its bloodlust. A poisoned arrow.
&lt;img src=&quot;Images/Outskirts/arrow1.jpg&quot; width=300 /&gt;

&lt;&lt;HeroTalk &quot;This is goblin-craft. That means those foul creatures have at least one nest in the Outskirts. But why drive the wildlife mad...&quot;&gt;&gt;
\
You won&#39;t be able to discover the answer to that question today. The sun is almost set. The time has come to return to the cabin, and rest.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt; \
&lt;&lt;set $outskirtsquest = 1&gt;&gt;\
&lt;&lt;set $outskirtstreasure = 0&gt;&gt;
&lt;&lt;set $wolfbattle = 0&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="18" name="GoblinAttack" tags="" position="800,399" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
You are wandering through the Outskirts when an arrow whizzes by your head. Turning to your left, you spot a goblin.
&lt;img src=&quot;Images/Outskirts/goblin1.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;Hideous creature - prepare to die!&quot;&gt;&gt; \
The goblin draws its rusted dagger.
&lt;&lt;GoblinTalk &quot;Grahhh! You are not welcome here, human!&quot;&gt;&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="19" name="Iron Helm" tags="" position="806,654" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;As you wander through the Outskirts, you come across a tranquil pond.
&lt;img src=&quot;Images/Outskirts/outskirts3.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;Seems peaceful enough...&quot;&gt;&gt;
\
You take the opportunity to slake your thirst. In the perfect silence of the woodland, you kneel before the pond and drink deep of its cool, clear water.

[[As you do, you notice something beneath the surface-&gt;Iron Helm][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;Curious, you reach down and grasp the glinting object. Feels like metal.
&lt;img src=&quot;Images/Armor/Iron Helm.jpg&quot; width=300 /&gt;

&lt;&lt;HeroTalk &quot;A helmet. A bit shabby in its craft... but it could be useful.&quot;&gt;&gt;
\
After slipping the helmet into your pack, you depart from the tranquil pond. 

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $headinventory.push($ironhelm)&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="20" name="Item Chest" tags="" position="403,898" size="100,100">You are in your Item Chest. Here you can keep track of your items and their uses.

[[Return-&gt;Cabin][$i = 0]] 

&lt;&lt;for _i to 0; _i lt $iteminventory.length; _i++&gt;&gt;
&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $iteminventory[_i].name&gt;&gt;&lt;/b&gt; 
	&lt;&lt;ItemImage $iteminventory[_i].name 200&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;
	Quantity: &lt;&lt;print $iteminventory[_i].quantity&gt;&gt;
	Description: &lt;&lt;print $iteminventory[_i].description&gt;&gt;
&lt;&lt;/for&gt;&gt;</tw-passagedata><tw-passagedata pid="21" name="SkeletonCliff" tags="" position="804,768" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;As you wander through the Outskirts, you come across a cliffside, leaning over a deep and rocky gully below. Just as you mean to turn around, you spot a skeleton, hanging precariously from the bluffs.
&lt;img src=&quot;Images/Outskirts/outskirts4.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;A lone wanderer - perhaps an adventurer, not unlike me. Now lost and forgotten.&quot;&gt;&gt;
\
The skeleton&#39;s clothes have faded to nothing, but it still wears a spotted tunic of iron chain, and clutches a notched sword.

If you dared, you could take them.

[[Carefully take the tunic-&gt;SkeletonCliff][$p = 1]]
[[Carefully take the sword-&gt;SkeletonCliff][$p = 2]]
[[Take neither, and instead pray for the soul&#39;s safety-&gt;SkeletonCliff][$p = 3]]
[[Take both! You&#39;ll need them more than the dead!-&gt;SkeletonCliff][$p = 4]]

&lt;&lt;set $outskirtsquest = 2&gt;&gt;\
\
&lt;&lt;elseif $p eq 1&gt;&gt;Leaning over the vast expanse, you ignore the burst of virtigo and instead focus on slipping the skeleton out of its tunic. Just as you manage it, the corpse tumbles off the cliffside, sword in hand, and falls down, down, down, before crashing into the gully far below.

The sword is lost, but you found an iron tunic!
&lt;img src=&quot;Images/Armor/Iron Tunic.jpg&quot; width=350 /&gt;

&lt;&lt;HeroTalk &quot;I just hope this serves me better than it did him...&quot;&gt;&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $chestinventory.push($irontunic)&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;elseif $p eq 2&gt;&gt;Leaning over the vast expanse, you ignore the burst of virtigo and instead focus on wrenching free the iron sword from the skeleton&#39;s deathly grip. Just as you manage it, the corpse tumbles off the cliffside, still wearing its iron tunic, and falls down, down, down, before crashing into the gully far below.

The tunic is lost, but you found an iron sword!
&lt;img src=&quot;Images/Weapons/Iron Sword.jpg&quot; width=350 /&gt;

&lt;&lt;HeroTalk &quot;I just hope this serves me better than it did him...&quot;&gt;&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $weaponinventory.push($ironsword)&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;elseif $p eq 3&gt;&gt;Instead of seeking out material gain, you drop to your knees, shut your eyes, and offer a prayer to the Gods, urging them to guide this poor soul to the peaceful hereafter.

The moment your prayer ends, you feel all the hairs upon your arms rise, and a cold wind whip across the woodlands. Opening your eyes, you gasp, realizing the skeleton is &lt;i&gt;gone&lt;/i&gt;!

&lt;&lt;HeroTalk &quot;I can only hope my prayer was answered, and he finds himself in the halls of his fathers.&quot;&gt;&gt;

As you rise from your knees, you feel newfound power pulsing deep in your heart. The Gods have surely approved of your display of piety.

Your &lt;b&gt;Willpower&lt;/b&gt; has permanently increased!

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $basewillpower += 2&gt;&gt; 
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;elseif $p eq 4&gt;&gt;Throwing caution to the wind, you grab at the skeleton with both hands, eager for its lost treasures. Fate has other plans, it seems, for the moment you take hold of the skeletal spine, the whole thing breaks apart, and the skeleton falls down, down, down into the gully.

You nearly trip over your own knees and drop down with it. Though you&#39;re able to find your balance, you lose your chance at grabbing the sword or tunic. They&#39;re lost in the gully below.

&lt;&lt;HeroTalk &quot;An error in judgement... it won&#39;t happen again.&quot;&gt;&gt;
\
After you catch your breath, you leave the cliffside behind you.

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;/if&gt;&gt;
</tw-passagedata><tw-passagedata pid="22" name="ShrineFind" tags="" position="806,888" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;As you wander through the Outskirts, you come a small, shaded clearing. The woods seem to go silent and still as you enter.
&lt;img src=&quot;Images/Outskirts/outskirts5.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;Odd... I feel almost &lt;i&gt;compelled&lt;/i&gt; to approach.&quot;&gt;&gt;
\
Something old and powerful, and yet familiar seems to call out to you - an ancient energy, drawing you to the center of the clearing.

There, buried beneath the undergrowth - there&#39;s some kind of artifact!

[[Pull it free-&gt;ShrineFind][$p = 3]]
[[Resist!-&gt;ShrineFind][$p = 1]]

&lt;&lt;set $i = 0&gt;&gt;\
&lt;&lt;set $passage = passage()&gt;&gt;\
\
&lt;&lt;set $outskirtsquest = 3&gt;&gt;\
\
&lt;&lt;elseif $p eq 1&gt;&gt;You try to resist the artifact&#39;s pull. It takes a great deal of mental and physical strain to do so.
&lt;img src=&quot;Images/Outskirts/outskirts6.jpg&quot; width=450 /&gt;

&lt;i&gt;You lose &lt;b&gt;15&lt;/b&gt; health!&lt;/i&gt;
&lt;&lt;set $currenthealth  -= 15&gt;&gt;\
&lt;&lt;set $i += 1&gt;&gt;

The artifact continues to call you forth.

[[Pull it free-&gt;ShrineFind][$p = 3]]
&lt;&lt;if $i gte 2&gt;&gt;[[Resist!-&gt;ShrineFind][$p = 2]]&lt;&lt;else&gt;&gt;[[Resist!-&gt;ShrineFind][$p = 1]]&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 2&gt;&gt;You cry out, roaring in anguish. At that moment, one final burst of pain strikes you, then the pull fades away to nothing.
&lt;img src=&quot;Images/Outskirts/outskirts6.jpg&quot; width=450 /&gt;

&lt;i&gt;You lose &lt;b&gt;15&lt;/b&gt; health!&lt;/i&gt;
&lt;&lt;set $currenthealth  -= 15&gt;&gt;\

You feel stronger from enduring this trial of pain.

Your &lt;b&gt;Willpower&lt;/b&gt; has permanently increased!

Now, you can examine the artifact on your own terms.

[[Examine the artifact-&gt;ShrineFind][$p = 3]]
\
&lt;&lt;set $basewillpower += 2&gt;&gt; \
&lt;&lt;set $i = 5&gt;&gt;

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;if $i lte 4&gt;&gt;You pull free the artifact, and its straining call fades away.&lt;&lt;else&gt;&gt;You examine the curious artifact.&lt;&lt;/if&gt;&gt;
&lt;img src=&quot;Images/Locations/shrine1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Is this... is this what I think it is?&quot;&gt;&gt;
\
If your eyes don&#39;t deceive you, you&#39;ve stumbled across a &lt;b&gt;Godshard&lt;/b&gt; - a rare crystal that can allow worthy mortals a closer connection to the very Gods above.

So long as they can prove themselves and hold a God&#39;s interest, that is. 

&lt;&lt;HeroTalk &quot;This is quite the boon - surely with the aid of the Gods, I can cleanse the Deep Woods. I should return to the cabin and build a shrine. &quot;&gt;&gt;
\
Just then, there&#39;s a rustling behind you. Something&#39;s coming. Something large.

[[Slip the Godshard in your pocket and turn around-&gt;ShrineFind][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
You turn just in time to see a massive, crazed bear.
&lt;img src=&quot;Images/Outskirts/direbear1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Another victim of goblin poison! Have at thee!&quot;&gt;&gt;

&lt;&lt;BearTalk &quot;GRAAAA! GRAAAAAAAA!!!&quot;&gt;&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;BearStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 10&gt;&gt; 
\
You are fighting a $enemyname!
&lt;img src=&quot;Images/Outskirts/direbear1.jpg&quot; width=300 /&gt;

&lt;b&gt;General Actions&lt;/b&gt;:
[[Attack-&gt;ShrineFind][$p = 11, $action = &quot;attack&quot;]]
&lt;i&gt;You cannot flee from this battle!&lt;/i&gt;

&lt;b&gt;Class Abilities&lt;/b&gt;:
&lt;&lt;for _i to 0; _i lt $abilityinventory.length; _i++&gt;&gt;\
&lt;&lt;print $abilityinventory[_i].name&gt;&gt; (Mana cost: $abilityinventory[_i].mana )\
&lt;&lt;capture _i&gt;&gt;\
		&lt;&lt;if $currentmana lt $abilityinventory[_i].mana&gt;&gt;&lt;i&gt;Not enough mana&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;ability&quot;&gt;&gt; &lt;&lt;set $ability = $abilityinventory[_i].widgetname&gt;&gt;&lt;&lt;set $abilitymana = $abilityinventory[_i].mana&gt;&gt;&lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;\

&lt;b&gt;Items&lt;/b&gt;:
&lt;&lt;for _i to 0; _i lt $iteminventory.length; _i++&gt;&gt;\
&lt;&lt;print $iteminventory[_i].name&gt;&gt; (Quantity :&lt;&lt;print $iteminventory[_i].quantity&gt;&gt;)
&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $iteminventory[_i].quantity lte 0&gt;&gt;&lt;i&gt;None left&lt;/i&gt;&lt;&lt;else&gt;&gt;\
	&lt;&lt;link &quot;Use&quot; ShrineFind&gt;&gt;&lt;&lt;set $p = 11&gt;&gt; &lt;&lt;set $action = &quot;item&quot;&gt;&gt; &lt;&lt;set $item = $iteminventory[_i].name&gt;&gt;\
			&lt;&lt;set $iteminventory[_i].quantity -= 1&gt;&gt;\
			&lt;&lt;set $itemstrength = $iteminventory[_i].strength&gt;&gt;\
			&lt;&lt;set $itemagility = $iteminventory[_i].agility&gt;&gt;\
			&lt;&lt;set $itemwillpower = $iteminventory[_i].willpower&gt;&gt;\
			&lt;&lt;set $itemarmor = $iteminventory[_i].armor&gt;&gt;\
			&lt;&lt;set $itemhealth = $iteminventory[_i].health&gt;&gt;\
			&lt;&lt;set $itemmana = $iteminventory[_i].mana&gt;&gt;\
			&lt;&lt;set $itemevadescore = $iteminventory[_i].evadescore&gt;&gt;\

			&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;\
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;\

&lt;&lt;EnemyBattleTable&gt;&gt;
&lt;&lt;set $battlecount += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 11&gt;&gt; 
You are fighting a $enemyname!
&lt;img src=&quot;Images/Outskirts/direbear1.jpg&quot; width=300 /&gt; 

&lt;&lt;if $action eq &quot;attack&quot;&gt;&gt;You attempt to hit the $enemyname with your $weapon!

&lt;&lt;AttackAttempt&gt;&gt;
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;You deal damage to the $enemyname!

&lt;&lt;AttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $action eq &quot;flee&quot;&gt;&gt;You attempt to flee from the $enemyname!

&lt;&lt;FleeAttempt&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;ability&quot;&gt;&gt;&lt;&lt;Ability $ability&gt;&gt;&lt;&lt;/Ability&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $action eq &quot;item&quot;&gt;&gt;You used your $item!
&lt;&lt;ItemImage $item 150&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;
&lt;&lt;ItemUse&gt;&gt;
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth lte 0&gt;&gt;[[The enemy is slain! Victory!-&gt;ShrineFind][$p = 20]]&lt;&lt;elseif $action eq &quot;flee success&quot;&gt;&gt;[[You escape!-&gt;ShrineFind][$p = 19]]&lt;&lt;else&gt;&gt;[[Enemy turn-&gt;ShrineFind][$p = 12]]&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;

&lt;&lt;elseif $p eq 12&gt;&gt; 
You are fighting a $enemyname!
&lt;img src=&quot;Images/Outskirts/direbear1.jpg&quot; width=300 /&gt; 
\
&lt;&lt;set $enemyaction = &quot;attack&quot;&gt;&gt;\

&lt;&lt;if $enemyaction eq &quot;attack&quot;&gt;&gt;The $enemyname attacks you!

&lt;&lt;EnemyAttackAttempt&gt;&gt;

&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;The $enemyname deals damage to you!

&lt;&lt;EnemyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]]&lt;&lt;else&gt;&gt;[[Player turn-&gt;ShrineFind][$p = 10]]&lt;&lt;/if&gt;&gt;

&lt;&lt;EnemyBattleTable&gt;&gt;
\
&lt;&lt;elseif $p eq 19&gt;&gt; 
You are not supposed to see this passage. This is an error.

&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

&lt;&lt;HeroTalk &quot;More goblin poison. I need answers. But first, I should build a shrine to house this precious Godshard.&quot;&gt;&gt;

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;
</tw-passagedata><tw-passagedata pid="23" name="ShrineBuild" tags="" position="599,298" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;shrine&quot;&gt;&gt;\
\
You venture fifty paces beyond the cabin, until it is hidden by trees. Here, in the quiet woods, you set hammer and chisel to a rough outcropping of stone.

To make full use of the &lt;b&gt;Godshard&lt;/b&gt; you must first build a worthy shrine. Then, you must dedicate the shrine - and your quest - to the God or Goddess most aligned with your path.

Much of the day you spend in vigorous labor, pounding away at the stone, fashioning it to just the right shape. At various points, when exhaustion slows you down, you peer down at the &lt;b&gt;Godshard&lt;/b&gt;.
&lt;img src=&quot;Images/Locations/shrine1.jpg&quot; width=400 /&gt;

Staring at its shimmering beauty for even a moment seems to renew your strength. Inspired once more, you set to chiseling out the shrine with a zealous fire in your eyes.

[[At last, it is finished-&gt;ShrineBuild][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;As the sun sets over the Deep Woods, you step back from the newly made shrine, and marvel at what you&#39;ve wrought.
&lt;img src=&quot;Images/Locations/shrine2.jpg&quot; width=700 /&gt;

It is a custom in your homeland to build all shrines in the form of the &lt;b&gt;Mother Goddess&lt;/b&gt;, &lt;b&gt;Tylae&lt;/b&gt;. It is said that all souls are formed of her, and all souls shall one day return to her - even those of the other Gods.

Beneath her gaze, you set the &lt;b&gt;Godshard&lt;/b&gt;. There it pulses with holy radiance, showering the small shrine with blue-white light.

&lt;&lt;HeroTalk &quot;Oh holy Tylae, sanctify this wretched land. Speak on my behalf to the God I now seek...&quot;&gt;&gt;

[[Dedicate the shrine-&gt;ShrineBuild][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;You determine to dedicate this shrine to &lt;b&gt;Iulius, God of Judgement&lt;/b&gt;. The patron of the Paladin order and great lawmaker of the heavens, only his justice can see the Deep Woods cleansed.
&lt;img src=&quot;Images/Locations/shrine4.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;Oh formidible, unyielding Iulius! I devote myself to your teachings, your rulings, your unchangeable laws. Bless me with your aid and I will sanctify these lands in your name, and your honor!&quot;&gt;&gt;

&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;You determine to dedicate this shrine to &lt;b&gt;Myridia, Goddess of War and Winged Victory&lt;/b&gt;. Matron of soldiers and gloryseekers across the world, only with her brazen might can you vanquish the darkness of the Deep Woods.
&lt;img src=&quot;Images/Locations/shrine5.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;Oh glorious, unconquerable Myridia! You value action over petty words, so let me be brief. Grant me aid in this forlorn place, and I will bring bloodshed and ruin upon those who stand in my way. By sword and axe, by blood and bone, I will conquer the Deep Woods in your name!&quot;&gt;&gt;

&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;You determine to dedicate this shrine to &lt;b&gt;Sathael, God of Shadow&lt;/b&gt;. Patron of actors and thieves, only by his trickery and guile will you slip into the black heart of this land, and split it in two.
&lt;img src=&quot;Images/Locations/shrine3.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;Oh Sathael, great and invisible! I once more seek your unseeing grace. Lend your aid to this student of the shadows, and I will prove to the world that the most dangerous blade is that which cannot be seen. Let it be by your untouchable power that the Deep Woods bested at last!&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;\
\
[[Light fills your gaze-&gt;ShrineBuild][$p = 3]]
\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;
&lt;&lt;elseif $p eq 3&gt;&gt;Looking up to the heavens, you see the night sky alive and alight with comets, streaking white and brilliant across the  darkness.
&lt;img src=&quot;Images/Locations/shrine6.jpg&quot; width=600 /&gt;

There can be no doubting what this means. It is a sign from above - your prayer has been answered. &lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;b&gt;Iulius&lt;/b&gt;&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;&lt;b&gt;Myridia&lt;/b&gt;&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;b&gt;Sathael&lt;/b&gt;&lt;&lt;/if&gt;&gt; has heard your plea through the &lt;b&gt;Godshard&lt;/b&gt;, and will lend you divine gifts in your quest... so long as you prove yourself worthy.

&lt;&lt;HeroTalk &quot;I will not let you down, nor the king.&quot;&gt;&gt;

[[Exhaustion weighs upon you. For now, you must rest-&gt;Sleep]] 

&lt;&lt;set $p = 0&gt;&gt;\
&lt;&lt;set $outskirtsquest = 4&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="24" name="PaladinShrine" tags="" position="602,405" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $music neq &quot;shrine&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt; &lt;&lt;set $music = &quot;shrine&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
You kneel before the shrine of &lt;b&gt;Tylae&lt;/b&gt;, and beseech &lt;b&gt;Iulius, God of Judgement&lt;/b&gt; for his aid. The &lt;b&gt;Godshard&lt;/b&gt; shimmers in response.
&lt;img src=&quot;Images/Locations/shrine2.jpg&quot; width=650 /&gt;

&lt;i&gt;&lt;b&gt;Note&lt;/b&gt;: Paladins get a 20% discount on the cost to increase Willpower.&lt;/i&gt;

&lt;table class=&quot;stat-table&quot;&gt;\
	&lt;tr&gt;\
		&lt;th&gt;Increase Strength&lt;/th&gt;
		&lt;th&gt;Increase Agility&lt;/th&gt;
		&lt;th&gt;Increase Willpower&lt;/th&gt;
	&lt;/tr&gt;\
	&lt;tr&gt;\
		&lt;td&gt;\
			Current (base) Strength: $basestrength
			Cost to increase by 1: &lt;&lt;StrengthCost&gt;&gt;
			&lt;&lt;if $strengthcost gt $exp&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;else&gt;&gt;[[Increase Strength-&gt;PaladinShrine][$p = 1]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
		&lt;td&gt;\
			Current (base) Agility: $baseagility
			Cost to increase by 1: &lt;&lt;AgilityCost&gt;&gt;
			&lt;&lt;if $agilitycost gt $exp&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;else&gt;&gt;[[Increase Agility-&gt;PaladinShrine][$p = 2]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
		&lt;td&gt;\
			Current (base) Willpower: $basewillpower
			Cost to increase by 1: &lt;&lt;WillpowerCost&gt;&gt;
			&lt;&lt;if $willpowercost gt $exp&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;else&gt;&gt;[[Increase Willpower-&gt;PaladinShrine][$p = 3]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
	&lt;/tr&gt;\
&lt;/table&gt;\

[[Return-&gt;Outside the Cabin]] 

To those deemed worthy, &lt;b&gt;Iulius&lt;/b&gt; can provide many boons...
&lt;&lt;if $abilitytotal gte $abilitymax&gt;&gt;&lt;i&gt;You can only know up to $abilitymax abilities at one time.&lt;/i&gt;&lt;&lt;else&gt;&gt;\
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $paladinabilityinventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:75%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $paladinabilityinventory[_i].name&gt;&gt;&lt;/b&gt; 
	Exp Cost: &lt;&lt;print $paladinabilityinventory[_i].exp&gt;&gt;
	Mana Cost: &lt;&lt;print $paladinabilityinventory[_i].mana&gt;&gt;
	Description: &lt;&lt;print $paladinabilityinventory[_i].description&gt;&gt;
	&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $exp gte $paladinabilityinventory[_i].exp&gt;&gt;&lt;&lt;link &quot;Gain Ability&quot; PaladinShrine&gt;&gt; \
	&lt;&lt;set $abilityinventory.push($paladinabilityinventory[_i])&gt;&gt;\
	&lt;&lt;set $abilityname = $paladinabilityinventory[_i].name&gt;&gt;\
	&lt;&lt;set $abilitywidgetname = $paladinabilityinventory[_i].widgetname&gt;&gt;\
	&lt;&lt;set $abilitycost = $paladinabilityinventory[_i].exp&gt;&gt;\
	&lt;&lt;set $paladinabilityinventory.delete($paladinabilityinventory[_i])&gt;&gt;\
	&lt;&lt;set $p = 4&gt;&gt;\
	&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;AbilityImage $paladinabilityinventory[_i].widgetname 200&gt;&gt;&lt;&lt;/AbilityImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;/table&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;b&gt;Ability Total:&lt;/b&gt; $abilitytotal / $abilitymax

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;b&gt;Iulius&lt;/b&gt; has bestowed you with increased strength! All will cower before your unending might!
&lt;img src=&quot;Images/Locations/shrine4.jpg&quot; width=500 /&gt;

&lt;i&gt;&lt;b&gt;Strength&lt;/b&gt; increased by 1!&lt;/i&gt;

[[Return-&gt;PaladinShrine][$p = 0]]

&lt;&lt;set $basestrength += 1&gt;&gt;
&lt;&lt;set $exp -= $strengthcost&gt;&gt;
&lt;&lt;set $timesincreasedstrength += 1&gt;&gt;

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;b&gt;Iulius&lt;/b&gt; has bestowed you with increased agility! None will match your speed, skill, and grace!
&lt;img src=&quot;Images/Locations/shrine4.jpg&quot; width=500 /&gt;

&lt;i&gt;&lt;b&gt;Agility&lt;/b&gt; increased by 1!&lt;/i&gt;

[[Return-&gt;PaladinShrine][$p = 0]]

&lt;&lt;set $baseagility += 1&gt;&gt;
&lt;&lt;set $exp -= $agilitycost&gt;&gt;
&lt;&lt;set $timesincreasedagility += 1&gt;&gt;

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;b&gt;Iulius&lt;/b&gt; has bestowed you with increased willpower! You will endure any trial, any tribulation - none will see you bested!
&lt;img src=&quot;Images/Locations/shrine4.jpg&quot; width=500 /&gt;

&lt;i&gt;&lt;b&gt;Willpower&lt;/b&gt; increased by 1!&lt;/i&gt;

[[Return-&gt;PaladinShrine][$p = 0]]

&lt;&lt;set $basewillpower += 1&gt;&gt;
&lt;&lt;set $exp -= $willpowercost&gt;&gt;
&lt;&lt;set $timesincreasedwillpower += 1&gt;&gt;

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;b&gt;Iulius&lt;/b&gt; has bestowed you with a boon. 
&lt;&lt;AbilityImage $abilitywidgetname 400&gt;&gt;&lt;&lt;/AbilityImage&gt;&gt;

&lt;i&gt;You can now use &lt;b&gt;$abilityname&lt;/b&gt; in battle!&lt;/i&gt;

[[Return-&gt;PaladinShrine][$p = 0]]

&lt;&lt;set $abilitytotal += 1&gt;&gt;\
\
&lt;&lt;set $exp -= $abilitycost&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
\
\
\
\
\
\</tw-passagedata><tw-passagedata pid="25" name="SoldierShrine" tags="" position="600,534" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $music neq &quot;shrine&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt; &lt;&lt;set $music = &quot;shrine&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
You kneel before the shrine of &lt;b&gt;Tylae&lt;/b&gt;, and beseech &lt;b&gt;Myridia, Goddess of War and Winged Victory&lt;/b&gt; for her aid. The &lt;b&gt;Godshard&lt;/b&gt; shimmers in response.
&lt;img src=&quot;Images/Locations/shrine2.jpg&quot; width=650 /&gt;

&lt;i&gt;&lt;b&gt;Note&lt;/b&gt;: Soldiers get a 20% discount on the cost to increase Strength.&lt;/i&gt;

&lt;table class=&quot;stat-table&quot;&gt;\
	&lt;tr&gt;\
		&lt;th&gt;Increase Strength&lt;/th&gt;
		&lt;th&gt;Increase Agility&lt;/th&gt;
		&lt;th&gt;Increase Willpower&lt;/th&gt;
	&lt;/tr&gt;\
	&lt;tr&gt;\
		&lt;td&gt;\
			Current (base) Strength: $basestrength
			Cost to increase by 1: &lt;&lt;StrengthCost&gt;&gt;
			&lt;&lt;if $strengthcost gt $exp&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;else&gt;&gt;[[Increase Strength-&gt;SoldierShrine][$p = 1]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
		&lt;td&gt;\
			Current (base) Agility: $baseagility
			Cost to increase by 1: &lt;&lt;AgilityCost&gt;&gt;
			&lt;&lt;if $agilitycost gt $exp&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;else&gt;&gt;[[Increase Agility-&gt;SoldierShrine][$p = 2]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
		&lt;td&gt;\
			Current (base) Willpower: $basewillpower
			Cost to increase by 1: &lt;&lt;WillpowerCost&gt;&gt;
			&lt;&lt;if $willpowercost gt $exp&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;else&gt;&gt;[[Increase Willpower-&gt;SoldierShrine][$p = 3]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
	&lt;/tr&gt;\
&lt;/table&gt;\

[[Return-&gt;Outside the Cabin][$music= 0 ]] 

To those deemed worthy, &lt;b&gt;Myridia&lt;/b&gt; can provide many boons...
&lt;&lt;if $abilitytotal gte $abilitymax&gt;&gt;&lt;i&gt;You can only know up to $abilitymax abilities at one time.&lt;/i&gt;&lt;&lt;else&gt;&gt;\
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $soldierabilityinventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:75%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $soldierabilityinventory[_i].name&gt;&gt;&lt;/b&gt; 
	Exp Cost: &lt;&lt;print $soldierabilityinventory[_i].exp&gt;&gt;
	Mana Cost: &lt;&lt;print $soldierabilityinventory[_i].mana&gt;&gt;
	Description: &lt;&lt;print $soldierabilityinventory[_i].description&gt;&gt;
	&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $exp gte $soldierabilityinventory[_i].exp&gt;&gt;&lt;&lt;link &quot;Gain Ability&quot; SoldierShrine&gt;&gt; \
	&lt;&lt;set $abilityinventory.push($soldierabilityinventory[_i])&gt;&gt;\
	&lt;&lt;set $abilityname = $soldierabilityinventory[_i].name&gt;&gt;\
	&lt;&lt;set $abilitywidgetname = $soldierabilityinventory[_i].widgetname&gt;&gt;\
	&lt;&lt;set $abilitycost = $soldierabilityinventory[_i].exp&gt;&gt;\
	&lt;&lt;set $soldierabilityinventory.delete($soldierabilityinventory[_i])&gt;&gt;\
	&lt;&lt;set $p = 4&gt;&gt;\
	&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;AbilityImage $soldierabilityinventory[_i].widgetname 200&gt;&gt;&lt;&lt;/AbilityImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;/table&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;b&gt;Ability Total:&lt;/b&gt; $abilitytotal / $abilitymax

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;b&gt;Myridia&lt;/b&gt; has bestowed you with increased strength! All will cower before your unending might!
&lt;img src=&quot;Images/Locations/shrine5.jpg&quot; width=500 /&gt;

&lt;i&gt;&lt;b&gt;Strength&lt;/b&gt; increased by 1!&lt;/i&gt;

[[Return-&gt;SoldierShrine][$p = 0]]

&lt;&lt;set $basestrength += 1&gt;&gt;
&lt;&lt;set $exp -= $strengthcost&gt;&gt;
&lt;&lt;set $timesincreasedstrength += 1&gt;&gt;

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;b&gt;Myridia&lt;/b&gt; has bestowed you with increased agility! None will match your speed, skill, and grace!
&lt;img src=&quot;Images/Locations/shrine5.jpg&quot; width=500 /&gt;

&lt;i&gt;&lt;b&gt;Agility&lt;/b&gt; increased by 1!&lt;/i&gt;

[[Return-&gt;SoldierShrine][$p = 0]]

&lt;&lt;set $baseagility += 1&gt;&gt;
&lt;&lt;set $exp -= $agilitycost&gt;&gt;
&lt;&lt;set $timesincreasedagility += 1&gt;&gt;

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;b&gt;Myridia&lt;/b&gt; has bestowed you with increased willpower! You will endure any trial, any tribulation - none will see you bested!
&lt;img src=&quot;Images/Locations/shrine5.jpg&quot; width=500 /&gt;

&lt;i&gt;&lt;b&gt;Willpower&lt;/b&gt; increased by 1!&lt;/i&gt;

[[Return-&gt;SoldierShrine][$p = 0]]

&lt;&lt;set $basewillpower += 1&gt;&gt;
&lt;&lt;set $exp -= $willpowercost&gt;&gt;
&lt;&lt;set $timesincreasedwillpower += 1&gt;&gt;

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;b&gt;Myridia&lt;/b&gt; has bestowed you with a boon. 
&lt;&lt;AbilityImage $abilitywidgetname 400&gt;&gt;&lt;&lt;/AbilityImage&gt;&gt;

&lt;i&gt;You can now use &lt;b&gt;$abilityname&lt;/b&gt; in battle!&lt;/i&gt;

[[Return-&gt;SoldierShrine][$p = 0]]
&lt;&lt;set $exp -= $abilitycost&gt;&gt;\
&lt;&lt;set $abilitytotal += 1&gt;&gt;\

&lt;&lt;/if&gt;&gt;\
\
\
\
\
\
\
\</tw-passagedata><tw-passagedata pid="26" name="RogueShrine" tags="" position="599,646" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $music neq &quot;shrine&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt; &lt;&lt;set $music = &quot;shrine&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
You kneel before the shrine of &lt;b&gt;Tylae&lt;/b&gt;, and beseech &lt;b&gt;Sathael, God of Shadow&lt;/b&gt; for his aid. The &lt;b&gt;Godshard&lt;/b&gt; shimmers in response.
&lt;img src=&quot;Images/Locations/shrine2.jpg&quot; width=650 /&gt;

&lt;i&gt;&lt;b&gt;Note&lt;/b&gt;: Rogues get a 20% discount on the cost to increase Agility.&lt;/i&gt;

&lt;table class=&quot;stat-table&quot;&gt;\
	&lt;tr&gt;\
		&lt;th&gt;Increase Strength&lt;/th&gt;
		&lt;th&gt;Increase Agility&lt;/th&gt;
		&lt;th&gt;Increase Willpower&lt;/th&gt;
	&lt;/tr&gt;\
	&lt;tr&gt;\
		&lt;td&gt;\
			Current (base) Strength: $basestrength
			Cost to increase by 1: &lt;&lt;StrengthCost&gt;&gt;
			&lt;&lt;if $strengthcost gt $exp&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;else&gt;&gt;[[Increase Strength-&gt;RogueShrine][$p = 1]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
		&lt;td&gt;\
			Current (base) Agility: $baseagility
			Cost to increase by 1: &lt;&lt;AgilityCost&gt;&gt;
			&lt;&lt;if $agilitycost gt $exp&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;else&gt;&gt;[[Increase Agility-&gt;RogueShrine][$p = 2]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
		&lt;td&gt;\
			Current (base) Willpower: $basewillpower
			Cost to increase by 1: &lt;&lt;WillpowerCost&gt;&gt;
			&lt;&lt;if $willpowercost gt $exp&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;else&gt;&gt;[[Increase Willpower-&gt;RogueShrine][$p = 3]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
	&lt;/tr&gt;\
&lt;/table&gt;\

[[Return-&gt;Outside the Cabin]] 

To those deemed worthy, &lt;b&gt;Sathael&lt;/b&gt; can provide many boons...
&lt;&lt;if $abilitytotal gte $abilitymax&gt;&gt;&lt;i&gt;You can only know up to $abilitymax abilities at one time.&lt;/i&gt;&lt;&lt;else&gt;&gt;\
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $rogueabilityinventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:75%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $rogueabilityinventory[_i].name&gt;&gt;&lt;/b&gt; 
	Exp Cost: &lt;&lt;print $rogueabilityinventory[_i].exp&gt;&gt;
	Mana Cost: &lt;&lt;print $rogueabilityinventory[_i].mana&gt;&gt;
	Description: &lt;&lt;print $rogueabilityinventory[_i].description&gt;&gt;
	&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $exp gte $rogueabilityinventory[_i].exp&gt;&gt;&lt;&lt;link &quot;Gain Ability&quot; RogueShrine&gt;&gt; \
	&lt;&lt;set $abilityinventory.push($rogueabilityinventory[_i])&gt;&gt;\
	&lt;&lt;set $abilityname = $rogueabilityinventory[_i].name&gt;&gt;\
	&lt;&lt;set $abilitywidgetname = $rogueabilityinventory[_i].widgetname&gt;&gt;\
	&lt;&lt;set $abilitycost = $rogueabilityinventory[_i].exp&gt;&gt;\
	&lt;&lt;set $rogueabilityinventory.delete($rogueabilityinventory[_i])&gt;&gt;\
	&lt;&lt;set $p = 4&gt;&gt;\
	&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;AbilityImage $rogueabilityinventory[_i].widgetname 200&gt;&gt;&lt;&lt;/AbilityImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;/table&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;b&gt;Ability Total:&lt;/b&gt; $abilitytotal / $abilitymax

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;b&gt;Sathael&lt;/b&gt; has bestowed you with increased strength! All will cower before your unending might!
&lt;img src=&quot;Images/Locations/shrine3.jpg&quot; width=500 /&gt;

&lt;i&gt;&lt;b&gt;Strength&lt;/b&gt; increased by 1!&lt;/i&gt;

[[Return-&gt;RogueShrine][$p = 0]]

&lt;&lt;set $basestrength += 1&gt;&gt;
&lt;&lt;set $exp -= $strengthcost&gt;&gt;
&lt;&lt;set $timesincreasedstrength += 1&gt;&gt;

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;b&gt;Sathael&lt;/b&gt; has bestowed you with increased agility! None will match your speed, skill, and grace!
&lt;img src=&quot;Images/Locations/shrine3.jpg&quot; width=500 /&gt;

&lt;i&gt;&lt;b&gt;Agility&lt;/b&gt; increased by 1!&lt;/i&gt;

[[Return-&gt;RogueShrine][$p = 0]]

&lt;&lt;set $baseagility += 1&gt;&gt;
&lt;&lt;set $exp -= $agilitycost&gt;&gt;
&lt;&lt;set $timesincreasedagility += 1&gt;&gt;

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;b&gt;Sathael&lt;/b&gt; has bestowed you with increased willpower! You will endure any trial, any tribulation - none will see you bested!
&lt;img src=&quot;Images/Locations/shrine3.jpg&quot; width=500 /&gt;

&lt;i&gt;&lt;b&gt;Willpower&lt;/b&gt; increased by 1!&lt;/i&gt;
&lt;&lt;set $exp -= $willpowercost&gt;&gt;
&lt;&lt;set $timesincreasedwillpower += 1&gt;&gt;

[[Return-&gt;RogueShrine][$p = 0]]

&lt;&lt;set $basewillpower += 1&gt;&gt;

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;b&gt;Sathael&lt;/b&gt; has bestowed you with a boon. 
&lt;&lt;AbilityImage $abilitywidgetname 400&gt;&gt;&lt;&lt;/AbilityImage&gt;&gt;

&lt;i&gt;You can now use &lt;b&gt;$abilityname&lt;/b&gt; in battle!&lt;/i&gt;

[[Return-&gt;RogueShrine][$p = 0]]

&lt;&lt;set $exp -= $abilitycost&gt;&gt;\
&lt;&lt;set $abilitytotal += 1&gt;&gt;\

&lt;&lt;/if&gt;&gt;\
\
\
\
\
\
\
\</tw-passagedata><tw-passagedata pid="27" name="Library" tags="" position="403,1033" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;You settle into a roughshod chair before your collection of tomes. Here, you can learn the deep secrets of this world and its denizens.
&lt;img src=&quot;Images/Locations/library1.jpg&quot; width=550 /&gt;

 &lt;table class=&quot;stat-table&quot;&gt;\
	&lt;tr&gt;\
		&lt;th&gt;Game Mechanics&lt;/th&gt;\
		&lt;th&gt;Lore&lt;/th&gt;\
	&lt;/tr&gt;\
	&lt;tr&gt;\
		&lt;td&gt;\
			[[Keybindings-&gt;Library][$p = 67]]
			[[Character Stats and Attributes-&gt;Library][$p = 1]]
			[[Battle Mechanics-&gt;Library][$p = 2]]
			[[Your Abilities-&gt;Library][$p = 3]]
			[[Attacks vs Abilities-&gt;Library][$p = 4]]
			[[Attacks vs Abilities Part 2-&gt;Library][$p = 5]]
			[[Stuns and Stun Limits-&gt;Library][$p = 6]]
		&lt;/td&gt;\
		&lt;td&gt;\
			[[The Deep Woods-&gt;Library][$p = 51]]
			&lt;&lt;if $outskirtsquest gte 3&gt;&gt;[[Goblins-&gt;Library][$p = 53]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $outskirtsquest gte 4&gt;&gt;[[The Gods-&gt;Library][$p = 52]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $outskirtsquest gte 5&gt;&gt;[[The Great Occident-&gt;Library][$p = 54]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $oristatus gte 2&gt;&gt;[[Golems-&gt;Library][$p = 57]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $outskirtsquest gte 7&gt;&gt;[[The Deathguard-&gt;Library][$p = 55]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $outskirtsquest gte 7&gt;&gt;[[The Kingdom of Man-&gt;Library][$p = 59]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $outskirtsquest gte 7&gt;&gt;[[Elves-&gt;Library][$p = 60]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $valequest gte 1&gt;&gt;[[The Dark Redeemer-&gt;Library][$p = 56]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $valequest gte 8&gt;&gt;[[The Scarlet Witch-&gt;Library][$p = 66]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $frozenquest gte 1&gt;&gt;[[The Destruction of Hadamshal-&gt;Library][$p = 61]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $frozenquest gte 1&gt;&gt;[[The Kingdom of Netheryn-&gt;Library][$p = 58]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $finalquest gte 1&gt;&gt;[[Duke Carnax-&gt;Library][$p = 62]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $finalquest gte 1&gt;&gt;[[Queen Domedra-&gt;Library][$p = 63]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $finalquest gte 1&gt;&gt;[[Nendel&#39;s Betrayal-&gt;Library][$p = 64]]&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $finalquest gte 1&gt;&gt;[[The Heart of Darkness-&gt;Library][$p = 65]]&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
	&lt;/tr&gt;\
&lt;/table&gt;\
\
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;table class=&quot;blank-table&quot;&gt;\
	&lt;tr&gt;\
		&lt;td&gt;\
			In &lt;b&gt;Battle Quest&lt;/b&gt;, your success in battle will depend on your &lt;b&gt;stats&lt;/b&gt; your &lt;b&gt;decisions&lt;/b&gt;, and a bit of &lt;b&gt;luck&lt;/b&gt;.

&lt;b&gt;Strength&lt;/b&gt;
Strength increases your chance to hit.
Strength increasing your damage dealt.
For the &lt;b&gt;Soldier&lt;/b&gt;, strength increases your maximum mana.

&lt;b&gt;Agility&lt;/b&gt;
Agility increases your chance to hit.
Agility decreases your chance to be hit by an enemy.
For the &lt;b&gt;Rogue&lt;/b&gt;, agility increases your maximum mana.

&lt;b&gt;Willpower&lt;/b&gt;
Willpower increases your maximum health.
For the &lt;b&gt;Paladin&lt;/b&gt;, willpower increases your maximum mana.

&lt;b&gt;Armor&lt;/b&gt;
If you are hit by an enemy, armor decreases the damage you take.

&lt;b&gt;Health&lt;/b&gt;
Health is a measure your lifeforce.
Health falls when you take damage, and is fully restored when you rest.
If your health falls to 0, you die and the game is over.

&lt;b&gt;Mana&lt;/b&gt;
Mana is a measure of your ability to do heroic actions.
Mana is consumed by using class abilities, and fully regenerates at the end of each battle.

&lt;b&gt;Gold&lt;/b&gt;
Gold is a valuable and common currency. It is generally gained by defeating enemies.
It can be spent on items, weapons, and armor - assuming you find a merchant in the Deep Woods

&lt;b&gt;Experience Points&lt;/b&gt;
Experience Points (exp) are a second currency. They measure your experience in defeating the evils of the Deep Woods.
Exp is gained by defeating enemies and completing heroic deeds.
It can be spent on increasing your base stats and gaining new abilities, once you gain the attention of a Shrine.
		&lt;/td&gt;\
		&lt;td&gt;\
			&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt; &lt;img src=&quot;Images/Character/paladin1.jpg&quot; width=350 /&gt; &lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt; &lt;img src=&quot;Images/Character/soldier1.jpg&quot; width=350 /&gt; &lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt; &lt;img src=&quot;Images/Character/rogue1.jpg&quot; width=350 /&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;if ($class eq &quot;paladin&quot;) and ($lewdmode eq 0)&gt;&gt; &lt;img src=&quot;Images/Character/paladin3.jpg&quot; width=350 /&gt; &lt;&lt;elseif ($class eq &quot;soldier&quot;) and ($lewdmode eq 0)&gt;&gt; &lt;img src=&quot;Images/Character/soldier3.jpg&quot; width=350 /&gt; &lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($lewdmode eq 0)&gt;&gt; &lt;img src=&quot;Images/Character/rogue3.jpg&quot; width=350 /&gt;&lt;&lt;elseif ($class eq &quot;paladin&quot;) and ($lewdmode eq 1)&gt;&gt; &lt;img src=&quot;Images/Character/paladin5.jpg&quot; width=350 /&gt;&lt;&lt;elseif ($class eq &quot;soldier&quot;) and ($lewdmode eq 1)&gt;&gt; &lt;img src=&quot;Images/Character/soldier5.jpg&quot; width=350 /&gt;&lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($lewdmode eq 1)&gt;&gt; &lt;img src=&quot;Images/Character/rogue5.jpg&quot; width=350 /&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;\
	&lt;/tr&gt;\
&lt;/table&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
In &lt;b&gt;Battle Quest&lt;/b&gt;, battle is a contest between you (the Player) and your foe (the Enemy). Battle consists of the Player and Enemy alternating turns until one of them runs out of Health. If you run out of the health, the game is over. If your Enemy runs out of health, you defeat them and the battle is finished.
&lt;img src=&quot;Images/Locations/library2.jpg&quot; width=600 /&gt;

&lt;b&gt;Player Turn&lt;/b&gt;
The Player goes first. The Player Turn consists of two phases, &lt;b&gt;Set-up&lt;/b&gt; and &lt;b&gt;Action&lt;/b&gt;.

During the &lt;b&gt;Player Set-up Phase&lt;/b&gt;, you choose what kind of action you want to take this turn. Typical actions are: attacking, fleeing the battle, using an ability, or using an item.

During the &lt;b&gt;Player Action Phase&lt;/b&gt;, you action will occur.

If you attack, you will complete an &lt;b&gt;attack roll&lt;/b&gt;. An attack roll consists of a random roll between 1 and 100, which is then increased by your Strength value and your Agility value.

If your total attack roll is higher than your enemies total evasion score, you hit.

If you hit, you roll a second roll: the &lt;b&gt;damage roll&lt;/b&gt;. A damage rol consists of a random roll between your weapons minimum damage and maximum damage, which is then increased by your Strength value.

Your Enemy&#39;s health then drops by your total damage roll, minus the Enemy&#39;s armor.

&lt;b&gt;Enemy Turn&lt;/b&gt;
The Enemy goes second. Like the Player Turn, the Enemy Turn also has a &lt;b&gt;Set-up&lt;/b&gt; and &lt;b&gt;Action&lt;/b&gt; phase. You do not decide the action the Enemy will take. Typically Enemies will attempt to attack the player, or use a special ability.

If the Enemy attacks, the mechanics are the same as during the Player turn. The Enemy will roll an &lt;b&gt;attack roll&lt;/b&gt; between 1 and 100, which will be increased by its Strength and Agility values.

If this roll is above the Player&#39;s evasion score, the Player is hit.

&lt;&lt;elseif $p eq 3&gt;&gt;\
You can review your available class abilities below. 

&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $abilityinventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:75%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $abilityinventory[_i].name&gt;&gt;&lt;/b&gt; 
	Mana Cost: &lt;&lt;print $abilityinventory[_i].mana&gt;&gt;
	Description: &lt;&lt;print $abilityinventory[_i].description&gt;&gt;
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;AbilityImage $abilityinventory[_i].widgetname 200&gt;&gt;&lt;&lt;/AbilityImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;
&lt;/table&gt;\
\
&lt;&lt;elseif $p eq 4&gt;&gt;\
In &lt;b&gt;Battle Quest&lt;/b&gt;, there are typically four actions you can take during your turn in battle: attack, ability, item, and flee.

It is important to know the difference between attacks and abilities. This distinction is important because some of your abilities will only work after an enemy &lt;i&gt;attacks&lt;/i&gt; - but will not work after an enemy &lt;i&gt;uses an ability&lt;/i&gt;. Both attacks and abilities can deal damage, so that is not enough to differentiate the two of them.

See below for an image of an attack.
&lt;img src=&quot;Images/Locations/library3.jpg&quot; width=650 /&gt;

Attacks always look like this. The attacker (the player or the enemy) will roll to hit, and then - if the hit lands - will roll for damage. Armor always reduces damage from attacks. Note that there is no special image denoting the attack, there is only text.

Now let&#39;s look at an ability.
&lt;img src=&quot;Images/Locations/library4.jpg&quot; width=650 /&gt;

Abilities always have a special image associated with them. If your enemy does something on its turn and you see an image associated with the attack, then that was an ability, not an attack.

Unlike attacks, abilities can do &lt;i&gt;nearly anything&lt;/i&gt;. Some abilities deal damage. Some abilities ignore armor. Some abilities reduce stats. Some abilities stun - or any combination of the above.

Abilities typically cannot be dodged, making them stronger than attacks. Over the course of the game, you will encounter enemies will more abilities, and they will attack &lt;i&gt;less&lt;/i&gt; often and use dangerous abilities &lt;i&gt;more&lt;/i&gt; often.

It&#39;s important to read the text involved in ability so you can understand what just happened, and plan your next move appropriately.
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
In &lt;b&gt;Battle Quest&lt;/b&gt;, attacks and abilities are &lt;i&gt;usually&lt;/i&gt; different things. Either you (or your enemy) will attack, or you (or your enemy) will use an ability. Seeing a special image associated with the action is a good way to quickly tell whether it is an ability (has an image) or an action (no image).

But there are a few special cases where an action is an ability AND an attack. See below.
&lt;img src=&quot;Images/Locations/library5.jpg&quot; width=650 /&gt;

&lt;b&gt;Smite&lt;/b&gt; is a Paladin ability that involves &lt;i&gt;making an attack&lt;/i&gt;. Mana is spent on the ability like any other ability, and it has its associated image. But, like an attack, there is a roll to hit and a roll to do damage. The Rogue&#39;s &lt;b&gt;Shadow Strike&lt;/b&gt; and the Soldier&#39;s &lt;b&gt;Burning Strike&lt;/b&gt; are also examples of this.

The important thing to know in these special cases is that when an ability involves an attack, it is typically treated as an attack in terms of the rules of battle. 

So if you have an ability that only works if you enemy just attacked you, but they used an ability &lt;i&gt;that involved them rolling to hit you&lt;/i&gt;, then your ability will work because your enemy&#39;s ability was also an attack.

If this is confusing, the best thing to do is to experiment in combat and see what happens. Ultimately, the golden rule is that &lt;i&gt;if you roll to hit, it is treated like an attack, even if it&#39;s also an ability&lt;/i&gt;.
\
&lt;&lt;elseif $p eq 6&gt;&gt;\
\
In &lt;b&gt;Battle Quest&lt;/b&gt;, the best way to mitigate taking damage and avoiding your enemy&#39;s debilitating abilities is to stun your enemy as often as possible.

Each class has one or more abilities that will stun the enemy for one or more turns. When an enemy is stunned, they cannot do anything, and their turn is skipped.
&lt;img src=&quot;Images/Locations/library7.jpg&quot; width=650 /&gt;

Stuns stack. This means that if you use an ability that stuns the enemy for 3 turns, then use it again the next turn, the enemy will be stunned for 5 turns (3 + 3 - 1 as a turn has passed). This means it is possible to &lt;i&gt;stun lock&lt;/i&gt; an enemy, keeping them stunned for a long time while chipping away at their health.

But be careful becoming too reliant on stuns, as every enemy has a &lt;i&gt;stun limit&lt;/i&gt;. Once this is reached, they will break out of there stun and will be immune to stuns for the rest of the battle!
&lt;img src=&quot;Images/Locations/library8.jpg&quot; width=650 /&gt;

Just as you can stun enemies, they can stun you. Unlike enemies, you don&#39;t have a stun limit. Beware enemies who will try to &lt;i&gt;stun lock&lt;/i&gt; you!
&lt;img src=&quot;Images/Locations/library6.jpg&quot; width=650 /&gt;

&lt;&lt;elseif $p eq 7&gt;&gt;
\
\
\
\
\
\
\
\
\
\
\
\
&lt;&lt;elseif $p eq 51&gt;&gt;\
&lt;b&gt;The Deep Woods&lt;/b&gt;
&lt;img src=&quot;Images/Locations/woods2.jpg&quot; width=600 /&gt;

The Deep Woods lie far into the hinterland of the kingdom you call home. An old forest, steeped in myth and legend.

The Woods have long thwarted any attempt at civilization. Hardy woodsmen will wander, axe in hand, but few will ever return. Those that do speak of eyes in the dark, and voiceless whispers like ice against their spine. Villages will be established in the Woods in spring, only to &lt;i&gt;disappear&lt;/i&gt; come winter&#39;s end. It&#39;s as if the Woods were a living thing. A thing best left undisturbed.

But lately, the Deep Woods have not been content to slumber. Word has reached the king of that the roads straddling the Woods are no longer safe. Rumours of dark riders seen leaving the Woods, though to where, none can say.

The kingdom&#39;s armies are already spread too thin - holding back orc hordes to the south, and putting down the River Rebellion far out West. The Kingdom&#39;s north is practically undefended. Whatever evil festers in the Deep Woods cannot be allowed to spread. 

It must be dealt with before it fully awakens.
\
\
&lt;&lt;elseif $p eq 52&gt;&gt;&lt;b&gt;The Gods&lt;/b&gt;
&lt;table class=&quot;blank-table&quot;&gt;\
	&lt;tr&gt;\
	&lt;td&gt;&lt;img src=&quot;Images/Locations/shrine2a.jpg&quot; width=300 /&gt;
	
	
	
	
	
	
		&lt;img src=&quot;Images/Locations/shrine4a.jpg&quot; width=300 /&gt;
		
		
		
		
		
		
		&lt;img src=&quot;Images/Locations/shrine3a.jpg&quot; width=300 /&gt;
		
		
		
		
		
		
		&lt;img src=&quot;Images/Locations/shrine5a.jpg&quot; width=300 /&gt;
		&lt;/td&gt;
	&lt;td&gt;There are many Gods that grace and stain the world. Some make their motivations clear, while some remain distant, their purpose obscure. Some take pity on mortals, some love a particular race as one would a child, while others shun or hate the mortal realms. A few actively seek life&#39;s destruction.
	
	The worship of those Gods amiable to mankind is encouraged in your kingdom - while the worship of those Gods bent on its destruction is forbidden - though this still happens, if in secret. Then there are the middling Gods, neither celebrated nor excluded, who hold small but devoted followings.
	
	A few Gods of note include:
	
	&lt;b&gt;Tylae, the Mother Goddess&lt;/b&gt;. Thought to be the first of the Gods, though some scholars refute this. Tylae sees all the world as her charge, if not her sole creation. Only she has the power to sew together new souls, and it is by her grace that mortals are granted free will. Why a Goddess of such power would allow souls of her making to deny her, and to commit evil, none can know. 
	
	Tylae is a popular icon of worship across the kingdom, and many shrines devoted to other Gods still bear her image, thus recognizing her as the font of all worship and creation. Though she is often petitioned for aid by young women, she is not the Goddess of fertility or of motherhood.
	
	&lt;b&gt;Iulius, God of Judgement&lt;/b&gt;. Iulius watched many tribes rise and fall in the chaos of mankind&#39;s beginning, and found it to be unjust. Thus, he established detailed codices of ethics - of rule and law - and passed these moral codes to early kingdoms. He is a maker of laws and a passer of judgements - there is, in Iulius&#39;s view, a right and a wrong to every situation. And for those who do wrong, punishment must be meted out.
	
	Iulius&#39;s followers, the Paladins, are a militant order of soldier-judges, and gain both the power of healing and righteous judgement from their patron God. They are relied upon by the kingdom to mete out justice, particularly in far-flung settlements where the king&#39;s law is often forgotten. Some find Iulius&#39;s morality too strict, too unbending. Some, indeed, see his Paladins as tyrants. 
	
	&lt;b&gt;Sathael, God of Shadow&lt;/b&gt;. So long as men have lied, Sathael has lived and breathed. He is the shadow behind every man, delighting in trickery, in deceit, and in cunning. It is said he travels across the world each night, observing and keeping careful record of all forms of subterfuge in his massive tome, the Book of Lies. None know, but many fear, what Sathael will do on the day the book is full.
	
	Worship of Sathael is not promoted in the kingdom, but it is not expressly forbidden. All but the strictess of rulers recognize the value of a well-placed lie, or misdirection. Those who turn their chin at Sathael should remember he abhors brute violence and outright cruelty. He is the patron of actors and thieves, and lends his followers his mastery of shadows, his silent step, and - if rumors are to be believed - the ability to turn invisible.
	
	&lt;b&gt;Myridia, Goddess of War and Winged Victory&lt;/b&gt;. Myridia has been a cornerstone of human worship since the first age of mankind. It is she who first taught men and women how to wage war, though it is unclear if this was to fight against the forces of evil, or each other. 
	
	Myridia is the matron of generals and soldiers. She does not champion violence for its own sake, but instead favors those who bring skill and courage to worthy combat for the sake of glory and victory. Those of her followers who fall in battle are reborn, it is said, in her bloodsoaked realm of conquest. Here, they spend eternity doing battle against ancient heroes each day, and feast in Myridia&#39;s hall each night.&lt;/td&gt;
	&lt;/tr&gt;\
&lt;/table&gt;\
\
&lt;&lt;elseif $p eq 53&gt;&gt;\
&lt;b&gt;Goblins&lt;/b&gt;

Goblins are green-skinned, cunning little creatures that live on the outskirts of most human civilizations. They tend to live in tribes, ruled by petty &#39;kings&#39; - which are at times hereditary positions, and at times won over by the strongest goblin of the tribe. 

Reviled by the righteous for the tendency to thievery, lies, and violence, it is law within the Kingdom of Man that they are to be forcibly relocated out of its borders, and killed if they refuse to leave.
&lt;img src=&quot;Images/DarkHeart/war3.jpg&quot; width=650 /&gt;

Some soft-hearted scholars see the villainy of goblins as a self-fulfilling prophecy - they are treated as creatures of darkness, and because of this they resort to dark deeds.

Of note is the symbiotic relationship between goblins and another hated species - trolls. Trolls provide goblins with some much needed physical strength for deeds demanded hard labor, and in exchange goblins provide them with food (mushrooms, mostly. Occasionaly dead goblin) and hygiene. Goblins love the taste of the fungus that grows on the backs of trolls, and clearing out this fungus is important for troll health. Thus, where one finds goblins, expect to find a few trolls, as well.

&lt;&lt;elseif $p eq 54&gt;&gt;
&lt;b&gt;The Great Occident&lt;/b&gt;

While the Kingdom of Man stretches across much of the fair lands of the Continent, it does have its limits to the east, where land turns to steppes and eventually desert, the Kingdom ends, and the Great Occident begins.
&lt;img src=&quot;Images/Locations/occident1.jpg&quot; width=500 /&gt;

The Occident is not so much a single kingdom as much as it is many separate polities - chiefs and warlords and merchant princes, all independent but closely drawn together through webs of marriage, trade, and alliances. The chiefdoms of the Occident are often at war with one another, and so keeping an updated map of the political landscape of the land is an impossible task. 

The culture of the Occident is obscure, yet much valued by the people who live there. Wealth of greater importance than blood, honor is dificult to define but all-important, and slavery is tolerated, with certain rules, limits, and rights placed on slaves to protect them and regulate their work and trade.

People of the Kingdom rarely see those from the Occident, except for the merchants, actors, and mercenaries that flow out of the distant land. This has given the people of Occident a poor reputation as liars and thieves.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

Some scholars have speculated that if a great warlord ever united the Occident into a single polity, it would have enough wealth and military might to forever shatter the Kingdom.

&lt;&lt;elseif $p eq 55&gt;&gt;\
&lt;b&gt;The Deathguard&lt;/b&gt;

The Kingdom of Man has no standing army, instead reliant on the levies mustered by its many counts, dukes, and aspiring lords. Instead, the kingdom is famed for its many orders of knights - militant groups who pledge their loyalty to the King and the Kingdom, instead of any particular lord or land. 
&lt;img src=&quot;Images/Locations/library9.jpg&quot; width=650 /&gt;

Each order has a purpose or virtue it aspires to, allowing for specalization between different groups of knights. The Ironhelms protect the great trade routes of the Kingdom. The Dawnwatch hunt vampires. The Ever Radiant serve as the royal protecters of the King.

Fifty years ago, in the wake of a bloody war between the Kingdom and an alliance of elven city-states, the Deathguard was formed. The war had ended in a somewhat humiliating statemate for the Kingdom - and many believed this was due to elven citizens of the Kingdom secretly aiding the rebel city-states. The Deathguard was charged with rooting out such treason.
&lt;img src=&quot;Images/Character/deathguard1.jpg&quot; width=500 /&gt;

The Deathguard took on this purpose with brutal efficiency. Elves were stripped of positions of power - driven out of scholarly circles, their estates put to the torch - and forces into slums. Elven knights were investigated and - after quick trials led by Deathguard judges - forced into exile. 

Much of the wealth taken from elves was transferred to the Kingdom&#39;s treasury directly. The Kingdom needed the funds, so looked the other way and quietly approved of the Deathguard&#39;s excessive zeal.

With the last independent elven city of Hadamshal destroyed twelve years ago, the Deathguard serve less purpose now than they once did. Some see them as little more than thugs, known for harassing elf servants and occasionally beheading an elf caught stealing bread.

All the same, the Deathguard knights are powerful, zealous, and unquestionably cruel. One must always be cautious in their presence.

&lt;&lt;elseif $p eq 56&gt;&gt;\
&lt;b&gt;The Dark Redeemer&lt;/b&gt;

Three years ago, a mysterious man going by the name &#39;the Redeemer&#39; appeared in the Deep Woods, seeking allies and eager to delve deep into the elven ruins in the heart of the Woods.
&lt;img src=&quot;Images/Character/redeemer1.jpg&quot; width=450 /&gt;

He had in his possession a strange crystal. Not only was the gem remarkably large and beautiful, it had the curious ability to &lt;i&gt;consume&lt;/i&gt; the light around it, darkening any room it entered. Any person spending too long near the gem seemed to become lost, agitated, paranoid, and violent. Only a powerful will could hold off its evil for long.
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=350 /&gt;

The Dark Redeemer appears to be the source of the evil waking in the Deep Woods. He seems to want to open an old portal created by the elves who once lived in the Woods, more than once thousand years ago. What is beyond that portal is unknown, but it is clear that something unfathomably evil lurks there, and must not be let out into the world.

The Redeemer&#39;s gem is the key to opening the portal. He must not be allowed to reunited with it. The gem must be found, and destroyed.

&lt;&lt;elseif $p eq 57&gt;&gt;\
&lt;b&gt;Golems&lt;/b&gt;

Before the Kingdom of Man was created, before even the elves ruled from the old forests of the Continent, the first dominant peoples of the land were the dwarves.

This was many thousands of years ago, when the world was freshly formed, and the Gods were not as distant to the mortal realm as they are today. The dwarves worshipped the God of the Mountains, and eager to be closer to their God, they delves deep into the mountainside.

There, the dwarves came upon Godshards - crystals of incredible power, thought to be physical manifestations of the Gods themselves. These they placed in grand statues to worship.

But remarkably, the statues came to life. The first golems had been forged.
&lt;img src=&quot;Images/Locations/library10.jpg&quot; width=500 /&gt;

The golems were not holy avatars of the Gods, as the dwarves hoped. They were in fact new life, formed using the same creative energy Tylae used to weave the world. Still, the dwarves celebrated the golems and treated them likely royalty. Many were created in those days of old, and a dwarf clan&#39;s stature was somewhat dependent on the golems they owned.

In time, the empires of the dwarves declined. Orc incursions, devestating earthquakes, and the rise of the elves all contributed. Golems stopped being seen as noble companions and instead as much-needed weapons of war. 

The use of golems in warfare aided the dwarves and likely sustained their failing empires for another few centuries. But there were only so many golems, as the ability to make more of them had been lost.

One day, the golems decided they were uninterested in going extinct. They left. The dwarves were displeased, and tried to stop them.

This was the final blow to dwarven might. The golems and dwarves were both devestated from the conflict that followed. The last dwarven empires were destroyed. Some fell to orcs. A few became vassals to elves, and later to the Kingdom of Man. 

As for the golems, most disappeared. Some can be found today, living alone in the forgotten corners of the continent. One actually rules as a chief in Great Occident. 

Rarest of all are the Golden Golems - none have been seen in over three hundred years. They are likely extinct - or perhaps one still remains. The last of its kind.
&lt;img src=&quot;Images/Character/ori1.jpg&quot; width=450 /&gt;

&lt;&lt;elseif $p eq 58&gt;&gt;\
\
&lt;b&gt;The Kingdom of Netheryn&lt;/b&gt;

Long before the Kingdom of Man was forcibly unified and humanity became the dominant species on the continent, the elves ruled the lands, their power divided into many glorious and decadent kingdoms.

Perhaps greatest of all the many elven kingdoms was that of Netheryn. Unrivaled in military might, magical mastery, or scientific advancement, the influence of Netheryn was felt across the full continent. Though it held power far beyond its home, the center of Netheryn&#39;s kingdom was always its capital city, located in the center of the Grove of the Goddess.
&lt;img src=&quot;Images/ScarletVale/tower13.jpg&quot; width=650 /&gt;

Only once Netheryn fell was the name of the forest changed to the Deep Woods.

Netheryn&#39;s fall is a mystery to most scholars of today. For a century, the kingdom had become to stagnate under an increasing, almost religious obsession with the concept of eternity, and the need for Netheryn to live forever. This inward focus came at the same time as a series of miitary defeats against young human kingdoms, and an increasing anti-human sentiment throughout the elven world. 

But the Kingdom of Netheryn did not decay slowly. Nor was it defeated by human invaders. In a single year, it &lt;i&gt;shattered&lt;/i&gt;. The capital was struck by some terrible tragedy, most of its population slain in an instant. Horrors of shadow and blade spread throughout the forest, killing everything they found. 
&lt;img src=&quot;Images/DarkHeart/void1.jpg&quot; width=500 /&gt;

The armies of Netheryn were able to contain the evil, barely, but only at great cost. There was nothing left of Netheryn&#39;s power remaining, by the end of it. The few survivors in the Deep Woods fled. The kingdom was essentially abandoned.

The time of the elves was over. While some elven kingdoms would continue to thrive for another seven hundred years, human kingdoms no longer paid them fealty or tribute. The time of human hegemony was near.

&lt;&lt;elseif $p eq 59&gt;&gt;\
&lt;b&gt;The Kingdom of Man&lt;/b&gt;
For five hundred years, the Continent&#39;s temperate center has been home to a single, undivided entity known as the Kingdom of Man. Its borders are many, and are as follows:
&lt;ul&gt;\
&lt;li&gt;To the west, a great spine of impassible mountains. Also many dwarven tributary fiefdoms that have sworn fealty to the Kingdon&lt;/li&gt;
&lt;li&gt;To the northwest, the vast and unbreachable Deep Woods&lt;/li&gt;
&lt;li&gt;To the northeast, the rugged steppes, filled with tribes of humans and goblins&lt;/li&gt;
&lt;li&gt;To the east, the drylands and later the Great Occident&lt;/li&gt;
&lt;li&gt;To the southeast, the Great Sea and, at its coasts, many nominally independent merchant city states. They pay the Kingdom for protection and peace&lt;/li&gt;
&lt;li&gt;To the south, vast and teeming jungles filled with orc barbarians, all eager to crush human civilization and set the Kingdom ablaze.&lt;/li&gt;
&lt;/ul&gt;\

The Kingdom of Man was forged from the fires of war. Once humans at last tore free of elven rule following the fall of Netheryn, they splintered into many minor dukedoms, each with its own laws, currency, and favored Gods. This would not do. Elves and dwarfs alike took advantage of the chaos to begin reconquering the divided humans. Worse, orcs flooded in from the south, killing and eating all in their path.

From a small village arose a man of undivided purpose and unstoppable might. His name has since become a thing nearly divine, and out of respect veering on veneration he is spoken of only as &lt;i&gt;The First King&lt;/i&gt;.

It was He who united humanity against the orcish threat. It was he who forced the orcs into the southern jungles. It was he wrote the first laws for a single human kingdom before his death.
&lt;img src=&quot;Images/Locations/library11.jpg&quot; width=650 /&gt;

That was over one thousand years ago. The centuries that followed involved a slow, steady growth as the Kingdom absorbed its neighbours, at time through diplomacy, at time through marriage. Eight hundred years ago, the dwarves were forced to bend the knee to the Kingdom, after a disastrous war against orcs that forced them to beg for human aid. The borders of the Kingdom spread and spread until it became by far the largest unified political entity in the known world.
&lt;img src=&quot;Images/Epilogue/kingdom1.jpg&quot; width=650 /&gt;

The elves fought against the Kingdom for centuries. First to conquer it. Then to defend their independence. Only recently have the last old elven principalities fallen under human rule. Now, it is illegal for elves to hold positions of nobility or high office, though some within the Kingdom seek to change this. 

Today, the kingdom is a massive political entity, always straddling a balance between royal power and the need for decentralization. The dukes retain a fair degree of independence, particularly those at the borders. A single currency and a single set of laws rules the land, and all matters mortal and divine ultimately rest on the king&#39;s authority, but the interpretation of those laws differs depending on the area one finds himself in. 

The Kingdom is remarkably stable, yet always appears on the brink of collapse. Its administration is bloated, its coffers often nearly empty, its enemies within and without many, and the next orcish incursion could be the fatal one. Only by the daily efforts of its knights, its devout priests and paladins, its countless spies, its hardy peasantry, and its dwindling heroes does it carry on. 

&lt;&lt;elseif $p eq 60&gt;&gt;\
&lt;b&gt;Elves&lt;/b&gt;

The history of elves is a matter of some dispute among scholars within the Kingdom of Man. The reason for this is twofold: first, the view many hold on elves is colored by distrust and in some cases hatred, and second, most libraries of elven lore - written by elves themselves in centuries past - were put to the torch when their lands were brought under the Kingdom&#39;s hegemony in glorious wars of conquest.

But some things are known with certainty. While mankind lived in small, disparate tribes, eeking out an existence in the shadows, elves were the dominant force on the Continent. Too prideful to ever unite in single purpose, elven civilization was made up of many grand kingdoms, each held together through magical might and the widespread trade of slaves - mostly humans, dwarves, and goblins. 
&lt;img src=&quot;Images/Locations/library12.jpg&quot; width=650 /&gt;

While human writing of this time in history is scant, what has survived notes the overwhelming cruelty of the elven kings - but then, what slave would say otherwise of his master? In time, the strength of elves began to fade. Petty wars between kingdoms drained blood and treasure from all. Academies of magic closed, and slaves broke out into broad revolt. 

When the great elven Kingdom of Netheryn fell apart in a single year, any pretense of elven dominace was shattered. Human kingdoms broke lines of fealty to their elven masters in the century that followed, and though elven independence lingered on until the fall of Hadamshal, the time of the elves was finished.

Where did the elves go? Some fled to the Great Occident. Some took the the Sea. Most sought to build new lives within the Kingdom of Man. While never were elves admitted to the nobility, many found wealth and honor in academic, military, and mercantile careers. 
&lt;img src=&quot;Images/Locations/library13.jpg&quot; width=550 /&gt;

As the last of the free elven principalities were gradually crushed over the last hundred years, distrust of elves has grown throughout the Kingdom of Man. Many have been stripped of their property, thrown into slums, or simply killed. Just as humans did fifteen hundred years ago, many elves now yearn for freedom, and dream of fleeing their great oppressor.

&lt;&lt;elseif $p eq 61&gt;&gt;\
\
&lt;b&gt;The Destruction of Hadamshal&lt;/b&gt;

Among all the elven city-states that rose to prominence in recent history, none was more grand and mighty than Hadamshal. A glittering city famed for its towers of glass and gardens of black roses, it was a metropolis of great repute, and a refuge for poets and scholars from across the Continent.
&lt;img src=&quot;Images/Locations/library14.jpg&quot; width=650 /&gt;

While many city-states took arms against the aggression of the Kingdom of Man, Hadamshal opted instead to push for peaceful co-existence and mutual dependence through trade. For a time, this strategy worked, and Hadamshal was spared the harsh wars of conquest that eventually took down its elven cousins.

But this peace was always a strategy to delay, not avoid, its conquest. When its king at last saw war or capitulation as completely inevitable, he negotiated a fair compromise - Hadamshal would bend the knee to the Kingdom of Man, pay a hefty annual tribute, and would raise no independent army. In exchange, its nobility would retain self-rule of the city-state, and fall under the Kingdom&#39;s protection.

But this compromise was betrayed. The human ambassador, while within the walls of Hadamshal, was slain by an elven assailant. His bodyguard reacted with fiery vengeance, alongside the human army that waited just beyond the city&#39;s walls. The battle was short and violent. Hadamshal was sacked, looted, and put to the torch. Its populace scattered, never to return.
&lt;img src=&quot;Images/ScarletVale/hadamshal1.jpg&quot; width=650 /&gt;

Hadamshal&#39;s king was killed, his skull split in two by a young hero who was graciously rewarded by the Kingdom. The elven king&#39;s son and daughter were never seen again - likely both were slain in the violence of that day.

Thus ended the last remnant of elven freedom on the continent.

&lt;&lt;elseif $p eq 62&gt;&gt;\
\
&lt;b&gt;Duke Carnax&lt;/b&gt;

Duke Radan&#39;ar Carnax was, in his mortal life, an elf of noble blood and the scion of an ancient house within the Kingdom of Netheryn. He was also an accomplished mage and reknowned scholar. At his queen&#39;s request, he led much of the arcane investigations that culminated in the creation of the Void Gem. 
&lt;img src=&quot;Images/FrozenHills/lich3.jpg&quot; width=450 /&gt;

Carnax, like most of the elves of Netheryn, was betrayed by Queen Domedra. She sought not to defeat Void itself, but instead to surrender the world to it. Thus it was Duke Carnax who led the Netheryn resistance against the Voidspawn once the Dark Portal was first opened. Though many lives were lost, Carnax was ultimately successful in closing the Portal and capturing Queen Domedra.

By that point, Netheryn&#39;s capital was already a ruin. Its army was shattered, and its many subject states took the opportunity to revolt against it. To Carnax&#39;s horror, he discovered that though he as victorious, there was no kingdom left to save. 

Gripped by bitterness and anger, Duke Carnax cursed Queen Domedra to a kind of half-life, entombed within the Winter Palace. He and his retainers vowed to guard her crypt for eternity, and cursed themselves with undeath to ensure they would be able to watch her forever.
&lt;img src=&quot;Images/FrozenHills/lich1.jpg&quot; width=450 /&gt;

That was fourteen hundred years ago. Duke Carnax maintained his vigil for many centuries in quiet contemplation. Slowly, though, his sanity unravelled, and his bitterness grew. He took to venturing to the Kingdom of Man in disguise, and stealing souls - whether for power, or for amusement, none can say.

Duke Carnax&#39;s waning grip on reality fully faded when he met the Redeemer, and was exposed to the corrupting influence of the Void Gem. Like so many, he became obsessed with it, and sought to use its power to restore the Kingdom of Netheryn and bring back the hegemony of elves.

&lt;&lt;elseif $p eq 63&gt;&gt;
&lt;b&gt;Queen Domedra&lt;/b&gt;

Queen Domedra was the sole child of her father, and succeeded him at a young age to become the reigning monarch of, at the time, the most powerful polity on the continent: the Kingdom of Netheryn. 
&lt;img src=&quot;Images/Locations/library15.jpg&quot; width=450 /&gt;

Before her father&#39;s death, she served as the high priestess of Tylae, and learned much of the magic of life and death, and the secrets of the world&#39;s creation. Blessed by the Goddess, she was known to be beautiful, wise, and unwavering in her judgements. Many expected her to lead Netheryn into a new golden age.

But Queen Domedra, even in her youth, carried with her a darkness in her heart that would spell the doom of her people. She wanted not just to protect the elves, but to destroy all those she saw as their enemies. She wanted not just glory for Netheryn, but eternal magnificence.

Slowly, carefully, she built a cult within her Kingdom around the concept of eternity - eternal life, enternal beauty, eternal power. This culminated in a &#39;crusade against the end&#39; - a war against Void, God of Destruction. This, Domedra convinced her people, would give Netheryn the power it so deserved.

The creation of the Void Gem demanded, above all else, blood. Human sacrifice became commonplace in Netheryn, and when that failed, elven sacrifice followed. Children turned on their parents, husbands against wives, as Domedra demanded more and more blood to feed the construction of the Void Gem, until at last, it was done.
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=350 /&gt;

Of course, Queen Domedra was lying to her people. She had no misconception about being able to defeat Void. Instead, her only ambition was to invite the end of the world into Netheryn. 

Why? This is unknown. One must speculate that she found the world wanting - unclear beyond any hope for redemption. Or, perhaps, as she grew old and saw her own death nearing, she hated the idea of Netheryn existing without her at its helm. 

Whatever the reason, Domedra opened the Dark Portal, and in a moment doomed the Kingdom of Netheryn. Only the bravery of Netheryn&#39;s mages saved the world, as the Portal was shut and Domedra was imprisoned.

&lt;&lt;elseif $p eq 64&gt;&gt;\
\
&lt;b&gt;Nendel&#39;s Betrayal&lt;/b&gt;

Prince Nendel&#39;ar of Hadamshal was born into desperate circumstances. Growing up, he watched from Hadamshals&#39; high walls as the last few free elven principalities were conquered by the Kingdom of Man. As he entered his adolesence, he advised in father, the king of Hadamshal, on how best to negotiate with the humans. 

He worked with his all his might and all his wit to become wise enough to protect Hadamshal from the indomitable will of the Kingdom of Man. By his twentieth year, he was an unmatched warrior, a masterful mage, and a scholar of elven lore.
&lt;img src=&quot;Images/Character/nendel1.jpg&quot; width=450 /&gt;

But in the end, this was not enough. There was nothing Nendel could do to stop the destruction of Hadamshal, or to save his father, who died before his eyes. In a single day, Nendel&#39;s life was shattered. Once a prince, he became a refugee, always on the run from the ever-vigilant Deathguard.

While in hiding, Nendel discovered a treasure, long-hidden in Hadamshal&#39;s vaults, but uncovered on the day the city fell. The Void Gem, the dark crystal that brought about the ruin of Netheryn.
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=350 /&gt;

Disturbed upon realized that the Void Gem still existed after all these centuries, Nendel at first attempted to destroy it. But slowly, the influence of the Gem worked its way into Nendel&#39;s mind, taking root within the guilt and anger he harbored in his soul. 

Three years ago, Nendel abandoned his sister and ventured alone in the Deep Woods. There he took on the name &lt;i&gt;the Redeemer&lt;/i&gt;, and worked with the Woods&#39; goblins to reactivate the Dark Portal and finish what Queen Domedra had started fourteen hundred years ago.
&lt;img src=&quot;Images/Character/redeemer1.jpg&quot; width=450 /&gt;

Nendel&#39;s ambitions were delayed by the betrayal of Gresh, the Goblin King. Fearing the Voidspawn that crawled from the Dark Portal, Gresh stole the gem and fled, his loyal goblins sacrificing their lives to buy him time to escape. 

Once relieved of the Void Gem, Nendel was able to regain some amount of control again, and realized the extent to which the Gem had corrupted him. He enlisted his sister&#39;s help, and together they dared to reclaim the Gem and destroy it once and for all.

But Nendel&#39;s will had forever been compromised. The closer he came to the Gem, the more inexorable its sway over him became. In the Winter Palace, he betrayed his sister and took possession of the Void Gem once more.

Prince Nendel&#39;ar of Hadamshal is dead. Only the Redeemer remains. In a few more days, the Dark Portal will be opened for a third and final time, and the world will surely be vanquished by the eternal dark.

&lt;&lt;elseif $p eq 65&gt;&gt;\
\
&lt;b&gt;The Heart of Darkness&lt;/b&gt;

In the center of the Deep Woods lies the heart of its corruption. Here, the trees are twisted and black, and the soil stinks like a festering wound. The Void has laid claimed to the land itself, and reality has little power over the overwhelming chaos. 
&lt;img src=&quot;Images/DarkHeart/dark1.jpg&quot; width=600 /&gt;

The Heart of Darkness is haunted by Voidspawn - monstrous creatures either corrupted by the Dark Portal, or else spawned from the end of time itself, having ventured into this world from the Dark Portal when it was last opened. There is no life, no beauty, no truth in the Heart of the Deep Woods. There is only madness and destruction.

And if one dares to venture deep into the Dark Heart, one will come upon an ancient, shadowed city. The ruins of Netheryn&#39;s capital still stand, diminished by time and long emptied of life, but still they linger, a haunted reminder of the city&#39;s untimely destruction. 
&lt;img src=&quot;Images/DarkHeart/ruins6.jpg&quot; width=600 /&gt;

&lt;&lt;elseif $p eq 66&gt;&gt;\
\
&lt;b&gt;The Scarlet Witch&lt;/b&gt;

The Deep Woods is not a tamed land. Few dare live in it, or even near it. Those brave and foolish enough to spend time beneath its shadowed canopies will often speak in whispers of a warden that guards the place. A devious mage who takes pleasure in driving the innocent mad, and drinking the blood of children.

This mage, they call &lt;i&gt;The Scarlet Witch&lt;/i&gt;.

In truth, the Scarlet Witch is a lie, a story carefully crafted by Scyllia, the priestess of Tylae, to keep people away from the Deep Woods.
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

The Deep Woods have always been closely tied to the Mother Goddess, though since the fall of Netheryn many have forgotten this fact. It was in the Deep Woods that Tylae first began her weave of creation that eventually became the world. Though the Woods have fallen to darkness, Scyllia remains, and strives to maintain a tenuous bond between Tylae and the mortal realm. 

In addition to being the priestess of Tylae, Scyllia is a powerful healer and wielder of light magic. This power, bestowed upon her by Tylae herself, is used to fight back against the Voidspawn whenever they venture too far from the Woods&#39; corrupted core. If not for the vigilance of the Scarlet Witch, many more would fall victim to the horrors of the Deep Woods.

&lt;&lt;elseif $p eq 67&gt;&gt;\
\
&lt;b&gt;Battle Quest&lt;/b&gt; uses a simple set of keybindings to help you navigate the game more smoothly.

For the first 10 links on any page, the links are bound to the keys 1 through to 0 (1, 2, 3, 4, 5, 6, 7, 8, 9, and then 0).

If there is only one link on a page, it is bound to the 1 key, even though it doesn&#39;t show a small 1 beside the link.

If there are more than 10 links on a given page, every link from the tenth onwards will &lt;i&gt;look&lt;/i&gt; like it is bound to the 0 key, but the 0 key will only activate the tenth link, not the eleventh, or the twelfth, and so on.

So that means that links past the tenth link do not have a key bound to them.

To test keybindings, press 1 on this page to return to the library list, or press 2 to leave the library.

&lt;&lt;elseif $p eq 68&gt;&gt;



















































\
&lt;&lt;/if&gt;&gt;
[[Return to Library list-&gt;Library][$p = 0]] 
[[Leave Library-&gt;Cabin]] 
\</tw-passagedata><tw-passagedata pid="28" name="Stat Blocks" tags="widget nobr" position="202,520" size="100,100">STAT BLOCKS

&lt;&lt;widget &quot;AlistairStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Alistair, the Red Butcher&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 600&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 600&gt;&gt;
&lt;&lt;set $enemystrength = 35&gt;&gt;
&lt;&lt;set $enemyagility = 40&gt;&gt;
&lt;&lt;set $enemywillpower = 20&gt;&gt;
&lt;&lt;set $enemybaseevade = 60&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 20&gt;&gt;
&lt;&lt;set $enemymindamage = 20&gt;&gt;
&lt;&lt;set $enemymaxdamage = 50&gt;&gt;
&lt;&lt;set $enemymingold = 100&gt;&gt;
&lt;&lt;set $enemymaxgold = 120&gt;&gt;
&lt;&lt;set $enemyminexp = 80&gt;&gt;
&lt;&lt;set $enemymaxexp = 115&gt;&gt;
&lt;&lt;set $enemyregion = &quot;ScarletVale&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;alistair1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;DoubleSlash&quot;, &quot;DoubleSlash&quot;, &quot;Haunt&quot;, &quot;ConsumeMana&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 8&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;AvatarStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Fragment of Iulius&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 9999&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 9999&gt;&gt;
&lt;&lt;set $enemystrength = 200&gt;&gt;
&lt;&lt;set $enemyagility = 10&gt;&gt;
&lt;&lt;set $enemywillpower = 200&gt;&gt;
&lt;&lt;set $enemybaseevade = 10&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 10&gt;&gt;
&lt;&lt;set $enemymindamage = 100&gt;&gt;
&lt;&lt;set $enemymaxdamage = 200&gt;&gt;
&lt;&lt;set $enemymingold = 10&gt;&gt;
&lt;&lt;set $enemymaxgold = 20&gt;&gt;
&lt;&lt;set $enemyminexp = 150&gt;&gt;
&lt;&lt;set $enemymaxexp = 200&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;avatar1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;AvatarArt&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 1&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;BearStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Dire Bear&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 200&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 200&gt;&gt;
&lt;&lt;set $enemystrength = 14&gt;&gt;
&lt;&lt;set $enemyagility = 2&gt;&gt;
&lt;&lt;set $enemywillpower = 10&gt;&gt;
&lt;&lt;set $enemybaseevade = 30&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 3&gt;&gt;
&lt;&lt;set $enemymindamage = 4&gt;&gt;
&lt;&lt;set $enemymaxdamage = 10&gt;&gt;
&lt;&lt;set $enemymingold = 25&gt;&gt;
&lt;&lt;set $enemymaxgold = 40&gt;&gt;
&lt;&lt;set $enemyminexp = 45&gt;&gt;
&lt;&lt;set $enemymaxexp = 55&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;direbear1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;Roar&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;BoarStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Dire Boar&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 100&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 100&gt;&gt;
&lt;&lt;set $enemystrength = 10&gt;&gt;
&lt;&lt;set $enemyagility = 1&gt;&gt;
&lt;&lt;set $enemywillpower = 5&gt;&gt;
&lt;&lt;set $enemybaseevade = 30&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 1&gt;&gt;
&lt;&lt;set $enemymindamage = 1&gt;&gt;
&lt;&lt;set $enemymaxdamage = 12&gt;&gt;
&lt;&lt;set $enemymingold = 12&gt;&gt;
&lt;&lt;set $enemymaxgold = 17&gt;&gt;
&lt;&lt;set $enemyminexp = 15&gt;&gt;
&lt;&lt;set $enemymaxexp = 25&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;direboar1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;BarsenesStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Count Barsenes the Vile&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 1199&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 1199&gt;&gt;
&lt;&lt;set $enemystrength = 30&gt;&gt;
&lt;&lt;set $enemyagility = 60&gt;&gt;
&lt;&lt;set $enemywillpower = 30&gt;&gt;
&lt;&lt;set $enemybaseevade = 40&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 25&gt;&gt;
&lt;&lt;set $enemymindamage = 49&gt;&gt;
&lt;&lt;set $enemymaxdamage = 59&gt;&gt;
&lt;&lt;set $enemymingold = 160&gt;&gt;
&lt;&lt;set $enemymaxgold = 170&gt;&gt;
&lt;&lt;set $enemyminexp = 155&gt;&gt;
&lt;&lt;set $enemymaxexp = 170&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;count1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;Gloat&quot;, &quot;DarkChivalry&quot;, &quot;BarsenesArt&quot;, &quot;BarsenesArt&quot;, &quot;BarsenesArt&quot;, &quot;BarsenesArt&quot;, &quot;BarsenesArt&quot;, &quot;BarsenesArt&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;BloodGolemStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Blood Golem&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 800&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 800&gt;&gt;
&lt;&lt;set $enemystrength = 40&gt;&gt;
&lt;&lt;set $enemyagility = 5&gt;&gt;
&lt;&lt;set $enemywillpower = 30&gt;&gt;
&lt;&lt;set $enemybaseevade = 40&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 1&gt;&gt;
&lt;&lt;set $enemymindamage = 30&gt;&gt;
&lt;&lt;set $enemymaxdamage = 60&gt;&gt;
&lt;&lt;set $enemymingold = 140&gt;&gt;
&lt;&lt;set $enemymaxgold = 160&gt;&gt;
&lt;&lt;set $enemyminexp = 131&gt;&gt;
&lt;&lt;set $enemymaxexp = 147&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;golem1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;Bloodsport&quot;, &quot;BloodFeast&quot;, &quot;BloodFeast&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;MinotaurStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Bloodied Minotaur&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 2000&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 1250&gt;&gt;
&lt;&lt;set $enemystrength = 100&gt;&gt;
&lt;&lt;set $enemyagility = 65&gt;&gt;
&lt;&lt;set $enemywillpower = 65&gt;&gt;
&lt;&lt;set $enemybaseevade = 70&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 65&gt;&gt;
&lt;&lt;set $enemymindamage = 45&gt;&gt;
&lt;&lt;set $enemymaxdamage = 85&gt;&gt;
&lt;&lt;set $enemymingold = 300&gt;&gt;
&lt;&lt;set $enemymaxgold = 400&gt;&gt;
&lt;&lt;set $enemyminexp = 300&gt;&gt;
&lt;&lt;set $enemymaxexp = 400&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;minotaur1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;Bloodsport&quot;, &quot;Wound&quot;, &quot;Charge&quot;, &quot;Charge&quot;, &quot;MonstrousBite&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;BoneGolemStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Bone Golem&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 800&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 800&gt;&gt;
&lt;&lt;set $enemystrength = 40&gt;&gt;
&lt;&lt;set $enemyagility = 5&gt;&gt;
&lt;&lt;set $enemywillpower = 30&gt;&gt;
&lt;&lt;set $enemybaseevade = 40&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 200&gt;&gt;
&lt;&lt;set $enemymindamage = 30&gt;&gt;
&lt;&lt;set $enemymaxdamage = 50&gt;&gt;
&lt;&lt;set $enemymingold = 140&gt;&gt;
&lt;&lt;set $enemymaxgold = 160&gt;&gt;
&lt;&lt;set $enemyminexp = 131&gt;&gt;
&lt;&lt;set $enemymaxexp = 147&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;golem3&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;BoneStorm&quot;, &quot;BoneStorm&quot;, &quot;BoneFeast&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;CarnaxStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Duke Carnax&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 1200&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 1200&gt;&gt;
&lt;&lt;set $enemyspecialhealth = 600&gt;&gt;
&lt;&lt;set $enemystrength = 30&gt;&gt;
&lt;&lt;set $enemyagility = 30&gt;&gt;
&lt;&lt;set $enemywillpower = 75&gt;&gt;
&lt;&lt;set $enemybaseevade = 35&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 30&gt;&gt;
&lt;&lt;set $enemymindamage = 40&gt;&gt;
&lt;&lt;set $enemymaxdamage = 65&gt;&gt;
&lt;&lt;set $enemymingold = 170&gt;&gt;
&lt;&lt;set $enemymaxgold = 190&gt;&gt;
&lt;&lt;set $enemyminexp = 165&gt;&gt;
&lt;&lt;set $enemymaxexp = 188&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;lich5&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;IceWall&quot;, &quot;CarnaxArt&quot;, &quot;CarnaxArt&quot;, &quot;CarnaxArt&quot;, &quot;CarnaxArt&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Carnax2Stats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Carnax, the Dread Lich&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 1600&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 1600&gt;&gt;
&lt;&lt;set $enemyspecialhealth = 800&gt;&gt;
&lt;&lt;set $enemystrength = 30&gt;&gt;
&lt;&lt;set $enemyagility = 50&gt;&gt;
&lt;&lt;set $enemywillpower = 100&gt;&gt;
&lt;&lt;set $enemybaseevade = 45&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 15&gt;&gt;
&lt;&lt;set $enemymindamage = 55&gt;&gt;
&lt;&lt;set $enemymaxdamage = 85&gt;&gt;
&lt;&lt;set $enemymingold = 170&gt;&gt;
&lt;&lt;set $enemymaxgold = 190&gt;&gt;
&lt;&lt;set $enemyminexp = 165&gt;&gt;
&lt;&lt;set $enemymaxexp = 188&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;lich1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;Haunt&quot;, &quot;ConsumeMana&quot;, &quot;Carnax2Art&quot;, &quot;Carnax2Art&quot;, &quot;Carnax2Art&quot;, &quot;Carnax2Art&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;FrostTrollStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Frost Troll&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 650&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 650&gt;&gt;
&lt;&lt;set $enemystrength = 50&gt;&gt;
&lt;&lt;set $enemyagility = 5&gt;&gt;
&lt;&lt;set $enemywillpower = 30&gt;&gt;
&lt;&lt;set $enemybaseevade = 45&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 40&gt;&gt;
&lt;&lt;set $enemymindamage = 35&gt;&gt;
&lt;&lt;set $enemymaxdamage = 60&gt;&gt;
&lt;&lt;set $enemymingold = 135&gt;&gt;
&lt;&lt;set $enemymaxgold = 150&gt;&gt;
&lt;&lt;set $enemyminexp = 120&gt;&gt;
&lt;&lt;set $enemymaxexp = 134&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;frosttroll1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;HardShell&quot;, &quot;Regenerate&quot;, &quot;FrostBreath&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GhorokStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Ghorok, the Berserker&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 800&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 800&gt;&gt;
&lt;&lt;set $enemyspecialhealth = 450&gt;&gt;
&lt;&lt;set $enemystrength = 30&gt;&gt;
&lt;&lt;set $enemyagility = 25&gt;&gt;
&lt;&lt;set $enemywillpower = 20&gt;&gt;
&lt;&lt;set $enemybaseevade = 45&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 10&gt;&gt;
&lt;&lt;set $enemymindamage = 20&gt;&gt;
&lt;&lt;set $enemymaxdamage = 30&gt;&gt;
&lt;&lt;set $enemymingold = 100&gt;&gt;
&lt;&lt;set $enemymaxgold = 120&gt;&gt;
&lt;&lt;set $enemyminexp = 100&gt;&gt;
&lt;&lt;set $enemymaxexp = 120&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;ghorok1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;IronBlood&quot;, &quot;BeserkerStance&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 8&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GreshStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Gresh, the Goblin King&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 500&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 500&gt;&gt;
&lt;&lt;set $enemystrength = 20&gt;&gt;
&lt;&lt;set $enemyagility = 20&gt;&gt;
&lt;&lt;set $enemywillpower = 20&gt;&gt;
&lt;&lt;set $enemybaseevade = 50&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 10&gt;&gt;
&lt;&lt;set $enemymindamage = 15&gt;&gt;
&lt;&lt;set $enemymaxdamage = 25&gt;&gt;
&lt;&lt;set $enemymingold = 100&gt;&gt;
&lt;&lt;set $enemymaxgold = 120&gt;&gt;
&lt;&lt;set $enemyminexp = 100&gt;&gt;
&lt;&lt;set $enemymaxexp = 120&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;gresh1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;DefensiveStance&quot;, &quot;ShieldSlam&quot;, &quot;ShieldSlam&quot;, &quot;BeserkerStance&quot;, &quot;GemSight&quot;, &quot;GemSight&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 10&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GoblinStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Goblin&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 90&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 90&gt;&gt;
&lt;&lt;set $enemystrength = 7&gt;&gt;
&lt;&lt;set $enemyagility = 10&gt;&gt;
&lt;&lt;set $enemywillpower = 5&gt;&gt;
&lt;&lt;set $enemybaseevade = 40&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 4&gt;&gt;
&lt;&lt;set $enemymindamage = 4&gt;&gt;
&lt;&lt;set $enemymaxdamage = 11&gt;&gt;
&lt;&lt;set $enemymingold = 15&gt;&gt;
&lt;&lt;set $enemymaxgold = 35&gt;&gt;
&lt;&lt;set $enemyminexp = 10&gt;&gt;
&lt;&lt;set $enemymaxexp = 20&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;goblin1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GoblinAlchemistStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Goblin Alchemist&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 250&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 250&gt;&gt;
&lt;&lt;set $enemystrength = 10&gt;&gt;
&lt;&lt;set $enemyagility = 10&gt;&gt;
&lt;&lt;set $enemywillpower = 10&gt;&gt;
&lt;&lt;set $enemybaseevade = 55&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 10&gt;&gt;
&lt;&lt;set $enemymindamage = 15&gt;&gt;
&lt;&lt;set $enemymaxdamage = 25&gt;&gt;
&lt;&lt;set $enemymingold = 45&gt;&gt;
&lt;&lt;set $enemymaxgold = 55&gt;&gt;
&lt;&lt;set $enemyminexp = 36&gt;&gt;
&lt;&lt;set $enemymaxexp = 50&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;goblin7&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;ExplosivePotion&quot;, &quot;PowerPotion&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 8&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GoblinArcherStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Goblin Archer&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 100&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 100&gt;&gt;
&lt;&lt;set $enemystrength = 7&gt;&gt;
&lt;&lt;set $enemyagility = 12&gt;&gt;
&lt;&lt;set $enemywillpower = 5&gt;&gt;
&lt;&lt;set $enemybaseevade = 45&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 2&gt;&gt;
&lt;&lt;set $enemymindamage = 6&gt;&gt;
&lt;&lt;set $enemymaxdamage = 11&gt;&gt;
&lt;&lt;set $enemymingold = 23&gt;&gt;
&lt;&lt;set $enemymaxgold = 47&gt;&gt;
&lt;&lt;set $enemyminexp = 21&gt;&gt;
&lt;&lt;set $enemymaxexp = 32&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;goblin3&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;PoisonArrow&quot;)&gt;&gt;&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GoblinBruiserStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Goblin Bruiser&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 150&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 150&gt;&gt;
&lt;&lt;set $enemystrength = 16&gt;&gt;
&lt;&lt;set $enemyagility = 6&gt;&gt;
&lt;&lt;set $enemywillpower = 10&gt;&gt;
&lt;&lt;set $enemybaseevade = 40&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 9&gt;&gt;
&lt;&lt;set $enemymindamage = 12&gt;&gt;
&lt;&lt;set $enemymaxdamage = 24&gt;&gt;
&lt;&lt;set $enemymingold = 35&gt;&gt;
&lt;&lt;set $enemymaxgold = 50&gt;&gt;
&lt;&lt;set $enemyminexp = 25&gt;&gt;
&lt;&lt;set $enemymaxexp = 42&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;goblin5&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;GoblinElite&quot;, &quot;ShieldSlam&quot;, &quot;Wound&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 8&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;DeathguardSoldierStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Deathguard Soldier&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 400&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 400&gt;&gt;
&lt;&lt;set $enemystrength = 30&gt;&gt;
&lt;&lt;set $enemyagility = 25&gt;&gt;
&lt;&lt;set $enemywillpower = 20&gt;&gt;
&lt;&lt;set $enemybaseevade = 40&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 35&gt;&gt;
&lt;&lt;set $enemymindamage = 20&gt;&gt;
&lt;&lt;set $enemymaxdamage = 42&gt;&gt;
&lt;&lt;set $enemymingold = 100&gt;&gt;
&lt;&lt;set $enemymaxgold = 150&gt;&gt;
&lt;&lt;set $enemyminexp = 90&gt;&gt;
&lt;&lt;set $enemymaxexp = 140&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;deathguard3&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;MightySlash&quot;, &quot;ShieldSlam&quot;, &quot;MightySlash&quot;, &quot;ExplosivePotion&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Domitus1Stats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Captain Domitus&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 1000&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 1000&gt;&gt;
&lt;&lt;set $enemystrength = 30&gt;&gt;
&lt;&lt;set $enemyagility = 30&gt;&gt;
&lt;&lt;set $enemywillpower = 30&gt;&gt;
&lt;&lt;set $enemybaseevade = 45&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 50&gt;&gt;
&lt;&lt;set $enemymindamage = 25&gt;&gt;
&lt;&lt;set $enemymaxdamage = 45&gt;&gt;
&lt;&lt;set $enemymingold = 150&gt;&gt;
&lt;&lt;set $enemymaxgold = 200&gt;&gt;
&lt;&lt;set $enemyminexp = 200&gt;&gt;
&lt;&lt;set $enemymaxexp = 225&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;deathguard5&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;Gloat&quot;, &quot;MightySlash&quot;, &quot;MightySlash&quot;, &quot;EternalVigil&quot;, &quot;DarkVerdict&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 8&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Domitus2Stats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Captain Domitus&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 1750&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 1750&gt;&gt;
&lt;&lt;set $enemystrength = 75&gt;&gt;
&lt;&lt;set $enemyagility = 50&gt;&gt;
&lt;&lt;set $enemywillpower = 50&gt;&gt;
&lt;&lt;set $enemybaseevade = 45&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 75&gt;&gt;
&lt;&lt;set $enemymindamage = 55&gt;&gt;
&lt;&lt;set $enemymaxdamage = 95&gt;&gt;
&lt;&lt;set $enemymingold = 260&gt;&gt;
&lt;&lt;set $enemymaxgold = 300&gt;&gt;
&lt;&lt;set $enemyminexp = 250&gt;&gt;
&lt;&lt;set $enemymaxexp = 300&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;deathguard5&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;DomitusArt&quot;, &quot;DomitusArt&quot;, &quot;DomitusArt&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 8&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;OriStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Oriazus the Resplendent&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 750&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 750&gt;&gt;
&lt;&lt;set $enemystrength = 40&gt;&gt;
&lt;&lt;set $enemyagility = 10&gt;&gt;
&lt;&lt;set $enemywillpower = 35&gt;&gt;
&lt;&lt;set $enemybaseevade = 10&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 20&gt;&gt;
&lt;&lt;set $enemymindamage = 20&gt;&gt;
&lt;&lt;set $enemymaxdamage = 30&gt;&gt;
&lt;&lt;set $enemymingold = 1000&gt;&gt;
&lt;&lt;set $enemymaxgold = 1500&gt;&gt;
&lt;&lt;set $enemyminexp = 300&gt;&gt;
&lt;&lt;set $enemymaxexp = 400&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;ori1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;HardShell&quot;, &quot;MoltenGold&quot;, &quot;Bash&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 2&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;HestusStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Fragment of Hestus&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 1000&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 1000&gt;&gt;
&lt;&lt;set $enemystrength = 1&gt;&gt;
&lt;&lt;set $enemyagility = 1&gt;&gt;
&lt;&lt;set $enemywillpower = 50&gt;&gt;
&lt;&lt;set $enemybaseevade = 1&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 200&gt;&gt;
&lt;&lt;set $enemymindamage = 15&gt;&gt;
&lt;&lt;set $enemymaxdamage = 30&gt;&gt;
&lt;&lt;set $enemymingold = 50&gt;&gt;
&lt;&lt;set $enemymaxgold = 100&gt;&gt;
&lt;&lt;set $enemyminexp = 100&gt;&gt;
&lt;&lt;set $enemymaxexp = 125&gt;&gt;
&lt;&lt;set $enemyregion = &quot;ScarletVale&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;hestus1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;Shatter&quot;, &quot;Shatter&quot;, &quot;MoltenGold&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 30&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;DireWolfStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Dire Wolf&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 115&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 115&gt;&gt;
&lt;&lt;set $enemystrength = 12&gt;&gt;
&lt;&lt;set $enemyagility = 12&gt;&gt;
&lt;&lt;set $enemywillpower = 5&gt;&gt;
&lt;&lt;set $enemybaseevade = 50&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 0&gt;&gt;
&lt;&lt;set $enemymindamage = 6&gt;&gt;
&lt;&lt;set $enemymaxdamage = 12&gt;&gt;
&lt;&lt;set $enemymingold = 1&gt;&gt;
&lt;&lt;set $enemymaxgold = 2&gt;&gt;
&lt;&lt;set $enemyminexp = 25&gt;&gt;
&lt;&lt;set $enemymaxexp = 35&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;direwolf1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;ViciousBite&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 4&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;KrakenspawnStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Krakenspawn&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 900&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 900&gt;&gt;
&lt;&lt;set $enemystrength = 45&gt;&gt;
&lt;&lt;set $enemyagility = 30&gt;&gt;
&lt;&lt;set $enemywillpower = 25&gt;&gt;
&lt;&lt;set $enemybaseevade = 60&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 30&gt;&gt;
&lt;&lt;set $enemymindamage = 45&gt;&gt;
&lt;&lt;set $enemymaxdamage = 65&gt;&gt;
&lt;&lt;set $enemymingold = 140&gt;&gt;
&lt;&lt;set $enemymaxgold = 180&gt;&gt;
&lt;&lt;set $enemyminexp = 130&gt;&gt;
&lt;&lt;set $enemymaxexp = 155&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;krakenspawn1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;Drown&quot;, &quot;Strangle&quot;, &quot;DriveMad&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;RyzStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Ryz, the Arcane Observer&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 750&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 750&gt;&gt;
&lt;&lt;set $enemystrength = 50&gt;&gt;
&lt;&lt;set $enemyagility = 20&gt;&gt;
&lt;&lt;set $enemywillpower = 45&gt;&gt;
&lt;&lt;set $enemybaseevade = 50&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 35&gt;&gt;
&lt;&lt;set $enemymindamage = 30&gt;&gt;
&lt;&lt;set $enemymaxdamage = 55&gt;&gt;
&lt;&lt;set $enemymingold = 150&gt;&gt;
&lt;&lt;set $enemymaxgold = 175&gt;&gt;
&lt;&lt;set $enemyminexp = 145&gt;&gt;
&lt;&lt;set $enemymaxexp = 164&gt;&gt;
&lt;&lt;set $enemyregion = &quot;ScarletVale&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;ryz1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;ArcaneBarrage&quot;, &quot;ArcaneBarrage&quot;, &quot;DoubleSlash&quot;, &quot;BeserkerStance&quot;, &quot;Madness&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ScarletAmbusherStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Scarlet Ambusher&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 200&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 200&gt;&gt;
&lt;&lt;set $enemystrength = 16&gt;&gt;
&lt;&lt;set $enemyagility = 22&gt;&gt;
&lt;&lt;set $enemywillpower = 12&gt;&gt;
&lt;&lt;set $enemybaseevade = 50&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 10&gt;&gt;
&lt;&lt;set $enemymindamage = 18&gt;&gt;
&lt;&lt;set $enemymaxdamage = 28&gt;&gt;
&lt;&lt;set $enemymingold = 30&gt;&gt;
&lt;&lt;set $enemymaxgold = 45&gt;&gt;
&lt;&lt;set $enemyminexp = 40&gt;&gt;
&lt;&lt;set $enemymaxexp = 50&gt;&gt;
&lt;&lt;set $enemyregion = &quot;ScarletVale&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;plant3&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;VineWhip&quot;, &quot;Sunlight&quot;, &quot;Bind&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 4&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ScarletGuardianStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Scarlet Guardian&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 280&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 280&gt;&gt;
&lt;&lt;set $enemystrength = 25&gt;&gt;
&lt;&lt;set $enemyagility = 5&gt;&gt;
&lt;&lt;set $enemywillpower = 15&gt;&gt;
&lt;&lt;set $enemybaseevade = 40&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 25&gt;&gt;
&lt;&lt;set $enemymindamage = 20&gt;&gt;
&lt;&lt;set $enemymaxdamage = 36&gt;&gt;
&lt;&lt;set $enemymingold = 45&gt;&gt;
&lt;&lt;set $enemymaxgold = 55&gt;&gt;
&lt;&lt;set $enemyminexp = 50&gt;&gt;
&lt;&lt;set $enemymaxexp = 68&gt;&gt;
&lt;&lt;set $enemyregion = &quot;ScarletVale&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;plant5&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;BeserkerStance&quot;, &quot;Sunlight&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 8&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ScarletBloodletterStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Scarlet Bloodletter&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 250&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 250&gt;&gt;
&lt;&lt;set $enemystrength = 30&gt;&gt;
&lt;&lt;set $enemyagility = 20&gt;&gt;
&lt;&lt;set $enemywillpower = 10&gt;&gt;
&lt;&lt;set $enemybaseevade = 50&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 5&gt;&gt;
&lt;&lt;set $enemymindamage = 40&gt;&gt;
&lt;&lt;set $enemymaxdamage = 50&gt;&gt;
&lt;&lt;set $enemymingold = 55&gt;&gt;
&lt;&lt;set $enemymaxgold = 65&gt;&gt;
&lt;&lt;set $enemyminexp = 62&gt;&gt;
&lt;&lt;set $enemymaxexp = 73&gt;&gt;
&lt;&lt;set $enemyregion = &quot;ScarletVale&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;plant7&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;Wound&quot;, &quot;Bloodsport&quot;, &quot;Sunlight&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 4&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ScarletDestroyerStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Scarlet Destroyer&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 650&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 650&gt;&gt;
&lt;&lt;set $enemystrength = 40&gt;&gt;
&lt;&lt;set $enemyagility = 10&gt;&gt;
&lt;&lt;set $enemywillpower = 15&gt;&gt;
&lt;&lt;set $enemybaseevade = 30&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 25&gt;&gt;
&lt;&lt;set $enemymindamage = 20&gt;&gt;
&lt;&lt;set $enemymaxdamage = 60&gt;&gt;
&lt;&lt;set $enemymingold = 125&gt;&gt;
&lt;&lt;set $enemymaxgold = 150&gt;&gt;
&lt;&lt;set $enemyminexp = 100&gt;&gt;
&lt;&lt;set $enemymaxexp = 115&gt;&gt;
&lt;&lt;set $enemyregion = &quot;ScarletVale&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;plant1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;Bind&quot;, &quot;Sunlight&quot;, &quot;VineWhip&quot;, &quot;Earthquake&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 14&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SerpentStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Serpent of the Deeps&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 2000&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 2000&gt;&gt;
&lt;&lt;set $enemystrength = 60&gt;&gt;
&lt;&lt;set $enemyagility = 60&gt;&gt;
&lt;&lt;set $enemywillpower = 60&gt;&gt;
&lt;&lt;set $enemybaseevade = 40&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 50&gt;&gt;
&lt;&lt;set $enemymindamage = 45&gt;&gt;
&lt;&lt;set $enemymaxdamage = 85&gt;&gt;
&lt;&lt;set $enemymingold = 400&gt;&gt;
&lt;&lt;set $enemymaxgold = 500&gt;&gt;
&lt;&lt;set $enemyminexp = 280&gt;&gt;
&lt;&lt;set $enemymaxexp = 320&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;serpent1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;MonstrousBite&quot;, &quot;RedVenom&quot;, &quot;GreenVenom&quot;, &quot;BlueVenom&quot;, &quot;Burrow&quot;, &quot;Burrow&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ShadowNymphStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Shadow Nymph&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 210&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 210&gt;&gt;
&lt;&lt;set $enemystrength = 20&gt;&gt;
&lt;&lt;set $enemyagility = 30&gt;&gt;
&lt;&lt;set $enemywillpower = 10&gt;&gt;
&lt;&lt;set $enemybaseevade = 60&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 10&gt;&gt;
&lt;&lt;set $enemymindamage = 30&gt;&gt;
&lt;&lt;set $enemymaxdamage = 50&gt;&gt;
&lt;&lt;set $enemymingold = 1&gt;&gt;
&lt;&lt;set $enemymaxgold = 2&gt;&gt;
&lt;&lt;set $enemyminexp = 55&gt;&gt;
&lt;&lt;set $enemymaxexp = 70&gt;&gt;
&lt;&lt;set $enemyregion = &quot;ScarletVale&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;nymph3&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;ConsumeMana&quot;, &quot;ShadowBeam&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SkeletalSoldierStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Skeletal Soldier&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 325&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 325&gt;&gt;
&lt;&lt;set $enemystrength = 35&gt;&gt;
&lt;&lt;set $enemyagility = 25&gt;&gt;
&lt;&lt;set $enemywillpower = 10&gt;&gt;
&lt;&lt;set $enemybaseevade = 55&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 20&gt;&gt;
&lt;&lt;set $enemymindamage = 30&gt;&gt;
&lt;&lt;set $enemymaxdamage = 50&gt;&gt;
&lt;&lt;set $enemymingold = 65&gt;&gt;
&lt;&lt;set $enemymaxgold = 80&gt;&gt;
&lt;&lt;set $enemyminexp = 90&gt;&gt;
&lt;&lt;set $enemymaxexp = 115&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;dead5&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;ShieldSlam&quot;, &quot;DoubleSlash&quot;, &quot;LifeSteal&quot;, &quot;Haunt&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 3&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SkeletalArcherStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Skeletal Archer&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 300&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 300&gt;&gt;
&lt;&lt;set $enemystrength = 25&gt;&gt;
&lt;&lt;set $enemyagility = 40&gt;&gt;
&lt;&lt;set $enemywillpower = 10&gt;&gt;
&lt;&lt;set $enemybaseevade = 55&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 15&gt;&gt;
&lt;&lt;set $enemymindamage = 35&gt;&gt;
&lt;&lt;set $enemymaxdamage = 45&gt;&gt;
&lt;&lt;set $enemymingold = 110&gt;&gt;
&lt;&lt;set $enemymaxgold = 130&gt;&gt;
&lt;&lt;set $enemyminexp = 75&gt;&gt;
&lt;&lt;set $enemymaxexp = 82&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;dead1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;PoisonArrow&quot;, &quot;IceArrow&quot;, &quot;LifeSteal&quot;, &quot;Haunt&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 3&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SkeletalMageStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Skeletal Mage&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 300&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 300&gt;&gt;
&lt;&lt;set $enemystrength = 20&gt;&gt;
&lt;&lt;set $enemyagility = 20&gt;&gt;
&lt;&lt;set $enemywillpower = 40&gt;&gt;
&lt;&lt;set $enemybaseevade = 50&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 15&gt;&gt;
&lt;&lt;set $enemymindamage = 15&gt;&gt;
&lt;&lt;set $enemymaxdamage = 25&gt;&gt;
&lt;&lt;set $enemymingold = 115&gt;&gt;
&lt;&lt;set $enemymaxgold = 135&gt;&gt;
&lt;&lt;set $enemyminexp = 78&gt;&gt;
&lt;&lt;set $enemymaxexp = 90&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;dead7&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;IceWall&quot;, &quot;HailStorm&quot;, &quot;LifeSteal&quot;, &quot;Haunt&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 3&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SkeletalKnightStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Skeletal Knight&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 500&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 500&gt;&gt;
&lt;&lt;set $enemystrength = 45&gt;&gt;
&lt;&lt;set $enemyagility = 10&gt;&gt;
&lt;&lt;set $enemywillpower = 25&gt;&gt;
&lt;&lt;set $enemybaseevade = 45&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 40&gt;&gt;
&lt;&lt;set $enemymindamage = 40&gt;&gt;
&lt;&lt;set $enemymaxdamage = 65&gt;&gt;
&lt;&lt;set $enemymingold = 120&gt;&gt;
&lt;&lt;set $enemymaxgold = 140&gt;&gt;
&lt;&lt;set $enemyminexp = 83&gt;&gt;
&lt;&lt;set $enemymaxexp = 90&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;dead3&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;EternalVigil&quot;, &quot;Haunt&quot;, &quot;DarkChivalry&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 4&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SkeletalDragonStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Nivraxus, the Enslaved&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 1800&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 1800&gt;&gt;
&lt;&lt;set $enemyspecialhealth = 900&gt;&gt;
&lt;&lt;set $enemystrength = 55&gt;&gt;
&lt;&lt;set $enemyagility = 20&gt;&gt;
&lt;&lt;set $enemywillpower = 40&gt;&gt;
&lt;&lt;set $enemybaseevade = 35&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 40&gt;&gt;
&lt;&lt;set $enemymindamage = 35&gt;&gt;
&lt;&lt;set $enemymaxdamage = 70&gt;&gt;
&lt;&lt;set $enemymingold = 200&gt;&gt;
&lt;&lt;set $enemymaxgold = 300&gt;&gt;
&lt;&lt;set $enemyminexp = 130&gt;&gt;
&lt;&lt;set $enemymaxexp = 160&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;dragon7&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;MonstrousBite&quot;, &quot;DragonSlash&quot;, &quot;HailStorm&quot;, &quot;Earthquake&quot;, &quot;FrostBreath&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 8&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;SpringGuardianStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Guardian of the Spring&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 800&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 800&gt;&gt;
&lt;&lt;set $enemystrength = 10&gt;&gt;
&lt;&lt;set $enemyagility = 10&gt;&gt;
&lt;&lt;set $enemywillpower = 10&gt;&gt;
&lt;&lt;set $enemybaseevade = 35&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 10&gt;&gt;
&lt;&lt;set $enemymindamage = 40&gt;&gt;
&lt;&lt;set $enemymaxdamage = 60&gt;&gt;
&lt;&lt;set $enemymingold = 140&gt;&gt;
&lt;&lt;set $enemymaxgold = 180&gt;&gt;
&lt;&lt;set $enemyminexp = 130&gt;&gt;
&lt;&lt;set $enemymaxexp = 190&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;spring7&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;SpringsPromise&quot;, &quot;WintersHeart&quot;, &quot;SummersGlory&quot;, &quot;AutumnsFire&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;TestDummyStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Test Dummy&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 800&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 900&gt;&gt;
&lt;&lt;set $enemystrength = 10&gt;&gt;
&lt;&lt;set $enemyagility = 10&gt;&gt;
&lt;&lt;set $enemywillpower = 5&gt;&gt;
&lt;&lt;set $enemybaseevade = 10&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 2&gt;&gt;
&lt;&lt;set $enemymindamage = 1&gt;&gt;
&lt;&lt;set $enemymaxdamage = 2&gt;&gt;
&lt;&lt;set $enemymingold = 1&gt;&gt;
&lt;&lt;set $enemymaxgold = 2&gt;&gt;
&lt;&lt;set $enemyminexp = 1&gt;&gt;
&lt;&lt;set $enemymaxexp = 2&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;testdummy&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;Earthquake&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 50&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;TrollStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Troll&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 275&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 275&gt;&gt;
&lt;&lt;set $enemystrength = 16&gt;&gt;
&lt;&lt;set $enemyagility = 2&gt;&gt;
&lt;&lt;set $enemywillpower = 10&gt;&gt;
&lt;&lt;set $enemybaseevade = 35&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 4&gt;&gt;
&lt;&lt;set $enemymindamage = 13&gt;&gt;
&lt;&lt;set $enemymaxdamage = 23&gt;&gt;
&lt;&lt;set $enemymingold = 45&gt;&gt;
&lt;&lt;set $enemymaxgold = 65&gt;&gt;
&lt;&lt;set $enemyminexp = 55&gt;&gt;
&lt;&lt;set $enemymaxexp = 65&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Outskirts&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;troll1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;HardShell&quot;, &quot;Regenerate&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 8&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidspawnStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Voidspawn&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 275&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 275&gt;&gt;
&lt;&lt;set $enemystrength = 25&gt;&gt;
&lt;&lt;set $enemyagility = 25&gt;&gt;
&lt;&lt;set $enemywillpower = 13&gt;&gt;
&lt;&lt;set $enemybaseevade = 55&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 10&gt;&gt;
&lt;&lt;set $enemymindamage = 25&gt;&gt;
&lt;&lt;set $enemymaxdamage = 45&gt;&gt;
&lt;&lt;set $enemymingold = 55&gt;&gt;
&lt;&lt;set $enemymaxgold = 75&gt;&gt;
&lt;&lt;set $enemyminexp = 55&gt;&gt;
&lt;&lt;set $enemymaxexp = 74&gt;&gt;
&lt;&lt;set $enemyregion = &quot;ScarletVale&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;voidspawn1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;VoidStrike&quot;, &quot;FadeToBlack&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidSentinelStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Void Sentinel&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 600&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 600&gt;&gt;
&lt;&lt;set $enemystrength = 45&gt;&gt;
&lt;&lt;set $enemyagility = 55&gt;&gt;
&lt;&lt;set $enemywillpower = 35&gt;&gt;
&lt;&lt;set $enemybaseevade = 70&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 40&gt;&gt;
&lt;&lt;set $enemymindamage = 50&gt;&gt;
&lt;&lt;set $enemymaxdamage = 65&gt;&gt;
&lt;&lt;set $enemymingold = 140&gt;&gt;
&lt;&lt;set $enemymaxgold = 160&gt;&gt;
&lt;&lt;set $enemyminexp = 130&gt;&gt;
&lt;&lt;set $enemymaxexp = 140&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;void1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;attack&quot;, &quot;FadeToBlack&quot;, &quot;FadeToBlack&quot;, &quot;Silencex&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidGoblinStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Void Goblin&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 500&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 500&gt;&gt;
&lt;&lt;set $enemystrength = 40&gt;&gt;
&lt;&lt;set $enemyagility = 65&gt;&gt;
&lt;&lt;set $enemywillpower = 40&gt;&gt;
&lt;&lt;set $enemybaseevade = 75&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 35&gt;&gt;
&lt;&lt;set $enemymindamage = 40&gt;&gt;
&lt;&lt;set $enemymaxdamage = 50&gt;&gt;
&lt;&lt;set $enemymingold = 140&gt;&gt;
&lt;&lt;set $enemymaxgold = 160&gt;&gt;
&lt;&lt;set $enemyminexp = 130&gt;&gt;
&lt;&lt;set $enemymaxexp = 140&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;void3&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;DarkBrotherhood&quot;, &quot;Viciousness&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidWarriorStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Void Warrior&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 700&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 700&gt;&gt;
&lt;&lt;set $enemystrength = 70&gt;&gt;
&lt;&lt;set $enemyagility = 40&gt;&gt;
&lt;&lt;set $enemywillpower = 45&gt;&gt;
&lt;&lt;set $enemybaseevade = 60&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 75&gt;&gt;
&lt;&lt;set $enemymindamage = 60&gt;&gt;
&lt;&lt;set $enemymaxdamage = 80&gt;&gt;
&lt;&lt;set $enemymingold = 155&gt;&gt;
&lt;&lt;set $enemymaxgold = 175&gt;&gt;
&lt;&lt;set $enemyminexp = 145&gt;&gt;
&lt;&lt;set $enemymaxexp = 155&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;void7&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;EternalVigil&quot;, &quot;Silencex&quot;, &quot;VoidBlade&quot;, &quot;VoidBlade&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidSlayerStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Void Slayer&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 750&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 750&gt;&gt;
&lt;&lt;set $enemystrength = 90&gt;&gt;
&lt;&lt;set $enemyagility = 30&gt;&gt;
&lt;&lt;set $enemywillpower = 30&gt;&gt;
&lt;&lt;set $enemybaseevade = 55&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 55&gt;&gt;
&lt;&lt;set $enemymindamage = 40&gt;&gt;
&lt;&lt;set $enemymaxdamage = 85&gt;&gt;
&lt;&lt;set $enemymingold = 170&gt;&gt;
&lt;&lt;set $enemymaxgold = 190&gt;&gt;
&lt;&lt;set $enemyminexp = 200&gt;&gt;
&lt;&lt;set $enemymaxexp = 240&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;void5&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;ShadowBeam&quot;, &quot;Silencex&quot;, &quot;VoidBlade&quot;, &quot;SoulDevour&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidColossusStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Void Colossus&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 3000&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 3000&gt;&gt;
&lt;&lt;set $enemystrength = 110&gt;&gt;
&lt;&lt;set $enemyagility = 15&gt;&gt;
&lt;&lt;set $enemywillpower = 50&gt;&gt;
&lt;&lt;set $enemybaseevade = 25&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 100&gt;&gt;
&lt;&lt;set $enemymindamage = 40&gt;&gt;
&lt;&lt;set $enemymaxdamage = 120&gt;&gt;
&lt;&lt;set $enemymingold = 300&gt;&gt;
&lt;&lt;set $enemymaxgold = 400&gt;&gt;
&lt;&lt;set $enemyminexp = 250&gt;&gt;
&lt;&lt;set $enemymaxexp = 350&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;greatvoid3&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;GiantSwipe&quot;, &quot;VoidShell&quot;, &quot;SoulVomit&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 14&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidColossus2Stats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Void Colossus&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 2800&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 2800&gt;&gt;
&lt;&lt;set $enemystrength = 110&gt;&gt;
&lt;&lt;set $enemyagility = 15&gt;&gt;
&lt;&lt;set $enemywillpower = 50&gt;&gt;
&lt;&lt;set $enemybaseevade = 25&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 100&gt;&gt;
&lt;&lt;set $enemymindamage = 40&gt;&gt;
&lt;&lt;set $enemymaxdamage = 120&gt;&gt;
&lt;&lt;set $enemymingold = 300&gt;&gt;
&lt;&lt;set $enemymaxgold = 400&gt;&gt;
&lt;&lt;set $enemyminexp = 250&gt;&gt;
&lt;&lt;set $enemymaxexp = 350&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;greatvoid3&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;GiantSwipe&quot;, &quot;VoidShell&quot;, &quot;VoidRoar&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 14&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GatekeeperStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;The Gatekeeper&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 2750&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 2750&gt;&gt;
&lt;&lt;set $enemystrength = 70&gt;&gt;
&lt;&lt;set $enemyagility = 90&gt;&gt;
&lt;&lt;set $enemywillpower = 70&gt;&gt;
&lt;&lt;set $enemybaseevade = 60&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 30&gt;&gt;
&lt;&lt;set $enemymindamage = 50&gt;&gt;
&lt;&lt;set $enemymaxdamage = 90&gt;&gt;
&lt;&lt;set $enemymingold = 300&gt;&gt;
&lt;&lt;set $enemymaxgold = 400&gt;&gt;
&lt;&lt;set $enemyminexp = 250&gt;&gt;
&lt;&lt;set $enemymaxexp = 350&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;greatvoid1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;GateKeeperArt&quot;, &quot;GateKeeperArt&quot;, &quot;GateKeeperArt&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 12&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ZenatarStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Zenatar, the Void General&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 2600&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 2600&gt;&gt;
&lt;&lt;set $enemystrength = 100&gt;&gt;
&lt;&lt;set $enemyagility = 50&gt;&gt;
&lt;&lt;set $enemywillpower = 50&gt;&gt;
&lt;&lt;set $enemybaseevade = 60&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 100&gt;&gt;
&lt;&lt;set $enemymindamage = 55&gt;&gt;
&lt;&lt;set $enemymaxdamage = 105&gt;&gt;
&lt;&lt;set $enemymingold = 300&gt;&gt;
&lt;&lt;set $enemymaxgold = 400&gt;&gt;
&lt;&lt;set $enemyminexp = 300&gt;&gt;
&lt;&lt;set $enemymaxexp = 350&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;greatvoid5&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;ZenatarArt&quot;, &quot;ZenatarArt&quot;, &quot;ZenatarArt&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 10&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;XornStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Xorn, the Void Prophet&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 2800&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 2800&gt;&gt;
&lt;&lt;set $enemystrength = 50&gt;&gt;
&lt;&lt;set $enemyagility = 50&gt;&gt;
&lt;&lt;set $enemywillpower = 100&gt;&gt;
&lt;&lt;set $enemybaseevade = 75&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 60&gt;&gt;
&lt;&lt;set $enemymindamage = 45&gt;&gt;
&lt;&lt;set $enemymaxdamage = 130&gt;&gt;
&lt;&lt;set $enemymingold = 300&gt;&gt;
&lt;&lt;set $enemymaxgold = 400&gt;&gt;
&lt;&lt;set $enemyminexp = 300&gt;&gt;
&lt;&lt;set $enemymaxexp = 350&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;greatvoid7&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;XornArt&quot;, &quot;XornArt&quot;, &quot;XornArt&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 14&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;JhuunStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Jhuun, the Void Blade&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 2600&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 2600&gt;&gt;
&lt;&lt;set $enemystrength = 75&gt;&gt;
&lt;&lt;set $enemyagility = 125&gt;&gt;
&lt;&lt;set $enemywillpower = 50&gt;&gt;
&lt;&lt;set $enemybaseevade = 60&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 75&gt;&gt;
&lt;&lt;set $enemymindamage = 70&gt;&gt;
&lt;&lt;set $enemymaxdamage = 130&gt;&gt;
&lt;&lt;set $enemymingold = 300&gt;&gt;
&lt;&lt;set $enemymaxgold = 400&gt;&gt;
&lt;&lt;set $enemyminexp = 300&gt;&gt;
&lt;&lt;set $enemymaxexp = 350&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;greatvoid9&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;JhuunArt&quot;, &quot;JhuunArt&quot;)&gt;&gt;
&lt;&lt;set $check9 = 0&gt;&gt;
&lt;&lt;set $enemystunlimit = 12&gt;&gt;
&lt;&lt;/widget&gt;&gt;


&lt;&lt;widget &quot;WaterElementalStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Water Elemental&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 450&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 450&gt;&gt;
&lt;&lt;set $enemystrength = 40&gt;&gt;
&lt;&lt;set $enemyagility = 30&gt;&gt;
&lt;&lt;set $enemywillpower = 10&gt;&gt;
&lt;&lt;set $enemybaseevade = 55&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 20&gt;&gt;
&lt;&lt;set $enemymindamage = 30&gt;&gt;
&lt;&lt;set $enemymaxdamage = 45&gt;&gt;
&lt;&lt;set $enemymingold = 80&gt;&gt;
&lt;&lt;set $enemymaxgold = 100&gt;&gt;
&lt;&lt;set $enemyminexp = 62&gt;&gt;
&lt;&lt;set $enemymaxexp = 93&gt;&gt;
&lt;&lt;set $enemyregion = &quot;ScarletVale&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;elemental1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;Drown&quot;, &quot;IceWall&quot;, &quot;HailStorm&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ZabilStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Zabil the Betrayed&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 1500&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 1500&gt;&gt;
&lt;&lt;set $enemystrength = 80&gt;&gt;
&lt;&lt;set $enemyagility = 40&gt;&gt;
&lt;&lt;set $enemywillpower = 25&gt;&gt;
&lt;&lt;set $enemybaseevade = 55&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 50&gt;&gt;
&lt;&lt;set $enemymindamage = 55&gt;&gt;
&lt;&lt;set $enemymaxdamage = 75&gt;&gt;
&lt;&lt;set $enemymingold = 180&gt;&gt;
&lt;&lt;set $enemymaxgold = 200&gt;&gt;
&lt;&lt;set $enemyminexp = 160&gt;&gt;
&lt;&lt;set $enemymaxexp = 175&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;zabil2&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;Bash&quot;, &quot;Revenge&quot;, &quot;Revenge&quot;, &quot;Haunt&quot;, &quot;DarkChivalry&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 9&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ZaradrasStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Zaradras, the Envious Flame&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 3000&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 1500&gt;&gt;
&lt;&lt;set $enemystrength = 50&gt;&gt;
&lt;&lt;set $enemyagility = 40&gt;&gt;
&lt;&lt;set $enemywillpower = 30&gt;&gt;
&lt;&lt;set $enemybaseevade = 55&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 40&gt;&gt;
&lt;&lt;set $enemymindamage = 45&gt;&gt;
&lt;&lt;set $enemymaxdamage = 70&gt;&gt;
&lt;&lt;set $enemymingold = 250&gt;&gt;
&lt;&lt;set $enemymaxgold = 300&gt;&gt;
&lt;&lt;set $enemyminexp = 150&gt;&gt;
&lt;&lt;set $enemymaxexp = 200&gt;&gt;
&lt;&lt;set $enemyregion = &quot;FrozenHills&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;dragon2&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;MonstrousBite&quot;, &quot;DragonSlash&quot;, &quot;DragonScales&quot;, &quot;FlameBreath&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 10&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ZyrStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Zyr, the Arcane Librarian&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 500&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 500&gt;&gt;
&lt;&lt;set $enemystrength = 25&gt;&gt;
&lt;&lt;set $enemyagility = 35&gt;&gt;
&lt;&lt;set $enemywillpower = 45&gt;&gt;
&lt;&lt;set $enemybaseevade = 60&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 50&gt;&gt;
&lt;&lt;set $enemymindamage = 30&gt;&gt;
&lt;&lt;set $enemymaxdamage = 45&gt;&gt;
&lt;&lt;set $enemymingold = 100&gt;&gt;
&lt;&lt;set $enemymaxgold = 150&gt;&gt;
&lt;&lt;set $enemyminexp = 100&gt;&gt;
&lt;&lt;set $enemymaxexp = 150&gt;&gt;
&lt;&lt;set $enemyregion = &quot;ScarletVale&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;zyr1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 6&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Redeemer1Stats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Nendel, the Dark Redeemer&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 4000&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 4000&gt;&gt;
&lt;&lt;set $enemystrength = 100&gt;&gt;
&lt;&lt;set $enemyagility = 100&gt;&gt;
&lt;&lt;set $enemywillpower = 100&gt;&gt;
&lt;&lt;set $enemybaseevade = 80&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 100&gt;&gt;
&lt;&lt;set $enemymindamage = 50&gt;&gt;
&lt;&lt;set $enemymaxdamage = 120&gt;&gt;
&lt;&lt;set $enemymingold = 500&gt;&gt;
&lt;&lt;set $enemymaxgold = 600&gt;&gt;
&lt;&lt;set $enemyminexp = 500&gt;&gt;
&lt;&lt;set $enemymaxexp = 600&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;evil2&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;Redeemer1Art&quot;, &quot;Redeemer1Art&quot;, &quot;Redeemer1Art&quot;)&gt;&gt;
&lt;&lt;set $enemystunlimit = 8&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Domedra2Stats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Domedra, the Mad Queen&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 3000&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 3000&gt;&gt;
&lt;&lt;set $enemystrength = 30&gt;&gt;
&lt;&lt;set $enemyagility = 70&gt;&gt;
&lt;&lt;set $enemywillpower = 120&gt;&gt;
&lt;&lt;set $enemybaseevade = 85&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 50&gt;&gt;
&lt;&lt;set $enemymindamage = 70&gt;&gt;
&lt;&lt;set $enemymaxdamage = 125&gt;&gt;
&lt;&lt;set $enemymingold = 500&gt;&gt;
&lt;&lt;set $enemymaxgold = 600&gt;&gt;
&lt;&lt;set $enemyminexp = 500&gt;&gt;
&lt;&lt;set $enemymaxexp = 600&gt;&gt;
&lt;&lt;set $enemyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;domedra3&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;DomedraArt&quot;, &quot;DomedraArt&quot;, &quot;DomedraArt&quot;)&gt;&gt;
&lt;&lt;set $check9 = 0&gt;&gt;
&lt;&lt;set $enemystunlimit = 8&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidStats&quot;&gt;&gt;
&lt;&lt;set $enemyname = &quot;Void, God of Destruction&quot;&gt;&gt;
&lt;&lt;set $enemymaxhealth = 5000&gt;&gt;
&lt;&lt;set $enemycurrenthealth = 5000&gt;&gt;
&lt;&lt;set $enemystrength = 125&gt;&gt;
&lt;&lt;set $enemyagility = 85&gt;&gt;
&lt;&lt;set $enemywillpower = 105&gt;&gt;
&lt;&lt;set $enemybaseevade = 70&gt;&gt;
&lt;&lt;set $enemyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyarmor = 150&gt;&gt;
&lt;&lt;set $enemymindamage = 60&gt;&gt;
&lt;&lt;set $enemymaxdamage = 150&gt;&gt;
&lt;&lt;set $enemymingold = 500&gt;&gt;
&lt;&lt;set $enemymaxgold = 600&gt;&gt;
&lt;&lt;set $enemyminexp = 500&gt;&gt;
&lt;&lt;set $enemymaxexp = 600&gt;&gt;
&lt;&lt;set $enemyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyimage = &quot;voidlord1&quot;&gt;&gt;
&lt;&lt;set $enemyability = []&gt;&gt;
&lt;&lt;set $enemyability.push(&quot;attack&quot;, &quot;VoidArt&quot;, &quot;VoidArt&quot;, &quot;VoidArt&quot;)&gt;&gt;
&lt;&lt;set $check7 = 0&gt;&gt;
&lt;&lt;set $check8 = 0&gt;&gt;
&lt;&lt;set $check9 = 0&gt;&gt;
&lt;&lt;set $enemystunlimit = 10&gt;&gt;
&lt;&lt;/widget&gt;&gt;






















</tw-passagedata><tw-passagedata pid="29" name="GoblinArcherAttack" tags="" position="805,1002" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You are wandering through the Outskirts when you come across a Goblin, clearly looking for you. He appears a bit better armed than the lesser kin you&#39;ve seen so far.
&lt;img src=&quot;Images/Outskirts/goblin3.jpg&quot; width=400 /&gt;

&lt;&lt;if $outskirtsquest gte 16&gt;&gt;&lt;&lt;GoblinArcherTalk &quot;Grahhh! Gresh will be avenged! Die, human!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Face me if you dare.&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Tell me, creature - what are you doing here? Why are you poisoning this land?&quot;&gt;&gt; \
The goblin readies its bow.
&lt;&lt;GoblinArcherTalk &quot;Grahhh! It is necessary, human! Necessary!&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinArcherStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="30" name="Battle1" tags="" position="600,22" size="100,100">&lt;&lt;if $p eq 10&gt;&gt; &lt;&lt;Aura&gt;&gt;\
\
You are fighting $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;i&gt;&lt;&lt;ItemAbilityRun&gt;&gt;&lt;&lt;if ($battlecount eq 0) and ($setbonus gte 1)&gt;&gt;&lt;&lt;SetBonus&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/i&gt;
\
&lt;&lt;if $stun lte 0&gt;&gt; &lt;&lt;set $action = &quot;notstun&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;if $stun gte 1&gt;&gt;&lt;&lt;set $action = &quot;stun&quot;&gt;&gt;&lt;&lt;set $stun -= 1&gt;&gt;You are stunned, and cannot take action! &lt;&lt;else&gt;&gt;\
\
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt;&lt;b&gt;Combat Points&lt;/b&gt;: $combatpoints / 5 
&lt;&lt;/if&gt;&gt;\
&lt;b&gt;General Actions&lt;/b&gt;:
&lt;&lt;link &quot;Attack&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;attack&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;if $flee eq 1&gt;&gt;&lt;&lt;link &quot;Flee&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;flee&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;i&gt;You cannot flee from this battle!&lt;/i&gt;&lt;&lt;/if&gt;&gt;

&lt;table class=&quot;stat-table&quot;&gt;\
&lt;td&gt;\
&lt;b&gt;Class Abilities&lt;/b&gt;:
&lt;&lt;for _i to 0; _i lt $abilityinventory.length; _i++&gt;&gt;\
&lt;&lt;print $abilityinventory[_i].name&gt;&gt; (Mana cost: $abilityinventory[_i].mana )\
&lt;&lt;capture _i&gt;&gt;\
		&lt;&lt;if $currentmana lt $abilityinventory[_i].mana&gt;&gt;&lt;i&gt;Not enough mana&lt;/i&gt;&lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($combatpoints lt $abilityinventory[_i].combatcost)&gt;&gt;&lt;i&gt;Not enough Combat Points&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;ability&quot;&gt;&gt; &lt;&lt;set $ability = $abilityinventory[_i].widgetname&gt;&gt; &lt;&lt;set $abilitymana = $abilityinventory[_i].mana&gt;&gt; &lt;&lt;set $abilitylevel = $abilityinventory[_i].level&gt;&gt; &lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;/td&gt;\
&lt;td&gt;\
&lt;b&gt;Items ($potioncount / 10)&lt;/b&gt;:
&lt;&lt;if $potioncount gte 10&gt;&gt;&lt;i&gt;You can only drink up to 10 potions in a single battle!&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;&lt;for _i to 0; _i lt $iteminventory.length; _i++&gt;&gt;\
&lt;&lt;print $iteminventory[_i].name&gt;&gt; (Quantity: &lt;&lt;print $iteminventory[_i].quantity&gt;&gt;) \
&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $iteminventory[_i].quantity lte 0&gt;&gt; &lt;i&gt;None left&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt; &lt;&lt;set $action = &quot;item&quot;&gt;&gt; &lt;&lt;set $item = $iteminventory[_i].name&gt;&gt;
			&lt;&lt;set $iteminventory[_i].quantity -= 1&gt;&gt;\
			&lt;&lt;set $itemstrength = $iteminventory[_i].strength&gt;&gt;\
			&lt;&lt;set $itemagility = $iteminventory[_i].agility&gt;&gt;\
			&lt;&lt;set $itemwillpower = $iteminventory[_i].willpower&gt;&gt;\
			&lt;&lt;set $itemarmor = $iteminventory[_i].armor&gt;&gt;\
			&lt;&lt;set $itemhealth = $iteminventory[_i].health&gt;&gt;\
			&lt;&lt;set $itemmana = $iteminventory[_i].mana&gt;&gt;\
			&lt;&lt;set $itemevadescore = $iteminventory[_i].evadescore&gt;&gt;\
			&lt;&lt;set $potioncount += 1&gt;&gt;\
			&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;/td&gt;\
&lt;/table&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;stun&quot;&gt;&gt; &lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;
\
&lt;&lt;set $battlecount += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 11&gt;&gt; 
You are fighting a $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;

&lt;&lt;if $action eq &quot;attack&quot;&gt;&gt;You attempt to hit the $enemyname with your $weapon!

&lt;&lt;AttackAttempt&gt;&gt;
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;You deal damage to the $enemyname!

&lt;&lt;AttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;flee&quot;&gt;&gt;You attempt to flee from the $enemyname!

&lt;&lt;FleeAttempt&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;ability&quot;&gt;&gt;&lt;&lt;Ability $ability&gt;&gt;&lt;&lt;/Ability&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $action eq &quot;item&quot;&gt;&gt;You used your $item!
&lt;&lt;ItemImage $item 150&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;
&lt;&lt;ItemUse&gt;&gt;
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;The enemy is slain! Victory!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $enemyactiveability gte 10&gt;&gt;&lt;&lt;link &quot;The enemy surrenders! Victory!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $action eq &quot;flee success&quot;&gt;&gt;&lt;&lt;link &quot;You escape!&quot; $passage&gt;&gt;&lt;&lt;set $p = 19&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\

&lt;&lt;elseif $p eq 12&gt;&gt; 
You are fighting a $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;EnemyStun&gt;&gt;
\
&lt;&lt;if $enemyaction eq &quot;attack&quot;&gt;&gt;The $enemyname attacks you!

&lt;&lt;EnemyAttackAttempt&gt;&gt;

&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;The $enemyname deals damage to you!

&lt;&lt;EnemyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if ($enemyaction neq &quot;stun&quot;) and ($enemyaction neq &quot;attack&quot;) and ($enemyaction neq &quot;attack success&quot;) and ($enemyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;EnemyAbility $enemyaction&gt;&gt;&lt;&lt;/EnemyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]]&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Player turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;

&lt;&lt;elseif $p eq 19&gt;&gt; 
You flee from the $enemyname - better to bandage your wounds and do battle another day than foolishly fight to the death.

As you near the safety of the cabin, you realize your coin purse is a bit lighter than before. Some gold pieces must have fallen out while you were running away.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $goldloss = $enemymaxgold&gt;&gt; \
&lt;&lt;set $gold -= $goldloss&gt;&gt; \
\
&lt;&lt;BattleEnd&gt;&gt;\
\
\
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
This page should not come up, as you should be out of the $passage passage and into the $returnpassage passage.

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="31" name="Enemy Abilities" tags="widget" position="200,888" size="100,100">ENEMY ABILITIES

ARTS

&lt;&lt;widget &quot;AvatarArt&quot;&gt;&gt;\
&lt;&lt;set $check1 = $enemymaxhealth&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth lt $check1&gt;&gt;
$enemyname strikes you down with holy retribution!
&lt;img src=&quot;Images/EnemyArts/retribution.jpg&quot; width=400 /&gt;
&lt;&lt;set $abilityvalue = ($enemystrength/2) + ($enemywillpower/2)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycurrenthealth = $enemymaxhealth&gt;&gt;\
&lt;&lt;set $enemystrength += 25&gt;&gt;\
&lt;&lt;set $enemywillpower += 25&gt;&gt;\
&lt;&lt;set $enemyactiveability = 0&gt;&gt;\

You take $abilityvalue damage!
$enemyname gains full health!
$enemyname gains 25 willpower!
$enemyname gains 25 strength!

&lt;&lt;else&gt;&gt;\
$enemyname prays for an end to all destruction!
&lt;img src=&quot;Images/EnemyArts/prayer.jpg&quot; width=400 /&gt;
&lt;&lt;set $enemystrength += 10&gt;&gt;\
&lt;&lt;set $enemywillpower += 10&gt;&gt;\
&lt;&lt;set $enemyactiveability += 2&gt;&gt;\

$enemyname gains 10 willpower!
$enemyname gains 10 strength!
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BarsenesArt&quot;&gt;&gt;\
&lt;&lt;set $check1 = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;set $check2 = $enemymaxhealth/4&gt;&gt;\
&lt;&lt;set $check3 = random(1,4)&gt;&gt;\
\
&lt;&lt;if $enemycombatpoints lt 2&gt;&gt;\
&lt;&lt;if $check3 gte 3&gt;&gt;\
$enemyname flings a dagger at you!
&lt;img src=&quot;Images/EnemyArts/daggerthrow.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemyagility/1.5&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycombatpoints += 1&gt;&gt;\

You take $abilityvalue damage!
$enemyname gains a Combat Point!
\
&lt;&lt;else&gt;&gt;\
$enemyname embraces the way of the duelist!
&lt;img src=&quot;Images/EnemyArts/duelist.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/6&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower*2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemyagility += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycombatpoints += 1&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue2&gt;&gt;\

$enemyname gains $abilityvalue agility!
$enemyname gains $abilityvalue2 health!
$enemyname gains a Combat Point!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $enemycurrenthealth gte $check1&gt;&gt;\
$enemyname uses his Combat Points, and pierces your side!
&lt;img src=&quot;Images/EnemyArts/pierce.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemyagility*2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycombatpoints = 0&gt;&gt;\
&lt;&lt;set $enemyagility -= 5&gt;&gt;\

You take $abilityvalue damage!
$enemyname loses all Combat Points!
$enemyname loses 5 agility!

&lt;&lt;elseif $enemycurrenthealth gte $check2&gt;&gt;\
$enemyname uses his Combat Points, and blinds you!
&lt;img src=&quot;Images/EnemyArts/stunflare.jpg&quot; width=300 /&gt;
&lt;&lt;set $stun += 2&gt;&gt;\
&lt;&lt;set $enemycombatpoints = 0&gt;&gt;\
&lt;&lt;set $enemyagility -= 5&gt;&gt;\

You are stunned for 2 turns!
$enemyname loses all Combat Points!
$enemyname loses 5 agility!

&lt;&lt;else&gt;&gt;\
$enemyname uses his Combat Points, and draws energy from his rapier!
&lt;img src=&quot;Images/EnemyArts/energysword.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemyagility*3.5&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemyagility/3&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $abilityvalue3 = $enemyagility/4&gt;&gt;\
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyagility += $abilityvalue3&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycombatpoints = 0&gt;&gt;\

$enemyname gains $abilityvalue health!
$enemyname gains $abilityvalue2 armor!
$enemyname gains $abilityvalue2 agility!
$enemyname loses all Combat Points!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;CarnaxArt&quot;&gt;&gt;\
&lt;&lt;set $check1 = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;set $check2 = $enemymaxhealth/4&gt;&gt;\
&lt;&lt;set $check3 = random(1,4)&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth gte $check1&gt;&gt;
&lt;&lt;if $check3 gte 3&gt;&gt;\
$enemyname attacks with a bolt of ice!
&lt;img src=&quot;Images/EnemyArts/icebolt.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/12&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue2&gt;&gt;\

You take $abilityvalue damage!
You lose $abilityvalue2 agility!
\
&lt;&lt;else&gt;&gt;\
$enemyname attacks with a storm of ice!
&lt;img src=&quot;Images/EnemyArts/icestorm.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialwillpower -= 3&gt;&gt;\

You take $abilityvalue damage!
You lose 3 willpower!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;else&gt;&gt;\
$enemyname draws on the soul of $enemyallyname to sustain himself!
&lt;img src=&quot;Images/EnemyArts/soulharvest.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = 100&gt;&gt;\
&lt;&lt;set $enemyallycurrenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;if $enemyallycurrenthealth lte 0&gt;&gt; &lt;&lt;set $enemyallycurrenthealth = 0&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += 300&gt;&gt;\
&lt;&lt;set $enemywillpower += 10&gt;&gt;\

$enemyname gains 300 health!
$enemyname gains 10 willpower!
$enemyallyname loses 100 health!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Carnax2Art&quot;&gt;&gt;\
&lt;&lt;set $check1 = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;set $check2 = $enemymaxhealth/4&gt;&gt;\
&lt;&lt;set $check3 = random(1,4)&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth gte $check1&gt;&gt;\
&lt;&lt;if $enemyarmor lt 10&gt;&gt;\
$enemyname crafts an icy barrier!
&lt;img src=&quot;Images/EnemyArts/icebarrier.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue&gt;&gt;

$enemyname gains $abilityvalue armor!
\
&lt;&lt;elseif $enemyarmor lt 50&gt;&gt;\
$enemyname launches an ice spear at you!
&lt;img src=&quot;Images/EnemyArts/icespear.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor += 15&gt;&gt;\

You take $abilityvalue damage!
$enemyname gains 15 armor!
\
&lt;&lt;else&gt;&gt;\
$enemyname launches a blizzard against you!
&lt;img src=&quot;Images/EnemyArts/blizzard.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor -= 25&gt;&gt;\

You take $abilityvalue damage!
$enemyname loses 25 armor!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;else&gt;&gt;\
$enemyname conjures up a massive ball of icy death!
&lt;img src=&quot;Images/EnemyArts/frostball.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*0.8&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemywillpower += 10&gt;&gt;\

You take $abilityvalue damage!
$enemyname gains 10 willpower!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\


&lt;&lt;widget &quot;DomedraArt&quot;&gt;&gt;\
&lt;&lt;set $check1 = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;set $check2 = $enemymaxhealth/4&gt;&gt;\
&lt;&lt;set $check3 = random(1, 5)&gt;&gt;\
\
\
&lt;&lt;if $enemycurrenthealth gte $check1&gt;&gt;\
&lt;&lt;if $check3 gte 4&gt;&gt;\
$enemyname strikes at you with void-empowered might!
&lt;img src=&quot;Images/EnemyArts/domedrastab.jpg&quot; width=400 /&gt;
&lt;&lt;set $abilityvalue = ($enemywillpower/2) + ($enemyagility/2)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lte 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemyagility += 8&gt;&gt;\

$enemyname deals $abilityvalue damage! Your armor blocks $armor - you take $abilityvalue2 damage!
$enemyname gains 8 agility!
&lt;&lt;if $armor gte 100&gt;&gt;You lose 25 armor! &lt;&lt;set $specialarmor -= 25&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;elseif $check3 gte 2&gt;&gt;\
$enemyname strikes at you with blinding speed!
&lt;img src=&quot;Images/EnemyArts/domedrarun.jpg&quot; width=400 /&gt;
&lt;&lt;set $abilityvalue = $enemyagility&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialarmor -= 25&gt;&gt;\

You take $abilityvalue damage!
You lose 25 armor!
\
&lt;&lt;else&gt;&gt;\
$enemyname unleashes a piercing scream!
&lt;img src=&quot;Images/EnemyArts/domedrascream.jpg&quot; width=400 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/14&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialwillpower -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialstrength -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue&gt;&gt;\
&lt;&lt;set $stun += 1&gt;&gt;\

You lose $abilityvalue strength!
You lose $abilityvalue agility!
You lose $abilityvalue willpower!
You are stunned!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $enemycurrenthealth gte $check2&gt;&gt;
&lt;&lt;if $check9 eq 0&gt;&gt;\
$enemyname forms a shield of dark energy!
&lt;img src=&quot;Images/Character/domedra3.jpg&quot; width=350 /&gt;

&lt;&lt;Domedra2Talk &quot;I am a queen! I am perfect! &lt;i&gt;I will not be defeated by the likes of you&lt;/i&gt;!&quot;&gt;&gt; \
\
&lt;&lt;set $enemyarmor += 400&gt;&gt;\
&lt;&lt;set $check9 = 1&gt;&gt;\
$enemyname gains 400 armor!
\
\
&lt;&lt;elseif $check3 gte 3&gt;&gt;\
$enemyname tears you down with the winds of oblivion!
&lt;img src=&quot;Images/EnemyArts/domedrascream.jpg&quot; width=400 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*0.75&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialarmor -= 15&gt;&gt;\
&lt;&lt;set $enemyarmor += 15&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\

You lose $abilityvalue health!
You lose 15 armor!
$enemyname gains 15 armor!
\
\
&lt;&lt;else&gt;&gt;\
$enemyname draws upon the power of malevolent stars!
&lt;img src=&quot;Images/EnemyArts/domedramagic.jpg&quot; width=400 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/15&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemywillpower += $abilityvalue&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue2&gt;&gt;\

$enemyname gains $abilityvalue willpower!
$enemyname restores $abilityvalue2 health!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;else&gt;&gt;\
&lt;&lt;if $enemyarmor gte 100&gt;&gt;\
$enemyname draws restorative power from her armor!
&lt;img src=&quot;Images/EnemyArts/domedradenial.jpg&quot; width=400 /&gt;
&lt;&lt;set $enemycurrenthealth += 450&gt;&gt;\
&lt;&lt;set $enemyarmor -= 30&gt;&gt;\
&lt;&lt;set $currenthealth -= 50&gt;&gt;\
&lt;&lt;set $specialstrength -= 5&gt;&gt;
&lt;&lt;set $specialwillpower -= 5&gt;&gt;
&lt;&lt;set $specialagility -= 5&gt;&gt;\

$enemyname restores 450 health!
$enemyname loses 30 armor!
You lose 50 health!
You lose 5 strength, agility, and willpower!
&lt;&lt;NayaTalk &quot;Her armor is healing her! We need to destroy it!&quot;&gt;&gt; \
\
\
&lt;&lt;else&gt;&gt;\
$enemyname burns everything down with unstable void energy!
&lt;img src=&quot;Images/EnemyArts/domedraburn.jpg&quot; width=400 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*1.5&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemywillpower -= 10&gt;&gt;\

You lose $abilityvalue health!
$enemyname loses $abilityvalue2 health!
$enemyname loses 10 willpower!
\
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\


&lt;&lt;widget &quot;DomitusArt&quot;&gt;&gt;\
&lt;&lt;set $check1 = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;set $check2 = $enemymaxhealth/4&gt;&gt;\
&lt;&lt;set $check3 = random(1,5)&gt;&gt;\
\
&lt;&lt;if $enemycombatpoints lt 2&gt;&gt;\
&lt;&lt;if ($check3 gte 3) and ($check3 lt 5)&gt;&gt;\
$enemyname delivers a mighty attack!
&lt;img src=&quot;Images/EnemyArts/slash.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = ($enemymindamage) + ($enemystrength/3)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lte 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycombatpoints += 1&gt;&gt;\
&lt;&lt;set $enemystrength += 5&gt;&gt;\

Domitus deals $abilityvalue damage - your armor blocks $armor of it - you take $abilityvalue2 damage!
Domitus gained 5 strength!
\
&lt;&lt;elseif $check3 lte 2&gt;&gt;\
$enemyname&#39;s dark helmet stares into your soul, draining you!
&lt;img src=&quot;Images/EnemyArts/stare.jpg&quot; width=400 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/12&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialwillpower -= $abilityvalue&gt;&gt;\
&lt;&lt;set $currentmana -= $enemywillpower&gt;&gt;\
&lt;&lt;set $enemywillpower += 5&gt;&gt;\
&lt;&lt;set $enemycombatpoints += 1&gt;&gt;\

You lose $abilityvalue willpower!
You lose $enemywillpower mana!
$enemyname gains 5 willpower!
\
&lt;&lt;else&gt;&gt;
$enemyname stands vigilant!
&lt;img src=&quot;Images/EnemyArts/vigil.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*1.2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemycombatpoints += 1&gt;&gt;\

$enemyname gains $abilityvalue health!
$enemyname gains $abilityvalue2 armor!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $enemycurrenthealth gte $check1&gt;&gt;\
$enemyname strikes deep!
&lt;img src=&quot;Images/EnemyArts/pierce.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycombatpoints = 0&gt;&gt;\
&lt;&lt;set $stun += 1&gt;&gt;

You take $abilityvalue damage!
You are stunned!

&lt;&lt;else&gt;&gt;\
&lt;&lt;if $enemyactiveability eq 0&gt;&gt;\
$enemyname leaps into the air!
&lt;img src=&quot;Images/EnemyArts/leap.jpg&quot; width=300 /&gt;
&lt;&lt;set $enemybaseevade += 500&gt;&gt;\
&lt;&lt;set $enemystrength += 30&gt;&gt;\
&lt;&lt;set $enemyactiveability = 1&gt;&gt;\

$enemyname gains 500 evasion!
$enemyname gains 30 strength!
$enemyname is preparing for a grand attack!
\
\
&lt;&lt;else&gt;&gt;\
$enemyname crashes upon you!
&lt;img src=&quot;Images/EnemyArts/crash.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemystrength*1.5&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lte 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycombatpoints = 0&gt;&gt;\
&lt;&lt;set $enemystrength -= 35&gt;&gt;\
&lt;&lt;set $specialarmor -= 35&gt;&gt;\
&lt;&lt;set $enemybaseevade -= 500&gt;&gt;\
&lt;&lt;set $enemyactiveability = 0&gt;&gt;\

$enemyname deals $abilityvalue damage - your armor blocks $armor damage - you take $abilityvalue2 damage!
You lose 35 armor!
$enemyname loses 35 strength!
$enemyname loses 500 evasion!
\
\
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;GateKeeperArt&quot;&gt;&gt;\
&lt;&lt;set $check1 = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;set $check2 = $enemymaxhealth/4&gt;&gt;\
&lt;&lt;set $check3 = random(1, 5)&gt;&gt;\
\
&lt;&lt;if $enemyagility lte 0&gt;&gt;
$enemyname has no more agility, and no more limbs! It is dying!
&lt;&lt;set $enemycurrenthealth = 0&gt;&gt;\
\
&lt;&lt;elseif $enemycurrenthealth gte $check1&gt;&gt;
&lt;&lt;if ($check3 gte 3) and ($check3 lt 5)&gt;&gt;\
$enemyname attacks with its many shadowed hands!
&lt;img src=&quot;Images/EnemyArts/grasp.jpg&quot; width=400 /&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lte 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemystrength += 10&gt;&gt;\
\
\
$enemyname deals $abilityvalue damage - your armor blocks $armor of it - you take $abilityvalue2 damage!
$enemyname gains 10 strength!
&lt;&lt;if $armor gte 25&gt;&gt; You lose 20 armor! &lt;&lt;else&gt;&gt;You are stunned!&lt;&lt;/if&gt;&gt;

&lt;&lt;if $armor gte 25&gt;&gt; &lt;&lt;set $specialarmor -= 20&gt;&gt; &lt;&lt;else&gt;&gt; &lt;&lt;set $stun += 1&gt;&gt; &lt;&lt;/if&gt;&gt;
\
&lt;&lt;elseif $check3 lte 2&gt;&gt;\
$enemyname turns your skin to dust!
&lt;img src=&quot;Images/EnemyArts/fade.jpg&quot; width=400 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/11&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialstrength -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue&gt;&gt;\
&lt;&lt;set $currenthealth -= 40&gt;&gt;\

You lose $abilityvalue strength!
You lose $abilityvalue agility!
You lose 40 health!
\
&lt;&lt;else&gt;&gt;
$enemyname drains your and $allyname&#39;s souls!
&lt;img src=&quot;Images/EnemyArts/drain.jpg&quot; width=300 /&gt;
&lt;&lt;set $allywillpower -= 7&gt;&gt;\
&lt;&lt;set $abilityvalue = $enemywillpower*0.75&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currentmana -= $abilityvalue&gt;&gt;\

$allyname loses 7 willpower!
You lose $abilityvalue mana!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;else&gt;&gt;\
$enemyname consumes a limb to restore its strength!
&lt;img src=&quot;Images/EnemyArts/cannibal.jpg&quot; width=400 /&gt;

&lt;&lt;set $enemyagility -= 30&gt;&gt;\
&lt;&lt;set $enemymaxhealth -= 300&gt;&gt;\
&lt;&lt;set $enemycurrenthealth = $enemymaxhealth&gt;&gt;\

$enemyname lost 300 max health!
$enemyname is fully healed!
$enemyname lost 30 agility!
\
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Redeemer1Art&quot;&gt;&gt;\
&lt;&lt;set $check1 = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;set $check2 = $enemymaxhealth/4&gt;&gt;\
&lt;&lt;set $check3 = random(1, 5)&gt;&gt;\
\
\
&lt;&lt;if $enemycurrenthealth gte $check1&gt;&gt;\ 
&lt;&lt;if $check3 gte 4&gt;&gt;\
$enemyname gloats over his assured victory!
&lt;&lt;Redeemer4Talk &quot;This world has been judged, and has been found wanting! The only remaining justice is to vanquish it altogether!&quot;&gt;&gt; \
\
\
\
&lt;&lt;elseif $check3 gte 2&gt;&gt;\
$enemyname strikes with dark power!
&lt;img src=&quot;Images/EnemyArts/darkattack.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = ($enemystrength/2) + ($enemyagility/2)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lte 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialarmor -= 45&gt;&gt;\

$enemyname deals $abilityvalue damage! Your armor blocks $armor - you take $abilityvalue2 damage!
You lose 15 armor!
&lt;&lt;else&gt;&gt;\
$enemyname blasts you with the draining void!
&lt;img src=&quot;Images/EnemyArts/voiddrop.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = ($enemywillpower/12)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialwillpower -= $abilityvalue&gt;&gt;\
&lt;&lt;set $currenthealth -= 75&gt;&gt;\

You take 75 damage!
You lose $abilityvalue willpower!
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $enemycurrenthealth gte $check2&gt;&gt;\ 
&lt;&lt;if $check3 gte 4&gt;&gt;\
$enemyname strikes twice with dark power!
&lt;img src=&quot;Images/EnemyArts/darkattack.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = ($enemystrength/2) + ($enemyagility/2)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lte 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
$enemyname deals $abilityvalue damage with the first strike! Your armor blocks $armor - you take $abilityvalue2 damage!
&lt;&lt;if $armor gte 100&gt;&gt;The attacks reduce your armor by 50! &lt;&lt;set $specialarmor -= 50&gt;&gt; &lt;&lt;/if&gt;&gt;

$enemyname deals $abilityvalue damage with the second strike! Your armor blocks $armor - you take $abilityvalue2 damage!
\
\
&lt;&lt;elseif $check3 gte 2&gt;&gt;\
$enemyname strikes with dark lightning!
&lt;img src=&quot;Images/EnemyArts/darklightning.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = $enemyagility&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialstrength -= 7&gt;&gt;\
&lt;&lt;set $specialagility -= 7&gt;&gt;\

You take $abilityvalue damage!
You lose 7 strength!
You lose 7 agility!
\
\
&lt;&lt;else&gt;&gt;\
$enemyname rants, burning with anguish!
&lt;&lt;Redeemer4Talk &quot;My city! My people! My home! MY MOTHER! MY FAMILY! YOU TOOK EVERYTHING FROM ME! &lt;i&gt;NOW I SHALL TAKE EVERYTHING FROM EVERYONE&lt;/i&gt;!&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;if $check3 gte 3&gt;&gt;\
$enemyname drives his blades deep!
&lt;img src=&quot;Images/EnemyArts/swordattack.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = random($enemymindamage, $enemymaxdamage)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = random($enemymindamage, $enemymaxdamage)&gt;&gt;\
\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\

The first blade deals $abilityvalue damage!
The second blade deals $abilityvalue2 damage!
\
&lt;&lt;else&gt;&gt;\
$enemyname looks towards the Dark Portal.
&lt;&lt;Redeemer4Talk &quot;&lt;i&gt;You can&#39;t win! I&#39;ve come too far!&lt;/i&gt;&quot;&gt;&gt; \
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;VoidArt&quot;&gt;&gt;\
&lt;&lt;set $check1 = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;set $check2 = $enemymaxhealth/4&gt;&gt;\
&lt;&lt;set $check3 = random(1, 5)&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth gte $check1&gt;&gt;\
&lt;&lt;if $check3 gte 5&gt;&gt;\
$enemyname stumbles, seemingly unable to control its body!
&lt;&lt;Void2Talk &quot;&lt;i&gt;THIS MORTAL SHELL SHALL OBEY ONLY ME!&lt;/i&gt;&quot;&gt;&gt; \
\
&lt;&lt;elseif $check3 gte 4&gt;&gt;\
$enemyname unleashes a flash of dark energy!
&lt;img src=&quot;Images/EnemyArts/voidshow.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/4&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/11&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
\
\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue2&gt;&gt;\

You lose $abilityvalue health!
You lose $abilityvalue armor!
You lose $abilityvalue2 agility!
\
&lt;&lt;elseif $check3 gte 3&gt;&gt;\
$enemyname smashes into you with the power of dark stars!
&lt;img src=&quot;Images/EnemyArts/voidsmash.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemystrength += 10&gt;&gt;\

You lose $abilityvalue health!
$enemyname gains 10 strength!

&lt;&lt;elseif $check7 eq 0&gt;&gt;\
$enemyname reveals the end of days!
&lt;img src=&quot;Images/EnemyArts/voidend.jpg&quot; width=450 /&gt;
&lt;&lt;if $currenthealth gt 100&gt;&gt; &lt;&lt;set $currenthealth = 100&gt;&gt; &lt;&lt;else&gt;&gt; &lt;&lt;set $currenthealth -= 50&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $check7 = 1&gt;&gt;\

You lose most of your health!
\
\
&lt;&lt;else&gt;&gt;\
$enemyname burns you with the fire of the dark sun!
&lt;img src=&quot;Images/EnemyArts/voidsun.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = $enemyagility&gt;&gt;\
&lt;&lt;set $enemyagility += 5&gt;&gt;\
&lt;&lt;set $specialstrength -= 5&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\

You lose $abilityvalue health!
You lose 5 strength!
$enemyname gains 5 agility!
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $enemycurrenthealth gte $check2&gt;&gt;\
&lt;&lt;if $check8 eq 0&gt;&gt;\
$enemyname grasps its wounds. Black bile spills from them.
&lt;&lt;Void2Talk &quot;&lt;i&gt;IS THIS... PAIN? GRAAAAHHHH!!!&lt;/i&gt;&quot;&gt;&gt; \
\
&lt;&lt;set $enemystrength += 15&gt;&gt;\
&lt;&lt;set $enemyagility += 15&gt;&gt;\
&lt;&lt;set $enemywillpower += 15&gt;&gt;\
&lt;&lt;set $enemyarmor += 150&gt;&gt;\
&lt;&lt;set $check8 = 1&gt;&gt;\

$enemyname gains 15 strength!
$enemyname gains 15 agility!
$enemyname gains 15 willpower!
$enemyname gains 150 armor!
\
&lt;&lt;elseif $check3 gte 4&gt;&gt;\
$enemyname calls upon the Dark Portal to swallow your soul!
&lt;img src=&quot;Images/EnemyArts/voidhole.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialwillpower -= 5&gt;&gt;\

You lose $abilityvalue health!
You lose 5 willpower!
\
\
&lt;&lt;elseif $check3 gte 3&gt;&gt;\
$enemyname claws at the fabric of time!
&lt;img src=&quot;Images/EnemyArts/voidclaw.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = $enemystrength/3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialarmor -= 15&gt;&gt;\
&lt;&lt;set $stun += 1&gt;&gt;

You lose $abilityvalue health!
You lose 15 armor!
You are stunned!
\
\
&lt;&lt;elseif $check3 gte 2&gt;&gt;\
$enemyname feasts on the darkness between stars!
&lt;img src=&quot;Images/EnemyArts/voidfeast.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/15&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $abilityvalue3 = $enemywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue3&gt;&gt;\

$enemyname gains $abilityvalue health!
$enemyname gains $abilityvalue3 armor!
$enemyname gains $abilityvalue2 strength!
\
&lt;&lt;else&gt;&gt;\
$enemyname is losing control of its body!
&lt;&lt;Redeemer4Talk &quot;&lt;i&gt;Die, damn you!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;Void2Talk &quot;&lt;i&gt;GRAAAHH! STOP THIS, MORTAL!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;set $enemycurrenthealth -= 50&gt;&gt;\
&lt;&lt;set $enemystrength -= 2&gt;&gt;\
&lt;&lt;set $enemyagility -= 2&gt;&gt;\
&lt;&lt;set $enemywillpower -= 2&gt;&gt;\

$enemyname loses 50 health!
$enemyname loses 2 strength!
$enemyname loses 2 agility!
$enemyname loses 2 willpower!
\
\
\
&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;\
&lt;&lt;if $check3 gte 3&gt;&gt;
$enemyname is losing control of its body!
&lt;&lt;Redeemer4Talk &quot;&lt;i&gt;Die!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;Void2Talk &quot;&lt;i&gt;GRAAAHH!!! THIS IS NOT POSSIBLE!!!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;set $enemycurrenthealth -= 150&gt;&gt;\
&lt;&lt;set $enemystrength -= 5&gt;&gt;\
&lt;&lt;set $enemyagility -= 5&gt;&gt;\
&lt;&lt;set $enemywillpower -= 5&gt;&gt;\

$enemyname loses 150 health!
$enemyname loses 5 strength!
$enemyname loses 5 agility!
$enemyname loses 5 willpower!
\
\
&lt;&lt;else&gt;&gt;\
$enemyname strikes with a beam of pure oblivion!
&lt;img src=&quot;Images/EnemyArts/voidzap.jpg&quot; width=450 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*3&gt;&gt;\
\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemywillpower -= 5&gt;&gt;\

You lose $abilityvalue health!
$enemyname loses 5 willpower!
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\


&lt;&lt;widget &quot;ZenatarArt&quot;&gt;&gt;\
&lt;&lt;set $check1 = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;set $check2 = $enemymaxhealth/4&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth gte $check1&gt;&gt;\
&lt;&lt;if $enemystrength lt 150&gt;&gt;\
$enemyname imbues his blade with dark magic!
&lt;img src=&quot;Images/EnemyArts/imbue.jpg&quot; width=300 /&gt;

&lt;&lt;set $abilityvalue = $enemystrength/2&gt;&gt;
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue&gt;&gt;\

$enemyname gains $abilityvalue strength!
\
&lt;&lt;else&gt;&gt;\
$enemyname strikes with devastating power!
&lt;img src=&quot;Images/EnemyArts/attack.jpg&quot; width=300 /&gt;
&lt;&lt;set $abilityvalue = $enemystrength*2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lte 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemystrength -= 50&gt;&gt;\
\
\
$enemyname deals $abilityvalue damage - your armor blocks $armor of it - you take $abilityvalue2 damage!
$enemyname loses 50 strength!
\
\
&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;\
&lt;&lt;if $enemyarmor lt 80&gt;&gt;\
$enemyname imbues his armor with dark magic!
&lt;img src=&quot;Images/EnemyArts/armorup.jpg&quot; width=350 /&gt;
&lt;&lt;set $abilityvalue = $enemywillpower&gt;&gt;
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemywillpower += 10&gt;&gt;\

$enemyname gains $abilityvalue armor!
$enemyname gains 10 willpower!

&lt;&lt;else&gt;&gt;\
$enemyname charges straight at you!
&lt;img src=&quot;Images/EnemyArts/charge.jpg&quot; width=400 /&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialstrength -= 10&gt;&gt;\

You lose $abilityvalue health!
You lose 10 strength!
\
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;XornArt&quot;&gt;&gt;\
&lt;&lt;set $check2 = random(1, 2)&gt;&gt;\
\
&lt;&lt;if $enemyactiveability gte 2&gt;&gt;\
$enemyname unleashes dark lightning upon you!
&lt;img src=&quot;Images/EnemyArts/biglightning.jpg&quot; width=400 /&gt;
\
&lt;&lt;set $abilityvalue = $enemywillpower*3&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;
&lt;&lt;set $abilityvalue2 = $enemywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemywillpower -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemyactiveability = 0&gt;&gt;\

You take $abilityvalue damage!
$enemyname loses $abilityvalue2 willpower!

&lt;&lt;else&gt;&gt;
&lt;&lt;if $enemywillpower lt 100&gt;&gt;\
$enemyname foresees death and destruction!
&lt;img src=&quot;Images/EnemyArts/foresee.jpg&quot; width=400 /&gt;
\
&lt;&lt;set $enemywillpower += 50&gt;&gt;\
&lt;&lt;set $enemyactiveability += 1&gt;&gt;\
&lt;&lt;set $enemyarmor += 20&gt;&gt;\
\
$enemyname gains 50 willpower!
$enemyname gains 20 armor!
\
&lt;&lt;else&gt;&gt;\
&lt;&lt;if $check2 eq 1&gt;&gt;\
$enemyname attacks with dark magic!
&lt;img src=&quot;Images/EnemyArts/lightning.jpg&quot; width=400 /&gt;
\
&lt;&lt;set $abilityvalue = $enemywillpower&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemywillpower += 10&gt;&gt;\
&lt;&lt;set $enemyactiveability += 1&gt;&gt;\

You take $abilityvalue damage!
$enemyname gains 10 willpower!
\
&lt;&lt;else&gt;&gt;\
$enemyname blinds you with a flash of lightning!
&lt;img src=&quot;Images/EnemyArts/flash.jpg&quot; width=400 /&gt;
\
&lt;&lt;set $stun += 1&gt;&gt;\
&lt;&lt;set $currentmana -= 50&gt;&gt;\

You are stunned!
You lose 50 mana!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;JhuunArt&quot;&gt;&gt;\
&lt;&lt;set $check1 = random(1, 4)&gt;&gt;\
\
&lt;&lt;if ($enemyactiveability eq 1) and ($enemycurrenthealth lt $check9)&gt;&gt;\
$enemyname responds with a devastating counterattack!
&lt;img src=&quot;Images/EnemyArts/counterattack.jpg&quot; width=400 /&gt;
&lt;&lt;set $enemyactiveability = 0&gt;&gt;\
&lt;&lt;set $abilityvalue = $enemyagility*4&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $stun += 1&gt;&gt;\

You take $abilityvalue damage!
You are stunned!
\
&lt;&lt;else&gt;&gt;\
\
\
&lt;&lt;if $check1 eq 1&gt;&gt;\
&lt;&lt;EnemyAttackAttempt&gt;&gt;\
&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;EnemyAttackDamage&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $enemyactiveability = 0&gt;&gt;\
\
&lt;&lt;elseif $check1 eq 2&gt;&gt;\
$enemyname falls into a defensive stance.
&lt;img src=&quot;Images/EnemyArts/prepare.jpg&quot; width=400 /&gt;

Attack him at your peril!
&lt;&lt;set $enemyactiveability = 1&gt;&gt;\
&lt;&lt;set $check9 = $enemycurrenthealth&gt;&gt;\
\
&lt;&lt;elseif $check1 eq 3&gt;&gt;\
$enemyname strikes from above!
&lt;img src=&quot;Images/EnemyArts/puncture.jpg&quot; width=400 /&gt;
&lt;&lt;set $enemyactiveability = 0&gt;&gt;\
&lt;&lt;set $abilityvalue = $enemyagility&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemyagility/5&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyagility += $abilityvalue2&gt;&gt;\

You lose $abilityvalue health!
$enemyname gains $abilityvalue2 agility!

&lt;&lt;elseif $check1 eq 4&gt;&gt;\
$enemyname strikes from the shadows!
&lt;img src=&quot;Images/EnemyArts/shadowstrike.jpg&quot; width=400 /&gt;
&lt;&lt;set $enemyactiveability = 0&gt;&gt;\
&lt;&lt;set $abilityvalue = $enemyagility&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemystrength += 10&gt;&gt;\

You lose $abilityvalue health!
$enemyname gains $abilityvalue2 armor!
$enemyname gains 10 strength!
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\



ABILITIES

&lt;&lt;widget &quot;AutumnsFire&quot;&gt;&gt;\
$enemyname unleashes the fire of Autumn!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemyagility&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lt 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue3 = $enemyagility/2&gt;&gt;\
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\

The first attack deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The second attack deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The third attack deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

$enemyname gains $abilityvalue3 strength!
$enemyname gains $abilityvalue3 willpower!

&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue3&gt;&gt;\
&lt;&lt;set $enemywillpower += $abilityvalue3&gt;&gt;\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;SpringsPromise&quot;&gt;&gt;\
$enemyname unleashes the promise of Spring!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\

$enemyname gains $abilityvalue health!
$enemyname gains $abilityvalue2 agility!

&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyagility += $abilityvalue2&gt;&gt;\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;SummersGlory&quot;&gt;&gt;\
$enemyname unleashes the glory of Summer!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower&gt;&gt;\

You lose $abilityvalue health!
You are stunned for 1 turn!

&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $stun += 1&gt;&gt;\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;WintersHeart&quot;&gt;&gt;\
$enemyname unleashes the heart of Winter!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemystrength/3&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\

You lose $abilityvalue health!
You lose $abilityvalue2 armor!
$enemyname gains $abilityvalue2 armor!

&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue2&gt;&gt;\
\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;ArcaneBarrage&quot;&gt;&gt;\
$enemyname launches an arcane barrage!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemyagility/2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lt 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue3 = $enemyagility/3&gt;&gt;\
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\

The first bolt deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The second bolt deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The third bolt deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The fourth bolt deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The final bolt shatters $abilityvalue3 armor!

&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue3&gt;&gt;\

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Bash&quot;&gt;&gt;\
$enemyname&#39;s strike knocks you senseless!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength*0.75&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $stun += 1&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
\
You take $abilityvalue damage!
You are stunned!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BeserkerStance&quot;&gt;&gt;\
$enemyname takes on a more aggressive stance, sacrificing defense for offensive might!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemybaseevade -= $abilityvalue&gt;&gt;\

$enemyname gains $abilityvalue strength!
$enemyname loses $abilityvalue armor!
$enemyname loses $abilityvalue evasion chance!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BloodFeast&quot;&gt;&gt;\
&lt;&lt;set $check = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;if $enemycurrenthealth gte $check&gt;&gt;\
$enemyname vomits its own blood onto you!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemymaxhealth/20&gt;&gt;
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

You take $abilityvalue damage!
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
\
&lt;&lt;else&gt;&gt;\
$enemyname consumes its own flesh for strength!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $enemymaxhealth -= 150&gt;&gt;\
&lt;&lt;if $enemymaxhealth lt 1&gt;&gt; &lt;&lt;set $enemymaxhealth = 1&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $enemycurrenthealth = $enemymaxhealth&gt;&gt;\

$enemyname&#39;s maximum health dropped to $enemymaxhealth!
$enemyname is fully healed!
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Bloodsport&quot;&gt;&gt;\
$enemyname revels in shedding your blood!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength/4&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemymindamage + $abilityvalue&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue&gt;&gt;\

You take $abilityvalue2 damage!
$enemyname gains $abilityvalue strength!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BoneFeast&quot;&gt;&gt;\
$enemyname feasts on bones!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*2&gt;&gt;\
&lt;&lt;if $enemyarmor gte $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemywillpower += 5&gt;&gt;\

$enemyname loses $abilityvalue armor!
$enemyname gains $abilityvalue health!
$enemyname gains 5 willpower!
&lt;&lt;else&gt;&gt;\
$enemyname has insufficient bones for the feast! It must gather more bones!
&lt;&lt;set $enemyarmor = $abilityvalue&gt;&gt;\

$enemyname&#39;s armor rose to $abilityvalue!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BoneStorm&quot;&gt;&gt;\
$enemyname unleashes a storm of bones!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*2&gt;&gt;\
&lt;&lt;if $enemyarmor gte $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\

$enemyname loses $abilityvalue armor!
You lose $abilityvalue health!
&lt;&lt;else&gt;&gt;\
$enemyname has insufficient bones for the storm! It must gather more bones!
&lt;&lt;set $enemyarmor = $abilityvalue&gt;&gt;\

$enemyname&#39;s armor rose to $abilityvalue!
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Bind&quot;&gt;&gt;\
$enemyname wraps you in constricting vines!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength/2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialevadescore -= $abilityvalue&gt;&gt;\
&lt;&lt;set $stun = 1&gt;&gt;\

You evasion score drops by $abilityvalue!
You are stunned!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Burrow&quot;&gt;&gt;\
&lt;&lt;if $enemyactiveability eq 0&gt;&gt;
$enemyname burrows under the ground!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemybaseevade += 100&gt;&gt;\
&lt;&lt;set $enemyactiveability = 1&gt;&gt;\

$enemyname gains $abilityvalue armor!
$enemyname gains 100 evasion!
\
&lt;&lt;else&gt;&gt;\
$enemyname springs out from the ground and attacks!
&lt;img src=&quot;Images/EnemyArts/burrow.jpg&quot; width=300 /&gt;
\
&lt;&lt;set $abilityvalue = $enemystrength + $enemyagility&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemyagility/4&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemybaseevade -= 100&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue2&gt;&gt;\

You take $abilityvalue damage!
You lose $abilityvalue2 armor!
$enemyname loses 100 evasion!
\
&lt;&lt;set $enemyactiveability = 0&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Charge&quot;&gt;&gt;\
The $enemyname charges at you!
&lt;&lt;EnemyAbilityImage $enemyaction 350&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemystrength/7&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $stun = 1&gt;&gt;\

You take $abilityvalue damage!
You lose $abilityvalue2 armor!
You are stunned!
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;ConsumeMana&quot;&gt;&gt;\
$enemyname leeches mana from your soul!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;if $abilityvalue gt 50&gt;&gt; &lt;&lt;set $abilityvalue = 50&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $enemywillpower&gt;&gt;\

Your mana falls by $abilityvalue!
$enemyname restores $enemywillpower health!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;DarkChivalry&quot;&gt;&gt;\
$enemyname delivers a devastating lance attack!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength*2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemystrength/5&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\

You take $abilityvalue damage!
You lose $abilityvalue2 armor!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;DarkBrotherhood&quot;&gt;&gt;\
$enemyname feeds its ally void energy!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower&gt;&gt;\
&lt;&lt;set $enemyallycurrenthealth += $abilityvalue&gt;&gt;
&lt;&lt;set $abilityvalue2 = $enemywillpower/5&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemyallystrength += $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemyallyagility += $abilityvalue2&gt;&gt;\
\
$enemyallyname gains $abilityvalue health!
$enemyallyname gains $abilityvalue2 strength!
$enemyallyname gains $abilityvalue2 agility!
\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;DarkVerdict&quot;&gt;&gt;\
$enemyname finds you guilty, and unleashes the Dark Verdict!
&lt;&lt;EnemyAbilityImage $enemyaction 500&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength*2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $armor/2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemystrength = $enemystrength/2&gt;&gt;\
&lt;&lt;set $enemystrength = Math.round($enemystrength)&gt;&gt;\

You take $abilityvalue damage!
Your armor is cut in half!
$enemyname is recovering from the Dark Verdict, and lost much of his strength!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;DefensiveStance&quot;&gt;&gt;\
$enemyname takes on a more defensive stance, sacrificing offense for defensive prowess!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemystrength -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemybaseevade += $abilityvalue&gt;&gt;\

$enemyname gains $abilityvalue armor!
$enemyname gains $abilityvalue evasion chance!
$enemyname loses $abilityvalue strength!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;DoubleSlash&quot;&gt;&gt;\
$enemyname attacks with two deadly strikes!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = ($enemyagility/2) + ($enemystrength/2)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lt 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\

The first strike deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The second strike deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;DragonScales&quot;&gt;&gt;\
$enemyname grows new diamond-hard dragon scales!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemywillpower -= 3&gt;&gt;\
&lt;&lt;if $enemywillpower lt 3&gt;&gt; &lt;&lt;set $enemywillpower = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\

$enemyname gains $abilityvalue armor!
The strain of the growth lowers $enemyname&#39;s willpower by 3!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;DragonSlash&quot;&gt;&gt;\
$enemyname slashes you with mighty claws!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength + $enemyagility&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lt 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\

The first strike deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The second strike deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;DriveMad&quot;&gt;&gt;\
$enemyname drives you towards madness!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/10&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/4&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $specialwillpower -= $abilityvalue&gt;&gt;\
&lt;&lt;set $currentmana -= $abilityvalue2&gt;&gt;\

You lose $abilityvalue willpower!
You lose $abilityvalue mana!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Drown&quot;&gt;&gt;\
$enemyname pushes you to your watery grave!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemywillpower = $enemywillpower*2&gt;&gt;\

You take $abilityvalue damage equal to your enemy&#39;s willpower!
$enemyname&#39;s willpower doubles to $enemywillpower!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Earthquake&quot;&gt;&gt;\
$enemyname shatters the very ground beneath you!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength*0.25&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;set $currenthealth -= $enemystrength&gt;&gt;
&lt;&lt;set $enemycurrenthealth -= $enemystrength&gt;&gt;

You and $enemyname take $enemystrength damage!
You and $enemyname lose $abilityvalue armor!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;GemSight&quot;&gt;&gt;\
$enemyname gets lost, absorbed in the dark powers of the gem!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;

$enemyname does nothing!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;EternalVigil&quot;&gt;&gt;\
$enemyname stands strong as a mountain!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue2&gt;&gt;

$enemyname restores $abilityvalue health!
$enemyname gains $abilityvalue2 armor!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;ExplosivePotion&quot;&gt;&gt;\
$enemyname throws an explosive potion at your feet! Boom!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialarmor -= $enemywillpower&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;

You take $abilityvalue damage!
You armor drops by $enemywillpower damage!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;GemSight&quot;&gt;&gt;\
$enemyname gets lost, absorbed in the dark powers of the gem!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;

$enemyname does nothing!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;GiantSwipe&quot;&gt;&gt;\
$enemyname goes into a frenzy and delivers a series of massive blows!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = ($enemyagility/2) + ($enemystrength/2)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lt 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue3 = $enemystrength/10&gt;&gt;\
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\

The first strike deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The second strike deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The third strike deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

You lose $abilityvalue3 armor!
\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue3&gt;&gt;\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;FadeToBlack&quot;&gt;&gt;\
$enemyname seeks refuge in the shadows!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $enemycurrenthealth += $enemywillpower&gt;&gt;\
&lt;&lt;set $enemyevadescore += $enemywillpower/4&gt;&gt;\
&lt;&lt;set $abilityvalue = $enemywillpower*.2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemywillpower += $abilityvalue&gt;&gt;\

$enemyname gains $enemywillpower health!
$enemyname has increased its evasion!
$enemyname gains $abilityvalue willpower!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;FlameBreath&quot;&gt;&gt;\
$enemyname unleashes a torrent of searing fire!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength*1.5&gt;&gt;
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemystrength/5&gt;&gt;
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\

You lose $abilityvalue health!
You lose $abilityvalue2 armor!

&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue2&gt;&gt;\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;FrostBreath&quot;&gt;&gt;\
$enemyname unleashes a torrent of frozen air!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $abilityvalue3 = $enemywillpower/4&gt;&gt;\
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\
\
You lose $abilityvalue health!
You lose $abilityvalue2 armor!
You lose $abilityvalue3 agility!
\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue3&gt;&gt;\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Gloat&quot;&gt;&gt;\
$enemyname gloats over your inevitable defeat.
&lt;&lt;if $enemyname eq &quot;Captain Domitus&quot;&gt;&gt;&lt;&lt;DomitusTalk &quot;None can stand before the Deathguard!&quot;&gt;&gt;\
&lt;&lt;elseif $enemyname eq &quot;Count Barsenes the Vile&quot;&gt;&gt;&lt;&lt;CountTalk &quot;&lt;i&gt;How pathetic! Thy skull shall make a fine goblet!&lt;/i&gt;&quot;&gt;&gt;\
 &lt;&lt;else&gt;&gt;\
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = 1&gt;&gt;\
&lt;&lt;set $specialstrength -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialwillpower -= $abilityvalue&gt;&gt;\

Your strength falls by $abilityvalue!
Your agility falls by $abilityvalue!
Your willpower falls by $abilityvalue!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;GoblinElite&quot;&gt;&gt;\
$enemyname calls upon his elite goblin combat training!
\
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;\
&lt;&lt;set $abilityvalue = $enemywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/5&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
\
&lt;&lt;set $enemystrength += $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemyagility += $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;\

$enemyname gains $abilityvalue2 strength!
$enemyname gains $abilityvalue2 agility!
$enemyname gains $abilityvalue health!
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;GreenVenom&quot;&gt;&gt;\
$enemyname attacks with green venom!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $agility/10&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $agility&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialagility += $abilityvalue&gt;&gt;\

You take damage equal to your agility - you take $abilityvalue2 damage!
Your agility increases by $abilityvalue!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BlueVenom&quot;&gt;&gt;\
$enemyname attacks with blue venom!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $willpower/10&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $willpower&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialwillpower += $abilityvalue&gt;&gt;\

You take damage equal to your willpower - you take $abilityvalue2 damage!
Your willpower increases by $abilityvalue!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;RedVenom&quot;&gt;&gt;\
$enemyname attacks with red venom!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $strength/10&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $strength&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialstrength += $abilityvalue&gt;&gt;\

You take damage equal to your strength - you take $abilityvalue2 damage!
Your strength increases by $abilityvalue!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;HailStorm&quot;&gt;&gt;\
$enemyname launches a storm of hail upon you!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;if $enemyagility gt $enemywillpower&gt;&gt;&lt;&lt;set $abilityvalue = $enemyagility/2&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $abilityvalue = $enemywillpower/2&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue += 10&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lt 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
The first wave of hail deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The second wave of hail deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

The third wave of hail deals $abilityvalue damage - your armor reduces your damage taken - you take $abilityvalue2 damage!

&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Haunt&quot;&gt;&gt;\
$enemyname haunts you, sapping your power!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*.25&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;if $abilityvalue gt 6&gt;&gt; &lt;&lt;set $abilityvalue = 6&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $specialstrength -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialwillpower -= $abilityvalue&gt;&gt;\

Your strength falls by $abilityvalue!
Your agility falls by $abilityvalue!
Your willpower falls by $abilityvalue!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;HardShell&quot;&gt;&gt;\
$enemyname gains an outer layer of impervious armor!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength/4&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue&gt;&gt;\

$enemyname gains armor equal to a quarter of its strength. $enemyname gains $abilityvalue armor!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;IceArrow&quot;&gt;&gt;\
$enemyname launches an arrow of piercing ice!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemymaxdamage + 5&gt;&gt;\

The arrow reduces your armor by $abilityvalue!
The arrow deals $abilityvalue2 damage to you!

&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue&gt;&gt;\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;IceWall&quot;&gt;&gt;\
$enemyname protects itself within a wall of ice!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;if $enemystrength gt $enemywillpower&gt;&gt;&lt;&lt;set $abilityvalue = $enemystrength/2&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $abilityvalue = $enemywillpower/2.5&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemystrength/4&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\

&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue2&gt;&gt;\

The $enemyname heals itself of $abilityvalue damage!
The $enemyname gains $abilityvalue2 armor!
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;IronBlood&quot;&gt;&gt;\
$enemyname trades blood for armor!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength/3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue&gt;&gt;\

$enemyname gains $abilityvalue armor!
$enemyname loses $abilityvalue health!
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;LifeSteal&quot;&gt;&gt;\
$enemyname draws out your life to fuel its own!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;\

You lose $abilityvalue health!
$enemyname gains $abilityvalue health!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Madness&quot;&gt;&gt;\
$enemyname hurts itself in madness!
&lt;&lt;if $enemyname neq &quot;Ryz, the Arcane Observer&quot;&gt;&gt; &lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength/4&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue&gt;&gt;\

&lt;&lt;if $enemyname eq &quot;Ryz, the Arcane Observer&quot;&gt;&gt;\
&lt;&lt;if $currenthealth gte 300&gt;&gt;\
&lt;&lt;Ryz2Talk &quot;I have seen all nine directions and all fourteen states of being. &lt;i&gt;I have seen too much&lt;/i&gt;!&quot;&gt;&gt;\
&lt;&lt;elseif $currenthealth gte 150&gt;&gt;\
&lt;&lt;Ryz2Talk &quot;I have observed generations of pigeons live and die! To them, I am a God. To me, &lt;i&gt;they are pidgeons&lt;/i&gt;!&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;\
&lt;&lt;Ryz2Talk &quot;Was I already mad, when I told Netheryn of the Void? What have I done? &lt;i&gt;What have I done&lt;/i&gt;!?&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
$enemyname loses $abilityvalue health!
$enemyname loses $abilityvalue armor!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;MightySlash&quot;&gt;&gt;\
$enemyname deals a devastating blow!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue lt 0&gt;&gt; &lt;&lt;set $abilityvalue = 0&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;
&lt;&lt;set $enemystrength += 15&gt;&gt;

You take $abilityvalue damage!
$enemyname gains 15 strength!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;MoltenGold&quot;&gt;&gt;\
$enemyname sprays you with molten gold!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength/4&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;set $currenthealth -= $enemystrength&gt;&gt;

You lose armor equal to a quarter of $enemyname&#39;s strength. You lose $abilityvalue armor!
You take damage equal to $enemyname&#39;s strength. You take $enemystrength damage!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;MonstrousBite&quot;&gt;&gt;\
$enemyname crushes you between rows of razor sharp teeth!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength*1.25&gt;&gt;
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lt 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue3 = $enemywillpower*0.25&gt;&gt;
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\

The bite deals $abilityvalue damage - your armor protects you! You lose $abilityvalue2 health!
Your wounds grant $enemyname strength! Its strength increases by $abilityvalue3!

&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue3&gt;&gt;\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Revenge&quot;&gt;&gt;\
$enemyname charges at $allyname, swearing revenge!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemystrength/12&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemywillpower += $abilityvalue2&gt;&gt;\
&lt;&lt;set $allycurrenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor += 25&gt;&gt;\
\
$allyname loses $abilityvalue health!
$enemyname&#39;s strength increases by $abilityvalue2!
$enemyname&#39;s willpower increases by $abilityvalue2!
$enemyname gains 25 armor!
\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Roar&quot;&gt;&gt;\
$enemyname delivers a fearsome roar!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $enemystrength += 1&gt;&gt;
&lt;&lt;set $specialstrength -= 1&gt;&gt;

$enemyname&#39;s strength increases by 1!
You lose 1 strength!
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;PoisonArrow&quot;&gt;&gt;\
The $enemyname shoots you with a poisoned arrow!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemyagility*1.5&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemyagility*0.2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
\
&lt;&lt;set $specialstrength -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\

The the poison hurts you for 1.5 times the $enemyname&#39;s Agility value - you take $abilityvalue damage!
The poison weakens you! You lose $abilityvalue2 Strength for the rest of the battle!
The poison slows you! You lose $abilityvalue2 Agility for the rest of the battle!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;PowerPotion&quot;&gt;&gt;\
$enemyname drinks an unstable restorative potion!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyagility += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $enemywillpower&gt;&gt;\

$enemyname gains $abilityvalue strength!
$enemyname gains $abilityvalue agility!
$enemyname gains $enemywillpower health!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Regenerate&quot;&gt;&gt;\
The $enemyname&#39;s wounds begin to close!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;\

The $enemyname heals itself of $abilityvalue damage!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;ShadowBeam&quot;&gt;&gt;\
The $enemyname strikes you with a beam of pure darkness!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $specialwillpower -= 5&gt;&gt;\
&lt;&lt;set $abilityvalue = $enemywillpower*1.5&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\

You lose $abilityvalue health!
Your willpower falls by 5 for the rest of the battle!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Shatter&quot;&gt;&gt;\
The $enemyname shatters his own armor, striking you with its shards!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*0.5&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue*0.5&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;if $enemyarmor gt 0&gt;&gt;&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemyagility += $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\

$enemyname loses $abilityvalue armor!
You take $abilityvalue damage!
$enemyname gains $abilityvalue2 strength!
$enemyname gains $abilityvalue2 agility!&lt;&lt;else&gt;&gt;
$enemyname has no armor, so the ability failed!&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;ShieldSlam&quot;&gt;&gt;\
The $enemyname slams you with their shield!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $stun = 1&gt;&gt;\
&lt;&lt;set $abilityvalue = $enemystrength/4&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue&gt;&gt;\

The $enemyname stuns you for one turn!
The $enemyname&#39;s armor increased by $abilityvalue!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Silencex&quot;&gt;&gt;\
The $enemyname steals the air from your lungs!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*1.5&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currentmana -= $abilityvalue&gt;&gt;\
&lt;&lt;set $stun += 1&gt;&gt;\

You lose $abilityvalue mana!
You are stunned!
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;SoulDevour&quot;&gt;&gt;\
$enemyname devours your soul!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/5&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialstrength -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialwillpower -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemywillpower += $abilityvalue&gt;&gt;
&lt;&lt;set $abilityvalue2 = $abilityvalue*3&gt;&gt;
&lt;&lt;set $enemycurrenthealth += $abilityvalue2&gt;&gt;

Your strength falls by $abilityvalue!
Your agility falls by $abilityvalue!
Your willpower falls by $abilityvalue!
$enemyname gains $abilityvalue willpower!
$enemyname gains $abilityvalue2 health!
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;SoulVomit&quot;&gt;&gt;\
$enemyname vomits a deluge of souls onto you and $allyname
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $allycurrenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemystrength/50&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $specialwillpower -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $allywillpower -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $abilityvalue3 = $enemystrength/10&gt;&gt;\
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue3&gt;&gt;\

You and $allyname lose $abilityvalue health!
You and $allyname lose $abilityvalue2 willpower!
$enemyname loses $abilityvalue3 armor!
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Strangle&quot;&gt;&gt;\
$enemyname wraps you in a vice-like grip!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemystrength/10&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue2&gt;&gt;\
\
You take $abilityvalue damage!
The $enemyname&#39;s strength increases by $abilityvalue2!
Your agility decreases by $abilityvalue2!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Sunlight&quot;&gt;&gt;\
The $enemyname opens its petals and absorbs sunlight!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/4&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;\

The $enemyname gains $abilityvalue health!
The $enemyname&#39;s petals are exposed! It loses $abilityvalue2 armor!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;ViciousBite&quot;&gt;&gt;\
$enemyname rends your flesh with a vicious bite!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength + $enemyagility&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemystrength += 2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\

You take $abilityvalue damage!
The $enemyname&#39;s strength increases by 2!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Viciousness&quot;&gt;&gt;\
$enemyname strikes with darkened claw and sharpened fang!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength + ($enemyagility/2)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemystrength/4&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue2&gt;&gt;\

You take $abilityvalue damage!
You lose $abilityvalue2 armor!
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;VineWhip&quot;&gt;&gt;\
$enemyname strikes you with thorned vines!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemyagility*2&gt;&gt;\
&lt;&lt;set $abilityvalue -= $armor&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;if $abilityvalue lt 0&gt;&gt; &lt;&lt;set $abilityvalue = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $enemyagility += 2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\

You take $abilityvalue damage!
The $enemyname&#39;s agility increases by 2!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;VoidBlade&quot;&gt;&gt;\
&lt;&lt;if $enemystrength lt 100&gt;&gt;
The $enemyname strikes with a sword of perfect darkness!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue2&gt;&gt;\

You take $abilityvalue damage!
$enemyname gains $abilityvalue2 strength!
&lt;&lt;else&gt;&gt;\
The $enemyname delivers a lethal blow!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength*2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemystrength/2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemystrength -= $abilityvalue2&gt;&gt;\

You take $abilityvalue damage!
$enemyname loses $abilityvalue2 strength!
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;VoidRoar&quot;&gt;&gt;\
The $enemyname warns its master that you are near!
&lt;&lt;VoidColossusTalk &quot;&lt;i&gt;GRAAAAAHHHH!!!&lt;/i&gt;&quot;&gt;&gt;\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;VoidShell&quot;&gt;&gt;\
The $enemyname gathers shadows to increase its power!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower*2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemywillpower/5&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue2&gt;&gt;\

The $enemyname gains $abilityvalue armor!
The $enemyname gains $abilityvalue2 strength!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;VoidStrike&quot;&gt;&gt;\
The $enemyname claws at your soul!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemywillpower/7&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue&gt;&gt;\

&lt;&lt;set $currenthealth -= $enemystrength&gt;&gt;\

You lose $enemystrength health!
Your agility falls by $abilityvalue for the rest of the battle!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Wound&quot;&gt;&gt;\
$enemyname gives you a terrible wound!
&lt;&lt;EnemyAbilityImage $enemyaction 250&gt;&gt;&lt;&lt;/EnemyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemystrength/6&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $enemymaxdamage&gt;&gt;\
&lt;&lt;set $specialstrength -= $abilityvalue&gt;&gt;\

You take $enemymaxdamage damage!
Your strength drops by $abilityvalue!

&lt;&lt;/widget&gt;&gt;\




















</tw-passagedata><tw-passagedata pid="32" name="MerchantMeet" tags="" position="806,1121" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You are wandering through the Outskirts when you hear a curious sound. A voice.

A &lt;i&gt;human&lt;/i&gt; voice. A man in trouble, by the sound of it. Curious, you pick up your pace and cut your way through the brambles and undergrowth. Soon you come upon what must some be kind of carriage. Its two work horses are bucking and kicking in fear.
&lt;img src=&quot;Images/Outskirts/outskirts7.jpg&quot; width=650 /&gt;

And no wonder. A group of goblins stand in the carriage&#39;s way.

[[Intervene-&gt;MerchantMeet][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;As you leap onto the forest road, a man peeks his head out from the carriage.

&lt;&lt;MerchantTalk &quot;By sand and sun - I am saved! Oh, most gracious hero - rid me of these hideous beasts!&quot;&gt;&gt; \
You study the goblins. Clearly, they expected the carriage to be easy prey. Now, seeing you, they appear uncertain.
&lt;&lt;HeroTalk &quot;Hm... who&#39;s first?&quot;&gt;&gt;

One particularly brave goblin leaps forward.

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 1&gt;&gt; \

&lt;&lt;elseif $p eq 20&gt;&gt;\
\
&lt;&lt;if $battletotal eq 1&gt;&gt;The first goblin lies dead at your feet.
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;MerchantTalk &quot;Most impressive, brave hero! Beware though, another of those miscreants is looking to take revenge!&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;What say you and I take this one on together?&quot;&gt;&gt;\
Unfortunately, the man jumps back into the safety of his carriage without giving you an answer.

The goblin charges forth, dagger clutched in two hands.
&lt;&lt;GoblinTalk &quot;Grahh! We will protect this land!&quot;&gt;&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 2&gt;&gt; \

&lt;&lt;elseif $battletotal eq 2&gt;&gt;The second goblin drops dead before you.
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;MerchantTalk &quot;Hahah! You were born for the battlefield!&quot;&gt;&gt; \
You catch your breath, then give the man a cold stare.
&lt;&lt;HeroTalk &quot;And where&#39;s your contribution to this battle?&quot;&gt;&gt;\
In answer, the man tosses you a red vial. A healing potion in fact.
&lt;&lt;HeroTalk &quot;Hm. That will do.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;And there&#39;s more where that came from! Just get me out of here, by the sands!&quot;&gt;&gt; \

At those words, a third goblin steps towards you. This one wields a curved bow, and its quiver bristles with poison-tipped arrows.

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinArcherStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 3&gt;&gt; \
\
&lt;&lt;set $iteminventory[0].quantity += 1&gt;&gt;\

&lt;&lt;elseif $battletotal eq 3&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;merchant_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
The goblin archer clutches at its wounds, then dies with one last gurgle. The rest of the goblins flee, seeing the battle is lost.
&lt;&lt;BattleEnd&gt;&gt;\

The moment they&#39;re gone, you slump down to your knees. A single goblin is a trifle, but once they attack in a group... things get tricky.

As you&#39;re catching your breath, the carriage door creaks open. Out steps a heavy-set man sporting the loose, exotic garb of the Great Occident - a vast collection of small polities and fiefdoms far beyond the kingdom&#39;s reach. 
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=400 /&gt;

You&#39;ve never met one of his kind before, but you&#39;ve heard stories. Most of them bad.

&lt;&lt;MerchantTalk &quot;Might I have the name of the hero who so boldly saved my life?&quot;&gt;&gt; \

He&#39;s offered you his hand. After a moment&#39;s pause, you stand and take it.

&lt;&lt;HeroTalk &quot;Once I was called $name. I hope one day men will call me so again.&quot;&gt;&gt; \
\
&lt;&lt;MerchantTalk &quot;And I am Babar Ogho - my trade is in trading. That is, the buying and selling artifacts, potions, and weapons of war. Glittering jewels, magical armor, ancient tomes of vast and fearsome power... but mostly potions.&quot;&gt;&gt; \
\
You study the aging, portly man in muted curiosity.

&lt;&lt;HeroTalk &quot;And what brings a merchant of the Occident to the Deep Woods?&quot;&gt;&gt; \

[[He takes his time in answering-&gt;MerchantMeet][$p = 21]]
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Well... perhaps you could say I&#39;m looking for something.&quot;&gt;&gt; \
\
&lt;&lt;HeroTalk &quot;All you&#39;ll find in this blighted land is death. Yours, if you&#39;re not careful.&quot;&gt;&gt; \
\
&lt;&lt;MerchantTalk &quot;I think you are right, $name. But I cannot leave until I find what I seek. I sense you would say the same, if I asked you to leave.&quot;&gt;&gt; \
You nod, somewhat begrudgingly.
\
&lt;&lt;MerchantTalk &quot;So I must stay. Do you have a camp nearby? My horses need a rest. By sun and sands - so do I!&quot;&gt;&gt; \
\
After considering it, you decide the merchant - &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/span&gt; - can stay by your cabin, at least for the night. After you give him directions, he thanks you and heads off.

[[Study the slain goblins-&gt;MerchantMeet][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
&lt;&lt;HeroTalk &quot;What are these goblins up to? Perhaps the merchant knows more than he lets on. I should visit him.&quot;&gt;&gt; \
&lt;&lt;set $enemygold = 120&gt;&gt;\
&lt;&lt;set $enemyexp = 100&gt;&gt; \

You loot the corpse of your fallen foes. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
\
&lt;&lt;set $outskirtsquest = 5&gt;&gt;\
&lt;&lt;set $merchantstatus = 1&gt;&gt;\

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="33" name="Merchant1" tags="" position="601,753" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;if $merchantstatus eq 1&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;merchant_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;merchant&quot;&gt;&gt;\
\
You approach &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&#39;s&lt;/b&gt;&lt;/span&gt; carriage, which has seemingly transformed since the last you saw it from a mobile carriage to more of a small shop. You&#39;re not exactly sure when he had time to do this.
&lt;img src=&quot;Images/Locations/merchant1.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;Where did all this stuff even come from?&quot;&gt;&gt;

[[Speak to Babar-&gt;Merchant1][$p = 10]]

&lt;&lt;elseif $time eq &quot;Night&quot;&gt;&gt;\
&lt;img src=&quot;Images/Locations/night3.jpg&quot; width=650 /&gt;
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&#39;s&lt;/b&gt;&lt;/span&gt; shop is closed. The merchant must be asleep. 

In fact, you can hear him snoring.

&lt;&lt;HeroTalk &quot;I&#39;ll come again tomorrow.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin][$p = 0]]
&lt;&lt;if ($lewdmode eq 1) and ($merchantlove eq 12)&gt;&gt;[[Investigate the gloryhole-&gt;Merchant Lewd][$p = 6]]
&lt;&lt;elseif ($lewdmode eq 1) and ($merchantlove eq 13)&gt;&gt;[[Return to the gloryhole-&gt;Merchant Lewd][$p = 13]]
&lt;&lt;elseif ($lewdmode eq 1) and ($merchantlove eq 14)&gt;&gt;[[Use the gloryhole-&gt;Merchant Lewd][$p = 17]]
&lt;&lt;elseif ($lewdmode eq 1) and ($merchantlove eq 15)&gt;&gt;[[Investigate the gloryhole-&gt;Merchant Lewd][$p = 24]]
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $merchantstatus gte 2&gt;&gt;\
&lt;&lt;if $music neq &quot;merchant&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;merchant_bgm&quot; volume 0.5 play loop&gt;&gt; &lt;&lt;set $music = &quot;merchant&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
You stand before &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&#39;s&lt;/b&gt;&lt;/span&gt; shop.
&lt;img src=&quot;Images/Locations/merchant1.jpg&quot; width=650 /&gt;
&lt;&lt;set $i = 0&gt;&gt;\

[[Buy-&gt;Merchant1][$p = 1]]
[[Sell-&gt;Merchant1][$p = 3]]
&lt;&lt;if $merchantstatus eq 2&gt;&gt;[[Talk to Babar about the goblins-&gt;Merchant1][$p = 12]]&lt;&lt;elseif $merchantstatus eq 4&gt;&gt;[[Talk to Babar about the crystal-&gt;Merchant1][$p = 16]]&lt;&lt;elseif ($merchantstatus eq 5) and ($valequest gte 5)&gt;&gt;[[Talk to Babar about the witch-&gt;Merchant1][$p = 18]]&lt;&lt;elseif $merchantstatus eq 7&gt;&gt;[[Give Babar the Star Nectar-&gt;Merchant1][$p = 21]]&lt;&lt;elseif $merchantstatus eq 10&gt;&gt;[[Ask Babar about Naya-&gt;Merchant1][$p = 23]]&lt;&lt;elseif ($merchantstatus eq 11) or ($merchantstatus eq 12)&gt;&gt;[[Ask Babar about the Spring of Life-&gt;Merchant1][$p = 25]]&lt;&lt;elseif ($merchantstatus eq 20)&gt;&gt;[[Ask Babar about Zabil-&gt;Merchant1][$p = 30]]&lt;&lt;elseif ($merchantstatus eq 21) and ($finalquest gte 3)&gt;&gt;[[Speak to Babar-&gt;Merchant1][$p = 33]]&lt;&lt;elseif ($merchantstatus eq 22)&gt;&gt;[[Speak to Babar about the void resin-&gt;Merchant1][$p = 35]]&lt;&lt;elseif ($merchantstatus eq 23) and ($finalquest eq 12)&gt;&gt;[[Say farewell-&gt;Merchant1][$p = 39]]&lt;&lt;/if&gt;&gt;
[[Return-&gt;Outside the Cabin][$p = 0]]
&lt;&lt;if ($lewdmode eq 1) and ($gender eq &quot;female&quot;) and ($merchantlove eq 10) and ($pussy lte 3)&gt;&gt;[[You notice a strange hole on Babar&#39;s carriage-&gt;Merchant Lewd][$p = 0]]
&lt;&lt;elseif $merchantlove eq 11&gt;&gt;&lt;i&gt;I&#39;m not going near that glory hole! I&#39;m so worked up... I need some relief.&lt;/i&gt;
&lt;&lt;elseif ($merchantlove eq 12) and ($time neq &quot;Night&quot;)&gt;&gt;&lt;i&gt;I can&#39;t just walk up to that gloryhole in the middle of the day! I&#39;ll go at night.&lt;/i&gt;
&lt;&lt;elseif $merchantlove eq 12&gt;&gt;[[Investigate the gloryhole-&gt;Merchant Lewd][$p = 6]]
&lt;&lt;elseif ($merchantlove eq 13) and ($time neq &quot;Night&quot;)&gt;&gt;&lt;i&gt;I&#39;m never returning to that dirty gloryhole. And especially not during the day!&lt;/i&gt;
&lt;&lt;elseif $merchantlove eq 13&gt;&gt;[[Return to the gloryhole-&gt;Merchant Lewd][$p = 13]]
&lt;&lt;elseif ($merchantlove eq 14) and ($time neq &quot;Night&quot;)&gt;&gt;&lt;i&gt;I wouldn&#39;t mind using that gloryhole again... but not during the day&lt;/i&gt;
&lt;&lt;elseif $merchantlove eq 14&gt;&gt;[[Use the gloryhole-&gt;Merchant Lewd][$p = 17]]
&lt;&lt;elseif $merchantlove eq 15&gt;&gt;[[Investigate the gloryhole-&gt;Merchant Lewd][$p = 24]]
&lt;&lt;elseif $merchantlove eq 17&gt;&gt;[[Speak to Babar about his naughty proposal-&gt;Merchant Lewd][$p = 27]]
&lt;&lt;elseif $merchantlove eq 25&gt;&gt;[[Confront Babar-&gt;Merchant Lewd][$p = 48]]
&lt;&lt;elseif $merchantlove eq 27&gt;&gt;[[Speak to Babar about your relationship-&gt;Merchant Lewd][$p = 60]]
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Take a look, take a look! Surely you&#39;ll find something that... &lt;i&gt;interests&lt;/i&gt; you.&quot;&gt;&gt;\
\
&lt;&lt;set $passage = passage()&gt;&gt;\
&lt;&lt;set $oldgold = $gold&gt;&gt;\
[[Return-&gt;Merchant1][$p = 0]] 

&lt;b&gt;Weapons&lt;/b&gt;
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $merchantweaponinventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:80%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $merchantweaponinventory[_i].name&gt;&gt;&lt;/b&gt; &lt;&lt;hovertip &#96;&#39;$merchantweaponinventory[_i].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt;
	Price: &lt;&lt;print $merchantweaponinventory[_i].price&gt;&gt;
	Strength: &lt;&lt;print $merchantweaponinventory[_i].strength&gt;&gt;
	Agility: &lt;&lt;print $merchantweaponinventory[_i].agility&gt;&gt;
	Willpower: &lt;&lt;print $merchantweaponinventory[_i].willpower&gt;&gt;
	Armor: &lt;&lt;print $merchantweaponinventory[_i].armor&gt;&gt;
	Damage: &lt;&lt;print $merchantweaponinventory[_i].mindamage&gt;&gt; - &lt;&lt;print $merchantweaponinventory[_i].maxdamage&gt;&gt;
&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;if $merchantweaponinventory[_i].price gt $gold&gt;&gt;&lt;i&gt;not enough gold&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Buy&quot; $passage&gt;&gt;&lt;&lt;set $p = 2&gt;&gt; &lt;&lt;set $weaponinventory.push($merchantweaponinventory[_i])&gt;&gt; &lt;&lt;set $gold -= $merchantweaponinventory[_i].price&gt;&gt; &lt;&lt;set $purchase = $merchantweaponinventory[_i].name&gt;&gt; &lt;&lt;set $purchaseclass = $merchantweaponinventory[_i].class&gt;&gt;&lt;&lt;set $merchantweaponinventory.delete($merchantweaponinventory[_i])&gt;&gt;&lt;&lt;/link&gt;&gt;  &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;WeaponImage $merchantweaponinventory[_i].name 200&gt;&gt;&lt;&lt;/WeaponImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;
&lt;/table&gt;\

&lt;b&gt;Armor&lt;/b&gt;
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $merchantarmorinventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:80%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $merchantarmorinventory[_i].name&gt;&gt;&lt;/b&gt; &lt;&lt;hovertip &#96;&#39;$merchantarmorinventory[_i].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt;
	Price: &lt;&lt;print $merchantarmorinventory[_i].price&gt;&gt;
	Strength: &lt;&lt;print $merchantarmorinventory[_i].strength&gt;&gt;
	Agility: &lt;&lt;print $merchantarmorinventory[_i].agility&gt;&gt;
	Willpower: &lt;&lt;print $merchantarmorinventory[_i].willpower&gt;&gt;
	Armor: &lt;&lt;print $merchantarmorinventory[_i].armor&gt;&gt;
&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;if $merchantarmorinventory[_i].price gt $gold&gt;&gt;&lt;i&gt;not enough gold&lt;/i&gt;&lt;&lt;elseif $merchantarmorinventory[_i].class eq &quot;head&quot;&gt;&gt;&lt;&lt;link &quot;Buy&quot; $passage&gt;&gt;&lt;&lt;set $p = 2&gt;&gt; &lt;&lt;set $headinventory.push($merchantarmorinventory[_i])&gt;&gt; &lt;&lt;set $gold -= $merchantarmorinventory[_i].price&gt;&gt; &lt;&lt;set $purchase = $merchantarmorinventory[_i].name&gt;&gt; &lt;&lt;set $purchaseclass = $merchantarmorinventory[_i].class&gt;&gt;&lt;&lt;set $merchantarmorinventory.delete($merchantarmorinventory[_i])&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $merchantarmorinventory[_i].class eq &quot;chest&quot;&gt;&gt;&lt;&lt;link &quot;Buy&quot; $passage&gt;&gt;&lt;&lt;set $p = 2&gt;&gt; &lt;&lt;set $chestinventory.push($merchantarmorinventory[_i])&gt;&gt; &lt;&lt;set $gold -= $merchantarmorinventory[_i].price&gt;&gt; &lt;&lt;set $purchase = $merchantarmorinventory[_i].name&gt;&gt; &lt;&lt;set $purchaseclass = $merchantarmorinventory[_i].class&gt;&gt;&lt;&lt;set $merchantarmorinventory.delete($merchantarmorinventory[_i])&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $merchantarmorinventory[_i].class eq &quot;hands&quot;&gt;&gt;&lt;&lt;link &quot;Buy&quot; $passage&gt;&gt;&lt;&lt;set $p = 2&gt;&gt; &lt;&lt;set $handsinventory.push($merchantarmorinventory[_i])&gt;&gt; &lt;&lt;set $gold -= $merchantarmorinventory[_i].price&gt;&gt; &lt;&lt;set $purchase = $merchantarmorinventory[_i].name&gt;&gt; &lt;&lt;set $purchaseclass = $merchantarmorinventory[_i].class&gt;&gt;&lt;&lt;set $merchantarmorinventory.delete($merchantarmorinventory[_i])&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $merchantarmorinventory[_i].class eq &quot;legs&quot;&gt;&gt;&lt;&lt;link &quot;Buy&quot; $passage&gt;&gt;&lt;&lt;set $p = 2&gt;&gt; &lt;&lt;set $legsinventory.push($merchantarmorinventory[_i])&gt;&gt; &lt;&lt;set $gold -= $merchantarmorinventory[_i].price&gt;&gt; &lt;&lt;set $purchase = $merchantarmorinventory[_i].name&gt;&gt; &lt;&lt;set $purchaseclass = $merchantarmorinventory[_i].class&gt;&gt;&lt;&lt;set $merchantarmorinventory.delete($merchantarmorinventory[_i])&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $merchantarmorinventory[_i].class eq &quot;feet&quot;&gt;&gt;&lt;&lt;link &quot;Buy&quot; $passage&gt;&gt;&lt;&lt;set $p = 2&gt;&gt; &lt;&lt;set $feetinventory.push($merchantarmorinventory[_i])&gt;&gt; &lt;&lt;set $gold -= $merchantarmorinventory[_i].price&gt;&gt; &lt;&lt;set $purchase = $merchantarmorinventory[_i].name&gt;&gt; &lt;&lt;set $purchaseclass = $merchantarmorinventory[_i].class&gt;&gt;&lt;&lt;set $merchantarmorinventory.delete($merchantarmorinventory[_i])&gt;&gt;&lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;ArmorImage $merchantarmorinventory[_i].name 200&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;
&lt;/table&gt;\

&lt;b&gt;Items&lt;/b&gt;
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $iteminventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:80%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $iteminventory[_i].name&gt;&gt;&lt;/b&gt; 
	Price: &lt;&lt;print $iteminventory[_i].price&gt;&gt;
	&lt;&lt;print $iteminventory[_i].description&gt;&gt;
&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;if $iteminventory[_i].price gt $gold&gt;&gt;&lt;i&gt;not enough gold&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Buy&quot; $passage&gt;&gt;&lt;&lt;set $p = 2&gt;&gt;  &lt;&lt;set $gold -= $iteminventory[_i].price&gt;&gt; &lt;&lt;set $purchase = $iteminventory[_i].name&gt;&gt; &lt;&lt;set $purchaseclass = $iteminventory[_i].class&gt;&gt; &lt;&lt;set $iteminventory[_i].quantity += 1&gt;&gt; &lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
		&lt;&lt;if $iteminventory[_i].tripleprice gt $gold&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Buy 3&quot; $passage&gt;&gt;&lt;&lt;set $p = 2&gt;&gt;  &lt;&lt;set $gold -= $iteminventory[_i].tripleprice&gt;&gt; &lt;&lt;set $purchase = $iteminventory[_i].name&gt;&gt; &lt;&lt;set $purchaseclass = $iteminventory[_i].class&gt;&gt; &lt;&lt;set $iteminventory[_i].quantity += 3&gt;&gt; &lt;&lt;set $bought3 = 1&gt;&gt; &lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;ItemImage $iteminventory[_i].name 200&gt;&gt;&lt;&lt;/ItemImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;
&lt;/table&gt;\

&lt;b&gt;Special&lt;/b&gt;
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $specialinventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:80%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $specialinventory[_i].name&gt;&gt;&lt;/b&gt; 
	Price: &lt;&lt;print $specialinventory[_i].price&gt;&gt;
	&lt;&lt;print $specialinventory[_i].description&gt;&gt;
&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;if $specialinventory[_i].price gt $gold&gt;&gt;&lt;i&gt;not enough gold&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Buy&quot; $passage&gt;&gt;&lt;&lt;set $p = $specialinventory[_i].jump&gt;&gt;  &lt;&lt;set $gold -= $specialinventory[_i].price&gt;&gt; &lt;&lt;set $purchase = $specialinventory[_i].name&gt;&gt; &lt;&lt;set $purchaseclass = $specialinventory[_i].class&gt;&gt; &lt;&lt;set $specialinventory.delete($specialinventory[_i])&gt;&gt; &lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;ItemImage $specialinventory[_i].name 200&gt;&gt;&lt;&lt;/ItemImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;
&lt;/table&gt;\

[[Return-&gt;Merchant1][$p = 0]] 
\
\
\
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;set $price = $oldgold - $gold&gt;&gt;\
&lt;&lt;set $merchantgold += $price&gt;&gt;\
\
&lt;&lt;if $bought3 eq 1&gt;&gt;You buy 3 $purchase for $price gold pieces!&lt;&lt;else&gt;&gt;You buy a $purchase for $price gold pieces!&lt;&lt;/if&gt;&gt;
&lt;&lt;if $purchaseclass eq &quot;weapon&quot;&gt;&gt;&lt;&lt;WeaponImage $purchase 300&gt;&gt;&lt;&lt;/WeaponImage&gt;&gt; &lt;&lt;elseif $purchaseclass eq &quot;item&quot;&gt;&gt;&lt;&lt;ItemImage $purchase 250&gt;&gt;&lt;&lt;/ItemImage&gt;&gt; &lt;&lt;else&gt;&gt;&lt;&lt;ArmorImage $purchase 300&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;MerchantBuyTalk&gt;&gt;

[[Buy more-&gt;Merchant1][$p = 1]] 
[[Return-&gt;Merchant1][$p = 0]] 
\
&lt;&lt;set $bought3 = 0&gt;&gt;\
\
\
\
&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;MerchantTalk &quot;So, $name, let&#39;s see what you have to trade...&quot;&gt;&gt;\
\
&lt;&lt;set $passage = passage()&gt;&gt;\
&lt;&lt;set $oldgold = $gold&gt;&gt;\
[[Return-&gt;Merchant1][$p = 0]] 

&lt;b&gt;Weapons&lt;/b&gt;
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 1; _i lt $weaponinventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:80%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $weaponinventory[_i].name&gt;&gt;&lt;/b&gt; &lt;&lt;hovertip &#96;&#39;$weaponinventory[_i].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt;
	Sell Price: &lt;&lt;print $weaponinventory[_i].sellprice&gt;&gt;
	Strength: &lt;&lt;print $weaponinventory[_i].strength&gt;&gt;
	Agility: &lt;&lt;print $weaponinventory[_i].agility&gt;&gt;
	Willpower: &lt;&lt;print $weaponinventory[_i].willpower&gt;&gt;
	Armor: &lt;&lt;print $weaponinventory[_i].armor&gt;&gt;
	Damage: &lt;&lt;print $weaponinventory[_i].mindamage&gt;&gt; - &lt;&lt;print $weaponinventory[_i].maxdamage&gt;&gt;
&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;link &quot;Sell&quot; $passage&gt;&gt;&lt;&lt;set $p = 4&gt;&gt; &lt;&lt;set $gold += $weaponinventory[_i].sellprice&gt;&gt; &lt;&lt;set $purchase = $weaponinventory[_i].name&gt;&gt; &lt;&lt;set $purchaseclass = $weaponinventory[_i].class&gt;&gt;&lt;&lt;set $weaponinventory.delete($weaponinventory[_i])&gt;&gt;&lt;&lt;/link&gt;&gt; 
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;WeaponImage $weaponinventory[_i].name 200&gt;&gt;&lt;&lt;/WeaponImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;
&lt;/table&gt;\

&lt;b&gt;Armor&lt;/b&gt;
\
\
&lt;table class=&quot;armory-table&quot;&gt;
  &lt;tr&gt;
    &lt;th&gt;Helms&lt;/th&gt;
    &lt;th&gt;Chest Pieces&lt;/th&gt;
	&lt;th&gt;Gloves&lt;/th&gt;
    &lt;th&gt;Leg Guards&lt;/th&gt;
	&lt;th&gt;Boots&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;\
	&lt;&lt;for _a to 1; _a lt $headinventory.length; _a++&gt;&gt;
&lt;b&gt;&lt;&lt;print $headinventory[_a].name&gt;&gt;&lt;/b&gt;
&lt;&lt;hovertip &#96;&#39;$headinventory[_a].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt; &lt;&lt;hovertip &#96; &#39;&lt;&lt;ArmorImage $headinventory[_a].name 200&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt;&#39;&#96;&gt;&gt;pic&lt;&lt;/hovertip&gt;&gt;
Sell Price: &lt;&lt;print $headinventory[_a].sellprice&gt;&gt;
Strength: &lt;&lt;print $headinventory[_a].strength&gt;&gt;
Agility: &lt;&lt;print $headinventory[_a].agility&gt;&gt;
Willpower: &lt;&lt;print $headinventory[_a].willpower&gt;&gt;
Armor: &lt;&lt;print $headinventory[_a].armor&gt;&gt;
&lt;&lt;capture _a&gt;&gt;
		&lt;&lt;link &quot;Sell&quot; $passage&gt;&gt;&lt;&lt;set $p = 4&gt;&gt; &lt;&lt;set $gold += $headinventory[_a].sellprice&gt;&gt; &lt;&lt;set $purchase = $headinventory[_a].name&gt;&gt; &lt;&lt;set $purchaseclass = $headinventory[_a].class&gt;&gt;&lt;&lt;set $headinventory.delete($headinventory[_a])&gt;&gt;&lt;&lt;/link&gt;&gt; 
	&lt;&lt;/capture&gt;&gt;\
	&lt;&lt;/for&gt;&gt;\
	&lt;/td&gt;\
    &lt;td&gt;\
	&lt;&lt;for _b to 1; _b lt $chestinventory.length; _b++&gt;&gt;
&lt;b&gt;&lt;&lt;print $chestinventory[_b].name&gt;&gt; &lt;/b&gt;
&lt;&lt;hovertip &#96;&#39;$chestinventory[_b].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt; &lt;&lt;hovertip &#96; &#39;&lt;&lt;ArmorImage $chestinventory[_b].name 200&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt;&#39;&#96;&gt;&gt;pic&lt;&lt;/hovertip&gt;&gt;
Sell Price: &lt;&lt;print $chestinventory[_b].sellprice&gt;&gt;
Strength: &lt;&lt;print $chestinventory[_b].strength&gt;&gt;
Agility: &lt;&lt;print $chestinventory[_b].agility&gt;&gt;
Willpower: &lt;&lt;print $chestinventory[_b].willpower&gt;&gt;
Armor: &lt;&lt;print $chestinventory[_b].armor&gt;&gt;
&lt;&lt;capture _b&gt;&gt;
		&lt;&lt;link &quot;Sell&quot; $passage&gt;&gt;&lt;&lt;set $p = 4&gt;&gt; &lt;&lt;set $gold += $chestinventory[_b].sellprice&gt;&gt; &lt;&lt;set $purchase = $chestinventory[_b].name&gt;&gt; &lt;&lt;set $purchaseclass = $chestinventory[_b].class&gt;&gt;&lt;&lt;set $chestinventory.delete($chestinventory[_b])&gt;&gt;&lt;&lt;/link&gt;&gt; 
	&lt;&lt;/capture&gt;&gt;\
	&lt;&lt;/for&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;\
	&lt;&lt;for _c to 1; _c lt $handsinventory.length; _c++&gt;&gt;
&lt;b&gt;&lt;&lt;print $handsinventory[_c].name&gt;&gt;&lt;/b&gt;
&lt;&lt;hovertip &#96;&#39;$handsinventory[_c].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt; &lt;&lt;hovertip &#96; &#39;&lt;&lt;ArmorImage $handsinventory[_c].name 200&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt;&#39;&#96;&gt;&gt;pic&lt;&lt;/hovertip&gt;&gt;
Sell Price: &lt;&lt;print $handsinventory[_c].sellprice&gt;&gt;
Strength: &lt;&lt;print $handsinventory[_c].strength&gt;&gt;
Agility: &lt;&lt;print $handsinventory[_c].agility&gt;&gt;
Willpower: &lt;&lt;print $handsinventory[_c].willpower&gt;&gt;
Armor: &lt;&lt;print $handsinventory[_c].armor&gt;&gt;
&lt;&lt;capture _c&gt;&gt;
		&lt;&lt;link &quot;Sell&quot; $passage&gt;&gt;&lt;&lt;set $p = 4&gt;&gt; &lt;&lt;set $gold += $handsinventory[_c].sellprice&gt;&gt; &lt;&lt;set $purchase = $handsinventory[_c].name&gt;&gt; &lt;&lt;set $purchaseclass = $handsinventory[_c].class&gt;&gt;&lt;&lt;set $handsinventory.delete($handsinventory[_c])&gt;&gt;&lt;&lt;/link&gt;&gt; 
	&lt;&lt;/capture&gt;&gt;\
	&lt;&lt;/for&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;\
	&lt;&lt;for _d to 1; _d lt $legsinventory.length; _d++&gt;&gt;
&lt;b&gt;&lt;&lt;print $legsinventory[_d].name&gt;&gt; &lt;/b&gt;
&lt;&lt;hovertip &#96;&#39;$legsinventory[_d].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt; &lt;&lt;hovertip &#96; &#39;&lt;&lt;ArmorImage $legsinventory[_d].name 200&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt;&#39;&#96;&gt;&gt;pic&lt;&lt;/hovertip&gt;&gt;
Sell Price: &lt;&lt;print $legsinventory[_d].sellprice&gt;&gt;
Strength: &lt;&lt;print $legsinventory[_d].strength&gt;&gt;
Agility: &lt;&lt;print $legsinventory[_d].agility&gt;&gt;
Willpower: &lt;&lt;print $legsinventory[_d].willpower&gt;&gt;
Armor: &lt;&lt;print $legsinventory[_d].armor&gt;&gt;
&lt;&lt;capture _d&gt;&gt;
		&lt;&lt;link &quot;Sell&quot; $passage&gt;&gt;&lt;&lt;set $p = 4&gt;&gt; &lt;&lt;set $gold += $legsinventory[_d].sellprice&gt;&gt; &lt;&lt;set $purchase = $legsinventory[_d].name&gt;&gt; &lt;&lt;set $purchaseclass = $legsinventory[_d].class&gt;&gt;&lt;&lt;set $legsinventory.delete($legsinventory[_d])&gt;&gt;&lt;&lt;/link&gt;&gt; 
	&lt;&lt;/capture&gt;&gt;\
	&lt;&lt;/for&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;\
	&lt;&lt;for _e to 1; _e lt $feetinventory.length; _e++&gt;&gt;
&lt;b&gt;&lt;&lt;print $feetinventory[_e].name&gt;&gt; &lt;/b&gt;
&lt;&lt;hovertip &#96;&#39;$feetinventory[_e].description&#39;&#96;&gt;&gt;info&lt;&lt;/hovertip&gt;&gt; &lt;&lt;hovertip &#96; &#39;&lt;&lt;ArmorImage $feetinventory[_e].name 200&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt;&#39;&#96;&gt;&gt;pic&lt;&lt;/hovertip&gt;&gt;
Sell Price: &lt;&lt;print $feetinventory[_e].sellprice&gt;&gt;
Strength: &lt;&lt;print $feetinventory[_e].strength&gt;&gt;
Agility: &lt;&lt;print $feetinventory[_e].agility&gt;&gt;
Willpower: &lt;&lt;print $feetinventory[_e].willpower&gt;&gt;
Armor: &lt;&lt;print $feetinventory[_e].armor&gt;&gt;
&lt;&lt;capture _e&gt;&gt;
		&lt;&lt;link &quot;Sell&quot; $passage&gt;&gt;&lt;&lt;set $p = 4&gt;&gt; &lt;&lt;set $gold += $feetinventory[_e].sellprice&gt;&gt; &lt;&lt;set $purchase = $feetinventory[_e].name&gt;&gt; &lt;&lt;set $purchaseclass = $feetinventory[_e].class&gt;&gt;&lt;&lt;set $feetinventory.delete($feetinventory[_e])&gt;&gt;&lt;&lt;/link&gt;&gt; 
	&lt;&lt;/capture&gt;&gt;\
	&lt;&lt;/for&gt;&gt;\
	&lt;/td&gt;\
  &lt;/tr&gt;
&lt;/table&gt;

&lt;b&gt;Items&lt;/b&gt;
\
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $iteminventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:80%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $iteminventory[_i].name&gt;&gt;&lt;/b&gt; 
	Sell Price: &lt;&lt;print $iteminventory[_i].sellprice&gt;&gt;
	Quantity: &lt;&lt;print $iteminventory[_i].quantity&gt;&gt;
	Description: &lt;&lt;print $iteminventory[_i].description&gt;&gt;
&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;if $iteminventory[_i].quantity lt 1&gt;&gt;&lt;i&gt;None to sell&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Sell&quot; $passage&gt;&gt;&lt;&lt;set $p = 4&gt;&gt; &lt;&lt;set $gold += $iteminventory[_i].sellprice&gt;&gt; &lt;&lt;set $purchase = $iteminventory[_i].name&gt;&gt; &lt;&lt;set $purchaseclass = $iteminventory[_i].class&gt;&gt; &lt;&lt;set $iteminventory[_i].quantity -= 1&gt;&gt;&lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;ItemImage $iteminventory[_i].name 200&gt;&gt;&lt;&lt;/ItemImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;
&lt;/table&gt;\

[[Return-&gt;Merchant1][$p = 0]] 
\
\
\
\
&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;set $price = $gold - $oldgold&gt;&gt;\
\
You sell a $purchase for $price gold pieces!
&lt;&lt;if $purchaseclass eq &quot;weapon&quot;&gt;&gt;&lt;&lt;WeaponImage $purchase 300&gt;&gt;&lt;&lt;/WeaponImage&gt;&gt; &lt;&lt;elseif $purchaseclass eq &quot;item&quot;&gt;&gt;&lt;&lt;ItemImage $purchase 250&gt;&gt;&lt;&lt;/ItemImage&gt;&gt; &lt;&lt;else&gt;&gt;&lt;&lt;ArmorImage $purchase 300&gt;&gt;&lt;&lt;/ArmorImage&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;MerchantSellTalk&gt;&gt;

[[Sell more-&gt;Merchant1][$p = 3]] 
[[Return-&gt;Merchant1][$p = 0]] 

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $weapon eq $purchase&gt;&gt;
&lt;&lt;set $weapon = $noweapon.name&gt;&gt;
&lt;&lt;set $weaponstrength = $noweapon.strength&gt;&gt;
&lt;&lt;set $weaponagility = $noweapon.agility&gt;&gt;
&lt;&lt;set $weaponwillpower = $noweapon.willpower&gt;&gt;
&lt;&lt;set $weaponarmor = $noweapon.armor&gt;&gt;
&lt;&lt;set $mindamage = $noweapon.mindamage&gt;&gt;
&lt;&lt;set $maxdamage = $noweapon.maxdamage&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($head eq $purchase) and ($gender eq &quot;male&quot;)&gt;&gt;
&lt;&lt;set $head = $nohelm.name&gt;&gt;
&lt;&lt;set $headstrength = $nohelm.strength&gt;&gt;
&lt;&lt;set $headagility = $nohelm.agility&gt;&gt;
&lt;&lt;set $headwillpower = $nohelm.willpower&gt;&gt;
&lt;&lt;set $headarmor = $nohelm.armor&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($head eq $purchase) and ($gender eq &quot;female&quot;)&gt;&gt;
&lt;&lt;set $head = $nohelmf.name&gt;&gt;
&lt;&lt;set $headstrength = $nohelmf.strength&gt;&gt;
&lt;&lt;set $headagility = $nohelmf.agility&gt;&gt;
&lt;&lt;set $headwillpower = $nohelmf.willpower&gt;&gt;
&lt;&lt;set $headarmor = $nohelmf.armor&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $chest eq $purchase&gt;&gt;
&lt;&lt;set $chest = $simpleshirt.name&gt;&gt;
&lt;&lt;set $cheststrength = $simpleshirt.strength&gt;&gt;
&lt;&lt;set $chestagility = $simpleshirt.agility&gt;&gt;
&lt;&lt;set $chestwillpower = $simpleshirt.willpower&gt;&gt;
&lt;&lt;set $chestarmor = $simpleshirt.armor&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hands eq $purchase&gt;&gt;
&lt;&lt;set $hands = $nogloves.name&gt;&gt;
&lt;&lt;set $handsstrength = $nogloves.strength&gt;&gt;
&lt;&lt;set $handsagility = $nogloves.agility&gt;&gt;
&lt;&lt;set $handswillpower = $nogloves.willpower&gt;&gt;
&lt;&lt;set $handsarmor = $nogloves.armor&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $legs eq $purchase&gt;&gt;
&lt;&lt;set $legs = $simplepants.name&gt;&gt;
&lt;&lt;set $legsstrength = $simplepants.strength&gt;&gt;
&lt;&lt;set $legsagility = $simplepants.agility&gt;&gt;
&lt;&lt;set $legswillpower = $simplepants.willpower&gt;&gt;
&lt;&lt;set $legsarmor = $simplepants.armor&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $feet eq $purchase&gt;&gt;
&lt;&lt;set $feet = $simpleshoes.name&gt;&gt;
&lt;&lt;set $feetstrength = $simpleshoes.strength&gt;&gt;
&lt;&lt;set $feetagility = $simpleshoes.agility&gt;&gt;
&lt;&lt;set $feetwillpower = $simpleshoes.willpower&gt;&gt;
&lt;&lt;set $feetarmor = $simpleshoes.armor&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;\
\
\
\
\
&lt;&lt;elseif $p eq 10&gt;&gt;\
&lt;&lt;HeroTalk &quot;Babar Ogho - what is the meaning of all of this?&quot;&gt;&gt;\
The merchant pops his head out from the back of the shop. He seems rather pleased with himself.
&lt;&lt;MerchantTalk &quot;This is perhaps the greatest idea I&#39;ve ever had. By sun and sand - it might be the best idea &lt;i&gt;anyone&lt;/i&gt; has ever had.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;What, a shop in the middle of the Deep Woods? Where are your customers?&quot;&gt;&gt;\
He chuckles to himself, like you just told a joke.
&lt;&lt;MerchantTalk &quot;Standing right in front of me. You, $name $title, you are my customer.&quot;&gt;&gt;\
The man&#39;s clearly gone mad.
&lt;&lt;HeroTalk &quot;Even if I wanted to buy your junk... you think my business alone can sustain you?&quot;&gt;&gt;\

[[Babar pauses before answering-&gt;Merchant1][$p = 11]]

&lt;&lt;elseif $p eq 11&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; sighs, his gaze lingering in the heavy woods beyond the cabin.

&lt;&lt;MerchantTalk &quot;If I venture any deeper into the Woods, I will meet my death. But I cannot go back until I find what I seek. So, what am I do? I must stay, but a merchant without trade is sure to wither. So, I will trade.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;With me?&quot;&gt;&gt;\
He laughs.
&lt;&lt;MerchantTalk &quot;Who else!? Yes, bring me your gold from the Deep Woods, and I will keep you armed and supplied for your forays. In turn, I will send that gold to Capital, and demand better supplies. By such a river of gold does the lifeblood of adventuring flow, no?&quot;&gt;&gt;\
He&#39;s starting to make at least a touch of sense.

Although, you still have one question.
&lt;&lt;HeroTalk &quot;What is it you&#39;re looking for, anyway?&quot;&gt;&gt;\

&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; stare grows wistful. You&#39;re poking at an old wound, clearly.

&lt;&lt;MerchantTalk &quot;I must buy something I once sold. Something priceless. Shall we leave it at that for now, friend?&quot;&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;I suppose that will do.&quot;&gt;&gt;\

&lt;i&gt;You can now buy items at &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&#39;s&lt;/b&gt;&lt;/span&gt; shop. As you adventure through the wilds, his inventory will grow!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $merchantstatus = 2&gt;&gt;\
&lt;&lt;MerchantInventory1&gt;&gt;\

&lt;&lt;elseif $p eq 12&gt;&gt;\
You wave to &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/span&gt; over, gesturing for him to come near.

&lt;&lt;MerchantTalk &quot;Yes, friend? Looking to buy? Or perhaps to sell?&quot;&gt;&gt;\
You shake your head.
&lt;&lt;HeroTalk &quot;I seek information, Babar. What do you know of the goblin activity in the area?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;What do I know? A little, maybe. Perhaps I&#39;d tell you... for fifty gold pieces.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Really? Is everything a bargain to you?&quot;&gt;&gt;\

He shrugs, but doesn&#39;t relent. 

&lt;&lt;if $gold gte 50&gt;&gt;[[Pay Babar for information-&gt;Merchant1][$p = 13, $i = 2]] &lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Pay Babar for information&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Maybe later-&gt;Merchant1][$p = 13, $i = 1]] 

&lt;&lt;elseif $p eq 13&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;That&#39;s no small sum, Babar.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Ah, but it&#39;s no small detail I have for you.&quot;&gt;&gt;\

You decide to take some time to think on it.

[[Return-&gt;Outside the Cabin]] 
\
\
&lt;&lt;elseif $i eq 2&gt;&gt;After a long moment, you reluctantly dig out your coin purse. 
&lt;&lt;HeroTalk &quot;Start talking.&quot;&gt;&gt;\
He takes the gold, counting it with his eyes before opening his mouth.
&lt;&lt;MerchantTalk &quot;There have always been goblins in the Deep Woods. They stick to themselves - as fearful of the older, darker things in the Woods as we are. But recently, things have changed.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Changed how?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;They&#39;ve moved - many of them, at least - from the deeper parts of the  Woods to the outskirts. And now they&#39;re far more aggressive than before. As for why... I don&#39;t know.&quot;&gt;&gt;\

The merchant&#39;s words match what you&#39;ve seen so far. The goblins are migrating to the Outskirts, and attacking anything in their path. Not to mention poisoning the wildlife. 
&lt;&lt;HeroTalk &quot;Do you think their aggression has anything to do with those rumors of an evil rising in the Deep Woods?&quot;&gt;&gt;\
He nods along, considering.
&lt;&lt;MerchantTalk &quot;Perhaps they are running from it. A frightening thought, no?&quot;&gt;&gt;\

[[You decide on a course of action-&gt;Merchant1][$p = 14]] 

&lt;&lt;set $gold -= 50&gt;&gt;\
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 14&gt;&gt;\
&lt;&lt;HeroTalk &quot;Whatever the goblins are up to, they must have the answers I seek. I will find their nest and demand to speak with their leader&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Ah... but a goblin hates to reveal its nest. That information won&#39;t come easily.&quot;&gt;&gt;\
You grip your $weapon.
&lt;&lt;HeroTalk &quot;I can be persuasive.&quot;&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/span&gt; stares into the woods beyond the cabin for a long while, then nudges your shoulder.
&lt;&lt;MerchantTalk &quot;$name... I like the way you think.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $merchantstatus = 3&gt;&gt;
&lt;&lt;set $outskirtsquest = 6&gt;&gt;
&lt;&lt;set $specialinventory.push($net)&gt;&gt;

&lt;&lt;elseif $p eq 15&gt;&gt;\
&lt;&lt;set $price = $oldgold - $gold&gt;&gt;\
&lt;&lt;set $merchantgold += $price&gt;&gt;\
\
You buy a $purchase for $price gold pieces!
&lt;&lt;ItemImage $purchase 250&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;

&lt;&lt;MerchantTalk &quot;A fine net! But tell me, $name, what is it for?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;m going to catch a fat boar and make us a feast for dinner.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;By sand and sun - really?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;No.&quot;&gt;&gt;\

With this net, you should be able to capture and question a goblin to learn the location of the Goblin King.

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $outskirtsquest = 7&gt;&gt;\
\
&lt;&lt;elseif $p eq 16&gt;&gt;\
You gesture for &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/span&gt; to step out of his cart and join you in the clearing.
&lt;&lt;MerchantTalk &quot;Yes, friend? Has a particular item caught your notice, perhaps?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I wanted to ask you something. After you dragged me from the goblin nest, you seemed interested in Redeemer&#39;s crystal.&quot;&gt;&gt;\
You give him a cold stare.
&lt;&lt;HeroTalk &quot;Was it you who sold the crystal to the Redeemer in the first place?&quot;&gt;&gt;\
The merchant goes a touch pale.
&lt;&lt;MerchantTalk &quot;By sun and sand - no! I am proud to say I have nothing to do with this vile &#39;Redeemer&#39; and his machinations. I seek a... a different stone, you could say.&quot;&gt;&gt;\

[[Babar wipes the sweat from his forehead-&gt;Merchant1][$p = 17]]

&lt;&lt;elseif $p eq 17&gt;&gt;\
&lt;&lt;HeroTalk &quot;Go on.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;I was not always the extraordinary merchant you see before you. I was once quite poor, I&#39;m afraid. But a chance run-in with a most mysterious benefactor changed my fortunes entirely. All I had to do was sell him a curious stone. A shimmering little thing, colored so deep a purple, one could lose himself in its glow...&quot;&gt;&gt;\
&lt;img src=&quot;Images/Outskirts/soulstone1.jpg&quot; width=400 /&gt;
&lt;&lt;HeroTalk &quot;And now you want it back?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Yes, now I want it back. And I&#39;ve come to believe my benefactor lives in the Deep Woods, though perhaps under a different name. By sand and sun, I will see the stone returned to my homeland!&quot;&gt;&gt;\

&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/span&gt; once more wipes the sweat from his brow. The merchant is quite worked up.

&lt;&lt;MerchantTalk &quot;Forgive me my rambling, $name. I feel our fortunes are now bound, yes? Each of us has a destiny tied to these cursed trees. And, if we work together, we might just survive.&quot;&gt;&gt;\
He pulls a yellow potion from one of his many vibrant cloaks and tosses it to you.
&lt;img src=&quot;Images/Items/Minor Strength Potion.jpg&quot; width=250 /&gt;
&lt;&lt;MerchantTalk &quot;A free sample, as thanks for listening to my worries. This elixir will give you a burst of strength in the heat of battle. Now, the taste leaves something to be desired...&quot;&gt;&gt;\

You gained a potion of strength!

[[Return-&gt;Outside the Cabin]] 
\
&lt;&lt;set $merchantstatus = 5&gt;&gt;\
&lt;&lt;set $iteminventory.push($minorstrengthpotion)&gt;&gt;\
\
&lt;&lt;elseif $p eq 18&gt;&gt;\
As you approach &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&#39;s&lt;/b&gt;&lt;/span&gt; shop, you see the merchant is already making his way towards you. He seems agitated.
&lt;&lt;MerchantTalk &quot;By sand and sun - $name, we&#39;re under attack!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Are we? I don&#39;t see any enemies.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;The Scarlet Witch herself has established a most foul abode right by your cabin! Come, we will draw a prayer circle and banish her together.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Or you could pay her to leave.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;&lt;i&gt;Pay her&lt;/i&gt;!? I&#39;m hardly making a profit as it is!&quot;&gt;&gt;\
He meets your amused stare.
&lt;&lt;MerchantTalk &quot;Ah, a joke. I didn&#39;t think you were the joking sort.&quot;&gt;&gt;\

[[Ask him why the witch bothers him-&gt;Merchant1][$p = 19]]

&lt;&lt;elseif $p eq 19&gt;&gt;\
&lt;&lt;HeroTalk &quot;Scyllia has you on edge. Why?&quot;&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; wipes the sweat from his brow.
&lt;&lt;MerchantTalk &quot;Magic can never be trusted. A wizard knows no such thing as fairness - and to bargain with a witch is to bargain with your soul.&quot;&gt;&gt;\
He seems truly uneasy with the idea of having &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; in your camp.
&lt;&lt;HeroTalk &quot;Keep your distance, if it suits you. For now, I need her aid.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Very well - actually, there something you can do to distract me. Something I&#39;m seeking, in the Scarlet Vale.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Gold?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Better than gold.&quot;&gt;&gt;\

[[Listen to the merchant&#39;s request-&gt;Merchant1][$p = 20]]

&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;&lt;MerchantTalk &quot;It is called Star Nectar. A rare fruit that is said to only grow in the Scarlet Vale. I may be able to create a rather exotic, powerful potion with such an ingredient.&quot;&gt;&gt;\
&lt;img src=&quot;Images/ScarletVale/fruit2.jpg&quot; width=450 /&gt;

After he describes the Star Nectar to you, you nod your head.
&lt;&lt;HeroTalk &quot;I&#39;ll see if I can find it in the Vale.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $merchantstatus = 6&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 21&gt;&gt;
You gesture for &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/span&gt; to step out of his cart and join you in the clearing.
&lt;&lt;MerchantTalk &quot;Yes, friend? Have you found it, then?&quot;&gt;&gt;\
You pull out the Star Nectar.
&lt;img src=&quot;Images/ScarletVale/fruit2.jpg&quot; width=450 /&gt;

Before he can grab it, you shake your head.
&lt;&lt;HeroTalk &quot;This isn&#39;t charity, Babar.&quot;&gt;&gt;\
Though it pains him, the merchant sighs and hands you a pouch holding 100 gold pieces. Then you hand him the fruit &lt;&lt;set $gold += 100&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Most astounding! The chemical properties of such a prize... it is said one bite of the Star Nectar will give a man the speed of a hawk in flight! A moment, please.&quot;&gt;&gt;\

[[Babar runs back to his shop-&gt;Merchant1][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
You stand beside the shop, curious as to what the merchant is up to. You can hear a cauldron hissing as it boils. Every once in a while, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; will shout a curse in his native tongue.

At last, he emerges. This time, he holds a curious potion.
&lt;img src=&quot;Images/Items/Minor Agility Potion.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;My latest creation - an agility potion. You foes won&#39;t be able to keep track of you after drinking this. The first sample is free, of course - though I expect you&#39;ll want to buy more...&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $merchantstatus = 8&gt;&gt;\
&lt;&lt;set $iteminventory.push($minoragilitypotion)&gt;&gt;\

&lt;&lt;elseif $p eq 23&gt;&gt;
As you approach &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&#39;s&lt;/b&gt;&lt;/span&gt; shop, you see the merchant is already making his way towards you. He seems excited.
&lt;&lt;MerchantTalk &quot;Can you believe it, friend! By sun and sand - I cannot!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;What are you talking about?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;The princess of Hadamshal, alive! Naya&#39;driel, living and breathing in our quiet forest home!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;It&#39;s &lt;i&gt;my&lt;/i&gt; cabin, Babar. And she&#39;s hardly a princess - Hadamshal is ash. Her people are long dead.&quot;&gt;&gt;\
He clicks his tongue, while wagging his head disapprovingly.
&lt;&lt;MerchantTalk &quot;Royalty &lt;i&gt;is&lt;/i&gt; royalty. That she survived her city&#39;s destruction only adds to the tale, no? We must protect her with our lives.&quot;&gt;&gt;\

[[I&#39;ll do what I can.-&gt;Merchant1][$p = 24, $i = 1]]
[[She&#39;s a capable warrior. She can take care of herself.-&gt;Merchant1][$p = 24, $i = 2]]
[[My only concern is the Void Gem-&gt;Merchant1][$p = 24, $i = 3]]

&lt;&lt;elseif $p eq 24&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;I&#39;ll do what I can, Babar.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;As will I. Speaking of which...&quot;&gt;&gt;\
&lt;&lt;elseif $i eq 2&gt;&gt;&lt;&lt;HeroTalk &quot;She&#39;s a capable warrior. She can take care of herself.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Ah, but a warrior is only as strong as her weapons, armor, and potions. Speaking of which...&quot;&gt;&gt;\
&lt;&lt;elseif $i eq 3&gt;&gt;&lt;&lt;HeroTalk &quot;My only concern is the destruction of the Void Gem.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Indeed! But unless you know how to operate a Netheryn Catalyst, Naya&#39;s livelihood is part of that concern. Speaking of which...&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; wanders into his shop, then returns with a few charred, ancient-looking books.
&lt;img src=&quot;Images/FrozenHills/spring1.jpg&quot; width=400 /&gt;

&lt;&lt;MerchantTalk &quot;The Tower of Zyr is little more than ashes, now, but I was able to dig up a few trinkets and books. This particular tome speaks of a fabled &lt;i&gt;Spring of Life&lt;/i&gt; in the Frozen Hills.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Spring of Life?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;By sun and sands, yes. A small pool rich in ancient elven magic. If you could bring me a vial from such a pool, the potions I could make... friend, you will strike with the might of the Gods themselves.&quot;&gt;&gt;\
You make a note to seek out this fabled spring. You&#39;ll need all the help you can get if you&#39;re to face off against the Redeemer.

[[Return-&gt;Outside the Cabin]] 
\
&lt;&lt;set $merchantstatus = 11&gt;&gt;\
\
&lt;&lt;elseif $p eq 25&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; leans over the counter of his shop, hopeful.
&lt;&lt;MerchantTalk &quot;Tell me, friend - have you found the Spring of Life?&quot;&gt;&gt;\

&lt;&lt;if $merchantstatus eq 12&gt;&gt;[[Yes-&gt;Merchant1][$p = 27]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Yes&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Not yet-&gt;Merchant1][$p = 26]]

&lt;&lt;elseif $p eq 26&gt;&gt;\
&lt;&lt;HeroTalk &quot;Not yet. Remind me, what am I looking for?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;I wish I had more to tell you. The book suggests it is a pool of water, echanted with ancient elven magic. A most powerful ingredient with which to enhance my potions!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;ll do my best to find it in the wilds.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;elseif $p eq 27&gt;&gt;\
You raise the vial you took from the Spring.
&lt;img src=&quot;Images/FrozenHills/spring3.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;That was no easy task, Babar. I trust this will be worth it.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;By sand and sun - it&#39;s &lt;i&gt;magnificent&lt;/i&gt;! Hand over your potions, and leave me to my work!&quot;&gt;&gt;\

After handing &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; your potions, you wait outside his shop while he mixes his potions inside. After a few exclaimations (and curses), he returns, grinning like a mad man.
&lt;&lt;MerchantTalk &quot;It worked! &lt;i&gt;It worked&lt;/i&gt;!&quot;&gt;&gt;\

[[What worked?-&gt;Merchant1][$p = 28]]

&lt;&lt;elseif $p eq 28&gt;&gt;\
In answer, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; places a set of potions on his counter, showing them off like prized possessions.
&lt;img src=&quot;Images/FrozenHills/spring4.jpg&quot; width=800 /&gt;

&lt;&lt;MerchantTalk &quot;Just as I&#39;d hoped, the Spring&#39;s properties were exactly what my potions needed for a bit of &lt;i&gt;oomph&lt;/i&gt;! From now on, you can expect much more powerful alchemical aid in battle, friend.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Impressive. Well done, Babar.&quot;&gt;&gt;\
The merchant beams.
&lt;&lt;MerchantTalk &quot;Of course, an enhanced product demands a higher price point, too...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Ah, of course...&quot;&gt;&gt;\

&lt;i&gt;Your potions have been upgraded!&lt;/i&gt;

&lt;i&gt;Upgraded potions can now be purchased at &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; shop!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $merchantstatus = 13&gt;&gt;\
&lt;&lt;set $iteminventory = []&gt;&gt;\
&lt;&lt;set $iteminventory.push($majorhealthpotion)&gt;&gt;\
&lt;&lt;set $iteminventory.push($majormanapotion)&gt;&gt;\
&lt;&lt;set $iteminventory.push($majorstrengthpotion)&gt;&gt;\
&lt;&lt;set $iteminventory.push($majoragilitypotion)&gt;&gt;\
\
&lt;&lt;if $minorhealthpotion.quantity gt 1&gt;&gt; &lt;&lt;set $majorhealthpotion.quantity = $minorhealthpotion.quantity&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $minormanapotion.quantity gt 1&gt;&gt; &lt;&lt;set $majormanapotion.quantity = $minormanapotion.quantity&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $minorstrengthpotion.quantity gt 1&gt;&gt; &lt;&lt;set $majorstrengthpotion.quantity = $minorstrengthpotion.quantity&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $minoragilitypotion.quantity gt 1&gt;&gt; &lt;&lt;set $majoragilitypotion.quantity = $minoragilitypotion.quantity&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 29&gt;&gt;
&lt;&lt;set $price = $oldgold - $gold&gt;&gt;\
&lt;&lt;set $merchantgold += $price&gt;&gt;\
\
You buy a $purchase for $price gold pieces!
&lt;&lt;ItemImage $purchase 250&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;

&lt;&lt;MerchantTalk &quot;Tell me, $name, what about the Dragonhorn caught your eye? It is a most impressive piece of art, no?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I don&#39;t care for art.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Oh? Then why buy such an artifact?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;m going dragonhunting.&quot;&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; almost gags on his tongue.
&lt;&lt;MerchantTalk &quot;You joke!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Certainly not.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;By sand and sun - you&#39;ve finally lost your mind! A &lt;i&gt;dragon&lt;/i&gt;!?&quot;&gt;&gt;\
The merchant&#39;s laughter follows you out of his shop.

Now you&#39;re ready to meet &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; at the ruins of the Tower of Zyr.

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $witchstatus = 13&gt;&gt;\

&lt;&lt;elseif $p eq 30&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; is polishing the counter of his shop as you approach.
&lt;&lt;MerchantTalk &quot;Tell me, friend - has something caught your eye? These newest finds were not easy to come by. While they might not be cheap, they&#39;ll be worth every ounce of gold.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;More like &lt;i&gt;pounds&lt;/i&gt; of gold.&quot;&gt;&gt;\
To that, the merchant just laughs, resting one hand on his portly gut.
&lt;&lt;HeroTalk &quot;I&#39;m not here to trade, Babar. I actually wanted to see how you&#39;re getting along. Our assault on the Winter Palace was...&quot;&gt;&gt;\

[[Seeing the change on Babar&#39;s face, you go silent-&gt;Merchant1][$p = 31]]

&lt;&lt;elseif $p eq 31&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;babar_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;babar&quot;&gt;&gt;\
For a moment, it seems like tears might take him. Then he draws a deep breath, and a contented smile softens his face.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;I am well, friend. Better than well, I am... &lt;i&gt;fulfilled&lt;/i&gt;. When I ventured to these woods, I did not truly expect to find my brother. Instead, I resolved myself to die trying. Absolution through death seemed a fair trade, after my misdeed.&quot;&gt;&gt;\
He points a finger under your nose.
&lt;&lt;MerchantTalk &quot;Then I ran into the most stubborn, glory-seeking, death-defying adventurer - no, &lt;i&gt;hero&lt;/i&gt; - to ever breathe. You gave me more than strength of arms, $name. You gave me hope. And now Zabil rests easy, at last.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;It was nothing.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;It was &lt;i&gt;everything&lt;/i&gt;.&quot;&gt;&gt;\

[[Babar reaches under his counter-&gt;Merchant1][$p = 32]]

&lt;&lt;elseif $p eq 32&gt;&gt;\
Your eyes widen as &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; pulls out two artifacts of incredible power - the Champion&#39;s Blade and the Sunsworn shield.
&lt;img src=&quot;Images/Weapons/Champion&#39;s Blade and Sunsworn Shield.jpg&quot; width=600 /&gt;
&lt;&lt;HeroTalk &quot;Where did you find such treasures?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Zabil once wielded them in service of our homeland. Once he died, I tried to sell them, but even the act of trying would send terrible waves of pain into my bones, and send my head into delirium. A curse from my brother, I assumed.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;And now that you have helped him, the curse is lifted?&quot;&gt;&gt;\
The merchant laughs.
&lt;&lt;MerchantTalk &quot;Not at all! I suspect these two artifacts have been imbued with magic that prevents them from being sold by anyone. But they can be given freely. $name: they are yours - they are my gift to you. Use them well.&quot;&gt;&gt;\
\
You rest your hand on the pommel of the blade.
&lt;&lt;HeroTalk &quot;Thank you, Babar.&quot;&gt;&gt;\

You gain the Champion&#39;s Blade and the Sunsworn Shield!

[[Return-&gt;Outside the Cabin]] 
\
&lt;&lt;set $merchantstatus = 21&gt;&gt;\
&lt;&lt;set $weaponinventory.push($championsblade)&gt;&gt;\
\
&lt;&lt;elseif $p eq 33&gt;&gt;\
As you pass by &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; shop, he waves you over.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;$name! Good day, friend. is it true that you are venturing into the Dark Heart each day, fighting off void mongrels?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You know that already, Babar. Get to your point.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Of course, of course. I was hoping that you might collect for me the void resin that these creatures leave behind, after you hack them to pieces.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;... you want &lt;i&gt;void resin&lt;/i&gt;?&quot;&gt;&gt;\

[[The merchant eagerly nods-&gt;Merchant1][$p = 34]]

&lt;&lt;elseif $p eq 34&gt;&gt;\
&lt;&lt;MerchantTalk &quot;I have devised a way to reverse the corruption of void resin. By sand and sun, I believe I can turn the stuff into a powerful restorative potion.&quot;&gt;&gt;\
That catches your attention. &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; potions have been an effective aid to your quest in the Deep Woods from the start.
&lt;&lt;HeroTalk &quot;How much resin do you need?&quot;&gt;&gt;\
&lt;img src=&quot;Images/DarkHeart/misc4.jpg&quot; width=450 /&gt;
&lt;&lt;MerchantTalk &quot;Three vials should be sufficient. Come find me when you have them all.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I will.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 
\
&lt;&lt;set $merchantstatus = 22&gt;&gt;\
&lt;&lt;set $voidresin = 0&gt;&gt;\
\
&lt;&lt;elseif $p eq 35&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Tell me, $name - have you gathered three vials of void resin?&quot;&gt;&gt;\

&lt;&lt;if $voidresin gte 3&gt;&gt;[[Yes-&gt;Merchant1][$p = 37]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Yes&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Not yet-&gt;Merchant1][$p = 36]]

&lt;&lt;elseif $p eq 36&gt;&gt;\
&lt;&lt;HeroTalk &quot;Not yet, Babar. I&#39;m working on it. I&#39;m also trying to save the world.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Multitasking is a skill required of any true hero... or so I hear.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;elseif $p eq 37&gt;&gt;\
You present &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; with the vials of void resin.
&lt;img src=&quot;Images/DarkHeart/misc4.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Will this do?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Hm... yes - this should be plenty. Give a moment, friend.&quot;&gt;&gt;\

[[The merchant enters his shop-&gt;Merchant1][$p = 38]]

&lt;&lt;elseif $p eq 38&gt;&gt;\
After a fair deal of cursing, kicking, the splash and sizzle of reagents being tossed into a cauldron, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; emerges from his shop, looking pleased with himself.
&lt;&lt;MerchantTalk &quot;I have made a most curious discovery, $name. Void resin is pure, undiluted destruction - so, with a bit of alchemical skill, I&#39;ve reversed it energy.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;That means nothing to me.&quot;&gt;&gt;\
He chuckles.
&lt;&lt;MerchantTalk &quot;I&#39;ve turned void energy into creative energy. I call it the &lt;i&gt;Potion of Grace&lt;/i&gt;. This may be the most effective - and best-selling - potion ever made.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Items/Potion of Grace.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;In a single swig, you will gain health, mana, even armor.&quot;&gt;&gt;\
He hands you a potion. 
&lt;&lt;HeroTalk &quot;I take it the first is free, but the rest are expensive?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Ah, $name... you know me too well.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $merchantstatus = 23&gt;&gt;\
&lt;&lt;set $iteminventory.push($gracepotion)&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 39&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;babar_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;babar&quot;&gt;&gt;\

You gesture for the merchant to leave his shop.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Babar Ogho.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;$name $title.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;It&#39;s time.&quot;&gt;&gt;\
He blinks, then realizes what you mean.
&lt;&lt;MerchantTalk &quot;It seems like only yesteday, you were rescuing me from goblins.&quot;&gt;&gt;\

&lt;&lt;if $merchantlove gte 30&gt;&gt;[[Kiss him-&gt;Merchant1][$p = 40]]&lt;&lt;else&gt;&gt;[[Shake his hand-&gt;Merchant1][$p = 40]]&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 40&gt;&gt;\
&lt;&lt;if $merchantlove gte 30&gt;&gt;Just as you try to kiss him, he comes in for a fierce, desperate hug. You&#39;re suddenly being suffocated by his considerable bulk.&lt;&lt;else&gt;&gt;Just as you try to shake his hand, he comes in for a hug. You&#39;re suddenly being suffocated by his considerable bulk.&lt;&lt;/if&gt;&gt;
&lt;&lt;MerchantTalk &quot;Don&#39;t die, $name! By sun and sand, I order you not to die!&quot;&gt;&gt;\
You embrace him for another moment, then step back.
&lt;&lt;if $merchantlove gte 30&gt;&gt;&lt;&lt;HeroTalk &quot;Suppose I succeed. What will happen to us?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;That is up to you, of course. But if I had it my way - a house on the sea. A quiet marriage. Lots and lots of children.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;So you would make me your wife?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;By the stars - yes! But first, you need to survive. Don&#39;t say farewell, sweet $name. Don&#39;t say a word. I&#39;ll see you tonight.&quot;&gt;&gt;\
You plant a chaste kiss on his cheek.
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Suppose I succeed. Where will you go, friend?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;A wandering merchant tends to wander. North, south... I&#39;ll flip a coin, maybe. And I could always use a seasoned bodyguard.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;ll think about it. Farewell, Babar.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;I&#39;ll see you tonight, $name.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 
\
&lt;&lt;set $merchantstatus = 24&gt;&gt;\
\
&lt;&lt;elseif $p eq 41&gt;&gt;\
&lt;&lt;set $price = $oldgold - $gold&gt;&gt;\
&lt;&lt;set $merchantgold += $price&gt;&gt;\
\
You buy the $purchase for $price gold pieces!
&lt;&lt;ItemImage $purchase 250&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;

&lt;&lt;MerchantTalk &quot;Tell me, $name, what magical powers do you believe this artifact has? Some say it provides eternal life. Others say that rubbing it before sleep ensures peaceful dreams.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;m not sure what it will do, I just had an odd feeling that buying it would help me.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Well, do let me know how your dreams go tonight-&quot;&gt;&gt;\
The artifact explodes.
&lt;img src=&quot;Images/FrozenHills/misc14.jpg&quot; width=600 /&gt;

You and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; stare at the empty space on the counter where the artifact sat, a moment before.
&lt;&lt;MerchantTalk &quot;Hmm... this seems like an opportune time to note that all sales are final.&quot;&gt;&gt;\
Just as you mean to argue, the words die in your throat. A strange, subtle change has settled into yourself. Your very essence feels &lt;i&gt;grander&lt;/i&gt; than before - brimming with potential.

You have a feeling this was, in fact, a valuable purchase.
&lt;&lt;HeroTalk &quot;Of course, Babar. Not a problem.&quot;&gt;&gt;\
You leave the merchant, taking some satisfaction in the dumbstruck look on his face.

&lt;i&gt;The maximum number of abilities you can know at the same time has increased by 1!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $abilitymax += 1&gt;&gt;\

&lt;&lt;elseif $p eq 42&gt;&gt;\
&lt;&lt;set $price = $oldgold - $gold&gt;&gt;\
&lt;&lt;set $merchantgold += $price&gt;&gt;\
\
You buy the $purchase for $price gold pieces!
&lt;&lt;ItemImage $purchase 250&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;

&lt;&lt;MerchantTalk &quot;Tell me, $name, which of the old stories is your favorite? Myself, I am partial to &lt;i&gt;&#39;Radahn and the Thousand Concubines&#39;&lt;/i&gt;.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;That one&#39;s good - although I&#39;ve heard there were, at most, one hundred concubines.&quot;&gt;&gt;\
The merchant laughs. 
&lt;&lt;MerchantTalk &quot;Fair enough. I wonder if we&#39;ll end up in a book like this, one day. &lt;i&gt;&#39;Glorious Babar and his servant $name against the evil Duke Carnax&#39;.&lt;/i&gt;&quot;&gt;&gt;\
You give &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; a long, unimpressed look.
&lt;&lt;HeroTalk &quot;Maybe, friend. Maybe.&quot;&gt;&gt;\

&lt;i&gt;You gained 1000 exp!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 
\
&lt;&lt;set $exp += 1000&gt;&gt;\
\
&lt;&lt;elseif $p eq 43&gt;&gt;\
\
&lt;&lt;set $price = $oldgold - $gold&gt;&gt;\
&lt;&lt;set $merchantgold += $price&gt;&gt;\
\
You buy the $purchase for $price gold pieces!
&lt;&lt;ItemImage $purchase 250&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;

&lt;&lt;MerchantTalk &quot;Tell me, $name, what brings a man like you to purchase such a pricey flower?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I thought it might remind Naya of her home. A welcoming gift, you can call it.&quot;&gt;&gt;\
The merchant laughs. 
&lt;&lt;MerchantTalk &quot;A welcoming gift! Hah! You scoundrel.&quot;&gt;&gt;\
You give &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; a long, unimpressed look.
&lt;&lt;HeroTalk &quot;What are you implying?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;She&#39;s a very pretty girl. Too young for me, otherwise she&#39;d already be mine. You know, there was an elf prostitute I met when I was young man. She actually taught me a lot about the art of love. Breasts the size of my head, and hips wide as you&#39;ve ever seen, she-&quot;&gt;&gt;\
&lt;img src=&quot;Images/Other/naya8.jpg&quot; width=450 /&gt;

Shaking your head, you leave the merchant to his fantasies.

[[Return-&gt;Outside the Cabin]] 
\
&lt;&lt;set $nayalove = 14&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 44&gt;&gt;















































&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="34" name="Ori1" tags="" position="807,1240" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;You are wandering through the Outskirts when the ground beneath your feet begins to shake. Crouching low, you draw your $weapon.

&lt;&lt;HeroTalk &quot;Something&#39;s coming - something big!&quot;&gt;&gt; \

[[You prepare for combat-&gt;Ori1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
The shaking of the ground becomes a rhythmic &lt;i&gt;stomp&lt;/i&gt;, &lt;i&gt;stomp&lt;/i&gt; as something massive draws near. The trees ahead shiver, then are pulled asunder by-

By... &lt;i&gt;something&lt;/i&gt;. Something large and strange and made of gold.
&lt;img src=&quot;Images/Character/ori1.jpg&quot; width=450 /&gt;

For a while, the &lt;i&gt;thing&lt;/i&gt; just stares at you. At least, you &lt;i&gt;think&lt;/i&gt; it&#39;s staring at you. What might be its eyes look like fist-sized golden spheres. 

&lt;&lt;HeroTalk &quot;Are you here for blood? If need be, I will fight to the bitter end.&quot;&gt;&gt;\

It blinks at you, lids of gold covering golden eyes.

[[Then it speaks-&gt;Ori1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;When it opens its mouth, a voice of cut gravel and crushed stone comes forth from deep in its gullet. Almost like a rockslide, forming words.

&lt;&lt;OriTalk &quot;Not blood. Hungry.&quot;&gt;&gt;\
It&#39;s... hungry?
&lt;&lt;HeroTalk &quot;Well, go find flesh elsewhere. Maybe eat a goblin, if you must.&quot;&gt;&gt;\
It furrows its golden brow.
&lt;&lt;OriTalk &quot;Goblins... no. Need gold. So hungry.&quot;&gt;&gt;\
You blink, realizing what it means.
&lt;&lt;HeroTalk &quot;You... &lt;i&gt;eat&lt;/i&gt; gold?&quot;&gt;&gt;\

[[It sagely nods its glimmering head-&gt;Ori1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;OriTalk &quot;Forgive me. Too hungry for good manners. Need gold. Will trade?&quot;&gt;&gt;\
The behemoth pulls a shread of material from behind its back. Upon closer inspection, it appears to be holding a rather fine pair of leather gloves.
&lt;img src=&quot;Images/Armor/Leather Gloves.jpg&quot; width=250 /&gt;

&lt;&lt;OriTalk &quot;Trade?&quot;&gt;&gt;\

&lt;&lt;if $gold gte 100&gt;&gt;[[Offer 100 gold for the gloves-&gt;Ori1][$p = 4, $i = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer 100 gold for the gloves&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $gold gte 50&gt;&gt;[[Offer 50 gold for the gloves-&gt;Ori1][$p = 4, $i = 2]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer 50 gold for the gloves&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $gold gte 25&gt;&gt;[[Offer 25 gold for the gloves-&gt;Ori1][$p = 4, $i = 3]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer 25 gold for the gloves&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Slay the beast!-&gt;Ori1][$p = 4, $i = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;You take out 100 gold pieces from your purse.
&lt;&lt;HeroTalk &quot;Will this do?&quot;&gt;&gt;\
Its carven lips crack into what must be its attempt at a smile.
&lt;&lt;OriTalk &quot;Generous. Very generous little human.&quot;&gt;&gt;\

Soon you&#39;ve poured the gold into its massive palm and collected the gloves as payment. You watch, somewhat bewildered, as the behemoth swallows the gold before belching out a gust of yellow flame.
&lt;&lt;OriTalk &quot;Delicious.&quot;&gt;&gt;\

[[Ask the thing if it has a name-&gt;Ori1][$p = 5]]
&lt;&lt;set $gold -= 100&gt;&gt;

&lt;&lt;elseif $i eq 2&gt;&gt;You take out 50 gold pieces from your purse.
&lt;&lt;HeroTalk &quot;Will this do?&quot;&gt;&gt;\
Its carven lips crack into what must be its attempt at a smile.
&lt;&lt;OriTalk &quot;Yes. This is quite a meal.&quot;&gt;&gt;\

Soon you&#39;ve poured the gold into its massive palm and collected the gloves as payment. You watch, somewhat bewildered, as the behemoth swallows the gold before belching out a gust of yellow flame.
&lt;&lt;OriTalk &quot;Appetizing.&quot;&gt;&gt;\

[[Ask the thing if it has a name-&gt;Ori1][$p = 5]]
&lt;&lt;set $gold -= 50&gt;&gt;

&lt;&lt;elseif $i eq 3&gt;&gt;You take out 25 gold pieces from your purse.
&lt;&lt;HeroTalk &quot;Will this do?&quot;&gt;&gt;\
It studies the gold, then slowly nods its head.
&lt;&lt;OriTalk &quot;I hoped for more. But I accept.&quot;&gt;&gt;\

Soon you&#39;ve poured the gold into its massive palm and collected the gloves as payment. You watch, somewhat bewildered, as the behemoth swallows the gold before belching out a gust of yellow flame.
&lt;&lt;OriTalk &quot;Quite the morsel.&quot;&gt;&gt;\

[[Ask the thing if it has a name-&gt;Ori1][$p = 5]]
&lt;&lt;set $gold -= 25&gt;&gt;

&lt;&lt;elseif $i eq 4&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle2_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
Enough prattling. You&#39;re here to cleanse the Deep Woods of hideous creatures such as this.

&lt;&lt;HeroTalk &quot;Vile thing - have at thee!&quot;&gt;&gt;\
As you raise your $weapon, the behemoth sighs.
&lt;&lt;OriTalk &quot;I will destroy you. If I must.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;OriStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $oristatus = 1&gt;&gt;\

&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;OriTalk &quot;Name? Hmmm... yes. Oriazus, I am called. The Resplendent. You do not know me? Hmm... I can see that you do not. This is fair. You are young and I... keep to myself. Unless hungry. What are you called?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Before I was sent here, I was called $name $title. Tell me, Oriazus, what are you doing in the Deep Woods?&quot;&gt;&gt;\
&lt;&lt;OriTalk &quot;Keeping away from humans. And dwarves. Dwarves love to... &lt;i&gt;mine&lt;/i&gt;. But the goblins give me no peace.&quot;&gt;&gt;\
You nod, unsurprised. Goblins are not know for giving any creature peace.
&lt;&lt;HeroTalk &quot;I seek to clear the goblins out. Them and whatever other evil wakes in the Deep Woods.&quot;&gt;&gt;\
The behemoth tilts it massive golden head.
&lt;&lt;OriTalk &quot;Careful, $name $title. You do not know what it is you seek.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Do you know something about the evil I speak of?&quot;&gt;&gt;\
&lt;&lt;OriTalk &quot;Know? I do not &lt;i&gt;know&lt;/i&gt;. But I &lt;i&gt;feel&lt;/i&gt;... something foul. Something that should not be. It is beyond you, human. You march toward your death.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I care not. It is my quest to deal with it.&quot;&gt;&gt;\
&lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Oriazus&lt;/b&gt;&lt;/span&gt; just shakes its head.
&lt;&lt;OriTalk &quot;Farewell, little one. Maybe we will meet again, before you die.&quot;&gt;&gt;\

&lt;i&gt;You gained 50 exp!&lt;/i&gt;

[[With that said, Oriazus stomps off into the woods. You decide it&#39;s about time you returned to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $oristatus = 2&gt;&gt;\
&lt;&lt;set $exp += 50&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $handsinventory.push($leathergloves)&gt;&gt;\

&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;\
\
You have slain &lt;b&gt;Ori the Resplendent&lt;/b&gt;!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="35" name="Abilities" tags="widget" position="200,782" size="100,100">PALADIN ABILITIES

&lt;&lt;widget &quot;HolyLight&quot;&gt;&gt;\
You glow with holy light, and feel your wounds close as you are healed by divine grace.
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $abilityvalue = $willpower&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue += $willpower*0.1*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

You gain $abilityvalue health!

&lt;&lt;set $currenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Smite&quot;&gt;&gt;\
You strike with holy wrath!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $attackroll = random(1,100)&gt;&gt;\
&lt;&lt;set $attackrolltotal = $attackroll + $strength + $agility&gt;&gt;\
You rolled $attackroll, which then added to your strength ($strength) and agility ($agility) for an attack roll total of $attackrolltotal
&lt;&lt;if $attackrolltotal gte $enemyevadescore&gt;&gt;Your attack roll total ($attackrolltotal) is greater than your enemy&#39;s evade score ($enemyevadescore) - you hit the $enemyname &lt;&lt;set $action = &quot;attack success&quot;&gt;&gt;
&lt;&lt;else&gt;&gt; Your attack roll total ($attackrolltotal) is less than your enemy&#39;s evade score ($enemyevadescore) - you miss the $enemyname &lt;&lt;set $action = &quot;attack failure&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $damageroll = random($mindamage,$maxdamage)&gt;&gt;\
&lt;&lt;set $damagerolltotal = $damageroll + ($strength/2) + ($willpower/2)&gt;&gt;
You rolled $damageroll, which then added to your half your strength ($strength) and half your willpower ($willpower) for a damage roll total of $damagerolltotal.
&lt;&lt;set $damagetoenemy = $damagerolltotal&gt;&gt;\
Your smite ignores all armor! You deal a total of $damagetoenemy damage to the $enemyname! &lt;br&gt;
&lt;&lt;set $enemycurrenthealth -= $damagetoenemy&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Empower&quot;&gt;&gt;\
Your $weapon glows with holy light, as it is imbued and strengthened by your own righteous fury.
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;if not $abilitycount.includes($ability)&gt;&gt;&lt;&lt;set $abilityvalue = $willpower/2&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue += $willpower*0.1*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

You gain $abilityvalue strength!&lt;&lt;else&gt;&gt;Your weapon is already empowered, so the spell has no effect!&lt;&lt;/if&gt;&gt;

&lt;&lt;if not $abilitycount.includes($ability)&gt;&gt;&lt;&lt;set $specialstrength += $abilityvalue&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;RighteousShield&quot;&gt;&gt;\
A shield of light forms over your armor, enhancing your defense with holy righteousness.
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;if not $abilitycount.includes($ability)&gt;&gt;&lt;&lt;set $abilityvalue = $willpower/2 &gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue += $willpower*0.1*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

You gain $abilityvalue armor!&lt;&lt;else&gt;&gt;Your defence is already enhanced with righteousness, so the spell has no effect.&lt;&lt;/if&gt;&gt;

&lt;&lt;if not $abilitycount.includes($ability)&gt;&gt;&lt;&lt;set $specialarmor += $abilityvalue&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Judgment&quot;&gt;&gt;\
You judge the $enemyname for the blow it struck against you. It is stunned by your righteous fury!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;if $enemyaction neq &quot;attack success&quot;&gt;&gt;The $enemyname did not successfully attack you last turn, so your judgement failed!&lt;&lt;else&gt;&gt;The $enemyname takes $willpower holy damage!
The $enemyname is stunned for two turns!

&lt;&lt;set $enemystun = 2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $willpower&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Daybreak&quot;&gt;&gt;\
Iulius&#39;s holy light reveals your enemy&#39;s weaknesses, and spurs you to action!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $abilityvalue = ($willpower/4)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $willpower/20&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\

The $enemyname&#39;s armor falls by $abilityvalue!
Your agility increases by $abilityvalue2!

&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility += $abilityvalue2&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Nullify&quot;&gt;&gt;\
You deny your enemy their unholy power!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $abilityvalue = 1 + ($willpower/25)&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue += $willpower*0.04*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

$enemyname&#39;s strength falls by $abilityvalue
$enemyname&#39;s agility falls by $abilityvalue
$enemyname&#39;s willpower falls by $abilityvalue
\
&lt;&lt;set $enemystrength -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyagility -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemywillpower -= $abilityvalue&gt;&gt;\
\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Prayer&quot;&gt;&gt;\
You fall to your knees and pray to Iulius for aid. His answer fills you with renewed power.
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $abilityvalue = 5 + ($willpower*0.75)&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue += $willpower*0.1*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $willpower*0.08&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\

You shed $abilityvalue2 armor in a demonstration of piety!
You gain $abilityvalue mana!

&lt;&lt;set $currentmana += $abilityvalue&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;set $prayercount += 1&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;DivineIntervention&quot;&gt;&gt;\
&lt;&lt;set $check = $maxhealth/4&gt;&gt;\
&lt;&lt;if $abilitycount.includes($ability)&gt;&gt;You have already received divine intervention. It cannot come again in the same battle.&lt;&lt;elseif $currenthealth gte $check&gt;&gt;Your call for divine intervention goes unanswered. Your health is not low enough.&lt;&lt;else&gt;&gt;\
In your moment of greatest need, Iulius intervenes. Your wounds close, and holy fire fills your heart. Your enemy falls back, blinded by the light that radiants from your eyes. The battle rages on!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $enemystun = 2&gt;&gt;\
&lt;&lt;set $abilityvalue = $willpower*3&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue += $willpower*0.2*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;if $abilitycount.includes($wrathofgod)&gt;&gt; &lt;&lt;set $check = 1&gt;&gt;&lt;&lt;else&gt;&gt; &lt;&lt;set $check = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilitycount = []&gt;&gt;\
&lt;&lt;if $check eq 1&gt;&gt;&lt;&lt;set $abilitycount.push($wrathofgod)&gt;&gt; &lt;&lt;/if&gt;&gt;\

You gain $abilityvalue health!
You gain $abilityvalue mana!
$enemyname is stunned for 2 turns!
You can use once-per-battle abilities again! &lt;&lt;if $check eq 1&gt;&gt;This does not include Wrath of God.&lt;&lt;/if&gt;&gt;

&lt;&lt;set $currentmana += $abilityvalue&gt;&gt;\
&lt;&lt;set $currenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;WrathOfGod&quot;&gt;&gt;\
&lt;&lt;if $abilitycount.includes($ability)&gt;&gt;You cannot use this ability more than once in each battle.&lt;&lt;elseif $prayercount lt 2&gt;&gt;You must use &#39;Prayer&#39; at least 3 times to call upon Iulius&#39;s wrath! &lt;&lt;else&gt;&gt;You utter Iulius&#39;s secret name and pray for deliverance. He arrives with sound and fury.
&lt;&lt;AbilityImagex $ability 300&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $abilityvalue = $willpower&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue += $willpower*0.1*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = 50 + ($abilityvalue*($prayercount*0.4))&gt;&gt;
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\

$enemyname suffers $abilityvalue2 damage!

&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;HolyAura&quot;&gt;&gt;\
You cast a holy aura across the battlefield, restoring your health and filling you with unyielding resolve.
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;if $aura eq 0&gt;&gt;\
&lt;&lt;set $aura = 1&gt;&gt;\
&lt;&lt;set $aurahealth = 1 + ($willpower/20)&gt;&gt;\
&lt;&lt;set $aurahealth = Math.round($aurahealth)&gt;&gt;\
\
You can no longer be stunned!
You will now gain $aurahealth health every turn!
\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;else&gt;&gt;Your holy aura is already active, so your ability failed!&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;\
&lt;&lt;widget &quot;Aura&quot;&gt;&gt;\
&lt;&lt;if $aura eq 1&gt;&gt; &lt;&lt;set $stun = 0&gt;&gt; &lt;&lt;set $currenthealth += $aurahealth&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;RadiantBolt&quot;&gt;&gt;\
You strike down your enemy with a bolt of holy light!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $abilityvalue = $maxhealth/2&gt;&gt;\
&lt;&lt;if $currenthealth lt $abilityvalue&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $willpower&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\

$enemyname takes $abilityvalue2 damage!
\
&lt;&lt;else&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $willpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue2&gt;&gt;\

$enemyname loses $abilityvalue2 armor!
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

SOLDIER ABILITIES

&lt;&lt;widget &quot;BurningStrike&quot;&gt;&gt;\
You strike with fire and fury!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $attackroll = random(1,100)&gt;&gt;\
&lt;&lt;set $attackrolltotal = $attackroll + $agility + $strength&gt;&gt;\
You rolled $attackroll, which then added to your agility ($agility) and strength ($strength) for an attack roll total of $attackrolltotal
&lt;&lt;if $attackrolltotal gte $enemyevadescore&gt;&gt;Your attack roll total ($attackrolltotal) is greater than your enemy&#39;s evade score ($enemyevadescore) - you hit the $enemyname &lt;&lt;set $action = &quot;attack success&quot;&gt;&gt;
&lt;&lt;else&gt;&gt; Your attack roll total ($attackrolltotal) is less than your enemy&#39;s evade score ($enemyevadescore) - you miss the $enemyname &lt;&lt;set $action = &quot;attack failure&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $damageroll = random($mindamage,$maxdamage)&gt;&gt;\
&lt;&lt;set $damagerolltotal = $damageroll + ($strength)&gt;&gt;
You rolled $damageroll, which then added to your strength ($strength) for a damage roll total of $damagerolltotal.
&lt;&lt;set $damagetoenemy = $damagerolltotal - $enemyarmor&gt;&gt;\
&lt;&lt;if $damagetoenemy lt 0&gt;&gt; &lt;&lt;set $damagetoenemy = 0&gt;&gt;&lt;&lt;/if&gt;&gt;\
The $enemyname&#39;s armor blocks $enemyarmor damage! You deal a total of $damagetoenemy damage to the $enemyname! 
&lt;&lt;set $enemycurrenthealth -= $damagetoenemy&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BloodRage&quot;&gt;&gt;\
You feel your blood spill down your palms. With it, your lust for battle increases!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $abilityvalue = $maxhealth / 20&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = 5 + ($basestrength/10)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\

You lose $abilityvalue Health!
You gain $abilityvalue2 Strength!
\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialstrength += $abilityvalue2&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Counterstrike&quot;&gt;&gt;\
You respond to the attack of the $enemyname with an equally devastating blow!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;if $enemyaction neq &quot;attack success&quot;&gt;&gt;The $enemyname did not successfully attack you last turn, so your counterstrike failed!&lt;&lt;else&gt;&gt; &lt;&lt;set $abilityvalue = $damagetoplayer + ($strength*0.25)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

You deal $abilityvalue damage to the $enemyname!&lt;&lt;/if&gt;&gt;

&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;&lt;&lt;set $enemycurrenthealth -= $abilityvalue&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;SunderArmor&quot;&gt;&gt;\
You crash your $weapon into the armor of the $enemyname, breaking it asunder!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $abilityvalue2 = 0&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue2 = $strength*0.1*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = ($strength/2)&gt;&gt;\
&lt;&lt;set $abilityvalue = $abilityvalue + $abilityvalue2&gt;&gt;\
&lt;&lt;set $abilityvalue3 = ($strength*0.75) + $abilityvalue2&gt;&gt;\
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

You deal $abilityvalue3 damage to the $enemyname!
You reduce the $enemyname&#39;s armor by $abilityvalue!

&lt;&lt;set $enemycurrenthealth -= $abilityvalue3&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;if $enemyarmor lt 0&gt;&gt; &lt;&lt;set $enemyarmor = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;SecondWind&quot;&gt;&gt;\
You fall into a state of battle clarity and find the strength to fight on!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $check = $maxhealth/2 &gt;&gt;\
&lt;&lt;set $abilityvalue = $strength*2 &gt;&gt;\
&lt;&lt;if ($currenthealth gt $check)&gt;&gt;Your health is too high - your ability failed!&lt;&lt;elseif $abilitycount.includes($ability)&gt;&gt;You already used your second wind - your ability failed!&lt;&lt;else&gt;&gt;

You gain $abilityvalue health!
You gain $abilityvalue mana!

&lt;&lt;set $currenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $currentmana += $abilityvalue&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $secondwinduse += 1&gt;&gt;\
&lt;&lt;if $secondwinduse gte $abilitylevel&gt;&gt;&lt;&lt;set $abilitycount.push($ability)&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Devastate&quot;&gt;&gt;\
Crying out with battle fury, you push yourself beyond your limits to deliver a desvastating blow!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $check = $maxhealth/2 &gt;&gt;\
&lt;&lt;set $abilityvalue = $strength*(2.5 + ($abilitylevel*0.5))&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $strength/4 &gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;if ($currenthealth gt $check)&gt;&gt;Your health is too high - your ability failed!&lt;&lt;else&gt;&gt; 

Your devastating blow deals $abilityvalue damage to your foe!

Your devastating blow leaves you winded - you lose $abilityvalue2 strength!
Your devastating blow leaves you winded - you lose $abilityvalue2 agility!
\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialstrength -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialagility -= $abilityvalue2&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BloodDrinker&quot;&gt;&gt;\
You strike your enemy and heal from the bloodshed!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $attackroll = random(1,100)&gt;&gt;\
&lt;&lt;set $attackrolltotal = $attackroll + $agility + $strength&gt;&gt;\
You rolled $attackroll, which then added to your agility ($agility) and strength ($strength) for an attack roll total of $attackrolltotal
&lt;&lt;if $attackrolltotal gte $enemyevadescore&gt;&gt;Your attack roll total ($attackrolltotal) is greater than your enemy&#39;s evade score ($enemyevadescore) - you hit the $enemyname &lt;&lt;set $action = &quot;attack success&quot;&gt;&gt;
&lt;&lt;else&gt;&gt; Your attack roll total ($attackrolltotal) is less than your enemy&#39;s evade score ($enemyevadescore) - you miss the $enemyname &lt;&lt;set $action = &quot;attack failure&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $damageroll = random($mindamage,$maxdamage)&gt;&gt;\
&lt;&lt;set $damagerolltotal = $damageroll + ($strength/2)&gt;&gt;
You rolled $damageroll, which then added to half your strength ($strength) for a damage roll total of $damagerolltotal.
&lt;&lt;set $damagetoenemy = $damagerolltotal - $enemyarmor&gt;&gt;\
&lt;&lt;if $damagetoenemy lt 0&gt;&gt; &lt;&lt;set $damagetoenemy = 0&gt;&gt;&lt;&lt;/if&gt;&gt;\
The $enemyname&#39;s armor blocks $enemyarmor damage! You deal a total of $damagetoenemy damage to the $enemyname! 
&lt;&lt;set $enemycurrenthealth -= $damagetoenemy&gt;&gt;\
&lt;&lt;set $abilityvalue = $damagetoenemy/2&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue += $abilityvalue*0.1*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
You absorb $abilityvalue damage as health!
&lt;&lt;set $currenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BoneBreaker&quot;&gt;&gt;\
You crush your enemy with a savage blow! They won&#39;t be getting up soon.
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $abilityvalue = $strength - $enemyarmor&gt;&gt;\
&lt;&lt;if $abilityvalue lt 10&gt;&gt; &lt;&lt;set $abilityvalue = 10&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $strength/10&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemystun += 1&gt;&gt;\

Your bonebreaking blow deals $abilityvalue damage to your enemy!
Your enemy lost $abilityvalue2 strength!
Your enemy is stunned for one turn!
\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemystrength -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BullRush&quot;&gt;&gt;\
You charge at the enemy like a rampant bull!
&lt;&lt;AbilityImagex $ability 300&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;if not $abilitycount.includes($ability)&gt;&gt;
&lt;&lt;set $abilityvalue = $strength/3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $strength/2&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue2 += $strength*0.1*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $maxdamage&gt;&gt;\
&lt;&lt;set $enemystun += 1&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt;\
&lt;&lt;set $currentmana += $abilityvalue2&gt;&gt;\
\
$enemyname loses $maxdamage health!
$enemyname loses $abilityvalue armor!
$enemyname is stunned!
You gain $abilityvalue2 mana!

&lt;&lt;else&gt;&gt;You can only use this ability once per battle, so it failed!&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BrashEndurance&quot;&gt;&gt;\
You withstand $enemyname&#39;s onslaught without breaking a sweat!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;if ($enemyaction eq &quot;attack success&quot;) or ($enemyaction eq &quot;attack failure&quot;) or ($enemyaction eq &quot;stun&quot;) or ($enemyaction eq &quot;none&quot;)&gt;&gt;The $enemyname did not use an ability last turn, so your ability failed!&lt;&lt;else&gt;&gt; \
\
&lt;&lt;set $abilityvalue = $strength/3&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue += $strength*0.1*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = 15 + $abilityvalue&gt;&gt;
&lt;&lt;set $abilityvalue3 = $strength/10&gt;&gt;\
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\
\
You gain $abilityvalue2 health!
You gain $abilityvalue3 armor!
\
&lt;&lt;set $currenthealth += $abilityvalue2&gt;&gt;
&lt;&lt;set $specialarmor += $abilityvalue3&gt;&gt;
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;HeroicStrike&quot;&gt;&gt;\
You strike like the heroes of old!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $damagetoenemy = 0&gt;&gt;\
&lt;&lt;set $attackroll = random(1,100)&gt;&gt;\
&lt;&lt;set $attackrolltotal = $attackroll + $agility + $strength&gt;&gt;\
You rolled $attackroll, which then added to your agility ($agility) and strength ($strength) for an attack roll total of $attackrolltotal
&lt;&lt;if $attackrolltotal gte $enemyevadescore&gt;&gt;Your attack roll total ($attackrolltotal) is greater than your enemy&#39;s evade score ($enemyevadescore) - you hit the $enemyname &lt;&lt;set $action = &quot;attack success&quot;&gt;&gt;
&lt;&lt;else&gt;&gt; Your attack roll total ($attackrolltotal) is less than your enemy&#39;s evade score ($enemyevadescore) - you miss the $enemyname &lt;&lt;set $action = &quot;attack failure&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $damageroll = random($mindamage,$maxdamage)&gt;&gt;\
&lt;&lt;set $damagerolltotal = $damageroll + ($strength/2)&gt;&gt;
You rolled $damageroll, which then added to half your strength ($strength) for a damage roll total of $damagerolltotal.
&lt;&lt;set $damagetoenemy = $damagerolltotal - $enemyarmor&gt;&gt;\
&lt;&lt;if $damagetoenemy lt 0&gt;&gt; &lt;&lt;set $damagetoenemy = 0&gt;&gt;&lt;&lt;/if&gt;&gt;\
The $enemyname&#39;s armor blocks $enemyarmor damage! You deal a total of $damagetoenemy damage to the $enemyname! 
&lt;&lt;set $enemycurrenthealth -= $damagetoenemy&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $damagetoenemy gt 0&gt;&gt;Your successful heroic strike fills you with might and glory!
&lt;&lt;set $abilityvalue = 1 + ($abilitylevel*1.5)&gt;&gt;\
You gain $abilityvalue strength!
You gain $abilityvalue agility!
You gain $abilityvalue willpower!
\
&lt;&lt;set $specialstrength += $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility += $abilityvalue&gt;&gt;\
&lt;&lt;set $specialwillpower += $abilityvalue&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\




&lt;&lt;widget &quot;Momentum&quot;&gt;&gt;\
You strike with a gradually increasing tempo! Keep up the assault!
&lt;&lt;AbilityImagex $ability 300&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;

&lt;&lt;if $battlecount eq 1&gt;&gt; &lt;&lt;set $momentumcount = 1&gt;&gt;\
&lt;&lt;elseif $momentumcheck eq $battlecount&gt;&gt; &lt;&lt;set $momentumcount += 1&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;set $momentumcount = 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $abilityvalue = $strength/5&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $strength/9&gt;&gt;\
&lt;&lt;set $abilityvalue3 = $abilityvalue + ($abilityvalue2*$momentumcount)&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt;&lt;&lt;set $abilityvalue3 = $abilityvalue3*(1+($abilitylevel*0.1))&gt;&gt;
&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\
&lt;&lt;set $abilityvalue4 = $abilityvalue3 - $enemyarmor&gt;&gt;\
&lt;&lt;if $abilityvalue4 lt 0&gt;&gt; &lt;&lt;set $abilityvalue4 = 0&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue4&gt;&gt;\
\
&lt;&lt;if $abilitylevel gt 1&gt;&gt;&lt;&lt;set $abilityvalue5 = ($strength/20)*$abilitylevel*0.5&gt;&gt;\
&lt;&lt;set $abilityvalue5 = Math.round($abilityvalue5)&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue5&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $momentumcheck = $battlecount + 1&gt;&gt;\

&lt;&lt;if $momentumcount gt 1&gt;&gt;You have used this ability $momentumcount turns in a row!&lt;&lt;/if&gt;&gt; Your momentum deals $abilityvalue3 damage - $enemyname&#39;s armor blocks $enemyarmor damage - you deal $abilityvalue4 damage!
&lt;&lt;if $abilitylevel gt 1&gt;&gt;$enemyname loses $abilityvalue5 armor!&lt;&lt;/if&gt;&gt;
\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

ROGUE ABILITIES

&lt;&lt;widget &quot;ShadowStrike&quot;&gt;&gt;\
You strike from the shadows!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $attackroll = random(1,100)&gt;&gt;\
&lt;&lt;set $attackrolltotal = $attackroll + $agility + $agility&gt;&gt;\
You rolled $attackroll, which then added to double your agility ($agility) for an attack roll total of $attackrolltotal
&lt;&lt;if $attackrolltotal gte $enemyevadescore&gt;&gt;Your attack roll total ($attackrolltotal) is greater than your enemy&#39;s evade score ($enemyevadescore) - you hit the $enemyname &lt;&lt;set $action = &quot;attack success&quot;&gt;&gt;
&lt;&lt;else&gt;&gt; Your attack roll total ($attackrolltotal) is less than your enemy&#39;s evade score ($enemyevadescore) - you miss the $enemyname &lt;&lt;set $action = &quot;attack failure&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $damageroll = random($mindamage,$maxdamage)&gt;&gt;\
&lt;&lt;set $damagerolltotal = $damageroll + ($agility/2)&gt;&gt;
You rolled $damageroll, which then added to your half your agility ($agility) for a damage roll total of $damagerolltotal.
&lt;&lt;set $damagetoenemy = $damagerolltotal - $enemyarmor&gt;&gt;\
&lt;&lt;if $damagetoenemy lt 0&gt;&gt; &lt;&lt;set $damagetoenemy = 0&gt;&gt;&lt;&lt;/if&gt;&gt;\
The $enemyname&#39;s armor blocks $enemyarmor damage! You deal a total of $damagetoenemy damage to the $enemyname! 
&lt;&lt;set $enemycurrenthealth -= $damagetoenemy&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;&lt;&lt;set $combatpoints += 1&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;SureStrike&quot;&gt;&gt;\
You throw your lucky dagger - it never misses!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $abilityvalue = $agility * 2&gt;&gt;\
&lt;&lt;set $abilityvalue -= $enemyarmor&gt;&gt;\
&lt;&lt;if $abilityvalue lt 0&gt;&gt;&lt;&lt;set $abilityvalue = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $check = random(1, 10)&gt;&gt; \
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;if $abilitylevel gte $check&gt;&gt; &lt;&lt;set $combatpoints += 1&gt;&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\

The $enemyname&#39;s armor blocks $enemyarmor damage!
You deal $abilityvalue damage to the $enemyname!
&lt;&lt;if ($abilitylevel gt 1) and ($abilitylevel gte $check)&gt;&gt;Combat point recovered! &lt;b&gt;Sathael&lt;/b&gt; smiles upon you! &lt;&lt;/if&gt;&gt;

&lt;&lt;set $enemycurrenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $combatpoints -= 1&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Riposte&quot;&gt;&gt;\
You block the $enemyname&#39;s blow and respond with one of your own!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;if $enemyaction neq &quot;attack failure&quot;&gt;&gt;The $enemyname did not miss an attack against you last turn, so your riposte failed!&lt;&lt;else&gt;&gt; &lt;&lt;set $abilityvalue = $maxdamage + $agility&gt;&gt;\
&lt;&lt;if $abilitylevel gte 2&gt;&gt;&lt;&lt;set $abilityvalue2 = (0.05*$abilitylevel)*$agility&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue -= $enemyarmor&gt;&gt;\
&lt;&lt;if $abilityvalue lt 0&gt;&gt;&lt;&lt;set $abilityvalue = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\

You deal $abilityvalue damage to the $enemyname!
&lt;&lt;if $abilitylevel gte 2&gt;&gt;Your agility increased by $abilityvalue2!&lt;&lt;set $specialagility += $abilityvalue2&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $feet eq &quot;Dancer&#39;s Boots&quot;&gt;&gt;You gain 10 evade score! 
&lt;&lt;set $specialevadescore += 10&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $enemyaction eq &quot;attack failure&quot;&gt;&gt;&lt;&lt;set $enemycurrenthealth -= $abilityvalue&gt;&gt;&lt;&lt;set $combatpoints += 1&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;CloakOfShadows&quot;&gt;&gt;\
You fade into a cloak of twisting shadows.
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $abilityvalue = ($agility/3)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;if $abilitylevel gte 2&gt;&gt; &lt;&lt;set $abilityvalue2 = $willpower*0.25*$abilitylevel&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $abilitylevel gte 2&gt;&gt;Your armor has increased by $abilityvalue2! &lt;&lt;set $specialarmor += $abilityvalue2&gt;&gt;&lt;&lt;/if&gt;&gt;\
Your evasion has increased by $abilityvalue!

&lt;&lt;set $specialevadescore += $abilityvalue&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Assassinate&quot;&gt;&gt;\
You leap behind the $enemyname to deliver a lethal blow!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $check = $enemymaxhealth/2&gt;&gt;
\
&lt;&lt;if $enemycurrenthealth gt $check&gt;&gt;The $enemyname has too much health remaining for that to work - your attack failed!&lt;&lt;else&gt;&gt; &lt;&lt;set $abilityvalue = $agility*$combatpoints&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;set $abilityvalue += 0.1*$agility*$combatpoints*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

You deal $abilityvalue damage to the $enemyname!&lt;&lt;/if&gt;&gt;

&lt;&lt;if $enemycurrenthealth lte $check&gt;&gt;&lt;&lt;set $enemycurrenthealth -= $abilityvalue&gt;&gt;&lt;&lt;set $combatpoints = 0&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Outflank&quot;&gt;&gt;\
You use your foe&#39;s armor against it, ducking out of sight before striking an exposed flank!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
&lt;&lt;set $abilityvalue = 10 + $strength/2&gt;&gt;\
\
&lt;&lt;if $strength gte $enemyarmor&gt;&gt;You are not nimble enough to pull off this attack - your strength needs to be less than your enemy&#39;s armor!&lt;&lt;else&gt;&gt;\
&lt;&lt;if $abilitylevel gte 2&gt;&gt; &lt;&lt;set $abilityvalue += 4*$abilitylevel&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

You deal $agility damage to the $enemyname!
The $enemyname&#39;s armor drops by $abilityvalue!&lt;&lt;/if&gt;&gt;

&lt;&lt;if $strength lt $enemyarmor&gt;&gt;&lt;&lt;set $enemycurrenthealth -= $agility&gt;&gt;
&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt; &lt;&lt;set $combatpoints -= 1&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Shadowstep&quot;&gt;&gt;\
You slip into the shadows, preparing for a deadly attack.
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;if $combatpoints gte 1&gt;&gt;You already have at least 1 Combat Point, so the ability failed!
&lt;&lt;else&gt;&gt;\
&lt;&lt;set $check = random(1, 10)&gt;&gt; \
&lt;&lt;if $abilitylevel gt 1&gt;&gt; &lt;&lt;if $abilitylevel gte $check&gt;&gt; &lt;&lt;set $combatpoints += 1&gt;&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
You gain 2 combat points!
&lt;&lt;if ($abilitylevel gt 1) and ($abilitylevel gte $check)&gt;&gt;Extra combat point gained! &lt;b&gt;Sathael&lt;/b&gt; smiles upon you! &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $combatpoints += 2&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;ConsumeShadows&quot;&gt;&gt;\
You dodge the $enemyname&#39;s blow and devour the shadows left behind!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;if $enemyaction neq &quot;attack failure&quot;&gt;&gt;The $enemyname did not miss an attack against you last turn, so your attempt failed!&lt;&lt;else&gt;&gt; \
&lt;&lt;set $abilityvalue = 55 + ($willpower)&gt;&gt;\
&lt;&lt;set $abilityvalueadd = (0.2*$abilitylevel) - 0.2&gt;&gt;\
&lt;&lt;set $abilityvalue = $abilityvalue*(1+$abilityvalueadd)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

You gain $abilityvalue mana from consuming your foe&#39;s shadows!&lt;&lt;/if&gt;&gt;

&lt;&lt;if $enemyaction eq &quot;attack failure&quot;&gt;&gt;&lt;&lt;set $currentmana += $abilityvalue&gt;&gt;&lt;&lt;set $combatpoints -= 1&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Incapacitate&quot;&gt;&gt;\
You leap upon your enemy in a wave of twisting shadows, temporarily paralyzing their body.
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $enemystun = 3&gt;&gt;\

Your enemy is stunned for 3 turns!

&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $combatpoints -= 2&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;BladeStorm&quot;&gt;&gt;\
You strike with a whirl of blades!
&lt;&lt;AbilityImagex $ability 300&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $c = 0&gt;&gt;\
&lt;&lt;set $b = 0&gt;&gt;\
&lt;&lt;set $a = 2 + $abilitylevel&gt;&gt;\
&lt;&lt;for _i to 0; _i lt $a; _i++&gt;&gt;
\
&lt;&lt;set $attackroll = random(1,100)&gt;&gt;\
&lt;&lt;set $attackrolltotal = $attackroll + $agility + $agility&gt;&gt;\
You rolled $attackroll, which then added to double your agility ($agility) for an attack roll total of $attackrolltotal
&lt;&lt;if $attackrolltotal gte $enemyevadescore&gt;&gt;Your attack roll total ($attackrolltotal) is greater than your enemy&#39;s evade score ($enemyevadescore) - you hit the $enemyname &lt;&lt;set $action = &quot;attack success&quot;&gt;&gt; &lt;&lt;set $c += 1&gt;&gt;
&lt;&lt;else&gt;&gt; Your attack roll total ($attackrolltotal) is less than your enemy&#39;s evade score ($enemyevadescore) - you miss the $enemyname &lt;&lt;set $action = &quot;attack failure&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $damageroll = random($mindamage,$maxdamage)&gt;&gt;\
&lt;&lt;set $damagerolltotal = $damageroll + ($agility/2)&gt;&gt;
You rolled $damageroll, which then added to your half your agility ($agility) for a damage roll total of $damagerolltotal.
&lt;&lt;set $check = $damagerolltotal - $enemyarmor&gt;&gt;\
&lt;&lt;if $check lt 0&gt;&gt; &lt;&lt;set $check = 0&gt;&gt; You deal no damage!&lt;&lt;else&gt;&gt;You deal $check damage!&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $b += $check&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/for&gt;&gt;\

Across all of your attacks, you deal $b damage to $enemyname!
&lt;&lt;if $c eq $a&gt;&gt;You landed every hit! You gain 1 Combat Point!&lt;&lt;/if&gt;&gt;\

&lt;&lt;set $enemycurrenthealth -= $b&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;set $combatpoints -= 3&gt;&gt;\
&lt;&lt;if $c eq $a&gt;&gt;&lt;&lt;set $combatpoints += 1&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;DeadlyFocus&quot;&gt;&gt;\
You fall into a meditative state and plan out your next deadly attack!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $abilityvalue = 10 + $agility/2&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt;&lt;&lt;set $abilityvalue = $abilityvalue*(1+(0.15*$abilitylevel)) &gt;&gt;\ &lt;&lt;/if&gt;&gt;
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

You gain 2 Combat Points!
You gain $abilityvalue health!

&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $combatpoints += 1&gt;&gt;\
&lt;&lt;set $currenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Deadlyfocus&quot;&gt;&gt;\
You fall into a meditative state and plan out your next deadly attack!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $abilityvalue = 10 + $agility/2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\

You gain 2 Combat Points!
You gain $abilityvalue health!

&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $combatpoints += 1&gt;&gt;\
&lt;&lt;set $currenthealth += $abilityvalue&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;SapWill&quot;&gt;&gt;\
You coat your weapon with mindnumbing poison and strike your enemy!
&lt;&lt;AbilityImagex $ability 250&gt;&gt;&lt;&lt;/AbilityImagex&gt;&gt;
\
&lt;&lt;set $abilityvalue = 5 + ($agility/20)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;if $abilitylevel gt 1&gt;&gt;&lt;&lt;set $abilityvalue2 = ($agility/20)*(1 + ($abilitylevel*0.1))&gt;&gt;\ 
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;&lt;&lt;/if&gt;&gt;\

$enemyname loses $abilityvalue willpower!
&lt;&lt;if $abilitylevel gt 1&gt;&gt;$enemyname loses $abilityvalue2 armor!
&lt;&lt;set $enemyarmor -= $abilityvalue2&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $currentmana -= $abilitymana&gt;&gt;\
&lt;&lt;set $enemywillpower -= $abilityvalue&gt;&gt;\
&lt;&lt;set $abilitycount.push($ability)&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\





</tw-passagedata><tw-passagedata pid="36" name="WolfAttack" tags="" position="801,522" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
You are wandering through the Outskirts when you hear a piercing howl. As you draw your $weapon, a fearsome wolf steps forth from the undergrowth, its fanged bared.
&lt;img src=&quot;Images/Outskirts/direwolf1.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;Another poisoned beast. I will put you out of your misery.&quot;&gt;&gt; \
&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;DireWolfStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="37" name="OutskirtsTreasure" tags="" position="809,1355" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;if $outskirtstreasure eq 0&gt;&gt;You are wandering through the Outskirts when you come upon a small path, leading into a hillside. Following it, you come across what appears to be an old, abandoned treasure chest.
&lt;img src=&quot;Images/Outskirts/treasure1.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;Likely hidden away by an adventurer. Looks at least a century old.&quot;&gt;&gt; \

It is a well-known rule that any treasure found is for the taking. This poor adventurer is likely long dead. And the treasure could be useful to your quest.

[[Attempt to open the treasure chest-&gt;OutskirtsTreasure][$p = 1]]
[[Leave it alone-&gt;Outside the Cabin]]
\
&lt;&lt;set $outskirtstreasure = 1&gt;&gt;\
&lt;&lt;set $treasurehealth = 40&gt;&gt;\
\
&lt;&lt;else&gt;&gt;You return to the hidden treasure chest, tucked away in the Outskirts hills.
&lt;img src=&quot;Images/Outskirts/treasure1.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;I wonder what lies inside...&quot;&gt;&gt; \

[[Attempt to open the treasure chest-&gt;OutskirtsTreasure][$p = 1]]
[[Leave it alone-&gt;Outside the Cabin]]

&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 1&gt;&gt;You stick your fingers beneath the treasure chest&#39;s lid and pull with all your might.
&lt;&lt;set $treasurehealth -= $strength&gt;&gt;\

&lt;&lt;if $treasurehealth lte 0&gt;&gt;With a final heave, the treasure chest&#39;s lid snaps open! 

[[Peer inside-&gt;OutskirtsTreasure][$p = 2]]

&lt;&lt;else&gt;&gt;After a fair deal of struggling, you slump to the ground, exhausted. You&#39;ve definitely weakened the chest&#39;s bindings, but whatever is inside still elludes you. You should come back once you recover your strength.
&lt;img src=&quot;Images/Outskirts/treasure1.jpg&quot; width=500 /&gt;

[[Leave for now-&gt;Outside the Cabin]]
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;You peer inside the treasure, and discover and horde of gold pieces!
&lt;img src=&quot;Images/Outskirts/treasure2.jpg&quot; width=500 /&gt;
&lt;&lt;set $treasurevalue = 300&gt;&gt;\

You gain $treasurevalue gold!

[[Take the gold and leave this place-&gt;Outside the Cabin]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += 300&gt;&gt;\
&lt;&lt;set $outskirtstreasure = 2&gt;&gt;\
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="38" name="GoblinCapture" tags="" position="809,1465" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;outskirts_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
As you wander through the Outskirts, you spot a narrow, wooded gorge with a creek running through it.
&lt;img src=&quot;Images/Outskirts/outskirts8.jpg&quot; width=550 /&gt;

&lt;&lt;if $outskirtsquest eq 6&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
And walking through it without a care in the world is a goblin.

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinArcherStats&gt;&gt; \
&lt;&lt;set $flee = 1&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
\
\
&lt;&lt;elseif $outskirtsquest eq 7&gt;&gt;This is a perfect place to set up the net and capture a goblin. You immediately get to work, fashioning your rope into a kind of tripwire, with your net hidden under the shallow water of the creek.

[[Then it&#39;s just a matter of patience-&gt;GoblinCapture][$p = 1]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 1&gt;&gt;Time passes. The sun makes it slow journey across the sky. All the while, you lie hidden above the gorge, waiting.
&lt;img src=&quot;Images/Outskirts/outskirts8.jpg&quot; width=550 /&gt;

At last, a goblin archer ventures into the gorge. It seems paranoid, always glancing behind its back to ensure it isn&#39;t followed. Luckily, it doesn&#39;t think to look below the water at its feet. The trap springs!

&lt;b&gt;Agility Check&lt;/b&gt;
&lt;&lt;AgilityCheck 40&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;With a splash and fiendish cry, the goblin is hoisted into the net!

[[Question the goblin-&gt;GoblinCapture][$p = 2]]

&lt;&lt;elseif $action eq &quot;failure&quot;&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
The goblin evades the trap - worse, it spots you the very next moment!

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinArcherStats&gt;&gt; \
&lt;&lt;set $flee = 1&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
\
\
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 2&gt;&gt;You approach the trapped goblin. It ceases its struggling when it spots you, and instead stares at you with a sullen sort of fury.

&lt;&lt;HeroTalk &quot;What are you doing in the Outskirts?&quot;&gt;&gt; \
It spits in answer.

[[Kick it-&gt;GoblinCapture][$p = 3, $i = 1]]
[[Appeal to its sense of kindness-&gt;GoblinCapture][$p = 3, $i = 2]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;if $i eq 2&gt;&gt;After remembering that goblins have no sense of kindness, you&lt;&lt;else&gt;&gt;You&lt;&lt;/if&gt;&gt; kick the goblin.
&lt;&lt;GoblinArcherTalk &quot;Ouch! That hurts, human!&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;What are you doing in the Outskirts?&quot;&gt;&gt; \
&lt;&lt;GoblinArcherTalk &quot;What are YOU doing in the Outskirts?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Kicking goblins, apparently.&quot;&gt;&gt; \

[[Kick it again-&gt;GoblinCapture][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;You kick it on the rump, earning a howl of anguish but not much else. 

A different strategy is needed.
&lt;&lt;HeroTalk &quot;What are you running from?&quot;&gt;&gt; \
That, at least, earns a new reaction. The goblin&#39;s eyes widen. Its lower lip begins to shake.

Fear. Terror, even.

&lt;&lt;GoblinArcherTalk &quot;Something bad.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Be more specific.&quot;&gt;&gt; \
&lt;&lt;GoblinArcherTalk &quot;I don&#39;t know, human! Dark as dark gets. Or darker. A shadow-thing, of many blades and deadly magic. We ran! Gresh told us to run! He knows the shadow-thing. He fears it! We all do!&quot;&gt;&gt; \

That sounds like what you&#39;re looking for. The evil waking in the Deep Woods.
&lt;&lt;HeroTalk &quot;Gresh? Is he your leader? Your king?&quot;&gt;&gt; \
The goblin nods.
&lt;&lt;HeroTalk &quot;Where is he? I need to speak to him.&quot;&gt;&gt; \

[[The goblin sputters, uncertain-&gt;GoblinCapture][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;GoblinArcherTalk &quot;He keeps hidden. Moves, nest to nest! I don&#39;t know where he is! I swears it! I swears it, human!&quot;&gt;&gt; \
You draw your $weapon.
&lt;&lt;HeroTalk &quot;Liar!&quot;&gt;&gt; \
&lt;&lt;GoblinArcherTalk &quot;I swears it! I swears it!!!&quot;&gt;&gt; \

Maybe the goblin is telling the truth. You&#39;ve likely learned all that you can from it, anyway.

[[It is no longer useful. Kill it-&gt;GoblinCapture][$p = 6, $i = 1]]
[[It is not honorable to slay a foe that cannot fight back. Leave it-&gt;GoblinCapture][$p = 6, $i = 2]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;You strike hard and fast. Before the goblin can realize what&#39;s happening, its head is severed from its shoulders. Your net is also ruined, but you no longer need it, anyway.

&lt;&lt;HeroTalk &quot;I need to find this goblin king, Gresh, as soon as possible. He will take me to this shadow-thing that haunts the Deep Woods.&quot;&gt;&gt; \

&lt;i&gt;Your act of viciousness was noticed by the Gods! you gain 1 strength!&lt;/i&gt; &lt;&lt;set $basestrength += 1&gt;&gt;

&lt;i&gt;You gain 100 exp!&lt;/i&gt; &lt;&lt;set $exp += 100&gt;&gt;
\
\
\
&lt;&lt;elseif $i eq 2&gt;&gt;You decide to spare the goblin&#39;s life. You head off, leaving the goblin in your net. Its kin should find it soon enough and set it free.

&lt;&lt;HeroTalk &quot;I need to find this goblin king, Gresh, as soon as possible. He will take me to this shadow-thing that haunts the Deep Woods.&quot;&gt;&gt; \

&lt;i&gt;Your act of mercy was noticed by the Gods! you gain 1 willpower!&lt;/i&gt; &lt;&lt;set $basewillpower += 1&gt;&gt;

&lt;i&gt;You gain 100 exp!&lt;/i&gt; &lt;&lt;set $exp += 100&gt;&gt;
&lt;&lt;/if&gt;&gt;\

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $outskirtsquest = 8&gt;&gt;\
\
&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

&lt;&lt;if $outskirtsquest eq 6&gt;&gt;&lt;&lt;HeroTalk &quot;This gorge is a good place to capture a goblin for questioning. I just need some kind of net to snare one with. I wonder if Babar sells a net in his shop...&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;That could have gone better. No matter, I will return here and try again another day.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;
\
[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
\
\
\
\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="39" name="TrollAttack" tags="" position="808,1585" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle2_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You step outside of your cabin, armed and ready for anything. Still, you&#39;re at least a touch surprised when you see what&#39;s waiting for you at the door.
&lt;img src=&quot;Images/Outskirts/troll1.jpg&quot; width=450 /&gt;

It&#39;s a troll. A very large troll.

&lt;&lt;TrollTalk &quot;You da human dat been catching dem gobbos? Puttin&#39; dem in nets?&quot;&gt;&gt;

Trolls are very, very powerful. But also rather dimwitted. You might be able to fool him.

[[No, that must be some other human-&gt;TrollAttack][$p = 1, $i = 1]]
[[I think that human passed by here yesterday. Went north. Far north.-&gt;TrollAttack][$p = 1, $i = 2]]
[[I don&#39;t even know what a goblin is-&gt;TrollAttack][$p = 1, $i = 3]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;No, that must be... some other human. Sorry.&quot;&gt;&gt;\
&lt;&lt;elseif $i eq 2&gt;&gt;&lt;&lt;HeroTalk &quot;Oh, &lt;i&gt;that&lt;/i&gt; human? He was here yesterday. Left, though. Said he was going north.&quot;&gt;&gt;\
&lt;&lt;elseif $i eq 3&gt;&gt;&lt;&lt;HeroTalk &quot;Goblin? What&#39;s a &lt;i&gt;goblin&lt;/i&gt;?&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
Unfortunately, the troll doesn&#39;t seem to like your answer.

&lt;&lt;TrollTalk &quot;Hmm... dat can&#39;t be right. Dis here other human says he sold you a net for gobbo catchin.&quot;&gt;&gt;\
You glance behind the troll. to where &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; is cowering. The merchant gives you a guilty look.

&lt;&lt;MerchantTalk &quot;My sincere apologies, $name! I may have said too much...&quot;&gt;&gt;\
You grimace. So much for that plan.

&lt;&lt;TrollTalk &quot;Gresh wants you dead, human. Real dead.&quot;&gt;&gt;\

[[Gresh? The goblin king?-&gt;TrollAttack][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;&lt;HeroTalk &quot;You know the goblin king Gresh?&quot;&gt;&gt;\
&lt;&lt;TrollTalk &quot;&#39;Course I do! I&#39;m his bodyguard, ain&#39;t I?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Take me to him.&quot;&gt;&gt;\
The troll laughs, a great booming chuckle.
&lt;&lt;TrollTalk &quot;Sure, human. I&#39;ll take ya to him. Right after you&#39;s dead.&quot;&gt;&gt;
Looks like a fight is inevitable. Just as the troll raises its club, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; tosses you a potion, its blue liquid sloshing in the glass as you catch it.
&lt;&lt;MerchantTalk &quot;A mana potion, $name! No payment needed!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;\
\
&lt;&lt;TrollStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $iteminventory.push($minormanapotion)&gt;&gt;\
\
&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;outskirts_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
The battle is won. The troll is at your mercy.
&lt;&lt;TrollTalk &quot;Dat &#39;urts! I don&#39;t like fightin&#39; with you anymore.&quot;&gt;&gt;\
The troll pulls itself to its feet and starts lumbering away from the cabin. As you catch your breath, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; approaches you.
&lt;&lt;MerchantTalk &quot;Well fought, friend. But why let the troll go?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Because trolls are stupid. He&#39;s going to take me right to the goblin nest.&quot;&gt;&gt;\

&lt;i&gt;You gained 150 exp!&lt;/i&gt;

[[Follow the troll-&gt;TrollAttack][$p = 21]]

&lt;&lt;set $exp += 150&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;

&lt;&lt;elseif $p eq 21&gt;&gt;Despite your wounds from your battle with the troll, you&#39;re easily able to keep up with it. It moves at a slow pace, and leave heavy footsteps and twisted foilage in its wake. As the sun drifts to the horizon, it at last arrives at what must be the Goblin King&#39;s nest.
&lt;img src=&quot;Images/Outskirts/cave1.jpg&quot; width=650 /&gt;

You mark the location on your map.

&lt;&lt;HeroTalk &quot;So this is where Gresh is hiding. Once I clear out this nest, my work in the Outskirts will be complete.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $outskirtsquest = 10&gt;&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="40" name="GoblinNest1" tags="" position="923,181" size="100,100">\
&lt;&lt;if $music neq &quot;goblincave&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;goblincave_bgm&quot; volume 0.5 play loop&gt;&gt; &lt;&lt;set $music = &quot;goblincave&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $outskirtsquest eq 10&gt;&gt;You are standing at the entrance to the goblin nest. There do not appear to be any guards to protect the cave.
&lt;img src=&quot;Images/Outskirts/cave1.jpg&quot; width=700 /&gt;

Just as you approach the cave, you suddenly feel like you are being watched. Casting a wary glance behind you, nothing seems amiss.

&lt;&lt;HeroTalk &quot;That&#39;s odd...&quot;&gt;&gt; \

[[Enter the cave-&gt;GoblinNest1][$p = 1]]
\
&lt;&lt;set $outskirtsquest = 11&gt;&gt;\
&lt;&lt;set $bonekey = 0&gt;&gt;
&lt;&lt;set $glasskey = 0&gt;&gt;
&lt;&lt;else&gt;&gt;You are standing at the entrance to the goblin nest. 
&lt;img src=&quot;Images/Outskirts/cave1.jpg&quot; width=700 /&gt;

[[Enter the cave-&gt;GoblinNest1][$p = 2]]
[[Return to the cabin-&gt;Outside the Cabin][$p = 0]]
\
\
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 1&gt;&gt;After you enter the cave, a lithe figure silently steps out from the woodland.

&lt;&lt;NayaTalk &quot;This must be the place...&quot;&gt;&gt; \

The elf girl slips back into the trees.

[[Continue-&gt;GoblinNest1][$p = 2]]
\
&lt;&lt;elseif $p eq 2&gt;&gt;You are standing just within the goblin nest. Behind you, light streams into the cave from the Outskirts beyond.
&lt;img src=&quot;Images/Outskirts/cave2.jpg&quot; width=700 /&gt;

&lt;&lt;if $outskirtsquest eq 11&gt;&gt;A goblin guard stands a few feet away from you, eating what looks to be roasted boar leg. He must be the entry guard.

[[Approach the goblin-&gt;GN1Battle1][$p = 0]]
[[Leave the Goblin Nest-&gt;GoblinNest1][$p = 0]]

&lt;&lt;else&gt;&gt;\
[[Enter the main chamber-&gt;GoblinNest1][$p = 3]]
[[Leave the goblin nest-&gt;GoblinNest1][$p = 0]]
\
&lt;&lt;/if&gt;&gt;
\
&lt;&lt;elseif $p eq 3&gt;&gt;You are standing within what looks to be the main chamber of the goblin nest. From here, passages twist deeper into the earth. The northern passage leads back to the surface.
&lt;img src=&quot;Images/Outskirts/cave3.jpg&quot; width=700 /&gt;

&lt;&lt;if $outskirtsquest eq 12&gt;&gt;Three goblins sit in the middle of the chamber, chittering at each other. They haven&#39;t noticed you yet.

[[Approach the goblins-&gt;GN1Battle2][$p = 0]]
[[Return to the entrance chamber-&gt;GoblinNest1][$p = 2]]

&lt;&lt;else&gt;&gt;\
&lt;&lt;if $witchstatus eq 23&gt;&gt;[[Leave the goblin nest-&gt;SnakeBattle1][$p = 2]] &lt;&lt;else&gt;&gt;[[Leave the goblin nest-&gt;GoblinNest1][$p = 0]]&lt;&lt;/if&gt;&gt;
[[Enter the west chamber-&gt;GoblinNest1][$p = 4]]
[[Enter the east chamber-&gt;GoblinNest1][$p = 5]]
[[Enter the south chamber-&gt;GoblinNest1][$p = 6]]
\
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 4&gt;&gt;You are in the western chamber. This is a narrow, dark, and curving passage. It seems like it was made by a burrowing snake. &lt;&lt;if $bonekey eq 0&gt;&gt;At the end of the chamber sits the troll, bandaging is wounds from your last battle.&lt;&lt;/if&gt;&gt;
&lt;img src=&quot;Images/Outskirts/cave6.jpg&quot; width=600 /&gt;

&lt;&lt;if $bonekey eq 0&gt;&gt;[[Confront the troll-&gt;GN1Battle3][$p = 0]]&lt;&lt;elseif $witchstatus eq 22&gt;&gt;[[Retrieve the troll skull-&gt;SnakeBattle1][$p = 0]]&lt;&lt;/if&gt;&gt;
[[Return to the main chamber-&gt;GoblinNest1][$p = 3]]

&lt;&lt;elseif $p eq 5&gt;&gt;You are in the eastern chamber. This chamber is vast and glimmers with old salt deposits, hanging from a ceiling lost to gloom. &lt;&lt;if $glasskey eq 0&gt;&gt;At the end of the chamber is a strange looking goblin, stirring a cauldron that bubbles and hisses with power.&lt;&lt;/if&gt;&gt;
&lt;img src=&quot;Images/Outskirts/cave7.jpg&quot; width=600 /&gt;

&lt;&lt;if $glasskey eq 0&gt;&gt;[[Confront the goblin-&gt;GN1Battle4][$p = 0]]&lt;&lt;/if&gt;&gt;
[[Return to the main chamber-&gt;GoblinNest1][$p = 3]]

&lt;&lt;elseif $p eq 6&gt;&gt; This small chamber of the cave contains nothing but a massive brass door. &lt;&lt;if $outskirtsquest lt 15&gt;&gt;The door is locked shut. It seems like it requires two keys to open - for it has two key holes: one made of bone, one made of glass.&lt;&lt;else&gt;&gt;The door is open. The Goblin King&#39;s chamber awaits beyond.&lt;&lt;/if&gt;&gt;
&lt;&lt;if $outskirtsquest lt 15&gt;&gt;&lt;img src=&quot;Images/Outskirts/cave4.jpg&quot; width=500 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Outskirts/cave5.jpg&quot; width=600 /&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if $bonekey eq 0&gt;&gt;The bone key hole awaits its key.&lt;&lt;elseif $bonekey eq 1&gt;&gt;[[Insert the bone key-&gt;GoblinNest1][$p = 7]]&lt;&lt;/if&gt;&gt;
&lt;&lt;if $glasskey eq 0&gt;&gt;The glass key hole awaits its key.&lt;&lt;elseif $glasskey eq 1&gt;&gt;[[Insert the glass key-&gt;GoblinNest1][$p = 8]]&lt;&lt;/if&gt;&gt;

&lt;&lt;if $outskirtsquest gte 15&gt;&gt;[[Enter the king&#39;s chamber-&gt;GoblinNest1][$p = 9]]&lt;&lt;/if&gt;&gt;
[[Return to the main chamber-&gt;GoblinNest1][$p = 3]]

&lt;&lt;elseif $p eq 7&gt;&gt;You insert the bone key into its matching key hole. It fits perfectly. &lt;&lt;set $outskirtsquest += 1&gt;&gt; &lt;&lt;set $bonekey = 2&gt;&gt;

&lt;&lt;if $outskirtsquest eq 14&gt;&gt;&lt;img src=&quot;Images/Outskirts/bonekey1.jpg&quot; width=300 /&gt; &lt;&lt;else&gt;&gt;The massive brass door opens! Gresh can hide no longer!
&lt;img src=&quot;Images/Outskirts/cave5.jpg&quot; width=600 /&gt;&lt;&lt;/if&gt;&gt;

[[Return-&gt;GoblinNest1][$p = 6]]

&lt;&lt;elseif $p eq 8&gt;&gt;You insert the glass key into its matching key hole. It fits perfectly. &lt;&lt;set $outskirtsquest += 1&gt;&gt; &lt;&lt;set $glasskey = 2&gt;&gt;

&lt;&lt;if $outskirtsquest eq 14&gt;&gt;&lt;img src=&quot;Images/Outskirts/glasskey1.jpg&quot; width=400 /&gt; &lt;&lt;else&gt;&gt;The massive brass door opens! Gresh can hide no longer!
&lt;img src=&quot;Images/Outskirts/cave5.jpg&quot; width=600 /&gt;&lt;&lt;/if&gt;&gt;

[[Return-&gt;GoblinNest1][$p = 6]]

&lt;&lt;elseif $p eq 9&gt;&gt; You stand in Gresh&#39;s chamber. It is a wide, cavernous room, lighted by many candles, as well as a single pillar of &lt;&lt;if $time eq &quot;Night&quot;&gt;&gt;moonlight&lt;&lt;else&gt;&gt;sunlight&lt;&lt;/if&gt;&gt; descending from above. It appears far finer than the rest of the cave - as if this was built by something else than goblins, long, long ago.
&lt;img src=&quot;Images/Outskirts/cave8.jpg&quot; width=650 /&gt;

&lt;&lt;if $outskirtsquest eq 15&gt;&gt;The Goblin King sits upon his throne. He is too absorbed by a gem in his palm to notice you.

[[Confront the Goblin King-&gt;GN1Battle5][$p = 0]]&lt;&lt;/if&gt;&gt;
[[Return to the main chamber-&gt;GoblinNest1][$p = 3]]

&lt;&lt;elseif $p eq 10&gt;&gt;






























&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="41" name="WolfBattle" tags="" position="808,1698" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;You are wandering through the Outskirts when you spot two wolves, resting over what looks to be a dead adventurer. That corpse might have valuable loot, but it would require dispatching both wolves.
&lt;img src=&quot;Images/Outskirts/outskirts9.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;A difficult battle... but the reward could be great.&quot;&gt;&gt; \

[[Back away from the wolves. Slowly-&gt;WolfBattle][$p = 1]]
[[Approach the wolves while drawing your weapon-&gt;WolfBattle][$p = 2]]

&lt;&lt;elseif $p eq 1&gt;&gt;You back away from the wolves. While the corpse may have treasure, it is not worth risking your life over.

&lt;&lt;HeroTalk &quot;Another day, maybe.&quot;&gt;&gt; \

[[Return to the cabin-&gt;Outside the Cabin]] 
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;set $wolfbattle = 1&gt;&gt;

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You approach the wolves while drawing your weapon.

&lt;&lt;WolfTalk &quot;Grrrrr...&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Come, then - to the victor go the spoils.&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;DireWolfStats&gt;&gt; \
&lt;&lt;set $flee = 1&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 1&gt;&gt; \
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;if $battletotal eq 1&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
You slay the first wolf! The second leaps forward, fangs bared!
&lt;img src=&quot;Images/Outskirts/direwolf1.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;Face me, beast!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;DireWolfStats&gt;&gt; \
&lt;&lt;set $flee = 1&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 2&gt;&gt; \
\
\
&lt;&lt;elseif $battletotal eq 2&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
The second wolf lies dead at your feet. Victory!
&lt;&lt;HeroDisplay&gt;&gt;

After catching your breath, you search the corpse for loot. You find a sack of 100 gold pieces, a health potion, and a set of iron leg guards. Valuable treasure!

&lt;i&gt;You gain 125 exp!&lt;/i&gt;

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += 125&gt;&gt;\
&lt;&lt;set $gold += 100&gt;&gt;\
&lt;&lt;set $iteminventory[0].quantity += 1&gt;&gt;\
&lt;&lt;set $legsinventory.push($ironpants)&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $wolfbattle = 2&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="42" name="GN1Battle1" tags="" position="923,306" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You approach the goblin. He looks a bit tougher than the goblins that you&#39;ve fought so far.
&lt;img src=&quot;Images/Outskirts/goblin5.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;I&#39;m here for Gresh.&quot;&gt;&gt; \
He sets down his dinner. 
&lt;&lt;GoblinBruiserTalk &quot;You the one who beat the troll?&quot;&gt;&gt; \
After a moment&#39;s pause, you nod. Seeing this, the goblin sighs, then raises his sword and shield.
&lt;&lt;GoblinBruiserTalk &quot;Well, Gresh don&#39;t want to see you.&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinBruiserStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Continue-&gt;GoblinNest1][$p = 2]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $outskirtsquest = 12&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="43" name="GN1Battle2" tags="" position="925,416" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;Before attacking the goblins, you listen in on their conversation. 

&lt;&lt;GoblinTalk &quot;Oy, you ever wonder why we&#39;re here?&quot;&gt;&gt; \
&lt;&lt;GoblinArcherTalk &quot;Sure, all the time.&quot;&gt;&gt; \
&lt;&lt;GoblinBruiserTalk &quot;One of the great mysteries of life, innit?&quot;&gt;&gt; \

[[Continue to listen to the goblins-&gt;GN1Battle2][$p = 1]]
[[Attack the goblins-&gt;GN1Battle2][$p = 5]]
&lt;&lt;if ($lewdmode eq 1) and ($gender eq &quot;female&quot;)&gt;&gt;[[Seduce the goblins-&gt;GN1Battle2][$p = 21]]&lt;&lt;elseif $lewdmode eq 1&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Seduce the goblins&lt;/span&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 1&gt;&gt;You continue to spy on the goblins, curious.

&lt;&lt;GoblinArcherTalk &quot;Is we just simple goblins, motes of life in an uncaring void?.&quot;&gt;&gt; \
&lt;&lt;GoblinBruiserTalk &quot;Right, or is there some grand cosmic plan?&quot;&gt;&gt; \
&lt;&lt;GoblinArcherTalk &quot;And if there&#39;s a plan - who&#39;s the planner?&quot;&gt;&gt; \
&lt;&lt;GoblinBruiserTalk &quot;Gods, maybe. But, who made the Gods?&quot;&gt;&gt; \

Fascinating as goblin philosophy is, you need to find Gresh, the Goblin King.

[[Continue to listen to the goblins-&gt;GN1Battle2][$p = 2]]
[[Attack the goblins-&gt;GN1Battle2][$p = 5]]
&lt;&lt;if ($lewdmode eq 1) and ($gender eq &quot;female&quot;)&gt;&gt;[[Seduce the goblins-&gt;GN1Battle2][$p = 21]]&lt;&lt;elseif $lewdmode eq 1&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Seduce the goblins&lt;/span&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 2&gt;&gt;Despite your better judgment, you keep listening to the goblins.

&lt;&lt;GoblinArcherTalk &quot;Who made the gods? It&#39;s enough to make a goblin&#39;s head spin.&quot;&gt;&gt; \
&lt;&lt;GoblinBruiserTalk &quot;Keeps me up at night.&quot;&gt;&gt; \
The first goblin stares at his two fellows like they&#39;ve lost their minds.
&lt;&lt;GoblinTalk &quot;What? I meant why are we &lt;i&gt;here&lt;/i&gt;, in the Outskirts of the Deep Woods?&quot;&gt;&gt; \
&lt;&lt;GoblinArcherTalk &quot;Oh... um. &#39;Cause Gresh said so.&quot;&gt;&gt; \
&lt;&lt;GoblinBruiserTalk &quot;Yep. Gresh is the boss.&quot;&gt;&gt; \
There&#39;s a long, awkward pause.
&lt;&lt;GoblinTalk &quot;What was that about a grand cosmic plan?&quot;&gt;&gt; \
&lt;&lt;GoblinArcherTalk &quot;Nothin&#39;.&quot;&gt;&gt; \
&lt;&lt;GoblinTalk &quot;You want to talk about it?&quot;&gt;&gt; \
&lt;&lt;GoblinBruiserTalk &quot;Nope.&quot;&gt;&gt; \

[[Continue to listen to the goblins-&gt;GN1Battle2][$p = 3]]
[[Attack the goblins-&gt;GN1Battle2][$p = 5]]
&lt;&lt;if ($lewdmode eq 1) and ($gender eq &quot;female&quot;)&gt;&gt;[[Seduce the goblins-&gt;GN1Battle2][$p = 21]]&lt;&lt;elseif $lewdmode eq 1&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Seduce the goblins&lt;/span&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 3&gt;&gt;Even though their conversation is over, you keep watching the goblins. The little green creatures are rather fascinating - in addition to being cruel and hideous.

&lt;&lt;GoblinTalk &quot;Oy - who&#39;s that lurking in the shadows?&quot;&gt;&gt; \
The goblin points at you.
&lt;&lt;GoblinBruiserTalk &quot;Looks like a human! Are you a human!?&quot;&gt;&gt; \

[[Approach the goblins-&gt;GN1Battle2][$p = 5]]
&lt;&lt;if ($lewdmode eq 1) and ($gender eq &quot;female&quot;)&gt;&gt;[[Seduce the goblins-&gt;GN1Battle2][$p = 21]]&lt;&lt;elseif $lewdmode eq 1&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Seduce the goblins&lt;/span&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You walk towards the goblins, your $weapon at the ready.

&lt;&lt;HeroTalk &quot;I&#39;m here for Gresh. I need to know what has his goblins hiding in the Outskirts.&quot;&gt;&gt; \
The goblins go slightly pale.
&lt;&lt;GoblinArcherTalk &quot;We don&#39;t know what has Gresh runnin&#39;, but &lt;i&gt;nothing&lt;/i&gt; scares Gresh. So if this scares Gresh...&quot;&gt;&gt; \
&lt;&lt;GoblinBruiserTalk &quot;... Then it&#39;s worth hiding from. You should be hidin&#39; too, human!&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Take me to him.&quot;&gt;&gt; \
The goblins raise their crude weapons.
&lt;&lt;GoblinTalk &quot;Graaah! The human does not listen! Kill it!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
&lt;&lt;set $battletotal = 1&gt;&gt; 

\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;if $battletotal eq 1&gt;&gt;You slay the first goblin.
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;HeroTalk &quot;Bring me to Gresh - now!&quot;&gt;&gt; \
&lt;&lt;GoblinArcherTalk &quot;You don&#39;t know what you&#39;re askin&#39; for human! Graah! Die!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinArcherStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
&lt;&lt;set $battletotal = 2&gt;&gt; 

&lt;&lt;elseif $battletotal eq 2&gt;&gt;The second goblin drops dead before your feet. You point your bloodied $weapon at the last one - the biggest and meanest of the three.
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;HeroTalk &quot;Is protecting your chief worth your life, creature?&quot;&gt;&gt; \
&lt;&lt;GoblinBruiserTalk &quot;You think that&#39;s all we&#39;re protecting, human? Graaah - you never should have come here!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinBruiserStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
&lt;&lt;set $battletotal = 3&gt;&gt; 

&lt;&lt;elseif $battletotal eq 3&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = 80&gt;&gt; \
&lt;&lt;set $enemygold = 95&gt;&gt; \

You find $enemygold gold pieces on the corpses of the goblins!

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Continue-&gt;GoblinNest1][$p = 3]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $outskirtsquest = 13&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 21&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You know you ought to deal with these goblins with steel and fury, but a part of you wonders if you might negotiate your way through this without bloodshed. These goblins are still males, after all. They can probably be swayed without too much trouble.
&lt;&lt;HeroTalk &quot;Can one of you lead me to Gresh?&quot;&gt;&gt; \
&lt;&lt;GoblinArcherTalk &quot;Human! You shouldn&#39;t be here!&quot;&gt;&gt; \
Instead of drawing your $weapon, you undo your armor and pull down your shirt.
&lt;&lt;if $chestlewd eq 5&gt;&gt;&lt;img src=&quot;Images/Other/chest5.jpg&quot; width=300 /&gt;
&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Other/chest6.jpg&quot; width=300 /&gt;&lt;&lt;/if&gt;&gt;
 
The three goblins stare at your exposed breasts, puzzled. One of them begins to drool.
&lt;&lt;GoblinBruiserTalk &quot;... If we lead you to Gresh, what is on offer, human?&quot;&gt;&gt; \
You slip off your $legs and spread your legs.
&lt;&lt;HeroTalk &quot;What isn&#39;t?&quot;&gt;&gt; \
&lt;video loop muted autoplay src=&quot;Images/Other/strip1.mp4&quot;&gt;&lt;/video&gt;

[[The goblins approach-&gt;GN1Battle2][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
\
It&#39;s hard to be sure what happens next. First they&#39;re all a bit tentative, touching your soft, pale flesh, clearly paranoid of some trap. Then one of them slips a green, pudgy finger into your twat. You didn&#39;t realize how wet you were until it easily slides inside.
&lt;&lt;HeroTalk &quot;Oh... fuck...&quot;&gt;&gt; \
Then they get bolder. Suddenly rough hands are gripping your breasts. Fingers are shoved down your throat. You suddenly find yourself in a very dangerous situation - you&#39;re being gangraped by goblins!
&lt;img src=&quot;Images/Other/goblin5.jpg&quot; width=450 /&gt;

But you don&#39;t scream. You don&#39;t fight back. All those hands and cocks feel &lt;i&gt;too good&lt;/i&gt; to protest. All you can do is moan as your pussy gets stretched by a thick green cock, you gag on goblin dick.

[[Cum-&gt;GN1Battle2][$p = 23]]

&lt;&lt;elseif $p eq 23&gt;&gt;\
The goblins cum shortly after you do, covering your body with semen and filling your womb with your seed. You can only hope you don&#39;t get pregnant with goblin-spawn! Afterwards, they dress and skitter away. 
&lt;&lt;GoblinBruiserTalk &quot;Gresh is in the south chamber. Two keys you will need, human-slut!&quot;&gt;&gt; \
Then you&#39;re alone. You slowly get up on shaking legs and dress. As you do, you notice a new piece of armor, lying beside your own. A gift from the goblins, maybe.
&lt;img src=&quot;Images/Armor/Naughty Corset.jpg&quot; width=450 /&gt;

&lt;i&gt;You gained the Naughty Corset!&lt;/i&gt;
&lt;i&gt;You gained 100 exp!&lt;/i&gt;

[[Continue-&gt;GoblinNest1][$p = 3]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $outskirtsquest = 13&gt;&gt;\
&lt;&lt;set $chestinventory.push($naughtycorset)&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="44" name="GoblinBruiserAttack" tags="" position="807,1809" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You are wandering through the Outskirts when you come across a Goblin, clearly looking for you. He looks armed and ready for battle.
&lt;img src=&quot;Images/Outskirts/goblin5.jpg&quot; width=400 /&gt;

&lt;&lt;if $outskirtsquest gte 16&gt;&gt;&lt;&lt;GoblinBruiserTalk &quot;Grahhh! I will avenge my king!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Then you leave me no choice.&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;GoblinBruiserTalk &quot;Grahhh! You should never have come here, human!&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinBruiserStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="45" name="GN1Battle3" tags="" position="923,530" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;You approach the troll. It tilts its head at you, confused.
&lt;img src=&quot;Images/Outskirts/troll1.jpg&quot; width=450 /&gt;

&lt;&lt;TrollTalk &quot;You follow me home, you silly git?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Where is Gresh?&quot;&gt;&gt; \
&lt;&lt;TrollTalk &quot;Why&#39;d ya care &#39;bout Gresh so much anyway? He&#39;s mindin&#39; &#39;is own business in the Outskirts, ain&#39;t he?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;He knows about the evil in the Deep woods. He will lead me to the object of my quest.&quot;&gt;&gt; \
The troll laughs.
&lt;&lt;TrollTalk &quot;From where I&#39;m standin&#39;, &lt;i&gt;you&lt;/i&gt; da evil of da Deep Woods.&quot;&gt;&gt; \

[[Draw your weapon-&gt;GN1Battle3][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle2_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Where. Is. Gresh?&quot;&gt;&gt; \
The troll pulls a key from his pocket. It seems to be made of bone.
&lt;&lt;TrollTalk &quot;South chamber of da cave, he is. All locked up, like he asked. Ya need two keys, and I&#39;ve just got one.&quot;&gt;&gt; \
That&#39;s strange. You can&#39;t understand why a Goblin King would want to be locked up like that.
&lt;&lt;HeroTalk &quot;He&#39;s made himself a prisoner in his own nest? Why?&quot;&gt;&gt; \
&lt;&lt;TrollTalk &quot;Protection, I think. He &#39;splained it to me once but I forgot.&quot;&gt;&gt; \
The troll tosses the key behind him.
&lt;&lt;TrollTalk &quot;So, dis how it ends, is it?&quot;&gt;&gt; \
You step forwards, your $weapon bared.
&lt;&lt;HeroTalk &quot;Or you could leave.&quot;&gt;&gt; \
&lt;&lt;TrollTalk &quot;You fink I&#39;d abondon Gresh? Hah! Let&#39;s go, human! Dis time, to da death!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;TrollStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer1_bgm&quot; volume 0.5 play loop&gt;&gt;\
The troll slumps down, defeated. It wont be long before death takes it.

&lt;&lt;HeroTalk &quot;Nothing can protect Gresh from me. Not even you.&quot;&gt;&gt; \
The troll spits blood.
&lt;&lt;TrollTalk &quot;You fink I&#39;m protectin&#39; Gresh? Stupid human. Gresh... &lt;i&gt;he&#39;s&lt;/i&gt; protectin&#39; &lt;i&gt;us&lt;/i&gt; from... it.&quot;&gt;&gt; \
Something in the troll&#39;s words unnerves you.
&lt;&lt;HeroTalk &quot;&lt;i&gt;It&lt;/i&gt;? What do you mean?&quot;&gt;&gt; \
But the troll is already dead.
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!
You find $enemygold on the $enemyname&#39;s corpse!
You find a mighty troll club! You can find it to your weapon vault!
You find the bone key!
&lt;img src=&quot;Images/Outskirts/bonekey1.jpg&quot; width=250 /&gt;

[[Continue-&gt;GoblinNest1][$p = 4]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $weaponinventory.push($trollclub)&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $bonekey = 1&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="46" name="GN1Battle4" tags="" position="923,648" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;You approach the goblin.
&lt;img src=&quot;Images/Outskirts/goblin7.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;That poison you&#39;re brewing... you&#39;re infecting the wildlife in the Outskirts.&quot;&gt;&gt; \
&lt;&lt;GoblinAlchemistTalk &quot;Ah, a fan of my work, human?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Why? What good would driving the wildlife into senseless rage do for Gresh?&quot;&gt;&gt; \
The goblin alchemist adds a pinch of black dust into its cauldron. The poison shifts from green to at toxic-looking orange.
&lt;&lt;GoblinAlchemistTalk &quot;Protection. Turn the animals into guards. Need to keep Gresh safe.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;From who?&quot;&gt;&gt; \

[[The alchemist shakes his head-&gt;GN1Battle4][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle2_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
&lt;&lt;GoblinAlchemistTalk &quot;You don&#39;t know about the Redeemer?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Should I?&quot;&gt;&gt; \
&lt;&lt;GoblinAlchemistTalk &quot;Gresh&#39;s former master. They had a... falling out. Now Gresh must be kept safe. Kept locked away.&quot;&gt;&gt; \
The goblin alchemist pulls a glass key from its pouch, then sets it down on the ground.
&lt;&lt;HeroTalk &quot;I don&#39;t understand.&quot;&gt;&gt; \
&lt;&lt;GoblinAlchemistTalk &quot;Graah! Humans know nothing. I will protect Gresh from the Redeemer, and from &lt;i&gt;you&lt;/i&gt;!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GoblinAlchemistStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer1_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
The goblin alchemist falls to the ground, bleeding out.

&lt;&lt;HeroTalk &quot;You will poison the Outskirts no longer.&quot;&gt;&gt; \
&lt;&lt;GoblinAlchemistTalk &quot;What is a little poison compared to the Redeemer? Gresh... I failed you...&quot;&gt;&gt; \
The alchemist shuts its eyes. Slowly, its breathing stops. It is dead.
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!
You find $enemygold on the $enemyname&#39;s corpse!
You find a health potion and a mana potion!
You find a pair of Blessed Gloves!
You find the glass key!
&lt;img src=&quot;Images/Outskirts/glasskey1.jpg&quot; width=300 /&gt;

[[Continue-&gt;GoblinNest1][$p = 5]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $minorhealthpotion.quantity += 1&gt;&gt;\
&lt;&lt;set $minormanapotion.quantity += 1&gt;&gt;\
&lt;&lt;set $handsinventory.push($blessedgloves)&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $glasskey = 1&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="47" name="GN1Battle5" tags="" position="929,772" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer1_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
You walk down an ancient path of smoothed stone. The room, its careful design... it&#39;s far too well-crafted for goblins. 
&lt;img src=&quot;Images/Outskirts/cave8.jpg&quot; width=600 /&gt;

At the end of the pathway, sitting upon a throne of granite, is a shrewd looking goblin wearing a crown of iron. 

&lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh, the Goblin King&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Outskirts/gresh1.jpg&quot; width=450 /&gt;

&lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&lt;/b&gt;&lt;/span&gt; holds in his palm a curious black gem. Instead of glowing with energy, it instead seems to &lt;i&gt;absorb&lt;/i&gt; and &lt;i&gt;diminish&lt;/i&gt; the light around it. Deep inside sparks of energy flicker with eldritch wrath. It sets your nerves on edge, but &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&lt;/b&gt;&lt;/span&gt; seems quite enthralled by it.

&lt;&lt;GreshTalk &quot;I knew this day would come. I knew, at best, I could only delay it.&quot;&gt;&gt; \
He stares at you with deep-set, intelligent eyes.
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;GreshTalk &quot;But answer me this: why would a man like you serve the Redeemer?&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;GreshTalk &quot;But answer me this: why would a woman like you serve the Redeemer?&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \
You come to a halt, ten paces from the Goblin King.
&lt;&lt;HeroTalk &quot;I do not serve the Redeemer.&quot;&gt;&gt; \
&lt;&lt;GreshTalk &quot;Really? Yet you have saved him so much trouble - finding my nest, killing my guards.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;I only wish to cull the evil waking in the Deep Woods.&quot;&gt;&gt; \
&lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&lt;/b&gt;&lt;/span&gt; shakes his head.
&lt;&lt;GreshTalk &quot;Your quest is folly, human. This evil cannot be stopped.&quot;&gt;&gt; \

[[He stands from his granite throne-&gt;GN1Battle5][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;GreshTalk &quot;Let me explain. A stranger approached my throne, some two years ago. He called himself the Redeemer, and offered me riches and power beyond my wildest dreams - in exchange for secrecy, for service. Blinded by greed, I served him in the Deep Woods.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Who is he?&quot;&gt;&gt; \
&lt;&lt;GreshTalk &quot;After all this time, I still don&#39;t know. He kept his face hidden, and disguised his voice. At best, I can say he is a being of great wealth and terrible power.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;But what could a being so powerful possibly need from goblins?&quot;&gt;&gt; \
&lt;&lt;GreshTalk &quot;Digging, mostly. Elves once lived in the Deep Woods, or so he said. This very room was built by them, a thousand years before the first human kingdoms sprouted from the dirt. The Redeemer was looking for something in the elven ruins.&quot;&gt;&gt; \
&lt;img src=&quot;Images/Outskirts/misc1.jpg&quot; width=450 /&gt;

The Goblin King has been surprisingly forthcoming, so far..
&lt;&lt;HeroTalk &quot;Did he find it?&quot;&gt;&gt; \

[[Gresh winces at the question-&gt;GN1Battle5][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;GreshTalk &quot;Deep into the heart of the Deep Woods, the Redeemer took us. Horrible creatures, we came upon. Old things. Things best left undisturbed. The closer we came to the ruins he sought, the more it felt like the &lt;i&gt;Woods themselves&lt;/i&gt; were telling us to turn back.&quot;&gt;&gt; \
&lt;img src=&quot;Images/Outskirts/misc2.jpg&quot; width=650 /&gt;

&lt;&lt;GreshTalk &quot;We dug up a ruin. An elven temple, maybe. And there... graah! It&#39;s hard to think about. The Redeemer was trying to open &lt;i&gt;something&lt;/i&gt;. A portal, maybe. Something that was supposed to stay shut.&quot;&gt;&gt; \
&lt;img src=&quot;Images/Outskirts/misc3.jpg&quot; width=650 /&gt;

&lt;&lt;GreshTalk &quot;That&#39;s when I had my change of heart. When I saw what he was opening. What was on &lt;i&gt;the other side&lt;/i&gt;.&quot;&gt;&gt; \
You grip your $weapon by instinct.
&lt;&lt;HeroTalk &quot;What was on the other side of the portal?&quot;&gt;&gt; \
&lt;&lt;GreshTalk &quot;The end. The end of everything.&quot;&gt;&gt; \

[[Gresh raises the dark crystal before his eyes-&gt;GN1Battle5][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;GreshTalk &quot;This &lt;i&gt;thing&lt;/i&gt; is the key. Without it, the Redeemer can&#39;t open his portal. Such a small thing. Yet so filled with darkness...&quot;&gt;&gt; \
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=450 /&gt;

&lt;&lt;GreshTalk &quot;You don&#39;t understand, human... the &lt;i&gt;horrors&lt;/i&gt; that poured from the gateway before I snatched the gem... monsters, not meant to ever step foot in this world... he cannot have it. The Redeemer can never get hold of this gem!&quot;&gt;&gt; \

Suddenly, &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&lt;/b&gt;&lt;/span&gt; leans closer to the gem, as if it were whispering in his ears.

&lt;&lt;GreshTalk &quot;Yes, yes, of course. The gem says you&#39;re a spy for the Redeemer. You &lt;i&gt;do&lt;/i&gt; serve him! You must!&quot;&gt;&gt; \

[[Give me the gem, Gresh! It is clouding your judgment!-&gt;GN1Battle5][$p = 4, $i = 1]]
[[Gresh, let us join forces! Together we can stop the Redeemer!-&gt;GN1Battle5][$p = 4, $i = 2]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle2_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
The Goblin King leers at you with dark, maddened eyes.

&lt;&lt;if $i eq 1&gt;&gt;&lt;&lt;GreshTalk &quot;No, you can&#39;t have the gem! It&#39;s mine - all mine! &lt;i&gt;I&#39;ll die before you take it from me&lt;/i&gt;!&quot;&gt;&gt; \
\
&lt;&lt;elseif $i eq 2&gt;&gt;&lt;&lt;GreshTalk &quot;Liar! You work for the Redeemer, yes, you must. The gem knows. The gem knows all. &lt;i&gt;I will not let you have it&lt;/i&gt;!&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\

&lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&lt;/b&gt;&lt;/span&gt; raises his blade above his head and charges straight at you!

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GreshStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer1_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
&lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&lt;/b&gt;&lt;/span&gt; falls to the ground, blood dripping from his teeth. Only now that he is near death does sanity return to his gaze.

&lt;&lt;GreshTalk &quot;Curses... the gem... had me fooled. It is evil... just as evil as the portal it wishes to open...&quot;&gt;&gt; \

He raises it before his eyes one last time.
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=450 /&gt;

&lt;&lt;GreshTalk &quot;It must be destroyed... the Redeemer must be stopped. Please... &lt;i&gt;please&lt;/i&gt;...&quot;&gt;&gt; \
The Goblin King goes silent.
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!
You find $enemygold on the Goblin King&#39;s corpse!
You find the Armor of the Goblin King!
You find the Biting Blade!

[[Pick up the dark crystal-&gt;GN1Battle5][$p = 21]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $outskirtsquest = 16&gt;&gt;\
&lt;&lt;set $valequest = 1&gt;&gt;\
&lt;&lt;set $weaponinventory.push($bitingblade)&gt;&gt;\
&lt;&lt;set $chestinventory.push($armorofthegoblinking)&gt;&gt;\

&lt;&lt;elseif $p eq 21&gt;&gt;Just as you lean down to pick up the dark crystal, you feel a stinging pain in your side. Wincing, you pluck the pain from your skin.
&lt;img src=&quot;Images/Outskirts/arrow2.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;A poison dart? But that&#39;s... not possible.&quot;&gt;&gt; \

The next moment, your legs go numb. You fall to the ground, paralyzed.

Footsteps, nearly silent, clip against the cold stone floor. As you struggle to move your face, you catch sight of your assailant.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

The elf girl kneels before you. Though you try your best to leap to your feet and tackle her, you cannot. You&#39;re completely immobile.

&lt;&lt;NayaTalk &quot;Forgive me, human. The paralysis will wear off in a day or so. That should give me enough time...&quot;&gt;&gt; \
She picks up the crystal with a gloved hand, then slips it into her pouch.
&lt;&lt;NayaTalk &quot;Don&#39;t try to find me.&quot;&gt;&gt; \

Then she leaves you in the dark.

[[...-&gt;GN1Battle5][$p = 22]]

&lt;&lt;set $currenthealth = 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 22&gt;&gt;\
\

Chapter 1 @@.delayed;...@@

@@.delayed;...@@

@@.delayed;...@@

@@.delayed;Complete.@@

@@.delayed;[[Continue-&gt;Interlude 1][$p = 0]] @@

&lt;&lt;set $check3 = random(1,3)&gt;&gt;\
&lt;&lt;if $check3 eq 1&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Quick&lt;/b&gt; in a new game to start off with a special weapon designed to make Chapter 1 easier to quickly complete!&lt;/i&gt;@@
&lt;&lt;elseif $check3 eq 2&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Lucky&lt;/b&gt; in a new game to start off with 500 gold!&lt;/i&gt;@@
&lt;&lt;elseif $check3 eq 3&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Thief&lt;/b&gt; in a new game to start off with leather gloves, leather armor, and leather pants!&lt;/i&gt;@@
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="48" name="Disclaimer" tags="" position="402,29" size="100,100">The following game is a work of fiction developed and written as a means of practicing basic programming in HTML, CSS, and JavaScript. All music and images found in this game are used for learning purposes only and are in no way monetized without the owners&#39; consent.

This game includes sound in the form of background music. This can be shut off using the volume bar in the left-side panel.

[[I understand-&gt;Opening and Name]] 
[[I do not understand-&gt;Disclaimer]]</tw-passagedata><tw-passagedata pid="49" name="Scarlet Vale Entry" tags="" position="1109,181" size="100,100">You arrive at the edge of the Scarlet Vale. 

Here life is in full bloom - trees with leaves as red as blood dominate the vale, and beneath them stretch creeping vines, like crimson veins that twist beneath your feet. Something feels amiss about the place. The evil of the Deep Woods is spreading its tendrils through the vale.
&lt;img src=&quot;Images/ScarletVale/vale1.jpg&quot; width=650 /&gt;

&lt;&lt;if $valequest gte 15&gt;&gt;The guardians of the Deep Wood have gone silent, but void creatures now prowl the Vale. &lt;&lt;else&gt;&gt;No matter the cost, the elf girl and the dark crystal must be found.&lt;&lt;/if&gt;&gt;
\
&lt;&lt;nobr&gt;&gt;

&lt;&lt;set $valeeventinventory = []&gt;&gt;

&lt;&lt;if $valequest eq 1&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;First Day&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($valequest gte 2) and ($valequest lt 5)&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;AmbusherAttack&quot;, &quot;GuardianAttack&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($valequest gte 5) and ($valequest lt 15)&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;AmbusherAttack&quot;, &quot;GuardianAttack&quot;, &quot;VoidspawnAttack&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($valequest gte 15)&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;VoidspawnAttack&quot;, &quot;DeathguardAttack&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($valequest gte 2) and ($oristatus eq 2)&gt;&gt;&lt;&lt;set $valeeventinventory.push(&quot;Ori2&quot;, &quot;Ori2&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($valequest gte 5) and ($valetreasure lt 2)&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;ValeTreasure&quot;, &quot;ValeTreasure&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($valequest gte 4) and ($valesword lt 2)&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;ValeSword&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($valequest gte 2) and not hasVisited(&quot;ValeGold&quot;)&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;ValeGold&quot;)&gt;&gt; &lt;&lt;/if&gt;&gt;

&lt;&lt;if $valequest eq 2&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;Nymph1&quot;, &quot;Nymph1&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $valequest eq 3&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;Nymph2&quot;, &quot;Nymph2&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $valequest eq 4&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;Witch1&quot;, &quot;Witch1&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $merchantstatus eq 6&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;StarNectar&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $valequest eq 6&gt;&gt; &lt;&lt;set $valeeventinventory.push(&quot;Destroyer&quot;, &quot;Destroyer&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;set $event = $valeeventinventory.pluck()&gt;&gt;\

&lt;&lt;/nobr&gt;&gt;
\
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $event eq &quot;First Day&quot;&gt;&gt; [[Venture Forth!-&gt;ValeFirstDay]]
&lt;&lt;elseif ($valequest gte 4) and not hasVisited(&quot;GhorokIntro&quot;)&gt;&gt; [[Venture Forth!-&gt;GhorokIntro]]
&lt;&lt;elseif ($lewdmode eq 1) and ($valequest gte 6) and ($nayalove eq 11) and ($gender eq &quot;male&quot;)&gt;&gt;[[Venture Forth!-&gt;Naya Lewd][$p = 0]]
&lt;&lt;elseif ($outskirtsquest gte 3) and ($lewdshrine eq 1) and ($lewdmode eq 1)&gt;&gt; [[Venture Forth!-&gt;LewdShrine2]]
&lt;&lt;elseif $event eq &quot;AmbusherAttack&quot;&gt;&gt; [[Venture Forth!-&gt;AmbusherAttack]]
&lt;&lt;elseif $event eq &quot;GuardianAttack&quot;&gt;&gt; [[Venture Forth!-&gt;GuardianAttack]]
&lt;&lt;elseif $event eq &quot;VoidspawnAttack&quot;&gt;&gt; [[Venture Forth!-&gt;VoidspawnAttack]]
&lt;&lt;elseif $event eq &quot;DeathguardAttack&quot;&gt;&gt; [[Venture Forth!-&gt;DeathguardAttack]]
&lt;&lt;elseif $event eq &quot;Ori2&quot;&gt;&gt; [[Venture Forth!-&gt;Ori2]]
&lt;&lt;elseif $event eq &quot;Nymph1&quot;&gt;&gt; [[Venture Forth!-&gt;Nymph1]]
&lt;&lt;elseif $event eq &quot;Nymph2&quot;&gt;&gt; [[Venture Forth!-&gt;Nymph2]]
&lt;&lt;elseif $event eq &quot;Witch1&quot;&gt;&gt; [[Venture Forth!-&gt;Witch1]]
&lt;&lt;elseif $event eq &quot;ValeTreasure&quot;&gt;&gt; [[Venture Forth!-&gt;ValeTreasure]]
&lt;&lt;elseif $event eq &quot;ValeSword&quot;&gt;&gt; [[Venture Forth!-&gt;ValeSword]]
&lt;&lt;elseif $event eq &quot;ValeGold&quot;&gt;&gt; [[Venture Forth!-&gt;ValeGold]]
&lt;&lt;elseif $event eq &quot;StarNectar&quot;&gt;&gt; [[Venture Forth!-&gt;StarNectar]]
&lt;&lt;elseif $event eq &quot;Destroyer&quot;&gt;&gt; [[Venture Forth!-&gt;Destroyer]]

&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if ($valequest gte 8)&gt;&gt;[[Venture to the Tower of Zyr-&gt;Tower Entrance]]&lt;&lt;/if&gt;&gt;
[[Back-&gt;Outside the Cabin]] 
\
&lt;&lt;set $p = 0&gt;&gt;\</tw-passagedata><tw-passagedata pid="50" name="ValeFirstDay" tags="" position="1108,297" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
You begin your first foray into the Scarlet Vale with grim purpose, nearly verging on anger. 
&lt;&lt;HeroTalk &quot;That elf girl took me surprise, in Gresh&#39;s cave. I can&#39;t let that happen again...&quot;&gt;&gt;\
As you venture deeper into the vale, the prominence of curiously red leaves and flowers grows and grows, until you can hardly spot a hint of green among the woodland.
&lt;img src=&quot;Images/ScarletVale/vale6.jpg&quot; width=700 /&gt;

An experienced tracker, you keep your keen eyes on the forest paths, searching out markers that would hint at the elf girl&#39;s passing. You find nothing of the sort. Truly, the only marks you spot are odd, webbed claws.
&lt;&lt;HeroTalk &quot;I&#39;ve never seen tracks like these...&quot;&gt;&gt;\

Just then, you hear something scuttling.

[[It&#39;s coming from above-&gt;ValeFirstDay][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
Drawing your weapon, you raise your vision to the tangle of branches above your head.
&lt;img src=&quot;Images/ScarletVale/vale2.jpg&quot; width=500 /&gt;

For a moment, you&#39;re not entirely sure what you&#39;re looking at. It appears to be a pack of feral creatures... made of the very plants of the Scarlet Vale. A cold blue energy hisses from beneath their petals. And you get that sense that, even without eyes, they are watching you.
\
&lt;&lt;ScarletAmbusherTalk &quot;...Interloper... run, while you still can.&quot;&gt;&gt;\
The noise - the &lt;i&gt;voice&lt;/i&gt; of the creature - carries the sound of shivering leaves and twisting roots. It raises a whip-like vine and cracks it in warning.
&lt;&lt;HeroTalk &quot;I will not turn back.&quot;&gt;&gt;\
&lt;&lt;ScarletAmbusherTalk &quot;Then &lt;i&gt;die&lt;/i&gt;!&quot;&gt;&gt;\

It leaps from the trees!

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ScarletAmbusherStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
The plant creature&#39;s grevious wounds ooze with a thick, sticky sap. The blue light beneath its petals begins to fade.
&lt;&lt;ScarletAmbusherTalk &quot;It matters not... all shall fall to the Void...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;The Void? What are you talking about?&quot;&gt;&gt;\
It crumples up as it dies. The rest of the creatures, watching from the trees, scatter deeper into the Vale.
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You will get no answer from this creature. All you know is that it was quite a formidable foe. If the plant life of the Scarlet Vale works for the elf girl and the Redeemer, your quest in the Deep Woods just became even more dangerous.
&lt;&lt;HeroTalk &quot;Maybe the plants see the elf girl as an interloper, too. Maybe she&#39;s already dead.&quot;&gt;&gt;\

You won&#39;t know for certain until you find her corpse within the Vale. For now, you must return to your cabin and rest.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt; \
&lt;&lt;set $valequest = 2&gt;&gt;\
&lt;&lt;set $valetreasure = 0&gt;&gt;\
&lt;&lt;set $valesword = 0&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="51" name="Interlude 1" tags="" position="933,998" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;\
Your thoughts shift through a liquid haze.

Consciousness slips. @@.delayed;Frays.@@ @@.delayed;Fades Away.@@

@@.delayed;Memories...@@

@@.delayed;&lt;&lt;KingTalk &quot;$name... you have failed me.&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;OldHeroTalk &quot;It will not happen again. I swear, by my life. By my honor.&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;KingTalk &quot;Some say I should have you removed. Some say the age of heroes is finished.&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;OldHeroTalk &quot;My lord. If I had but one more chance-&quot;&gt;&gt; @@ \

@@.delayed; [[Awaken-&gt;Interlude 1][$p = 1]]@@

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
You awaken to sunlight, streaming into your cabin. You&#39;re lying on your bed, your wounds from your battle with the Goblin King bandaged.
&lt;img src=&quot;Images/Locations/morning2.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;What... what happened?&quot;&gt;&gt;\
The next moment, the portly face of the robust merchant, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/span&gt; looms over you.
&lt;&lt;MerchantTalk &quot;What happened!? By sand and sun - when you never returned, I hustled to that horrible cave, slipped past a mess of goblin corpses, and dragged you back here! Pulled my shoulder in the process,  I might add!&quot;&gt;&gt;\
You blink, slowly.
&lt;&lt;HeroTalk &quot;You saved my life?&quot;&gt;&gt;\
The merchant looks rather proud of himself.
&lt;&lt;MerchantTalk &quot;Well, let&#39;s just say we&#39;re even. But I want to hear from you - what happened back there?&quot;&gt;&gt;\

[[Recount the events in the goblin nest-&gt;Interlude 1][$p = 2]]
\
\
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
&lt;&lt;set $daynumber += 1&gt;&gt;\
&lt;&lt;set $time = &quot;Morning&quot;&gt;&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
\
First you relay the foreboding conversation you had with &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh, the Goblin King&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Outskirts/gresh1.jpg&quot; width=400 /&gt;

&lt;&lt;MerchantTalk &quot;I&#39;ve never heard this &#39;Redeemer&#39; fellow, but if even half of what the Goblin King said was truth, he is surely a foe to be reckoned with! It seems you&#39;ve found the source of the evil haunting the Deep Woods, $name.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Agreed. A shame the goblin had to die. I sense he had more to tell, and no love for his former master.&quot;&gt;&gt;\

[[Continue your tale-&gt;Interlude 1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
Next, you recount the elf girl who paralyzed you, stole the dark crystal, and left you in the cave.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;I suspect the girl is an agent of the Redeemer. She used me as a blunt instrument to deal with the goblins, then took the jewel on behalf of her master.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;A dark crystal... was it perhaps purple in color? Shining with otherworldly light?&quot;&gt;&gt;\
The question is oddly specific.
&lt;&lt;HeroTalk &quot;Not at all, no. Why, Babar? Are you looking for such a gem?&quot;&gt;&gt;\
The merchant seems to have lost some of his color. He seems like he might answer, then slowly shakes his head.
&lt;&lt;MerchantTalk &quot;Never mind, friend. But tell me... what will you do now?&quot;&gt;&gt;\

[[You come to a decision-&gt;Interlude 1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;main_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;main&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I will not fail. Not again. I have but one path ahead of me, Babar: I will hunt down the elf girl, regain the dark crystal, and destroy this Redeemer before he can open his dark portal.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Hahah! That is what I like to hear. I suppose you&#39;ll be going to the Scarlet Vale, then?&quot;&gt;&gt;\
You tilt your head.
&lt;&lt;MerchantTalk &quot;Based on Gresh&#39;s tale, my bet is this elf girl is heading deeper into the Deep Woods. Past the outskirts lies the Scarlet Vale - a maze of blood red forest. If you move quickly... by sand and sun, you might just catch her.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Enough talk, then. Onward!&quot;&gt;&gt;\

[[To the Scarlet Vale!-&gt;Cabin][$p = 0]] 

&lt;&lt;set $merchantstatus = 4&gt;&gt;\
&lt;&lt;MerchantInventory2&gt;&gt;\

&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt; &lt;&lt;set $paladinabilityinventory.push($nullify, $prayer, $divineintervention)&gt;&gt; &lt;&lt;/if&gt;&gt; \
&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt; &lt;&lt;set $soldierabilityinventory.push($blooddrinker, $bonebreaker, $momentum)&gt;&gt; &lt;&lt;/if&gt;&gt; \
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt; &lt;&lt;set $rogueabilityinventory.push($shadowstep, $consumeshadows, $incapacitate)&gt;&gt; &lt;&lt;/if&gt;&gt; \
\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="52" name="AmbusherAttack" tags="" position="1106,426" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You are wandering through the Scarlet Vale when from above you comes the skittering voice of a Scarlet Ambusher!
&lt;img src=&quot;Images/ScarletVale/plant3.jpg&quot; width=400 /&gt;

&lt;&lt;ScarletAmbusherTalk &quot;Interlopers must be silenced.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Have at thee!&quot;&gt;&gt; \

The creature leaps upon you!

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ScarletAmbusherStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="53" name="GuardianAttack" tags="" position="1108,541" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You are wandering through the Scarlet Vale when the &lt;i&gt;clink&lt;/i&gt; of heavy armor sounds from the trees. As you draw your $weapon, a bulky blood-red creature armed in heavy chain steps forth. Its greatsword gleams, ready for use.
&lt;img src=&quot;Images/ScarletVale/plant5.jpg&quot; width=400 /&gt;

&lt;&lt;ScarletGuardianTalk &quot;The time of the Void as come. Interlopers cannot interfere.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Try and stop me, fiend.&quot;&gt;&gt; \

The creature charges!

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ScarletGuardianStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="54" name="Ori2" tags="" position="1108,652" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;You are wandering through the Scarlet Vale when the ground beneath your feet begins to shake. The stomp feels almost... familiar.

&lt;&lt;HeroTalk &quot;... is that-&quot;&gt;&gt; \

[[The trees start to shiver-&gt;Ori2][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
The shaking of the ground becomes a rhythmic &lt;i&gt;stomp&lt;/i&gt;, &lt;i&gt;stomp&lt;/i&gt; as something massive draws near. The trees ahead shiver, then are pulled asunder by-

A golem, made of solid gold. &lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Oriazus the Resplendant&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/ori1.jpg&quot; width=450 /&gt;

&lt;&lt;OriTalk &quot;Little one, is that you?&quot;&gt;&gt;\
The golem peers down at you with its spherical, golden eyes. Slowly, they blink, before the golem nods its head.
&lt;&lt;HeroTalk &quot;You sound surprised.&quot;&gt;&gt;\
&lt;&lt;OriTalk &quot;That you&#39;re alive. Yes. Do you still chase your doom?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You mean my quest? I have not abandoned it.&quot;&gt;&gt;\
The golem sighs, flecks of gold flittering forth from its mouth. 
&lt;&lt;OriTalk &quot;Then it is only a matter of time.&quot;&gt;&gt;\
\
&lt;&lt;set $a = 0&gt;&gt;\
&lt;&lt;set $b = 0&gt;&gt;\
&lt;&lt;set $c = 0&gt;&gt;\

[[Have you seen an elf girl lately?-&gt;Ori2][$p = 2, $a = 1]]
[[What foul magic festers in this land?-&gt;Ori2][$p = 2, $b = 1]]
[[Do you have anything to trade?-&gt;Ori2][$p = 2, $c = 1]]


&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;if $a eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;Have you seen an elf girl in the Scarlet Vale? I must find her without delay.&quot;&gt;&gt;\
&lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Ori&lt;/b&gt;&lt;/span&gt; hefts its massive shoulders. The sound is much like a rockslide.
&lt;&lt;OriTalk &quot;Elf... human... you little ones look much alike. Yet always so keen to cut each other down.&quot;&gt;&gt;\
You sigh.
&lt;&lt;OriTalk &quot;Don&#39;t fret, little one. You will find your quarry, I think. You have proven... resilient.&quot;&gt;&gt;\
Coming from a golem, that&#39;s quite the compliment.
&lt;&lt;set $a = 2&gt;&gt;\
\
&lt;&lt;elseif $b eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;What foul magic festers in this land? The plants have come alive, and speak of Interlopers, and the Void.&quot;&gt;&gt;\
&lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Ori&lt;/b&gt;&lt;/span&gt; does not answer, for a time. Instead, it stares out into the crimson woodland. 

You get the sense that it is &lt;i&gt;afraid&lt;/i&gt; to speak.
&lt;&lt;OriTalk &quot;The Scarlet Vale&#39;s guardians are meant to &lt;i&gt;protect&lt;/i&gt; the Deep Woods. Perhaps something has corrupted them. As for this talk of &#39;Void...&#39;&quot;&gt;&gt;\

The golem shakes it head. Whether it has nothing to say, or would rather stay silent for its own safety, you cannot tell.
&lt;&lt;set $b = 2&gt;&gt;\
\
&lt;&lt;elseif $c eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;Do you have anything to trade?&quot;&gt;&gt;\
The golem perks up at the question.
&lt;&lt;OriTalk &quot;I happened upon a little morsel, just yesterday. I had planned on eating it, before realizing it was in fact an enchanted amulet. Magic tends to spoil the taste of gold...&quot;&gt;&gt;\
It reveals a small, shimmering amulet in its massive, rocky palm.
&lt;img src=&quot;Images/Armor/Amulet of Heroes.jpg&quot; width=450 /&gt;
&lt;&lt;set $c = 2&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $a eq 0&gt;&gt;[[Have you seen an elf girl lately?-&gt;Ori2][$p = 2, $a = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Have you seen an elf girl lately?&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $b eq 0&gt;&gt;[[What foul magic festers in this land?-&gt;Ori2][$p = 2, $b = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;What foul magic festers in this land&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $c eq 0&gt;&gt;[[Do you have anything to trade?-&gt;Ori2][$p = 2, $c = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Do you have anything to trade?&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $c eq 2&gt;&gt;[[Trade with Ori-&gt;Ori2][$p = 3]]&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 3&gt;&gt;The amulet looks like a worthy item to aid you in your quest. It&#39;s just a matter of how much gold to offer for it...
&lt;img src=&quot;Images/Armor/Amulet of Heroes.jpg&quot; width=450 /&gt;

&lt;&lt;if $gold gte 200&gt;&gt;[[Offer 200 gold for the amulet-&gt;Ori2][$p = 4, $i = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer 200 gold for the amulet&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $gold gte 100&gt;&gt;[[Offer 100 gold for the amulet-&gt;Ori2][$p = 4, $i = 2]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer 100 gold for the amulet&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $gold gte 50&gt;&gt;[[Offer 50 gold for the amulet-&gt;Ori2][$p = 4, $i = 3]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer 50 gold for the amulet&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[To battle!-&gt;Ori2][$p = 4, $i = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;You take out 200 gold pieces from your purse.
&lt;&lt;HeroTalk &quot;Will this do?&quot;&gt;&gt;\
Its carven lips crack into a smile.
&lt;&lt;OriTalk &quot;Generous. Very generous, little one.&quot;&gt;&gt;\

Soon you&#39;ve poured the gold into its massive palm and collected the amulet as payment. You watch, amused, as the behemoth swallows the gold before belching out a gust of yellow flame.
&lt;&lt;OriTalk &quot;How... appetizing.&quot;&gt;&gt;\

[[Ask Ori for aid in your quest-&gt;Ori2][$p = 5]]
&lt;&lt;set $gold -= 200&gt;&gt;

&lt;&lt;elseif $i eq 2&gt;&gt;You take out 100 gold pieces from your purse.
&lt;&lt;HeroTalk &quot;Will this do?&quot;&gt;&gt;\
Its carven lips crack into a smile.
&lt;&lt;OriTalk &quot;Yes. This is quite a meal.&quot;&gt;&gt;\

Soon you&#39;ve poured the gold into its massive palm and collected the amulet as payment. You watch, amused, as the behemoth swallows the gold before belching out a gust of yellow flame.
&lt;&lt;OriTalk &quot;What a wonderful snack.&quot;&gt;&gt;\

[[Ask Ori for aid in your quest-&gt;Ori2][$p = 5]]
&lt;&lt;set $gold -= 100&gt;&gt;

&lt;&lt;elseif $i eq 3&gt;&gt;You take out 50 gold pieces from your purse.
&lt;&lt;HeroTalk &quot;Will this do?&quot;&gt;&gt;\
It studies the gold, then slowly nods its head.
&lt;&lt;OriTalk &quot;I hoped for more. But I accept.&quot;&gt;&gt;\

Soon you&#39;ve poured the gold into its massive palm and collected the amulet as payment. You watch, amused, as the behemoth swallows the gold before belching out a gust of yellow flame.
&lt;&lt;OriTalk &quot;Delectable!&quot;&gt;&gt;\

[[Ask Ori for aid in your quest-&gt;Ori2][$p = 5]]
&lt;&lt;set $gold -= 50&gt;&gt;

&lt;&lt;elseif $i eq 4&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle2_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
Enough prattling. You&#39;re here to cleanse the Deep Woods of hideous creatures such as this.

&lt;&lt;HeroTalk &quot;Vile thing - have at thee!&quot;&gt;&gt;\
As you raise your $weapon, the behemoth sighs.
&lt;&lt;OriTalk &quot;I will destroy you. If I must.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;OriStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $oristatus = 1&gt;&gt;\

&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;HeroTalk &quot;Ori - would you aid me in my quest? This Redeemer must be stopped.&quot;&gt;&gt;\
The golem stares past you, unblinking. Then it slowly shakes its head.

&lt;&lt;OriTalk &quot;This is not my fight.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;But you &lt;i&gt;live&lt;/i&gt; here.&quot;&gt;&gt;\
&lt;&lt;OriTalk &quot;I hide here. Hiding precludes fighting, little one. I am sorry.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Character/ori1.jpg&quot; width=450 /&gt;

Then it stomps off, its heavy footfalls rattling the ground long after it is out of view.

&lt;i&gt;You gained 100 exp!&lt;/i&gt;

[[You decide it&#39;s about time you returned to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $oristatus = 3&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $headinventory.push($amuletofheroes)&gt;&gt;\

&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;\
\
You have slain &lt;b&gt;Ori the Resplendent&lt;/b&gt;!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $oristatus = 0&gt;&gt;

&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="55" name="Nymph1" tags="" position="1107,766" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
You stalk through Scarlet Vale, your $currentweapon drawn. The Vale itself seems intent on killing you, meaning you must always be ready to fight.
&lt;img src=&quot;Images/ScarletVale/vale8.jpg&quot; width=700 /&gt;

As you walk through an old, overgrown path, you see faint sunlight up ahead. The woods are not quite so foreboding, here. There&#39;s even some true greenery to the foilage.

And just around the bend, you hear what sounds like a girl&#39;s laughter?

Could it be the elf?

[[Approach the sound-&gt;Nymph1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
As you round an ancient oak, you spot a peculiar looking young girl. Her ears are pointed, much like an elf&#39;s, but her hair is the color of tilled soil, and her skin shifts from pale white to a rigid, bark-like texture.
&lt;img src=&quot;Images/ScarletVale/nymph1.jpg&quot; width=450 /&gt;

That&#39;s not an elf... it&#39;s a forest nymph.
&lt;&lt;NymphTalk &quot;Hello, $name. Want to play a game?&quot;&gt;&gt;\
You definitely do &lt;i&gt;not&lt;/i&gt; want to play a game. Forest nymphs are callous, capricious creatures. They like nothing better than tricking a human into selling his freedom. Or his soul.
&lt;&lt;HeroTalk &quot;I&#39;m looking for an elf girl, wandering the vale. Tell me where she is, and I&#39;ll let you live.&quot;&gt;&gt;\

[[The nymph laughs at your threat-&gt;Nymph1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;NymphTalk &quot;It sounds like you &lt;i&gt;do&lt;/i&gt; want to play a game. Since you&#39;ll never find her if you don&#39;t play.&quot;&gt;&gt;\
You feel yourself scowling.
&lt;&lt;if ($lewdmode eq 1) and ($gender eq &quot;male&quot;)&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;Why should I believe you&#39;ve even seen her? Only a fool would trust a nymph.&quot;&gt;&gt;\
The nymph giggles, then tosses a shimmering dust into the air. Before your eyes, the dust catches the sunlight and &lt;i&gt;shifts&lt;/i&gt;, taking shape.

[[An image appears in the dust-&gt;Nymph1][$p = 21]]
\
\
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;You truly know where she is?&quot;&gt;&gt;\
The nymph giggles in answer. They&#39;re not exactly known for being straight-forward.
&lt;&lt;HeroTalk &quot;Fine. What game?&quot;&gt;&gt;\
&lt;&lt;NymphTalk &quot;It&#39;s easy! All you need to do is look into my eyes. Don&#39;t you dare stop until I blink.&quot;&gt;&gt;\

... seems simple enough.

[[Play the game-&gt;Nymph1][$p = 5]]
[[Slay the nymph-&gt;Nymph1][$p = 3]]&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 3&gt;&gt;To play a nymph&#39;s game is folly. Leaping forwards, you swing at the nymph- 

-only to strike at the air...

... for the nymph is gone.

As you look around the emptiness where the nymph just was, you feel a chilling breath against the back of your neck.

[[Spin around-&gt;Nymph1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
Staring at you is... &lt;i&gt;something&lt;/i&gt;. 
&lt;img src=&quot;Images/ScarletVale/nymph3.jpg&quot; width=450 /&gt;

&lt;&lt;ShadowNymphTalk &quot;That&#39;s not how you play the game!&quot;&gt;&gt;\
It&#39;s the nymph&#39;s shadow!

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ShadowNymphStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 


&lt;&lt;elseif $p eq 5&gt;&gt;You decide to play the nymph&#39;s game. Steeling yourself, you settle your gaze against the nymph&#39;s unyielding sight.
&lt;img src=&quot;Images/ScarletVale/nymph1.jpg&quot; width=450 /&gt;

Time passes. A bead of sweat drips down your brow. Still, the nymph does not blink.
&lt;&lt;NymphTalk &quot;Isn&#39;t this game fun?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;No.&quot;&gt;&gt;\

Just then, you feel a chilling breath against the back of your neck. Something is right behnd you.

[[Turn around-&gt;Nymph1][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
You spin around, just in time to see... &lt;i&gt;something&lt;/i&gt;. 
&lt;img src=&quot;Images/ScarletVale/nymph3.jpg&quot; width=450 /&gt;

&lt;&lt;ShadowNymphTalk &quot;You lose!&quot;&gt;&gt;\
It&#39;s the nymph&#39;s shadow!

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ShadowNymphStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 


&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
The nymph&#39;s shadow fades away. You are left alone in the vale. Distantly, you can hear the forest nymph&#39;s singsong voice.
&lt;&lt;NymphTalk &quot;Come play with me, $name... you&#39;re almost out of time...&quot;&gt;&gt;\
You realize that despite it&#39;s capricious nature, besting the nymph at its game might be your only chance at finding the elf girl. It seems to have complete mastery of the Scarlet Vale.
&lt;&lt;HeroTalk &quot;I hate nymphs...&quot;&gt;&gt;\
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt; &lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt; &lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \
&lt;&lt;set $valequest = 3&gt;&gt;\
\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;elseif $p eq 21&gt;&gt;\
\
&lt;&lt;NymphTalk &quot;Behold - see my sight in the mist. This is where I spotted your elf girl.&quot;&gt;&gt;\
The dust becomes a kind of floating image, like paint suspended in mid-air. In it, you see the elf girl. She&#39;s bathing in a spring, somewhere in the Scarlet Vale.
&lt;img src=&quot;Images/Other/naya1.jpg&quot; width=450 /&gt;

Your breath catches, seeing her so exposed, seeing the spring water glisten on her lithe figure, and the subtle curve of her breasts and swell of her hips.

Many in the Kingdom say elf women are revolting. Seeing one up close, you realize...

[[She&#39;s as filthy as any elf-&gt;Nymph1][$p = 22, $i = 1]]
[[She&#39;s beautiful-&gt;Nymph1][$p = 22, $i = 2]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
\
&lt;&lt;if $i eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;I wanted proof you&#39;ve seen her - get this filthy image out of my sight.&quot;&gt;&gt;\
The nymph shrugs, and the dust dissipates. The image of the elf girl is gone.
&lt;&lt;set $nayalove = 5&gt;&gt;\
\
&lt;&lt;elseif $i eq 2&gt;&gt;&lt;&lt;HeroTalk &quot;She&#39;s... beautiful.&quot;&gt;&gt;\
You shut your lips, the next moment. You hadn&#39;t meant to say that out loud - but the elf girl is such a splendid sight to behold.
&lt;&lt;NymphTalk &quot;She is oh so pretty. I wonder how she&#39;ll die.&quot;&gt;&gt;\
Then the dust dissipates. The image of the elf girl is gone.
&lt;&lt;set $nayalove = 11&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;So, you truly know where she is?&quot;&gt;&gt;\
The nymph giggles in answer. They&#39;re not exactly known for being straight-forward.
&lt;&lt;NymphTalk &quot;I know plenty. But I won&#39;t tell until you play my game.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Fine. What game?&quot;&gt;&gt;\
&lt;&lt;NymphTalk &quot;It&#39;s easy! All you need to do is look into my eyes. Don&#39;t you dare stop until I blink.&quot;&gt;&gt;\

... seems simple enough.

[[Play the game-&gt;Nymph1][$p = 5]]
[[Slay the nymph-&gt;Nymph1][$p = 3]]
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="56" name="Nymph2" tags="" position="1106,878" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
You stalk through Scarlet Vale, your $currentweapon drawn. The Vale itself seems intent on killing you, meaning you must always be ready to fight.
&lt;img src=&quot;Images/ScarletVale/vale8.jpg&quot; width=700 /&gt;

As you walk through an old, overgrown path, you see faint sunlight up ahead. The woods are not quite so foreboding, here. There&#39;s even some true greenery to the foilage.

And just around the bend, you hear what sounds the nymph, laughing.
&lt;&lt;HeroTalk &quot;This time, I&#39;ll have the better of her.&quot;&gt;&gt;\

[[Approach the nymph-&gt;Nymph2][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
As you round an ancient oak, you spot the nymph. She looks happy to see you.
&lt;img src=&quot;Images/ScarletVale/nymph1.jpg&quot; width=450 /&gt;

&lt;&lt;NymphTalk &quot;Hello, $name. Are you ready to play the game again?&quot;&gt;&gt;\
You feel your temper rising, but you know you must focus if you&#39;re to beat her at her game...

[[Play the game-&gt;Nymph2][$p = 2]]
[[Slay the nymph-&gt;Nymph2][$p = 9]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;HeroTalk &quot;If I beat your game, you&#39;ll tell me where the elf girl is?&quot;&gt;&gt;\
The nymph giggles in answer. They&#39;re not exactly known for being straight-forward.
&lt;&lt;HeroTalk &quot;Fine. Let&#39;s begin...&quot;&gt;&gt;\
&lt;&lt;NymphTalk &quot;&lt;i&gt;Yay&lt;/i&gt;! All you need to do is look into my eyes. Don&#39;t you dare stop until I blink.&quot;&gt;&gt;\

[[Focus-&gt;Nymph2][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
You settle your gaze against the nymph&#39;s unyielding sight.
&lt;img src=&quot;Images/ScarletVale/nymph1.jpg&quot; width=450 /&gt;

Time passes. A bead of sweat drips down your brow. Still, the nymph does not blink.
&lt;&lt;NymphTalk &quot;Isn&#39;t this game fun?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;No.&quot;&gt;&gt;\

Just then, you feel a chilling breath against the back of your neck. Something is right behnd you.

&lt;b&gt;Willpower Check&lt;/b&gt;
&lt;&lt;WillpowerCheck 50&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;You just barely resist the urge to turn around. The moment passes. The chill against your neck fades away.
&lt;&lt;NymphTalk &quot;Aww... you weren&#39;t supposed to win.&quot;&gt;&gt;\

With a sigh, the nymph blinks.

[[Victory!-&gt;Nymph2][$p = 4]]

&lt;&lt;else&gt;&gt;You can&#39;t hold your nerve. Crying out, [[you spin around to face your foe-&gt;Nymph2][$p = 8]]

&lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 9&gt;&gt;To play a nymph&#39;s game is folly. Leaping forwards, you swing at the nymph- 

-only to strike at the air...

... for the nymph is gone.

As you look around the emptiness where the nymph just was, you feel a chilling breath against the back of your neck.

[[Spin around-&gt;Nymph1][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
It&#39;s the nymph&#39;s shadow!
&lt;img src=&quot;Images/ScarletVale/nymph3.jpg&quot; width=450 /&gt;

&lt;&lt;ShadowNymphTalk &quot;That&#39;s not how you play the game!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ShadowNymphStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 


&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;HeroTalk &quot;It&#39;s over, nymph. Take me to the elf girl.&quot;&gt;&gt;\
The nymph giggles.
&lt;&lt;NymphTalk &quot;Elf girl? I haven&#39;t seen any elf girl!&quot;&gt;&gt;\
Just as you reach for your $weapon, the nymph shakes her head.
&lt;&lt;NymphTalk &quot;But the Scarlet Witch has seen her. She is helping her as we speak. Your only hope, $name $title, is find the Witch.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Enough games. Where is this witch?&quot;&gt;&gt;\
&lt;&lt;NymphTalk &quot;Her home lies between four hills. Smoke will guide you.&quot;&gt;&gt;\

Before you can ask what she means, the nymph disappears.
&lt;&lt;HeroTalk &quot;It seems I&#39;m on a witch hunt...&quot;&gt;&gt;\

&lt;i&gt;You gained 150 exp!&lt;/i&gt;

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $valequest = 4&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt; &lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt; &lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \
&lt;&lt;set $exp += 150&gt;&gt;\

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
The nymph&#39;s shadow fades away. You are left alone in the vale. Distantly, you can hear the forest nymph&#39;s singsong voice.
&lt;&lt;NymphTalk &quot;Come play with me, $name... you&#39;re almost out of time...&quot;&gt;&gt;\
You realize that despite its capricious nature, besting the nymph at its game might be your only chance at finding the elf girl. It seems to have complete mastery of the Scarlet Vale.
&lt;&lt;HeroTalk &quot;I hate nymphs...&quot;&gt;&gt;\
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt; &lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt; &lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \
&lt;&lt;set $valequest = 3&gt;&gt;\
\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="57" name="Witch1" tags="" position="1107,992" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
After a long while searching for an opening in the thick canopy of crimson leaves, you find a small patch of rocky ground. No longer obscured from sight, you spot a ring of four hills not too far from where you stand. And there, beyond them, a plume of smoke!
&lt;img src=&quot;Images/ScarletVale/smoke1.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;The witch!&quot;&gt;&gt;\
You shift into a sprint, leaping over thorn and stone to get to the witch - and that elf thief - before you lose their trail.

[[Onwards!-&gt;Witch1][$p = 1]]

&lt;&lt;set $witchstatus = 0&gt;&gt;\
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
Just as you cross the hills, you have the odd feeling of being watched. Slowing down, you spot the spy.

A mouse. Staring at you.
&lt;img src=&quot;Images/ScarletVale/mouse1.jpg&quot; width=500 /&gt;

You&#39;re not sure why, but it&#39;s almost unnerving, that mouse&#39;s stare. Like it knows you.
&lt;&lt;HeroTalk &quot;These woods are driving me mad...&quot;&gt;&gt;\

[[Give the mouse a respectful wave and then keep going-&gt;Witch1][$p = 2, $i = 1]]
[[Kick the mouse and then keep going-&gt;Witch1][$p = 2, $i = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;&lt;if $i eq 1&gt;&gt;Not in the mood for idle talk, you give a quick wave to the oddly serene rodent and continue on your way.
\
&lt;&lt;else&gt;&gt;Finding the little mouse aggravating, you crash your foot against it - 

- at least, you mean to. The mouse deftly avoids your foot and scurries into the woods. Not sparing it a second thought, you continue on your way.
\
&lt;&lt;/if&gt;&gt;\

Soon you pass the hills and arrive in a small, shaded dell. There you spot the source of the smoke. 
&lt;img src=&quot;Images/ScarletVale/house1.jpg&quot; width=550 /&gt;

The witch&#39;s hut. It&#39;s burning. In a few more moments, it will be fully consumed by flames. If the witch is here, she&#39;s very likely dead.

As you stare in glum curiosity, a figure stirs within the burning house.

Not a witch. A man, his face hidden, his body clad in black armor.
&lt;&lt;HeroTalk &quot;Who...?&quot;&gt;&gt;\

[[He approaches you-&gt;Witch1][$p = 3]]


&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;redeemer&quot;&gt;&gt;\
\
The flames don&#39;t seem to harm it. Without haste, the figure walks out of the burning hut just moments before its roof collapses in a flash of orange fire.
&lt;img src=&quot;Images/Character/redeemer1.jpg&quot; width=450 /&gt;

The figure faces you, though still its eyes are lost in the shadow of its hood. Despite the heat of the fire, a cold sense of despair strikes you. Gritting your teeth, you fight the feeling.

&lt;&lt;HeroTalk &quot;Who are you?&quot;&gt;&gt;\
The figure tilts its head.
&lt;&lt;Redeemer1Talk &quot;I am the spring rains, come to clean this bloodied world. Who are you?&quot;&gt;&gt;\
You start to suspect that you&#39;ve found your quarry.
&lt;&lt;HeroTalk &quot;You&#39;re the Redeemer.&quot;&gt;&gt;\

[[Slowly, the figure nods-&gt;Witch1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;Redeemer2Talk &quot;Yes. I am the world&#39;s one last chance at redemption. Tell me, human - have you seen a witch, by chance? She has something of mine. Something important.&quot;&gt;&gt;\
The stone - he hasn&#39;t found the elf girl, yet! Now is your chance to end his schemes, before they&#39;ve truly begun.
&lt;&lt;HeroTalk &quot;Your portal won&#39;t be opening, fiend. You will answer-&quot;&gt;&gt;\
He raises one hand, and all sound dies in your throat.
&lt;&lt;Redeemer2Talk &quot;Enough. I&#39;ve no time for righteous prattling. You haven&#39;t seen the witch, then? Shame...&quot;&gt;&gt;\
From in front of the Redeemer, a shadow rises.
&lt;&lt;Redeemer2Talk &quot;I might have let you live.&quot;&gt;&gt;\

[[The Redeemer disappears-&gt;Witch1][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
The Redeemer is suddenly &lt;i&gt;gone&lt;/i&gt;. But the shadow it summoned remains, rapidly gaining size, and sprouting limbs.

You&#39;re reminded of the horrors that &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&lt;/b&gt;&lt;/span&gt; spoke of. Shadow things. Things that shouldn&#39;t be.
&lt;img src=&quot;Images/ScarletVale/voidspawn1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;You&#39;re an ugly little bastard...&quot;&gt;&gt;\
&lt;&lt;VoidspawnTalk &quot;&lt;i&gt;The Void... will consume this world...&lt;/i&gt;&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidspawnStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
The Voidspawn fades.
&lt;&lt;VoidspawnTalk &quot;The Void... cannot be stopped...&quot;&gt;&gt;\
Then it is gone.
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $valequest = 5&gt;&gt;\
&lt;&lt;set $witchstatus = 1&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

As you catch your breath, you notice a mouse, sniffing at the ground where the Voidspawn disappeared. It looks &lt;i&gt;exactly&lt;/i&gt; like the mouse you saw before.
&lt;img src=&quot;Images/ScarletVale/mouse1.jpg&quot; width=450 /&gt;

[[And then the mouse begins to change-&gt;Witch1][$p = 21]]

&lt;&lt;elseif $p eq 21&gt;&gt;\
Before your eyes, the mouse transforms - or rather, shapeshifts - into a young woman.
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;You must be the Scarlet Witch.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Must I? You can call me Scyllia, if you&#39;d like.&quot;&gt;&gt;\
As she speaks, her staff flashes with red, ethereal light. Before you can ask what she&#39;s doing, a warmth fills you as your wounds from the battle with the Voidspawn fade away. &lt;&lt;set $currenthealth = $maxhealth&gt;&gt;
&lt;&lt;HeroTalk &quot;Careful, witch. Don&#39;t presume to cast spells on me.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Don&#39;t be ungrateful - it&#39;s unbecoming of a hero. Now, I assume you&#39;re after Naya?&quot;&gt;&gt;\
At your stare, she clarifies.
&lt;&lt;WitchTalk &quot;Naya - the elf girl with white hair.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;How do you know what I&#39;m after?&quot;&gt;&gt;\
She winks at you.
&lt;&lt;WitchTalk &quot;Just a guess - everyone is after her, nowadays.&quot;&gt;&gt;\

[[Demand Scyllia take you to the elf-&gt;Witch1][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; seems to read your mind.
&lt;&lt;WitchTalk &quot;You want me to lead you to her? Tonight? So reckless.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;She has something of mine.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Then you will fetch it tomorrow. Don&#39;t pout, hero. I will lead you to her... but there&#39;s something we must discuss, first. And not here. It seems I&#39;m in need of a new home.&quot;&gt;&gt;\
She stares at you, expectantly.
&lt;&lt;HeroTalk &quot;I have a cabin on the edge of the woods.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Perfect. Come find me there, when you get the chance.&quot;&gt;&gt;\

In a puff of smoke, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; disappears. You just barely catch sight of a mouse, scurrying through the grass and into the trees, towards your cabin.
&lt;&lt;HeroTalk &quot;It seems I have a new house guest. I hope Babar won&#39;t mind.&quot;&gt;&gt;\

&lt;&lt;if (($lewdmode eq 1) and ($gender eq &quot;female&quot;)) or (($lewdmode eq 1) and ($penis eq 2))&gt;&gt;Just as you are about to leave, you spot a pair of remarkably beautiful high-heeled shoes. You decide to take them with you to the cabin.
&lt;img src=&quot;Images/Armor/Naughty Stilettos.jpg&quot; width=350 /&gt;

&lt;i&gt;You gain the Naughty Stilettos!&lt;/i&gt;
&lt;&lt;set $feetinventory.push($naughtystilettos)&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="58" name="VoidspawnAttack" tags="" position="1107,1101" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
As you are wandering through the Scarlet Vale a fog slips past your feet, and the air becomes cold enough to mist beneath your lips.

Drawing your $weapon, you turn around in time to see the shadows drawing together and taking form
&lt;img src=&quot;Images/ScarletVale/voidspawn1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Stay back, fiend!&quot;&gt;&gt;\
&lt;&lt;VoidspawnTalk &quot;Why do you resist the inevitable? The time of the Void has come.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidspawnStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="59" name="ValeTreasure" tags="" position="1106,1226" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\

As you wander through the Scarlet Vale, you spot the opening to an old, abandoned Elven ruin. Within, the darkness is inpenetrable.
&lt;img src=&quot;Images/ScarletVale/vale9.jpg&quot; width=700 /&gt;

[[Investigate the ruin-&gt;ValeTreasure][$p = 1]]
[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;elseif $p eq 1&gt;&gt;\
The way is dark, the path strewn with broken stone. Soon, you arrive at a crossroad.
&lt;img src=&quot;Images/ScarletVale/mine1.jpg&quot; width=650 /&gt;

[[Go right-&gt;ValeTreasure][$p = 4]]
[[Go left-&gt;ValeTreasure][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
You continue to traverse the ruin. The tunnel grows wider, the deeper you wander. Eventually, the path opens up into a great, cavernous room. Slowly, you realize it is some kind of temple. 
&lt;img src=&quot;Images/ScarletVale/mine2.jpg&quot; width=650 /&gt;

There, in its center, is a statue of a hooded woman. It might be &lt;b&gt;Tylae, the Mother Goddess&lt;/b&gt;, but you are not sure.

[[Pray to the statue-&gt;ValeTreasure][$p = 3]]
[[Turn your back to it and leave the mine-&gt;ValeTreasure][$p = 5]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
You kneel before the massive statue, and shut your eyes.

&lt;&lt;HeroTalk &quot;Oh, graceful Tylae - hear my plea. This Wood is dark and sick with evil. Lend me your light to guide my steps, and strength enough to persevere.&quot;&gt;&gt;\
A flash of white light fills the ruined temple. Blinking away the afterimage of the brightness, you spot something that was not there, before. A banner, bearing the sigil of Tylae. It looks newly made, and seems to glow with divine power.
&lt;img src=&quot;Images/Weapons/Banner of Tylae.jpg&quot; width=400 /&gt;

&lt;i&gt;Your piety has been recognized! Your willpower has increased by 2!&lt;/i&gt;
&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;You gained the Banner of Tylae!&lt;/i&gt;

[[Leave the ruin-&gt;Outside the Cabin]] 

&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $basewillpower += 2&gt;&gt;\
&lt;&lt;set $weaponinventory.push($banneroftylae)&gt;&gt;\
&lt;&lt;set $valetreasure = 2&gt;&gt;\

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
Following your chosen path, you soon realize that you&#39;re going in circles. After muttering a few curses, you try to double-back the way you came.

Only to see that you&#39;re being followed by one of the creatures of the Scarlet Vale. It is some kind of monstrous rose, with arms that end in wicked scythes.
&lt;img src=&quot;Images/ScarletVale/plant7.jpg&quot; width=450 /&gt;

&lt;&lt;ScarletBloodletterTalk &quot;Interloper... the time for prayer has passed. Now all must heed the Void.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Heed my blade, fiend!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ScarletBloodletterStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 5&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\

Not daring to pray to some heathen Goddess you cannot recgonize, you instead attempt to leave the ruin. You don&#39;t get very far before realizing that you&#39;re being followed.

Turning heel, you spot one of the creatures of the Scarlet Vale, closing the distance between you. It is some kind of monstrous rose, with arms that end in wicked scythes.
&lt;img src=&quot;Images/ScarletVale/plant7.jpg&quot; width=450 /&gt;

&lt;&lt;ScarletBloodletterTalk &quot;Interloper... the time for prayer has passed. Now all must heed the Void.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Heed my blade, fiend!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ScarletBloodletterStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
The plant creature&#39;s grevious wounds ooze with a thick, sticky sap. The blue light beneath its petals begins to fade.
&lt;&lt;ScarletBloodletterTalk &quot;I am but an instrument... of the end...&quot;&gt;&gt;\
It crumples up as it dies. 

After catching your breath, you exit the ruin. You have half a mind to return and explore it once more, but not until after you&#39;ve rested.
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 
\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\

\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="60" name="ValeSword" tags="" position="1105,1340" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\

As you wander through the Scarlet Vale, you spot a small clearing. At its center, a well-forged sword awaits, its blade firmly lodged into a stone.
&lt;img src=&quot;Images/ScarletVale/sword1.jpg&quot; width=700 /&gt;

[[Attempt to pull the sword from the stone-&gt;ValeSword][$p = 1]]
[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;elseif $p eq 1&gt;&gt;\
You wrap your hands around the handle of the sword, then set your feet against the stone and pull with all your might.
&lt;img src=&quot;Images/ScarletVale/sword1.jpg&quot; width=700 /&gt;

&lt;b&gt;Strength Check&lt;/b&gt;
&lt;&lt;StrengthCheck 60&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;[[The sword comes free!-&gt;ValeSword][$p = 3]]
&lt;&lt;else&gt;&gt;[[The sword does not budge-&gt;ValeSword][$p = 2]] &lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 2&gt;&gt;\
Soon enough your sweat is dripping past your nose, and your breath comes in quick huffs. Still, the sword has not budget. You&#39;ve bested, for now.
&lt;&lt;HeroTalk &quot;I&#39;ll return, once I recover my strength...&quot;&gt;&gt;\

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;elseif $p eq 3&gt;&gt;\
You shout in triumph as the sword slides out of its stone prison. The weapon turns out to be a hefty steel greatsword - kind the handsome tool for cutting down the evils of the Deep Woods. And if you don&#39;t plan to use it, Babar would likely pay a fair price for it.
&lt;img src=&quot;Images/Weapons/Steel Greatsword.jpg&quot; width=500 /&gt;

&lt;i&gt;You gained a Steel Greatsword!&lt;/i&gt;

&lt;i&gt;This impressive act has left you feeling deft and powerful! Your strength and agility have both increased by 1!&lt;/i&gt;

&lt;i&gt;You gained 100 exp!&lt;/i&gt;

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $basestrength += 1&gt;&gt;\
&lt;&lt;set $baseagility += 1&gt;&gt;\
&lt;&lt;set $valesword = 2&gt;&gt;\
&lt;&lt;set $weaponinventory.push($steelgreatsword)&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\

&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="61" name="ValeGold" tags="" position="1103,1455" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\

As you wander through the Scarlet Vale, you find an area where the forest has retained its healthy, green coloring. Walking through this little refuge, you spot a curious thing indeed - a treasure chest, glowing with gold coins.
&lt;img src=&quot;Images/ScarletVale/gold1.jpg&quot; width=650 /&gt;

[[Run towards the treasure!-&gt;ValeGold][$p = 1, $i = 1]]
[[Cautiously approach-&gt;ValeGold][$p = 1, $i = 2]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;You run towards the glittering treasure, eager to take its riches.&lt;&lt;else&gt;&gt; You cautiously walk towards the treasure, expecting some kind of trap. As far as you can tell, it appears to be safe.&lt;&lt;/if&gt;&gt; On the treasure&#39;s lid, words have been carved into the wood.

&lt;i&gt;Gods, heed my prayer: let this treasure provide be saved for a &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;man of purpose and unyielding will.&lt;&lt;else&gt;&gt;woman of grace and ceaseless virtue&lt;&lt;/if&gt;&gt;.&lt;/i&gt;

It seems the writer&#39;s prayers were answered. Likely this part of the Scarlet Vale is protected by the Gods, and untouched by the creatures that now haunt it.

&lt;i&gt;You gained 350 gold!&lt;/i&gt;

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $gold += 350&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;/if&gt;&gt;\
</tw-passagedata><tw-passagedata pid="62" name="DeathGuardIntro" tags="" position="806,1918" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
You are wandering through the outskirts when you spot something odd. A goblin, sticking out its tongue, mostly hidden by the undergrowth. Drawing your weapon and stepping close, you pull back the vines and face your foe.

Only to find that the goblin is dead. And its body is missing.
&lt;img src=&quot;Images/Outskirts/goblinhead1.jpg&quot; width=450 /&gt;

Forming grisly trophies out of the fallen to warn the others against retaliation is a harsh tactic of war. You know of only one knightly order in the Kingdom that still makes use such bloody work.

The Deathguard.

Just then, you hear footsteps behind you.

[[Turn around-&gt;DeathGuardIntro][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;deathguard1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;deathguard&quot;&gt;&gt;\

Two soldiers and one captain of the Deathguard approach you, their blades drawn and wet with goblin blood.
&lt;img src=&quot;Images/Character/deathguard1.jpg&quot; width=600 /&gt;

&lt;&lt;DomitusTalk &quot;You - you&#39;re human. State your business in this forsaken woodland.&quot;&gt;&gt; \
You&#39;ve seen the Deathguard in action before. They&#39;re a closeknit group of knights, sworn to defend the Kingdom against the malice and trickery of elves. Some call them paranoid, even fanatical.

You don&#39;t want to draw their ire.
&lt;&lt;HeroTalk &quot;I am $name $title, sworn agent of the king. I was sent to the Deep Woods on his request, to root out the evil in this land.&quot;&gt;&gt; \

The captain stares at you for a long while, testing your words for truth, at last, he nods his head.
&lt;&lt;DomitusTalk &quot;Yes, we received word we might cross path with one such as you. I am Captain Domitus of the Holy and Unyielding Deathguard.&quot;&gt;&gt;\

[[Ask Captain Domitus what he and his men are doing in the Deep Woods-&gt;DeathGuardIntro][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;HeroTalk &quot;What brings the Deathguard into the Deep Woods?&quot;&gt;&gt; \
&lt;&lt;DeathguardTalk &quot;Watch your tone - we need not answer to any but the king.&quot;&gt;&gt;\
&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; raises a hand to silence his soldier.
&lt;&lt;DomitusTalk &quot;We&#39;ve heard reports of a pair of elves running amok in the woods. Survivors of our great victory at Hadamshal, perhaps. They will be shown the King&#39;s justice.&quot;&gt;&gt;\
Which is to say, they&#39;ll both be killed. While you hold no affection for the Deathguard - you do appreciate having more of the King&#39;s men in the Deep Woods.
&lt;&lt;DomitusTalk &quot;All we&#39;ve found in the Outskirts are crazed goblins. We venture next to the Scarlet Vale. Be ever vigilant, $name $title.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Same to you, Captain.&quot;&gt;&gt; \

The Deathguard leave without another word. You only sheath your weapon when you can no longer hear their footsteps.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="63" name="Witch2" tags="" position="1103,1563" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;witch1_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
&lt;&lt;if $time eq &quot;Night&quot;&gt;&gt;It is late, and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; is asleep. 
&lt;img src=&quot;Images/Locations/night3.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;I&#39;ll visit her in the morning.&quot;&gt;&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;else&gt;&gt;Walking through the clearing beside your cabin, you see that &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; has made a new home for herself, not too far from &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; shop.
&lt;img src=&quot;Images/Locations/hut1.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;How did she set this up so quickly?&quot;&gt;&gt;\
Just as you ask the question, the Scarlet Witch steps out of her hut, looking pleased to see you.

&lt;&lt;WitchTalk &quot;I&#39;ve been waiting for you, $name. Come, let&#39;s go for a walk. We have much to talk about.&quot;&gt;&gt;\
You don&#39;t trust the witch for a moment... but she&#39;s your only lead on finding the elf girl. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, she called her.

[[Follow the witch-&gt;Witch2][$p = 1]]
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 1&gt;&gt;\
You and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; walk to the edge of the trees.
&lt;&lt;WitchTalk &quot;I know you still wish to chase after your elf thief. But first, there&#39;s something you should know about the Deep Woods.&quot;&gt;&gt;\
You nod, beckoning for her to speak.
\
&lt;&lt;WitchTalk &quot;These Woods were not always the dark, haunted place you know them to be. Once, an elven kingdom thrived, here. These woods were called the Grove of the Goddess, then.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Locations/city1.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;The Grove of the Goddess?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;The mother Goddess, Tylae, yes. It is said that these woods were where she first set foot on this barren world, and began her grand Creation. It is also said these Woods are where her Creation will be undone.&quot;&gt;&gt;\
Dark words.

You wonder what to ask her next.
\
&lt;&lt;set $a = 0&gt;&gt;\
&lt;&lt;set $b = 0&gt;&gt;\
&lt;&lt;set $c = 0&gt;&gt;\

[[What happened to the elven kingdom in the Deep Woods?-&gt;Witch2][$p = 2, $a = 1]]
[[The undoing of Tylae&#39;s creation... is that the &#39;Void&#39; those monsters speak of?-&gt;Witch2][$p = 2, $b = 1]]
[[What do you know about the Redeemer?-&gt;Witch2][$p = 2, $c = 1]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;if $a eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;What happened to the elven kingdom in the Deep Woods?&quot;&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; shakes her head. 
&lt;&lt;WitchTalk &quot;No one knows. My research into the ruins in these Woods make it clear that the elves became obsessed with predicting - and stopping - the end of the world. Then there was some kind of disaster, and the kingdom fell apart.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Locations/city2.jpg&quot; width=700 /&gt;

&lt;&lt;WitchTalk &quot;Evil has haunted this land forever since. Tylae&#39;s touch can still be felt, but only faintly.&quot;&gt;&gt;\
&lt;&lt;set $a = 2&gt;&gt;\
\
&lt;&lt;elseif $b eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;The undoing of Tylae&#39;s creation... is that the &#39;Void&#39; those monsters speak of?&quot;&gt;&gt;\
&lt;img src=&quot;Images/ScarletVale/vale2.jpg&quot; width=450 /&gt;
&lt;&lt;WitchTalk &quot;Those monsters are actually the guardians of the Deep Woods. They used to be kind to me, and brought harm only to those who sought to hurt this place.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Yet now they kill on sight.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;They&#39;ve been corrupted by the Redeemer. But I will save them.&quot;&gt;&gt;\
&lt;&lt;set $b = 2&gt;&gt;\
\
&lt;&lt;elseif $c eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;What do you know of the Redeemer?&quot;&gt;&gt;\
&lt;img src=&quot;Images/Character/redeemer1.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;Very little. He arrived in the Deep Woods three years ago, and came to me, interested in the elven ruins. He soon hired a tribe of goblins to aid him in his work. I thought him a lone adventurer eager for treasure, nothing more.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;There&#39;s something you should know...&quot;&gt;&gt;\
As the two of you walk through the trees, you tell &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; of your conversation with &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&lt;/b&gt;&lt;/span&gt;, the Goblin King.
&lt;&lt;WitchTalk &quot;I&#39;ve never heard of such a portal. And you say that Naya now possesses its key? I fear she&#39;s in grave danger.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Danger!? She &lt;i&gt;is&lt;/i&gt; the danger! She must be in league with the Redeemer.&quot;&gt;&gt;\
The witch shakes her head.
&lt;&lt;WitchTalk &quot;When we spoke, she struck me as true of heart. Not like that blackhearted fiend. And ever since I helped Naya, the Redeemer has sought my death. No, I think the two are enemies.&quot;&gt;&gt;\
&lt;&lt;set $c = 2&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\

You wonder what to ask her next.

&lt;&lt;if $a eq 0&gt;&gt;[[What happened to the elven kingdom in the Deep Woods?-&gt;Witch2][$p = 2, $a = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;What happened to the elven kingdom in the Deep Woods?&lt;/span&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if $b eq 0&gt;&gt;[[The undoing of Tylae&#39;s creation... is that the &#39;Void&#39; those monsters speak of?-&gt;Witch2][$p = 2, $b = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;The undoing of Tylae&#39;s creation... is that the &#39;Void&#39; those monsters speak of?&lt;/span&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if $c eq 0&gt;&gt;[[What do you know about the Redeemer?-&gt;Witch2][$p = 2, $c = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;What do you know about the Redeemer?&lt;/span&gt; &lt;&lt;/if&gt;&gt;
&lt;&lt;if ($a eq 2) and ($b eq 2) and ($c eq 2)&gt;&gt;[[Tell me how to find Naya-&gt;Witch2][$p = 3]] &lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Tell me how to find Naya&lt;/span&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 3&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;I appreciate your insights, Scyllia - though I haven&#39;t yet put all the pieces together, I&#39;m beginning to think that the Redeemer hopes to get ahold of whatever destroyed that old elven kingdom.&quot;&gt;&gt;\
The witch nods in sharp agreement.
&lt;&lt;WitchTalk &quot;He must be stopped - which means the crystal Naya holds must be destroyed.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Indeed! Tell me, then. Where is Naya? I must find her before the Redeemer does.&quot;&gt;&gt;\
After a moment&#39;s silence, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; whispers her answer, her voice filled with dread.
&lt;&lt;WitchTalk &quot;The Tower of Zyr.&quot;&gt;&gt;\

[[The Tower of Zyr?-&gt;Witch2][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer1_bgm&quot; volume 0.5 play loop&gt;&gt;\
&lt;&lt;WitchTalk &quot;It&#39;s a tower built by that old elven kingdom, where they kept arcane artifacts of unbelievable power. Naya believed she could cure the guardians of the Deep Woods with the magic of the Tower, so I showed her the way there.&quot;&gt;&gt;\
&lt;img src=&quot;Images/ScarletVale/tower2.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;Take me there.&quot;&gt;&gt;\
She shakes her head.
&lt;&lt;WitchTalk &quot;The Tower is warded against trespass. I can get you past the wardings, but for such an encantation I will need a specific reagent. A crystal heart.&quot;&gt;&gt;\
&lt;img src=&quot;Images/ScarletVale/crystalheart1.jpg&quot; width=450 /&gt;

Another quest. Nothing is ever easy.
&lt;&lt;HeroTalk &quot;And where will I find such a thing?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Wander deep into the Scarlet Vale. Seek out a Scarlet Destroyer - the most powerful of the Wood&#39;s guardians. Slay it, and tear free the crystal heart within its flesh. Then I shall take you to the Tower of Zyr.&quot;&gt;&gt;\

[[The hunt begins-&gt;Outside the Cabin]] 

&lt;&lt;set $witchstatus = 2&gt;&gt;\
&lt;&lt;set $valequest = 6&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="64" name="Witch3" tags="" position="1102,1677" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;witch1_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
&lt;&lt;if $time eq &quot;Night&quot;&gt;&gt;It is late, and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; is asleep. 
&lt;img src=&quot;Images/Locations/night3.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;I&#39;ll visit her in the morning.&quot;&gt;&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;else&gt;&gt;\
Walking through the clearing beside your cabin, you spot &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;. 
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;Tell me, $name, have you brought me a crystal heart?&quot;&gt;&gt;\

&lt;&lt;if $valequest eq 7&gt;&gt;[[Yes-&gt;Witch3][$p = 2]] &lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Yes&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Not yet-&gt;Witch3][$p = 1]]

&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;Not yet.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Then hurry! Find a Scarlet Destroyer deep in the Vale and slay it. Only with the magic from its crystal heart can I safely bring you to the Tower of Zyr.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Is there no other way for us to find Naya?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;None. Now go - do not delay any longer!&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;elseif $p eq 2&gt;&gt;\
From your pack you pull out the crystal heart.
&lt;img src=&quot;Images/ScarletVale/crystalheart1.jpg&quot; width=500 /&gt;

&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; admires its radiant glow.
&lt;&lt;WitchTalk &quot;Well done, $name. Come, we will perform the ritual at your shrine.&quot;&gt;&gt;\

[[Follow Scyllia-&gt;Witch3][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
As you and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; walk to the shrine, she casts down her hood and lets sunlight lighten her brow.
&lt;&lt;WitchTalk &quot;As you might have already guessed, I&#39;m not truly a &#39;Scarlet Witch.&#39; There&#39;s no such thing.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You&#39;re a priestess of Tylae, aren&#39;t you?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;&lt;i&gt;The&lt;/i&gt; priestess, yes. Charged with protecting the Deep Woods. But I am no match for the Redeemer and his machinations. Nor are you, yet.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;What do you mean?&quot;&gt;&gt;\
The two of you have arrived at your shrine.
&lt;img src=&quot;Images/Locations/shrine2.jpg&quot; width=650 /&gt;

&lt;&lt;WitchTalk &quot;The crystal heart will enhance the Godshard you found in the Outskirts. Together, they will strengthen your divine bond. You&#39;ll need it, to stand against the Redeemer. Are you ready?&quot;&gt;&gt;\

[[Begin the ritual-&gt;Witch3][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;\

Once you kneel before the shrine, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; places the crystal health beside the &lt;b&gt;Godshard&lt;/b&gt;.
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;WitchTalk &quot;Holy Tylae, blessed mother, heed my prayer. The very threads of your Creation are being pulled apart. Here kneels a man who would stand against such evil. I beseech you: Lend him your ward.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;WitchTalk &quot;Holy Tylae, blessed mother, heed my prayer. The very threads of your Creation are being pulled apart. Here kneels a woman who would stand against such evil. I beseech you: Lend her your ward.&quot;&gt;&gt;\ &lt;&lt;/if&gt;&gt;

The shrine glows in response. From within its pool rises a torrent of blue and orange lights, intertwined. 
&lt;img src=&quot;Images/Locations/shrine7.jpg&quot; width=450 /&gt;

Then the lights soar downwards, and pierce your heart.

[[Darkness-&gt;Witch3][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;\
\
@@.delayed;You&#39;re drifting a sea of darkness.@@ 

@@.delayed;Then, a light.@@ @@.delayed;A woman.@@
@@.delayed;@@
\
@@.delayed;&lt;img src=&quot;Images/Locations/tylae1.jpg&quot; width=550 /&gt;@@

@@.delayed;...@@

@@.delayed;&lt;&lt;HeroTalk &quot;... can it be? Tylae?&quot;&gt;&gt;@@

@@.delayed;[[...-&gt;Witch3][$p = 6]]@@

&lt;&lt;elseif $p eq 6&gt;&gt;\
@@.delayed;@@
@@.delayed;&lt;&lt;TylaeTalk &quot;Is this the child who will set right what once went wrong?&quot;&gt;&gt;@@ \
@@.delayed;@@ \
@@.delayed;&lt;&lt;HeroTalk &quot;I will.&quot;&gt;&gt;@@ \
@@.delayed;@@ \
@@.delayed;&lt;&lt;TylaeTalk &quot;You seek your redemption?&quot;&gt;&gt;@@ \
@@.delayed;@@ \
@@.delayed;&lt;&lt;HeroTalk &quot;I do.&quot;&gt;&gt;@@ \
@@.delayed;@@ \
@@.delayed;&lt;&lt;TylaeTalk &quot;Would you fight for it? Bleed for it?&quot;&gt;&gt;@@ \
@@.delayed;@@ \
@@.delayed;&lt;&lt;HeroTalk &quot;Yes!&quot;&gt;&gt;@@ \
@@.delayed;@@ \
@@.delayed;&lt;&lt;TylaeTalk &quot;Die for it?&quot;&gt;&gt;@@ \
@@.delayed;@@ \
@@.delayed;&lt;&lt;HeroTalk &quot;...&quot;&gt;&gt;@@ \
\
@@.delayed;[[Awaken-&gt;Witch3][$p = 7]]@@

&lt;&lt;elseif $p eq 7&gt;&gt;\
When you open your eyes, it is night, and the sky is full of stars.
&lt;img src=&quot;Images/Locations/night3.jpg&quot; width=650 /&gt;

&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; stands over you.
&lt;&lt;WitchTalk &quot;It worked. You&#39;ve been blessed with Tylae&#39;s ward.&quot;&gt;&gt;\

&lt;b&gt;Tylae&#39;s&lt;/b&gt; ward flows within you!

&lt;i&gt;Your Strength has increased by 3!&lt;/i&gt;
&lt;i&gt;Your Agility has increased by 3!&lt;/i&gt;
&lt;i&gt;Your Willpower has increased by 3!&lt;/i&gt;

&lt;&lt;WitchTalk &quot;The Tower of Zyr will open for you, now. Before you leave, you would be wise to speak to me in the morning. There is one more thing I can give you, to prepare you for the horrors within the tower.&quot;&gt;&gt;\

[[Rise-&gt;Outside the Cabin]] 

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $valequest = 8&gt;&gt;\
&lt;&lt;set $witchstatus = 4&gt;&gt;\
\
&lt;&lt;set $basestrength += 3&gt;&gt;\
&lt;&lt;set $baseagility += 3&gt;&gt;\
&lt;&lt;set $basewillpower += 3&gt;&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="65" name="StarNectar" tags="" position="1102,1802" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
\
You are wandering through the Scarlet Vale whn you spot a tree you haven&#39;t seen before. Thick of trunk and many-branched, it towers over the red-tinged foilage below it. Among its flowers are a few glowing, turqouise bundles of brightness.
&lt;img src=&quot;Images/ScarletVale/fruit3.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;Star Nectar. Babar Ogho was looking for such a prize.&quot;&gt;&gt;

You deftly climb the tree and pull off one of the closer fruits. It comes free without much effort, and for a moment you stare at it, entranced by the shimmering juices shining beneath its translucent skin.

Just as you slip it into your pack, you get the feeling that you&#39;re not alone.

[[Look up-&gt;StarNectar][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
Glancing up, you see that you&#39;re being watched from the further branches.
&lt;img src=&quot;Images/ScarletVale/vale2.jpg&quot; width=500 /&gt;

&lt;&lt;ScarletAmbusherTalk &quot;Slay the interloper!&quot;&gt;&gt;\
The creature leaps at you, its vines wiping at your hands! 

&lt;b&gt;Agility Check&lt;/b&gt;
&lt;&lt;AgilityCheck 55&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;You nimbly avoid the attack, then scamper off the tree and draw your weapon.\
&lt;&lt;else&gt;&gt;You lose your grip on the branch and drop fifteen paces to the ground below.

&lt;&lt;set $currenthealth -= 50&gt;&gt;\
&lt;i&gt;You lost 50 health!&lt;/i&gt;&lt;&lt;/if&gt;&gt;\

The creature follows you to the ground, hissing in anticipation.
&lt;&lt;HeroTalk &quot;Face me, monster!&quot;&gt;&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ScarletAmbusherStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 1&gt;&gt; \

&lt;&lt;elseif $p eq 20&gt;&gt;\
\
&lt;&lt;if $battletotal eq 1&gt;&gt;The plant lies dead on your feet, its sap oozing out from its many wounds.
&lt;&lt;BattleEnd&gt;&gt;\

Before you can catch your breath, a second leaps down from the tree, taking the place of the fallen.
&lt;&lt;ScarletAmbusherTalk &quot;The Void cannot be stopped!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ScarletAmbusherStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 2&gt;&gt; \

&lt;&lt;elseif $battletotal eq 2&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;\
The second monster drops dead before you. Two more remain in the tree above, but seeing their fellows slain, they slink back into the canopy.
&lt;&lt;BattleEnd&gt;&gt;\

As you gasp for breath, you pull the Star Nectar from your pack and give it a long look.
&lt;img src=&quot;Images/ScarletVale/fruit2.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Babar... this better be worth it.&quot;&gt;&gt;
&lt;&lt;set $enemyexp = 200&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
\
&lt;&lt;set $merchantstatus = 7&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="66" name="Destroyer" tags="" position="1101,1914" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
\
You are wandering through the Scarlet Vale when you see a long line of broken trees. It appears that something massive passed through this area, recently.
&lt;img src=&quot;Images/ScarletVale/vale10.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;This might lead me to the Scarlet Destroyer Scyllia asked me to slay. I need its crystal heart, but it could prove to be a fearsome foe.&quot;&gt;&gt; \

[[Retreat, for now-&gt;Outside the Cabin]] 
[[Pursue the Destroyer-&gt;Destroyer][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
As you follow the trail, the sky appears to darken. Droplets of cold rain fall upon your face. Soon, the start of a storm has swallowed the Scarlet Vale.
&lt;img src=&quot;Images/ScarletVale/vale11.jpg&quot; width=600 /&gt;

You carry on, unhindered by the storm. Amid the flash of lightning and roar of thunder, you feel a trembling, beneath you feet. Something is moving towards you. Something large.

There is a sudden crash as the trees before you are torn asunder. 

[[Behold the Destroyer-&gt;Destroyer][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle4_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\

The Destroyer looms over you, larger than any troll you&#39;ve ever seen. From deep in its chest comes a deep, paralyzing roar.
&lt;img src=&quot;Images/ScarletVale/plant1.jpg&quot; width=500 /&gt;

&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt;&lt;&lt;HeroTalk &quot;For Myridia! For blood and victory!&quot;&gt;&gt; \
&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;&lt;HeroTalk &quot;For Sathael! For the lord of shadows!&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;For Iulius! Justice shall triumph!&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ScarletDestroyerStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

Plunging your hand into the fallen Destroyer, you push through the sap and sinew until you touch something hard. Grabbing it, you pull forth the crystal heart.
&lt;img src=&quot;Images/ScarletVale/crystalheart1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;I should bring this artifact to Scyllia...&quot;&gt;&gt; \

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $valequest = 7&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="67" name="Tower Entrance" tags="" position="1239,177" size="100,100">&lt;&lt;if $valequest gte 15&gt;&gt;&lt;&lt;if $music neq &quot;vale&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You are standing before the ruins of the Tower of Zyr.
&lt;img src=&quot;Images/ScarletVale/tower19.jpg&quot; width=600 /&gt;

&lt;&lt;if $witchstatus eq 13&gt;&gt;\
[[Meet Scyllia and face the dragon-&gt;Dragon1][$p = 0]]&lt;&lt;/if&gt;&gt;
[[Return to your cabin-&gt;Outside the Cabin]] 

&lt;&lt;elseif $valequest eq 8&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $music neq &quot;vale&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

Using &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; directions, you travel deep into the Scarlet Vale, then cross through a small dell between two sharp, barren hills. As you traverse the dell, a beaten dirt path becomes visible. Then it changes, shifting to broken stone.

A ruined road. Elven, most likely.
&lt;&lt;HeroTalk &quot;I&#39;m getting close.&quot;&gt;&gt; \

After a few more bends in the road, you pass the dell and enter a lush, green valley, a hidden oasis in the Scarlet Vale. Tall peaks guard it from sight. And there, in the center...
&lt;img src=&quot;Images/ScarletVale/tower1.jpg&quot; width=700 /&gt;

The Tower of Zyr. If &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; spoke true, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; hides within, still in possession of the Redeemer&#39;s dark crystal.

[[Cross the bridge-&gt;Tower Entrance][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;deathguard1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;deathguard&quot;&gt;&gt;\
\
Water streams down from mountains overhead, pouring down to the Tower&#39;s base far below. The whole valley is alive with the distant roar of the falls.

As you near the bridge&#39;s end, you spot a troop of armored men, standing before the Tower&#39;s open door. You recognize them.

The Deathguard.
&lt;img src=&quot;Images/Character/deathguard1.jpg&quot; width=600 /&gt;

A scout quickly sees you approaching, and signals for his captain. 
&lt;&lt;DomitusTalk &quot;$name $title! So, you still breathe.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;You sound surprised.&quot;&gt;&gt; \
He stares at you, his skull-helmet glittering in the sunlight.
&lt;&lt;DomitusTalk &quot;What brings you to this dark tower?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;The object of my quarry lies within. The source of the Deep Wood&#39;s evil.&quot;&gt;&gt; \
&lt;&lt;DomitusTalk &quot;Then our paths are aligned. We had nearly caught an elf girl before she fled inside. This entire tower must be destroyed. It stinks of elf trickery.&quot;&gt;&gt; \
&lt;&lt;DeathguardTalk &quot;Death to the elves!&quot;&gt;&gt;\
You don&#39;t care that the Deathguard want &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; dead - but you can&#39;t let the crystal fall into their hands. You&#39;ll have to find her first.

[[Ask Domitus why he&#39;s stationed at the entrance.-&gt;Tower Entrance][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
You glance at the yawning entrance of the tower.
&lt;img src=&quot;Images/ScarletVale/tower3.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;How long until you begin your assault?&quot;&gt;&gt; \
&lt;&lt;DomitusTalk &quot;The tower doorway is blocked by ancient and cruel magic. My wizards will soon dispell it, or we&#39;ll blast our way in.&quot;&gt;&gt; \

He hefts a heavy, metallic bomb.
&lt;img src=&quot;Images/ScarletVale/bomb1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;I don&#39;t think the doorway&#39;s ward will give me pause. Find me once you make it inside.&quot;&gt;&gt; \
The Deathguard captain tilts his head.
&lt;&lt;DomitusTalk &quot;Eager to die, $name? I won&#39;t stop you. Be ever vigilant - and beware the trickery of elves.&quot;&gt;&gt; \

[[Enter the tower-&gt;Tower Entrance][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;tower1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;tower&quot;&gt;&gt;\
You march towards the open doorway. As you do, your skin begins to tingle. Magic is in the air.

Just as you pass the yawning arch, there&#39;s a flash of brilliant color. The air shifts. The wind dies. A chill trickles down your spine.
&lt;img src=&quot;Images/ScarletVale/tower4.jpg&quot; width=450 /&gt;

When the light fades, you find yourself standing in a dark, windowless room, built of ancient stone of elven design. Behind you is a closed door, likely leading back out.

You&#39;ve clearly teleported somewhere in the tower. The Tower of Zyr is steeped in old magic...
&lt;&lt;HeroTalk &quot;I&#39;ll need to keep my guard up...&quot;&gt;&gt; \

[[Venture on-&gt;Tower1][$p = 0]]

&lt;&lt;set $valequest = 9&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $valequest gte 9&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
You&#39;re standing before the great Tower of Zyr. The Deathguard are nowhere in sight.
&lt;img src=&quot;Images/ScarletVale/tower1.jpg&quot; width=700 /&gt;

[[Enter the Tower-&gt;Tower1][$p = 0]]
[[Return to your cabin-&gt;Outside the Cabin]] 
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="68" name="Witch4" tags="" position="1101,2028" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;witch1_bgm&quot; volume 0.5 play loop&gt;&gt; &lt;&lt;set $music = &quot;witch&quot;&gt;&gt;\
\
&lt;&lt;if $time eq &quot;Night&quot;&gt;&gt;It is late, and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; is asleep. 
&lt;img src=&quot;Images/Locations/night3.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;I&#39;ll visit her in the morning.&quot;&gt;&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;else&gt;&gt;\
Walking through the clearing beside your cabin, you spot &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;. 
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;Tell me, $name, how does it feel to have Tylae&#39;s blessing flowing in your veins?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Stronger, certainly. My resolve was never in question, but it too feels empowered from her grace.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Good. You&#39;ll need every bit of that strength for what&#39;s to come.&quot;&gt;&gt;\

[[Heed Scyllia&#39;s words-&gt;Witch4][$p = 1]]
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;WitchTalk &quot;Now that Tylae has blessed you, I have no doubt that you are our best hope at besting the Redeemer. As such, I will serve you as a priestess for so long as you remain in the Deep Woods.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;And what can you offer me?&quot;&gt;&gt;\
Her staff flashes with arcane energy,
&lt;&lt;WitchTalk &quot;While your shrine can grant you new abilities, I can in turn take those abilities and empower them, making them stronger than ever before.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Impressive.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;And should you be overstretched, burdened with too many abilities, I can draw one out of you, restoring a portion of the experience to your soul.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;ll be sure to call on your powers, Scyllia.&quot;&gt;&gt;\
She bows her head.
&lt;&lt;WitchTalk &quot;Of course. May Tylae watch over you, $name.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $witchstatus = 5&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="69" name="Witch5" tags="" position="604,861" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
\
&lt;&lt;if $time eq &quot;Night&quot;&gt;&gt;It is late, and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; is asleep. 
&lt;img src=&quot;Images/Locations/night3.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;I&#39;ll visit her in the morning.&quot;&gt;&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;else&gt;&gt;\
&lt;&lt;if $music neq &quot;witch&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;witch1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;witch&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You approach &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; hut. 
&lt;img src=&quot;Images/Locations/hut1.jpg&quot; width=650 /&gt;

[[Empower Abilities-&gt;Witch5][$p = 1]]
[[Unlearn Abilities-&gt;Witch5][$p = 3]]
&lt;&lt;if $witchstatus eq 10&gt;&gt;[[Ask Scyllia for advice-&gt;Witch5][$p = 5]]&lt;&lt;elseif ($frozenquest gte 5) and ($witchstatus eq 11)&gt;&gt;[[Speak to Scyllia-&gt;Witch5][$p = 7]]&lt;&lt;elseif $witchstatus eq 14&gt;&gt;[[Speak to Scyllia-&gt;Witch5][$p = 10]]&lt;&lt;elseif ($finalquest gte 8) and ($spoketowitch eq 0)&gt;&gt;[[Speak to Scyllia about death-&gt;Witch5][$p = 28]]&lt;&lt;elseif ($finalquest gte 12) and ($spoketowitch eq 1)&gt;&gt;[[Speak to Scyllia about Jhuun&#39;s revelation-&gt;Witch5][$p = 30]]&lt;&lt;elseif ($witchstatus gte 20) and ($dragon eq 1)&gt;&gt;[[Scyllia is expecting you-&gt;Witch5][$p = 14]]&lt;&lt;elseif $witchstatus eq 20&gt;&gt;[[Speak to Scyllia-&gt;Witch5][$p = 16]]&lt;&lt;elseif ($witchstatus eq 21) and ($finalquest gte 2)&gt;&gt;[[Speak to Scyllia-&gt;Witch5][$p = 18]]&lt;&lt;elseif $witchstatus eq 24&gt;&gt;[[Give Scyllia the skull-&gt;Witch5][$p = 20]]&lt;&lt;/if&gt;&gt;
[[Return-&gt;Outside the Cabin]]
&lt;&lt;if ($lewdmode eq 1) and ($gender eq &quot;male&quot;) and ($witchlove eq 10) and ($frozenquest gte 1) and ($finalquest lte 0)&gt;&gt;\
[[Seduce Scyllia-&gt;Witch Lewd][$p = 0]]
&lt;&lt;elseif ($lewdmode eq 1) and ($witchlove lte 11) and ($witchawareness eq 0) and ($pussy eq 4)&gt;&gt;\
[[Spy on Scyllia-&gt;Witch Lewd][$p = 10]]
&lt;&lt;elseif ($lewdmode eq 1) and ($witchlove eq 12) and ($finalquest lt 6)&gt;&gt;\
[[Speak to Scyllia about your body-&gt;Witch Lewd][$p = 16]]
&lt;&lt;elseif ($lewdmode eq 1) and ($witchlove eq 14) and ($finalquest lt 6)&gt;&gt;\
[[Speak to Scyllia about your powerful urges-&gt;Witch Lewd][$p = 28]]
&lt;&lt;elseif ($lewdmode eq 1) and ($witchlove eq 16) and ($finalquest lt 1)&gt;&gt;\
[[Speak to Scyllia about twice blessed women-&gt;Witch Lewd][$p = 37]]
&lt;&lt;elseif ($lewdmode eq 1) and ($witchlove eq 19) and ($finalquest lt 1)&gt;&gt;\
&lt;i&gt;You&#39;re too focused on defeating Duke Carnax to speak to Scyllia about the staff. Return here once Carnax has been dealt with.&lt;/i&gt;
&lt;&lt;elseif ($lewdmode eq 1) and ($witchlove eq 21) and ($finalquest lt 1)&gt;&gt;\
&lt;i&gt;You&#39;re too focused on defeating Duke Carnax to give Scyllia the staff. Return here once Carnax has been dealt with.&lt;/i&gt;
&lt;&lt;elseif ($lewdmode eq 1) and ($witchlove eq 19)&gt;&gt;\
[[Speak to Scyllia about the staff-&gt;Witch Lewd][$p = 46]]
&lt;&lt;elseif ($lewdmode eq 1) and ($witchlove eq 21)&gt;&gt;\
[[Give Scyllia the staff-&gt;Witch Lewd][$p = 49]]
&lt;&lt;/if&gt;&gt;\

&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 1&gt;&gt;\
\
&lt;&lt;WitchTalk &quot;Steel yourself, $name. It takes a stalwart spirit to empower an ability...&quot;&gt;&gt;\

&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $abilityinventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:75%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $abilityinventory[_i].name&gt;&gt;&lt;/b&gt; 
	Current Ability Level: &lt;&lt;print $abilityinventory[_i].level&gt;&gt;
	Empowerment Exp Cost: &lt;&lt;print $abilityinventory[_i].levelexp&gt;&gt;
	Empowerment Description: &lt;&lt;print $abilityinventory[_i].leveldescription&gt;&gt;
	&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $exp gte $abilityinventory[_i].levelexp&gt;&gt;&lt;&lt;link &quot;Empower Ability&quot; Witch5&gt;&gt; \
	&lt;&lt;set $abilityname = $abilityinventory[_i].name&gt;&gt;\
	&lt;&lt;set $abilitycost = $abilityinventory[_i].levelexp&gt;&gt;\
	&lt;&lt;set $abilityinventory[_i].levelexp = $abilityinventory[_i].levelexp*2&gt;&gt;\
	&lt;&lt;set $abilitywidgetname = $abilityinventory[_i].widgetname&gt;&gt;\
	&lt;&lt;set $abilityinventory[_i].mana += $abilityinventory[_i].levelmana&gt;&gt;\
	&lt;&lt;if $abilityinventory[_i].mana lt 5&gt;&gt; &lt;&lt;set $abilityinventory[_i].mana = 5&gt;&gt; &lt;&lt;/if&gt;&gt;\
	&lt;&lt;set $abilityinventory[_i].level += 1&gt;&gt;\
	&lt;&lt;set $p = 2&gt;&gt;\
	&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;i&gt;Not enough experience&lt;/i&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;AbilityImage $abilityinventory[_i].widgetname 200&gt;&gt;&lt;&lt;/AbilityImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;/table&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;i&gt;&lt;b&gt;Note:&lt;/b&gt; The cost to empower an ability is doubled each time it is empowered.&lt;/i&gt;
&lt;i&gt;&lt;b&gt;Note:&lt;/b&gt; an empowered ability&#39;s mana cost can never be reduced below 5 mana.&lt;/i&gt;

&lt;&lt;elseif $p eq 2&gt;&gt;\
Drawing upon your spirit, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; has empowered an ability!
&lt;&lt;AbilityImage $abilitywidgetname 400&gt;&gt;&lt;&lt;/AbilityImage&gt;&gt;

&lt;i&gt;&lt;b&gt;$abilityname&lt;/b&gt; is now more powerful in battle!&lt;/i&gt;

[[Return-&gt;Witch5][$p = 0]]
\
&lt;&lt;set $exp -= $abilitycost&gt;&gt;\
\
&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;WitchTalk &quot;Unlearning an ability will free your spirit to draw upon new divine skills. You will also regain a portion of the power used to learn the ability.&quot;&gt;&gt;\

&lt;b&gt;Ability Total:&lt;/b&gt; $abilitytotal / $abilitymax

&lt;table class=&quot;stat-table&quot;&gt;\
&lt;&lt;for _i to 0; _i lt $abilityinventory.length; _i++&gt;&gt;
&lt;tr&gt;\
&lt;td style=&quot;width:75%&quot;&gt;&lt;&lt;print _i + 1&gt;&gt;. &lt;b&gt;&lt;&lt;print $abilityinventory[_i].name&gt;&gt;&lt;/b&gt; 
	Level: &lt;&lt;print $abilityinventory[_i].level&gt;&gt;
	Mana Cost: &lt;&lt;print $abilityinventory[_i].mana&gt;&gt;
	Description: &lt;&lt;print $abilityinventory[_i].description&gt;&gt;
	&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;link &quot;Unlearn Ability&quot; Witch5&gt;&gt;
	&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;&lt;set $paladinabilityinventory.push($abilityinventory[_i])&gt;&gt;\
	&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;&lt;set $rogueabilityinventory.push($abilityinventory[_i])&gt;&gt;\
	&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;&lt;&lt;set $soldierabilityinventory.push($abilityinventory[_i])&gt;&gt; &lt;&lt;/if&gt;&gt;\
	&lt;&lt;set $abilityname = $abilityinventory[_i].name&gt;&gt;\
	&lt;&lt;set $abilitywidgetname = $abilityinventory[_i].widgetname&gt;&gt;\
	&lt;&lt;set $abilitycost = $abilityinventory[_i].exp*0.5&gt;&gt;\
	&lt;&lt;set $abilitycost = Math.round($abilitycost)&gt;&gt;\
	&lt;&lt;set $abilityinventory.delete($abilityinventory[_i])&gt;&gt;\
	&lt;&lt;set $p = 4&gt;&gt;\
	&lt;&lt;/link&gt;&gt;\
	&lt;&lt;/capture&gt;&gt;\
	&lt;/td&gt;\
	&lt;td&gt;&lt;&lt;AbilityImage $abilityinventory[_i].widgetname 200&gt;&gt;&lt;&lt;/AbilityImage&gt;&gt; &lt;/td&gt;\
	&lt;/tr&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;/table&gt;\

[[Return-&gt;Outside the Cabin]] 
\
&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; has enabled you to unlearn an ability!
&lt;&lt;AbilityImage $abilitywidgetname 400&gt;&gt;&lt;&lt;/AbilityImage&gt;&gt;

&lt;i&gt;&lt;b&gt;$abilityname&lt;/b&gt; is no longer usable in battle! It can be relearned at the Shrine.&lt;/i&gt;
&lt;&lt;set $abilitytotal -= 1&gt;&gt;\

&lt;i&gt;You regain $abilitycost experience points!&lt;/i&gt;

&lt;b&gt;New Ability Total:&lt;/b&gt; $abilitytotal / $abilitymax

[[Return-&gt;Witch5][$p = 0]]
\
&lt;&lt;set $exp += $abilitycost&gt;&gt;\
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; nods as you approach.
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;$name, how might I aid you?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;The Frozen Hills are as vast as they are cold. Could Tylae perhaps reveal to us the location of the Winter Palace?&quot;&gt;&gt;\
She chuckles.
&lt;&lt;WitchTalk &quot;I&#39;m afraid not. You are her champion in the Deep Woods, now. She has carved the path in fate, but it is you who must walk it.&quot;&gt;&gt;\
You expected as much.
&lt;&lt;HeroTalk &quot;I am on my own, then.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Not entirely. I might be able to provide some small help.&quot;&gt;&gt;\

[[She pulls a pouch from her cloak-&gt;Witch5][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
The pouch is full of gold.
&lt;img src=&quot;Images/FrozenHills/spring2.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;What&#39;s this?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Babar looted the Tower of Zyr once it exploded. I forgave his sin, in exchange for a donation in Tylae&#39;s name.&quot;&gt;&gt;\
She passes the gold to you.
&lt;&lt;WitchTalk &quot;But what use have I of gold? Take it, $name, and buy a trinket from Babar with his own treasure. It serves him right.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;My thanks, Scyllia.&quot;&gt;&gt;\
She gives a small bow.
&lt;&lt;WitchTalk &quot;Blessings of the mother goddess upon you.&quot;&gt;&gt;\

&lt;i&gt;You gained 500 gold!&lt;/i&gt;

[[Return-&gt;Outside the Cabin][$p = 0]]

&lt;&lt;set $witchstatus = 11&gt;&gt;\
&lt;&lt;set $gold += 500&gt;&gt;\

&lt;&lt;elseif $p eq 7&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; waves you over.
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;$name, I was hoping we might talk.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course - what is it, Scyllia?&quot;&gt;&gt;\
She looks around, as if to make sure the two of you are alone.
&lt;&lt;WitchTalk &quot;There is nothing more important that our war against the Redeemer. It demands our full attention... but...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;But?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;As priestess of Tylae, it is my sacred duty to guard these woods from those who would do them harm.&quot;&gt;&gt;\

[[Ask her what she needs-&gt;Witch5][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
&lt;&lt;HeroTalk &quot;What troubles you?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;An unwanted guest has made the ruins of the Tower of Zyr its home. A dragon.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;... a dragon?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Indeed. Dragons are attracted to wealth, knowledge, and power. The Tower&#39;s spirit still dwells within the ruins, and the dragon seems keen on drawing that energy into itself. It must be stopped, before it names itself tyrant of the Woods.&quot;&gt;&gt;\
&lt;img src=&quot;Images/FrozenHills/dragon1.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;I understand. What would you have me do?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;An example must be set, lest more dragons come. It must be killed.&quot;&gt;&gt;\

[[Killed?-&gt;Witch5][$p = 9]]

&lt;&lt;elseif $p eq 9&gt;&gt;\
&lt;&lt;HeroTalk &quot;Slaying a dragon... it is beyond my strength.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;We will fight it together, $name. And we will first weaken it with a dragonhorn.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Items/Dragonhorn.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;And where can I find such an artifact?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;I believe Babar has one for sale. Once you have it in your possession, meet me at the Tower of Zyr. Be prepared, $name... even weakened, the dragon will prove a fearsome adversary.&quot;&gt;&gt;\

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;set $witchstatus = 12&gt;&gt;\
&lt;&lt;set $specialinventory.push($dragonhorn)&gt;&gt;

&lt;&lt;elseif $p eq 10&gt;&gt;\
When you approach &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, she&#39;s in the midst of prayer.
&lt;&lt;WitchTalk &quot;Blessed Tylae, consecrate these lands, and forever make them unwelcome to your errant, eldest children...&quot;&gt;&gt;\
Her eyes snap open, and she smiles warmly to you.
&lt;&lt;WitchTalk &quot;It is done. The Deep Woods will remain safe from the whims of dragons. For now, at least.&quot;&gt;&gt;\

[[What will become of the corpse?-&gt;Witch5][$p = 11]]

&lt;&lt;elseif $p eq 11&gt;&gt;\
&lt;&lt;WitchTalk &quot;I am not overly fond of profiteering off of holy work, but...&quot;&gt;&gt;\
She gestures in the direction of &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; shop.
&lt;&lt;WitchTalk &quot;Babar has already scoured the corpse for anything of value. The heart I needed for my ritual. He was able to find a few unspoiled scales and teeth. The rest was too damaged in our battle to be of use.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;So Babar will sell the scales for gold?&quot;&gt;&gt;\
She nearly laughs.
&lt;&lt;WitchTalk &quot;He certainly wants to. No, he will send the scales to the best smiths in the Capital and see about forging something of use for our fight against the Redeemer. Dragon scales make fine materials.&quot;&gt;&gt;\

[[What could be made?-&gt;Witch5][$p = 12]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
&lt;&lt;WitchTalk &quot;That is up to you, but three ideas come to my mind on how best to use the scales. The first would be to have an armor-smith forge a set of armor made with the might of Zaradras. Such armor would likely be heavy, but would withstand many blows and empower the wearer with health and strength.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Armor/Dragon Armor.jpg&quot; width=400 /&gt;

&lt;&lt;WitchTalk &quot;If that does not suit you, you could have a smith forge a set of gauntlets made with the speed and wickedness of Zaradras. Such gauntlets would be capable of drawing out health and mana from your foes.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Armor/Dragon Gauntlets.jpg&quot; width=400 /&gt;

&lt;&lt;WitchTalk &quot;And last, you could have a weapon-smith forge an axe made from the fire and brutality of Zaradras. Such a weapon would have power beyond measure, but would sap your own lifeforce with each attack.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Weapons/Dragon Axe.jpg&quot; width=400 /&gt;

[[Ask for the armor-&gt;Witch5][$p = 13, $i = 1]]
[[Ask for the gauntlets-&gt;Witch5][$p = 13, $i = 2]]
[[Ask for the axe-&gt;Witch5][$p = 13, $i = 3]]

&lt;&lt;elseif $p eq 13&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;I need something that can withstand the Redeemer&#39;s strength. Have the smiths forge me the set of armor.&quot;&gt;&gt;\
&lt;&lt;elseif $i eq 2&gt;&gt;&lt;&lt;HeroTalk &quot;So long as I can sustain myself, I can defeat the Redeemer. Have the smiths forge me the pair of gauntlets.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Only by raw power alone can I best the Redeemer. Have the smiths forge me the axe.&quot;&gt;&gt;\ &lt;&lt;/if&gt;&gt;
&lt;&lt;WitchTalk &quot;As you wish, $name. I will find you when it has arrived. Blessings of Tylae upon you.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $witchstatus = 15&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt; &lt;&lt;set $dragonitem = &quot;armor&quot;&gt;&gt;\
&lt;&lt;elseif $i eq 2&gt;&gt; &lt;&lt;set $dragonitem = &quot;gauntlets&quot;&gt;&gt;\
&lt;&lt;elseif $i eq 3&gt;&gt; &lt;&lt;set $dragonitem = &quot;axe&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;elseif $p eq 14&gt;&gt;\
When you approach &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, she&#39;s standing over a wooden box, marked with a wax insignia of the kingdom&#39;s capital.
&lt;&lt;WitchTalk &quot;It seems in our darkest moment, a bit of light has crept in. A seed, put to soil, has taken root.&quot;&gt;&gt;\
You raise a brow, curious as to her meaning.
&lt;&lt;WitchTalk &quot;The artifact you requested, following our battle with the dragon Zaradras. It is here.&quot;&gt;&gt;\

[[Open the box-&gt;Witch5][$p = 15]]

&lt;&lt;elseif $p eq 15&gt;&gt;\
You kneel before the box, and with one sharp tug crack it open. Resting on a bed of fresh hay is your prize.
&lt;&lt;if $dragonitem eq &quot;armor&quot;&gt;&gt;&lt;img src=&quot;Images/Armor/Dragon Armor.jpg&quot; width=400 /&gt;
&lt;&lt;elseif $dragonitem eq &quot;gauntlets&quot;&gt;&gt;&lt;img src=&quot;Images/Armor/Dragon Gauntlets.jpg&quot; width=400 /&gt;
&lt;&lt;elseif $dragonitem eq &quot;axe&quot;&gt;&gt;&lt;img src=&quot;Images/Weapons/Dragon Axe.jpg&quot; width=400 /&gt;
&lt;&lt;/if&gt;&gt;\
So much has happened since you made the request, the sight of the artifact is half a surprise to you. A welcome one, certainly.
&lt;&lt;if $dragonitem eq &quot;armor&quot;&gt;&gt;&lt;&lt;HeroTalk &quot;Such a fine set of armor. Protected by dragon scales, I may yet survive the Dark Heart of Netheryn.&quot;&gt;&gt;\
&lt;&lt;elseif $dragonitem eq &quot;gauntlets&quot;&gt;&gt;&lt;&lt;HeroTalk &quot;I can already feel the hunger of Zaradras in these gauntlets. These will surely come to good use, in the Dark Heart of Netheryn.&quot;&gt;&gt;\
&lt;&lt;elseif $dragonitem eq &quot;axe&quot;&gt;&gt;&lt;&lt;HeroTalk &quot;The fury of Zaradras burns in this axe. It will set it against my enemies, in the Dark Heart of Netheryn.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;WitchTalk &quot;Take heart, $name. Few can claim to have slain a dragon, and fewer still have armed themselves with the fruit of such a conquest. Your power is beyond formidable. The Redeemer may yet meet his match.&quot;&gt;&gt;\

[[Thank Scyllia, then take your newfound artifact and leave-&gt;Outside the Cabin]] 
\
&lt;&lt;set $dragon = 2&gt;&gt;\
&lt;&lt;if $dragonitem eq &quot;armor&quot;&gt;&gt;&lt;&lt;set $chestinventory.push($dragonarmor)&gt;&gt;\
&lt;&lt;elseif $dragonitem eq &quot;gauntlets&quot;&gt;&gt;&lt;&lt;set $handsinventory.push($dragongauntlets)&gt;&gt;\
&lt;&lt;elseif $dragonitem eq &quot;axe&quot;&gt;&gt;&lt;&lt;set $weaponinventory.push($dragonaxe)&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 16&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; gestures for you to come close.
&lt;&lt;if $finalquest lt 8&gt;&gt;&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Character/witch3.jpg&quot; width=450 /&gt;&lt;&lt;/if&gt;&gt;

When you do, she sets her thumb upon your forehead, then traces a line to your chin.
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;WitchTalk &quot;Watch over this one, blessed Tylae. He fights for every thread of your creation.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;WitchTalk &quot;Watch over this one, blessed Tylae. She fights for every thread of your creation.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
For a moment, you expect the sky to open, and for a grand ray of sunlight to piece your soul, imbuing you with godlike power.

But nothing happens.

&lt;&lt;HeroTalk &quot;The Goddess is silent?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;I think perhaps the time or prayer is in the past. You are her champion in these Woods, $name. The rest is up to you.&quot;&gt;&gt;\

[[Discuss the events of the Winter Palace-&gt;Witch5][$p = 17]]

&lt;&lt;elseif $p eq 17&gt;&gt;\
&lt;&lt;HeroTalk &quot;I wish you were with Babar and I in the Winter Palace, Scyllia. Perhaps you would have seen the darkness in Nendel&#39;s heart.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;I doubt it - the Redeemer is a powerful wizard. He would have known to shield his thoughts from me. No, my place was here, hiding this cabin - and your shrine - from his grasp.&quot;&gt;&gt;\
You see some sense in her words. Still, having a priestess at your side in the final confrontation might tilt the scales in your favor.
&lt;&lt;HeroTalk &quot;Can I count on you, for what&#39;s to come?&quot;&gt;&gt;\
She looks beyond you - perhaps towards the Dark Heart of Netheryn, in the center of the Deep Woods.
&lt;&lt;WitchTalk &quot;I sense my fate lies in that city, yes. A shadow of purest darkness. A thread that must be plucked out. I will be there, $name. You can count on it.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $witchstatus = 21&gt;&gt;\

&lt;&lt;elseif $p eq 18&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; gestures for you to follow her.
&lt;&lt;if $finalquest lt 8&gt;&gt;&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Character/witch3.jpg&quot; width=450 /&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;WitchTalk &quot;In a dream, I stumbled upon an encantation. An old and dangerous one... but it might prove useful to your fight against the Redeemer.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;m listening.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;This encantation would allow you to hold more divine skills within your soul at a given time. Would this help, knowing two more divine skills at once?&quot;&gt;&gt;\
It&#39;s an intriguing offer. More skills at-hand means more options in battle.
&lt;&lt;HeroTalk &quot;It could be the difference between victory and defeat. What are the risks?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Nothing I can&#39;t protect you from. The trouble is, I&#39;m missing a key reagent.&quot;&gt;&gt;\

[[Ask Scyllia what she needs-&gt;Witch5][$p = 19]]

&lt;&lt;elseif $p eq 19&gt;&gt;\
&lt;&lt;WitchTalk &quot;This is an encantation of regeneration - I seek to expand the bounds of your soul. For such a spell to work... I need a troll skull.&quot;&gt;&gt;\
For a moment, you assume you misheard her.
&lt;&lt;HeroTalk &quot;I can&#39;t imagine any connection between the skull of a troll and divine blessings upon my soul.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;That is because you&#39;re a $class, while &lt;i&gt;I&lt;/i&gt; am a priestess. The troll is a creature of restoration and regeneration. They are not inherently evil. $name, can you find a troll skull in the Deep Woods?&quot;&gt;&gt;\
You think back to the troll you slew in the Goblin Nest.
&lt;img src=&quot;Images/Outskirts/troll2.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Yes, Scyllia. I can get you your skull.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $witchstatus = 22&gt;&gt;\

&lt;&lt;elseif $p eq 20&gt;&gt;\
You hand &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; the troll skull.
&lt;img src=&quot;Images/Outskirts/troll3.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;This will do nicely. I trust it wasn&#39;t too difficult to find.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I managed.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;I sense there&#39;s more to it than that, but I won&#39;t press. Let us begin the ritual - if you&#39;ll kneel.&quot;&gt;&gt;\
Once you fall to your knees, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; fills the troll skull with an assortment of flowers and kindling, then sets it down before you. 

[[The ritual begins-&gt;Witch5][$p = 21]]

&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;&lt;WitchTalk &quot;Oh holy Tylae - unfurl the seams of this one&#39;s soul, and draw them far across the stars. Let in the light.&quot;&gt;&gt;\
At that last word, smoke rises from the troll skull. The kindling has been lit. Somehow.
&lt;&lt;WitchTalk &quot;Breathe deep, $name.&quot;&gt;&gt;\

Inhaling, your nose is filled with incense and a heady, curious scent. You shudder.

[[Darkness-&gt;Witch5][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;

@@.delayed; @@ \
@@.delayed;&lt;&lt;TrollTalk &quot;Oy! What&#39;s goin&#39; on &#39;ere? Can&#39;ta troll be ded in peace?&quot;&gt;&gt;@@ \
@@.delayed; @@ \
@@.delayed; &lt;&lt;HeroTalk &quot;Where am I? Are you... are the troll who worked for Gresh?&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;TrollTalk &quot;&#39;Course I am! Killin&#39; me wasn&#39;t enuf, was it? Now you wanna bother me soul?&quot;&gt;&gt;@@ \
@@.delayed; @@ \
@@.delayed; &lt;&lt;HeroTalk &quot;I want nothing to do with you. I&#39;m just using your skull for an encantation.&quot;&gt;&gt; @@ \
\
@@.delayed;[[Continue-&gt;Witch5][$p = 23]]
 @@
 
 &lt;&lt;elseif $p eq 23&gt;&gt;\
 The Troll starts to laugh.
@@.delayed;&lt;&lt;TrollTalk &quot;I see &#39;ow it is. Big bad adventurer needs troll powa&#39; to kill da&#39; Redeemer.&quot;&gt;&gt;@@ \
@@.delayed; @@ \
@@.delayed; &lt;&lt;HeroTalk &quot;Something like that, yes.&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;TrollTalk &quot;Well... too bad!&quot;&gt;&gt;@@ \
@@.delayed; Just then, another soul appears between you and the troll.@@ \
@@.delayed;&lt;&lt;GreshTalk &quot;Help the human. The fight against the Redeemer is too important to be delayed by your stubbornness.&quot;&gt;&gt;@@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;TrollTalk &quot;Er... fine. I&#39;m &#39;elp ya. But only &#39;cause da boss says so.&quot;&gt;&gt;@@ \

@@.delayed;[[Light fills you-&gt;Witch5][$p = 24]]
 @@

&lt;&lt;elseif $p eq 24&gt;&gt;&lt;&lt;audio &quot;witch1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;witch&quot;&gt;&gt;\

When you awaken, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; is standing over you.
&lt;&lt;if $finalquest lt 8&gt;&gt;&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Character/witch3.jpg&quot; width=450 /&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;WitchTalk &quot;It worked. For a moment, I thought I had done something wrong, but then the seams of your soul neatly expanded.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;The troll was reluctant to aid me, even in death.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Fascinating. You may want to get some rest, $name. Growing one&#39;s soul is tiring work.&quot;&gt;&gt;\

&lt;i&gt;The maximum number of skills you can know at once has increased by 2!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $abilitymax += 2&gt;&gt;\
&lt;&lt;set $witchstatus = 25&gt;&gt;\
\
&lt;&lt;elseif $p eq 25&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;witch1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;witch&quot;&gt;&gt;\
When you approach &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, she seems to be expecting you.
&lt;&lt;if $finalquest lt 8&gt;&gt;&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Character/witch3.jpg&quot; width=450 /&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;WitchTalk &quot;You seek a path through the Shadow Gate.&quot;&gt;&gt;\
You blink, startled. Then again, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; tends to be somewhat prescient. Or she&#39;s spoken to &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;HeroTalk &quot;We&#39;re running out of time. I must stop the Redeemer, and the Shadow Gate is the only way into the Netheryn Capital.&quot;&gt;&gt;\
She nods, well aware of your pressing need.
&lt;&lt;if $witchlove gte 22&gt;&gt;&lt;&lt;WitchTalk &quot;My love, there&#39;s something you need to know: I had a dream, last night.&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;WitchTalk &quot;I had a dream, last night.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

[[Listen to the priestess-&gt;Witch5][$p = 26]]

&lt;&lt;elseif $p eq 26&gt;&gt;\
She shuts her eyes.
&lt;&lt;WitchTalk &quot;In it, I saw a great, yawning doorway, behind which hid many darting shadows.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;The Shadow Gate.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Indeed. But when I opened it, I met... &lt;i&gt;something&lt;/i&gt;. A creature of such darkness, such power...&quot;&gt;&gt;\
Her eyes snap open. Her gaze upon you is intense.
&lt;&lt;WitchTalk &quot;I saw my death.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Dreams can be deceiving.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Not this one.&quot;&gt;&gt;\

[[Her fingers rest on your own-&gt;Witch5][$p = 27]]

&lt;&lt;elseif $p eq 27&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;\
As her fingers touch yours, her lips come close to your ear.
&lt;img src=&quot;Images/DarkHeart/savewitch3.jpg&quot; width=700 /&gt;

&lt;&lt;WitchTalk &quot;You need not save me, $name. In the end, you alone must face the darkness at the Deep Woods&#39; core.&quot;&gt;&gt;\
&lt;&lt;if $witchlove gte 22&gt;&gt;&lt;&lt;HeroTalk &quot;Scyllia - don&#39;t say such a thing. I will never let you die. I need you.&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Scyllia...&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;WitchTalk &quot;Hush, that is all I wanted to say. Perhaps, as you say, it&#39;s just a dream.&quot;&gt;&gt;\
She rises, seeming fully at peace with what may come.
&lt;&lt;WitchTalk &quot;I will venture to the Shadow Gate.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $finalquest = 7&gt;&gt;\
\
&lt;&lt;elseif $p eq 28&gt;&gt;\
When you approach &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, she appears to be staring off into space, her mind elsewhere.
&lt;img src=&quot;Images/Character/witch3.jpg&quot; width=450 /&gt;

&lt;&lt;if $witchlove gte 22&gt;&gt;&lt;&lt;HeroTalk &quot;Scyllia, my love. How are you?&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Scyllia. How are you?&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
She blinks, then seems to remember herself and fixes you with a curious stare.
&lt;&lt;WitchTalk &quot;Alive.&quot;&gt;&gt;\
Clearly she has mixed feelings with having cheated her fated death, but you do not press her.
&lt;&lt;HeroTalk &quot;Did it hurt? to die?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;The battle hurt. Living hurts. Dying is... strange. I do not want to say &lt;i&gt;easy&lt;/i&gt;. It is unlike any experience in life.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Did you see Tylae?&quot;&gt;&gt;\

[[She laughs-&gt;Witch5][$p = 29]]

&lt;&lt;elseif $p eq 29&gt;&gt;\
&lt;&lt;WitchTalk &quot;I&#39;m afraid I had no time. I was just drifting out of my body when a hand - &lt;i&gt;your hand&lt;/i&gt; - drew me back.&quot;&gt;&gt;\
&lt;&lt;if $witchlove gte 22&gt;&gt;&lt;&lt;HeroTalk &quot;Perhaps that was selfish... but I would be lost without you.&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Perhaps that was selfish... but the fight against the Redeemer isn&#39;t over. I still need you.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $witchlove gte 22&gt;&gt;She studies you for a moment, then leans in and slips her tongue past your teeth.
&lt;video loop muted autoplay src=&quot;Images/Other/kiss5.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;WitchTalk &quot;I love you too, $name. And I will serve you until faithfully the end. And forever after.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;She nearly rests a hand against your cheek, then thinks better of it.
&lt;&lt;WitchTalk &quot;And I will serve you until the end. Now, leave me. Blessings of Tylae be upon you, $name.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;And on you, Scyllia.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $spoketowitch = 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 30&gt;&gt;\
You approach &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/witch3.jpg&quot; width=450 /&gt;

&lt;&lt;if $witchlove gte 22&gt;&gt;&lt;&lt;WitchTalk &quot;My love, is the final battle at hand? Don&#39;t you dare march off against the Redeemer without holding me first.&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;WitchTalk &quot;Come to say farewell?&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $witchlove gte 22&gt;&gt;&lt;&lt;HeroTalk &quot;It&#39;s not that. I learned something recently. Queen Domedra was a priestess of Tylae, like you. Fourteen hundred years ago, she was the Deep Woods&#39; witch.&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;No. Queen Domedra was a priestess of Tylae, like you. Fourteen hundred years ago, she was the Deep Woods&#39; witch.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;WitchTalk &quot;I did not know that. And?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;She learned something about Tylae, and how the world works. How it ends. How it restarts. Over and over again. Better and better each time.&quot;&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; keeps her face passive, but glances around to ensure that &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; are not near.
&lt;&lt;WitchTalk &quot;Come with me.&quot;&gt;&gt;\

[[Follow Scyllia-&gt;Witch5][$p = 31]]

&lt;&lt;elseif $p eq 31&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; leads you to a quiet glade, far away from the rest of your camp.

&lt;&lt;WitchTalk &quot;That kind of knowledge is for the priestesses, alone. Domedra was a fool to speak of it to anyone. Then again, it&#39;s quite clear she&#39;s lost her mind.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;So you don&#39;t deny it? If this world ends, a new one, a better one, will form?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;&lt;i&gt;Don&#39;t be a fool!&lt;/i&gt;&quot;&gt;&gt;\
Her shout echoes through the wood. You stare at her, unnerved.
&lt;&lt;WitchTalk &quot;Is... is that honestly how you see it? Do you think so little of Tylae, of her creation, to believe that to be true?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Teach me otherwise, then. Tell me I&#39;m wrong.&quot;&gt;&gt;\

[[She closes her eyes-&gt;Witch5][$p = 32]]

&lt;&lt;elseif $p eq 32&gt;&gt;\
&lt;&lt;WitchTalk &quot;The world has ended before. Many times. And every time it has ended, it has had a single cause.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;The Void?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;No, the Void is only the instrument, not the cause. The cause is hatred, $name. It is always so.&quot;&gt;&gt;\
You listen in silence.
&lt;&lt;WitchTalk &quot;And when it ends, Tylae gathers her many threads and weaves the world anew. But it is not &lt;i&gt;better&lt;/i&gt;. It is the same.&quot;&gt;&gt;\
&lt;img src=&quot;Images/DarkHeart/misc18.jpg&quot; width=600 /&gt;

You stare at her, stunned.
&lt;&lt;HeroTalk &quot;It falls to pieces, and she does it all over again? &lt;i&gt;Why&lt;/i&gt;?&quot;&gt;&gt;\

[[Scyllia smiles-&gt;Witch5][$p = 33]]

&lt;&lt;elseif $p eq 33&gt;&gt;\
&lt;&lt;WitchTalk &quot;Because it is up to us, $name. Not her. That is the point of creation. It is &lt;i&gt;us&lt;/i&gt; who must do better, not the Gods. Can we rise above our anger? Can we be more than our worst mistakes?&quot;&gt;&gt;\
You don&#39;t know how to answer that question.
&lt;&lt;WitchTalk &quot;Domedra and the Redeemer think not. Perhaps this coming battle has happened before. Perhaps you are doomed to lose it, and this world is trapped in an eternal loop. Creation... destruction... and back again.&quot;&gt;&gt;\
She rests a hand beneath your chin.
&lt;&lt;WitchTalk &quot;But... for what it&#39;s worth... I hope you win. I think we can be better than our past. I think &lt;i&gt;you&lt;/i&gt; can be better.&quot;&gt;&gt;\
\
&lt;&lt;if $witchlove gte 22&gt;&gt;She plants a final kiss on your lips, then she walks away, leaving you with your thoughts.&lt;&lt;else&gt;&gt;And then she walks away, leaving you with your thoughts.&lt;&lt;/if&gt;&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $spoketowitch = 2&gt;&gt;\
\
&lt;&lt;elseif $p eq 34&gt;&gt;


























&lt;&lt;/if&gt;&gt;\
\
\</tw-passagedata><tw-passagedata pid="70" name="Tower1" tags="" position="1242,301" size="100,100">\
&lt;&lt;if $music neq &quot;tower&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;tower1_bgm&quot; volume 0.5 play loop&gt;&gt; &lt;&lt;set $music = &quot;tower&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $p eq 0&gt;&gt;You are standing in the entrance room of the Tower of Zyr. Behind you, a magic door leads back outside.
&lt;img src=&quot;Images/ScarletVale/tower5.jpg&quot; width=600 /&gt;

&lt;&lt;if $valequest eq 9&gt;&gt;A bright pool bubbles between you and the next door. Distant sunlight dances on the pool&#39;s surface. You can just barely make out a face beneath the water.

[[Approach the fountain-&gt;TZBattle1][$p = 0]]
[[Return-&gt;Tower Entrance][$p = 0]]

&lt;&lt;else&gt;&gt;\
[[Enter the lift chamber-&gt;Tower1][$p = 1]]
[[Return-&gt;Tower Entrance][$p = 0]]
\
&lt;&lt;/if&gt;&gt;
\
&lt;&lt;elseif $p eq 1&gt;&gt;You are standing in what looks to be the central chamber of the Tower of Zyr. A chasm stretches down the Tower&#39;s heart, with a floating platform serving as a kind of magical lift between levels. &lt;&lt;if $towerstone eq 0&gt;&gt;On the far side of the chamber, a large red stone is lodged into the wall, where it ominously glows.&lt;&lt;/if&gt;&gt;
&lt;img src=&quot;Images/ScarletVale/tower6.jpg&quot; width=600 /&gt;
\
&lt;&lt;if $valequest eq 10&gt;&gt;There doesn&#39;t appear to be any other way to ascend the tower. No stairs, no adjoining rooms beyond the one behind you. It seems you will need to make use of the tower&#39;s magic in order to find &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.

[[Activate the lift-&gt;TZBattle2][$p = 0]]
[[Return-&gt;Tower Entrance][$p = 0]]

&lt;&lt;set $towerstone = 0&gt;&gt;\
&lt;&lt;set $towerprison = 0&gt;&gt;\
&lt;&lt;set $towerarmory = 0&gt;&gt;\
&lt;&lt;set $towerlibrary = 0&gt;&gt;\
\
&lt;&lt;else&gt;&gt;\
From here, you can access any floor in the Tower of Zyr.
[[Ascend to the observatory-&gt;Tower1][$p = 6]]
[[Ascend to the library-&gt;Tower1][$p = 5]]
[[Descend to the armory-&gt;Tower1][$p = 4]]
[[Descend to the prison-&gt;Tower1][$p = 3]]

Or you can:
&lt;&lt;if $towerstone eq 0&gt;&gt;[[Investigate the glowing red stone-&gt;Tower1][$p = 2]]&lt;&lt;else&gt;&gt;[[Touch the heartstone-&gt;Tower1][$p = 2]]&lt;&lt;/if&gt;&gt;
[[Leave the Tower of Zyr-&gt;Tower Entrance][$p = 0]]
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;if $towerstone eq 0&gt;&gt;You approach the glowing red stone, curious of its function and purpose.
&lt;img src=&quot;Images/ScarletVale/crystalheart2.jpg&quot; width=500 /&gt;

As you near it, your wounds seem to fade and seal. Strength returns to your limbs. The stone has remarkable healing properties.

Unfortunately, try as you might to pull it free, it seems impossible to move from the wall.

&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
&lt;&lt;if $class neq &quot;soldier&quot;&gt;&gt; &lt;&lt;set $currentmana = $maxmana&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $towerstone = 1&gt;&gt;\
\
&lt;&lt;else&gt;&gt;You approach the healing stone. In a single moment, your vitality returns.
&lt;img src=&quot;Images/ScarletVale/crystalheart2.jpg&quot; width=500 /&gt;
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
&lt;&lt;if $class neq &quot;soldier&quot;&gt;&gt; &lt;&lt;set $currentmana = $maxmana&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

[[Return-&gt;Tower1][$p = 1]]
\
&lt;&lt;elseif $p eq 3&gt;&gt;\
You stand within a dark, silent prison. It clearly hasn&#39;t been visited by anyone in centuries.
&lt;img src=&quot;Images/ScarletVale/tower8.jpg&quot; width=650 /&gt;

&lt;&lt;if $towerprison eq 0&gt;&gt;\
All the cells are empty, their bars long since fallen to ruin. Yet from the furthest cell, faint whispering can be heard.

[[Approach-&gt;TZBattle3][$p = 0]]
[[Return-&gt;Tower1][$p = 1]]

&lt;&lt;else&gt;&gt;With &lt;b&gt;Alistair&lt;/b&gt; defeated, there is nothing left to haunt this forlon place, nor any reason to be here.

[[Return-&gt;Tower1][$p = 1]]
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 4&gt;&gt;\
You stand before an ancient armory, littered with ruined metal. Nature has almost fully reconquered the vast hall.
&lt;img src=&quot;Images/ScarletVale/tower9.jpg&quot; width=650 /&gt;

&lt;&lt;if $towerarmory eq 0&gt;&gt;You are not alone. Two bulky-looking figures, mostly lost to shadow, appear to be kneeling, perhaps praying - at the end of the hall.

[[Approach-&gt;TZBattle4][$p = 0]]
[[Return-&gt;Tower1][$p = 1]]

&lt;&lt;elseif $towerarmory eq 1&gt;&gt;Now that the Scarlet Guardians have been dispatched, you can approach the object of their devotion.

[[Approach the strange shrine-&gt;TZBattle5][$p = 0]]
[[Return-&gt;Tower1][$p = 1]]

&lt;&lt;elseif $towerarmory eq 2&gt;&gt;The armory is silent as a tomb.

[[Return-&gt;Tower1][$p = 1]]
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
You stand at the precipice of a vast and ancient library. Unlike the rest of the Tower of Zyr, it appears to be in excellent condition. A touch overgrown, but otherwise meticulously cared for. &lt;&lt;if $towerlibrary gte 1&gt;&gt;Within, you can faintly hear &lt;span class=&quot;water&quot;&gt;&lt;b&gt;Zyr&lt;/b&gt;&lt;/span&gt; humming.&lt;&lt;/if&gt;&gt;
&lt;img src=&quot;Images/ScarletVale/tower11.jpg&quot; width=700 /&gt;

[[Explore-&gt;Zyr1][$p = 0]]
[[Return-&gt;Tower1][$p = 1]]

&lt;&lt;elseif $p eq 6&gt;&gt;You stand at the top floor of the Tower of Zyr. Beyond is a long hallway leading to great Observatory.
&lt;img src=&quot;Images/ScarletVale/tower16.jpg&quot; width=600 /&gt;

[[Explore-&gt;Observatory1][$p = 0]]
[[Return-&gt;Tower1][$p = 1]]

&lt;&lt;elseif $p eq 7&gt;&gt;























&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="71" name="TZBattle1" tags="" position="1240,423" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
\
You approach the fountain. As you do, you hear a man&#39;s voice, coming from beneath the water.
&lt;&lt;Water1Talk &quot;&lt;i&gt;Anu inethilin Tor Azyr?&lt;/i&gt;&quot;&gt;&gt; \

You&#39;ve had few encounters with elves in your lifetime, besides the sack of Hadamshal. But you can recognize the sound of their native tongue.

You can&#39;t understand it, though.
&lt;&lt;HeroTalk &quot;I am $name $title. I seek an elf girl. Did she enter this way?&quot;&gt;&gt; \
&lt;&lt;Water1Talk &quot;&lt;i&gt;Diini faleni ain Tor Azyr?&lt;/i&gt;&quot;&gt;&gt; \

[[...Yes?-&gt;TZBattle1][$p = 1, $i = 1]]
[[...No?-&gt;TZBattle1][$p = 1, $i = 2]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle4_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
Your answer did not seem to please the voice in the water. The pool&#39;s bubbling grows, and from it rises a figure formed of mist and wave. A water elemental of old guards the Tower of Zyr!
&lt;img src=&quot;Images/ScarletVale/elemental1.jpg&quot; width=500 /&gt;

&lt;&lt;if $i eq 1&gt;&gt;&lt;&lt;Water2Talk &quot;&lt;i&gt;Idri nil&#39;athar! Idri!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;Water2Talk &quot;&lt;i&gt;Hestak!&lt;/i&gt;&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;HeroTalk &quot;So be it - to arms!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;WaterElementalStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!
&lt;&lt;Water2Talk &quot;&lt;i&gt;Tor Azyr es tirnalyn... Naya... venatar...&lt;/i&gt;&quot;&gt;&gt;\

You find a pair of Sapphire Gloves at the bottom of the pool! They glow with the energy of the Water Elemental...

[[Continue-&gt;Tower1][$p = 0]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $valequest = 10&gt;&gt;\
&lt;&lt;set $handsinventory.push($sapphiregloves)&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="72" name="TZBattle2" tags="" position="1242,542" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
\
The moment you step onto the lift, you notice something on the ground. Reaching down, you pick it up.
&lt;img src=&quot;Images/ScarletVale/tower7.jpg&quot; width=450 /&gt;

A lock of white hair, cleanly chopped.
&lt;&lt;HeroTalk &quot;Naya... she&#39;s close.&quot;&gt;&gt; \

Just as you utter those words, three lithe figures fall from the darkness above and land upon the lift. 

&lt;&lt;ScarletBloodletterTalk &quot;Interloper...&quot;&gt;&gt; \

[[Face your foes-&gt;TZBattle2][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
Drawing your weapon, you stand your ground in the center of the lift as the tainted guardians of the Scarlet Vale encircle you.
&lt;img src=&quot;Images/ScarletVale/plant7.jpg&quot; width=500 /&gt;

&lt;&lt;ScarletBloodletterTalk &quot;None can stop the Void. Not even you.&quot;&gt;&gt; \

You&#39;re woefully outnumbered. This won&#39;t be easy.

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ScarletBloodletterStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
&lt;&lt;set $battletotal = 1&gt;&gt; \

\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;if $battletotal eq 1&gt;&gt;\
The first Bloodletter falls, only for another to take its place.
&lt;&lt;ScarletBloodletterTalk &quot;Your fate is inevitable, interloper...&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;ScarletBloodletterStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
&lt;&lt;set $battletotal = 2&gt;&gt; \

\
&lt;&lt;elseif $battletotal eq 2&gt;&gt;\
The second Bloodletter falls. Your own strength failing you, fight to stay standing as the third guardian raises its scythes against you.
&lt;&lt;ScarletBloodletterTalk &quot;The end has come.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Never!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;ScarletBloodletterStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
&lt;&lt;set $battletotal = 3&gt;&gt; \
\
&lt;&lt;elseif $battletotal eq 3&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You survive the onslaught of the Bloodletters!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Continue-&gt;TZBattle2][$p = 21]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $valequest = 11&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;tower1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;tower&quot;&gt;&gt;\

With the lift cleared of enemies, you survey it a bit more closely. There don&#39;t appear to be any levers to grasp, or chains to pull to get it moving.
&lt;&lt;HeroTalk &quot;Elf magic is never intuitive... and these ancient elves were clearly more advanced in magic than any living human wizard.&quot;&gt;&gt; \

And yet, as you stand in the center of the lift, a quiet voice seems to slip into your mind.
&lt;&lt;Zyr1Talk &quot;Which floor do you seek? Containment... Armory... Library... Observatory...&quot;&gt;&gt; \

You shake your head, realizing that the lift works on the basis of telepathy. Simply &lt;i&gt;think&lt;/i&gt; of the floor to travel to, and the lift will take you there.

[[Step back and consider where to go next-&gt;Tower1][$p = 1]]
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="73" name="TZBattle3" tags="" position="1243,655" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
\
As you approach the farthest cell, the whispering becomes clearer.
&lt;&lt;Alistair1Talk &quot;Release me... please... release me...&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Who&#39;s there? Show yourself.&quot;&gt;&gt; \

But no one appears. The whispering seem to emanate from an old, rusted lock, lying on the prison cell floor. It rattles with strange power.
&lt;&lt;Alistair1Talk &quot;The elves locked me away... because I told them their path was false. Their doom was false! Please... release me...&quot;&gt;&gt; \

A ghost, it seems. Trapped in the cell where his mortal life ended.
&lt;&lt;HeroTalk &quot;The elves? Do you know about the portal, and the Redeemer?&quot;&gt;&gt; \
&lt;&lt;Alistair1Talk &quot;Yes... yes...&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;And if I break this lock, will you aid me?&quot;&gt;&gt; \
&lt;&lt;Alistair1Talk &quot;Please... &lt;i&gt;please&lt;/i&gt;...&quot;&gt;&gt; \

It&#39;s rarely wise to trust a ghost...

[[Release him-&gt;TZBattle3][$p = 1]]
[[Back away-&gt;Tower1][$p = 3]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle4_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
The moment the lock shatters in your hands, a ghostly creature materializes in the cell.
&lt;img src=&quot;Images/ScarletVale/alistair1.jpg&quot; width=500 /&gt;

&lt;&lt;Alistair2Talk &quot;BWAHAHAHAHA! FOOLISH MORTAL! YOU HAVE RELEASED ALISTAIR, THE RED BUTCHER!&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;... who?&quot;&gt;&gt; \
&lt;b&gt;Alistair&lt;/b&gt; looks a bit peeved, then carries on.
&lt;&lt;Alistair2Talk &quot;ALISTAIR! THE MOST VILE MURDERER AND MOST FEARED CRIMINAL THE WORLD HAS EVER KNOWN. ALL KNOW ME! ALL FEAR ME!&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;... I&#39;ve never heard of you.&quot;&gt;&gt; \

[[The ghost sighs-&gt;TZBattle3][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;Alistair2Talk &quot;TRULY? HAVE ELVES AND MEN SO QUICKLY FORGOTTEN ALISTAIR THE RED BUTCHER!&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;... Perhaps you weren&#39;t so vile and fearsome in life as you thought.&quot;&gt;&gt; \
&lt;&lt;Alistair2Talk &quot;LIES! MY REIGN OF TERROR BEGINS ANEW, AND STARTS WITH YOU!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;AlistairStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \

&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You have defeated $enemyname
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Continue-&gt;TZBattle3][$p = 21]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $towerprison = 1&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;tower1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;tower&quot;&gt;&gt;\

&lt;b&gt;Alistair&lt;/b&gt; begins to fade away.
&lt;&lt;Alistair2Talk &quot;WHAT CRUELER FATE CAN THERE BE... TO WAIT OVER ONE THOUSAND YEARS... ONLY ONCE MORE... to... &lt;i&gt;perish&lt;/i&gt;...&quot;&gt;&gt; \

And then he is gone. In his place, you find a thin, shimmering blade. It looks enfused with otherworldly power.

[[Leave the cell-&gt;Tower1][$p = 3]]
\
&lt;&lt;set $weaponinventory.push($ghostblade)&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="74" name="TZBattle4" tags="" position="1243,770" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You approach the two figures. Neither appears slender enough to be &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, but you have to be certain.
&lt;&lt;HeroTalk &quot;Who goes there? Show yourself.&quot;&gt;&gt; \

At your voice, the figures rise, and step out from the shadows. They&#39;re both heavily armored... and made of petal, stem, and thorns.
&lt;img src=&quot;Images/ScarletVale/plant5.jpg&quot; width=500 /&gt;

&lt;&lt;ScarletGuardianTalk &quot;Interloper!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ScarletGuardianStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
&lt;&lt;set $battletotal = 1&gt;&gt; \
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;if $battletotal eq 1&gt;&gt;\
The first Guardian falls with a solid &lt;i&gt;clang&lt;/i&gt;
&lt;&lt;ScarletGuardianTalk &quot;You shouldn&#39;t be here, interloper!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;ScarletGuardianStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
&lt;&lt;set $battletotal = 2&gt;&gt; \
\
&lt;&lt;elseif $battletotal eq 2&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You defeated both Guardians!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Continue-&gt;Tower1][$p = 4]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $towerarmory = 1&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="75" name="TZBattle5" tags="" position="1246,882" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
\
You walk past the corpses of the Scarlet Guardians. It&#39;s strange - you&#39;ve never seen the ceatures of the Scarlet Vale &lt;i&gt;pray&lt;/i&gt; to anything before...
&lt;img src=&quot;Images/ScarletVale/tower10.jpg&quot; width=500 /&gt;

You recognize the plain, well-carved altar immediately. It&#39;s a shrine to &lt;b&gt;Hestus&lt;/b&gt;, the God of metal. A minor God, he is revered by smiths and some soldiers who put more trust into the steel of their sword than the hand that swings it.

A faint energy seems to emanate from the altar, as if &lt;b&gt;Hestus&lt;/b&gt; himself was waiting for something.

As the God of metal, you know he appreciates an offering of gold...

&lt;&lt;if $gold gte 1000&gt;&gt;[[Offer Hestus 1000 gold pieces-&gt;TZBattle5][$p = 1, $i = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer Hestus 1000 gold pieces&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $gold gte 500&gt;&gt;[[Offer Hestus 500 gold pieces-&gt;TZBattle5][$p = 1, $i = 2]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer Hestus 500 gold pieces&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $gold gte 100&gt;&gt;[[Offer Hestus 100 gold pieces-&gt;TZBattle5][$p = 1, $i = 3]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer Hestus 100 gold pieces&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Retreat for now-&gt;Tower1][$p = 4]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle4_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
The moment after you pour the gold onto the table, the entire armory begins to shake.
&lt;&lt;HestusTalk &quot;&lt;i&gt;Gold?&lt;/i&gt; Is that &lt;i&gt;gold!?!?&lt;/i&gt;&quot;&gt;&gt; \
The God&#39;s voice seems to come from everywhere at once. As you struggle to maintain your footing, scraps of discarded metal begin to rise from the ground and slam into eachother. 

Slowly, a figure forms of iron and steel.
&lt;img src=&quot;Images/ScarletVale/hestus1.jpg&quot; width=450 /&gt;
&lt;&lt;if $i eq 1&gt;&gt;\
&lt;&lt;HestusTalk &quot;So much! So much! A most worthy offering!&quot;&gt;&gt; \
The armored husk takes a step towards you.
&lt;&lt;HestusTalk &quot;But do you deserve my blessing, little human? We shall see! I demand combat. GLORIOUS COMBAT!&quot;&gt;&gt; \
\
&lt;&lt;elseif $i eq 2&gt;&gt;\
&lt;&lt;HestusTalk &quot;A fair offering. A fair offering, indeed...&quot;&gt;&gt; \
The armored husk takes a step towards you.
&lt;&lt;HestusTalk &quot;But do you deserve my blessing, little human? We shall see! I demand combat. GLORIOUS COMBAT!&quot;&gt;&gt; \
&lt;&lt;elseif $i eq 3&gt;&gt;\
&lt;&lt;HestusTalk &quot;Such a tiny little offering. Insulting, in fact!&quot;&gt;&gt; \
The armored husk takes a step towards you.
&lt;&lt;HestusTalk &quot;Such an offering must be punished! I demand combat! GLORIOUS COMBAT!&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\

Before you can utter a word, the husk charges straight at you!

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;HestusStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;if $i eq 1&gt;&gt; &lt;&lt;set $gold -= 1000&gt;&gt; &lt;&lt;elseif $i eq 2&gt;&gt; &lt;&lt;set $gold -= 500&gt;&gt; &lt;&lt;elseif $i eq 3&gt;&gt; &lt;&lt;set $gold -= 100&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 20&gt;&gt; \

&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You have defeated the Fragment of Hestus!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Continue-&gt;TZBattle5][$p = 21]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $towerarmory = 1&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;tower1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;tower&quot;&gt;&gt;\

The fragment of Hestus slumps over its altar, nearly destroyed.
&lt;&lt;HestusTalk &quot;Most impressive... little human.&quot;&gt;&gt; \
&lt;&lt;if $i eq 1&gt;&gt;&lt;&lt;HestusTalk &quot;For such a grand offering, you shall receive my full blessing. Let your blood run hot with steel!&quot;&gt;&gt; \
&lt;&lt;elseif $i eq 2&gt;&gt;&lt;&lt;HestusTalk &quot;For your offering, you shall receive my  blessing. Let your blood run hot with iron!&quot;&gt;&gt; \
&lt;&lt;elseif $i eq 3&gt;&gt;&lt;&lt;HestusTalk &quot;Though your offering was poor, I shall proide a small blessing. Let your blood run hot with bronze!&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\

&lt;i&gt;Hestus&#39;s blessing flows through our veins. You&#39;ve gained &lt;&lt;if $i eq 1&gt;&gt;5&lt;&lt;elseif $i eq 2&gt;&gt;3&lt;&lt;elseif $i eq 3&gt;&gt;1&lt;&lt;/if&gt;&gt; base armor!&lt;/i&gt;

[[Leave the armory-&gt;Tower1][$p = 4]]
\
&lt;&lt;set $towerarmory = 2&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt; &lt;&lt;set $basearmor += 5&gt;&gt; &lt;&lt;elseif $i eq 2&gt;&gt; &lt;&lt;set $basearmor += 3&gt;&gt; &lt;&lt;elseif $i eq 3&gt;&gt; &lt;&lt;set $basearmor += 1&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="76" name="Zyr1" tags="" position="1247,992" size="100,100">&lt;&lt;if $towerlibrary eq 0&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
You wander the length of the library, &lt;&lt;if $valequest eq 11&gt;&gt;on the look out for &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;. So far, the elf girl has eluded you.&lt;&lt;else&gt;&gt;eager to find some way into the Observatory.&lt;&lt;/if&gt;&gt;

Soon, you hear a faint, almost jovial humming. It is rather high-pitched, though neither masculine or feminine. It&#39;s just... odd-sounding. Disconcerting, even.
&lt;&lt;Zyr1Talk &quot;&lt;i&gt;Hmmm, hm hm, hmmm... la la la... la, la...&lt;/i&gt;&quot;&gt;&gt; \

[[Pursue the strange humming-&gt;Zyr1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;Turning a corner between two great bookshelves, you come across... &lt;i&gt;something&lt;/i&gt;.
&lt;img src=&quot;Images/ScarletVale/zyr1.jpg&quot; width=500 /&gt;

The thing is organizing a set of old, moldy books, humming all the while. It soon stops, and turns to face you. Though it doesn&#39;t exactly have a face.
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;Zyr1Talk &quot;Human. Male. Thirty years old. Prone to violence. Morality uncertain... &lt;i&gt;how curious!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;Zyr1Talk &quot;Human. Female. Thirty years old. Prone to violence. Morality uncertain... &lt;i&gt;how curious!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\

The creature approaches you!

[[To battle!-&gt;Zyr1][$p = 2]]

&lt;&lt;ZyrStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle4_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
You are fighting $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;

&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt;&lt;b&gt;Combat Points&lt;/b&gt;: $combatpoints / 5 
&lt;&lt;/if&gt;&gt;
&lt;b&gt;General Actions&lt;/b&gt;:
[[Attack-&gt;Zyr1][$p = 3]]

&lt;&lt;EnemyBattleTable&gt;&gt;
\
\
\
\
\
&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;tower1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;tower&quot;&gt;&gt;\
\
Before you can attack, the creature tilts its body, confused.
&lt;&lt;Zyr2Talk &quot;Why do you wish to destroy me?&quot;&gt;&gt; \
The question catches you offguard.
&lt;&lt;HeroTalk &quot;Weren&#39;t you about to... hit me?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;No.&quot;&gt;&gt; \
&lt;&lt;if $valequest eq 11&gt;&gt;&lt;&lt;HeroTalk &quot;Oh. That&#39;s usually how it works, so I... nevermind. I&#39;m looking for an elf girl. Have you seen one lately?&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Oh. That&#39;s usually how it works, so I... nevermind. I&#39;m looking for a key to the tower&#39;s observatory. Do you have one?&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;
The creature ignores your question.
&lt;&lt;Zyr2Talk &quot;A human... &lt;i&gt;most curious!&lt;/i&gt; I am Zyr, the Arcane Librarian. And you are $name $title.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;How did you know that?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;Telepathy. Come with me, $name $title.&quot;&gt;&gt; \

&lt;span class=&quot;water&quot;&gt;&lt;b&gt;Zyr&lt;/b&gt;&lt;/span&gt; walks off, collecting stray books on its way to wherever it&#39;s going. You don&#39;t have much of a choice but to follow.

[[Follow Zyr-&gt;Zyr1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;span class=&quot;water&quot;&gt;&lt;b&gt;Zyr&lt;/b&gt;&lt;/span&gt; leads you to what you assume is its private study.
&lt;img src=&quot;Images/ScarletVale/tower12.jpg&quot; width=600 /&gt;

&lt;&lt;Zyr2Talk &quot;One thousand, four hundred, thirty-three years without a visitor - and then two visitors, so close together. &lt;i&gt;Most curious!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;if $valequest eq 11&gt;&gt;&lt;&lt;HeroTalk &quot;Two visitors? Do you mean Naya?&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;You mean Naya? An elf girl?&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
Again, &lt;span class=&quot;water&quot;&gt;&lt;b&gt;Zyr&lt;/b&gt;&lt;/span&gt; ignores your question.
&lt;&lt;Zyr2Talk &quot;Tell me, $name $title, what brings you to my Tower? At one time many visitors came from Netheryn, until they did not. A library without visitors for one thousand, four hundred, thirty-three years is a very lonely place, even for Zyr, the Arcane Librarian.&quot;&gt;&gt; \
That name, &lt;i&gt;Netheryn&lt;/i&gt;, catches your attention. It reminds you of something &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; said.
&lt;&lt;HeroTalk &quot;Netheryn. Is that an elf kingdom? In the Deep Woods?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;Of course. The elves of Netheryn built this tower - and me. I was instructed to keep careful record of everything... until one day they stopped visiting me. Now I keep record of the speed at which vines crawl across a ceiling. The answer is approximately four and a half feet each season, but this depends on the average rain-&quot;&gt;&gt; \

[[Ignore him-&gt;Zyr1][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;HeroTalk &quot;Zyr. What happened to the kingdom of Netheryn?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;I do not know - I cannot leave this library to find out, and without visitors, I have no new information on Netheryn&#39;s fate. But I have a hypothesis.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Go on.&quot;&gt;&gt; \
The arcane construct crosses its study, plucks a book from its desk, then returns. The writing is Elven, made in a precise script.
&lt;&lt;Zyr2Talk &quot;In the last year before Netheryn fell, paranoia swept the kingdom. It was powerful, rich, and secure from any mortal threat... yet the people were restless. Rumors swirled of a dark prophecy - of Tylae&#39;s very Creation being undone.&quot;&gt;&gt; \
&lt;img src=&quot;Images/ScarletVale/tower13.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;I don&#39;t understand.&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;Allow me to explain. The people of Netheryn expected their kingdom to last &lt;i&gt;forever&lt;/i&gt;. The more obsessed they became with that fact, the more the fated end to the world bothered them.&quot;&gt;&gt; \
&lt;span class=&quot;water&quot;&gt;&lt;b&gt;Zyr&lt;/b&gt;&lt;/span&gt; flips the page in its book.
&lt;&lt;Zyr2Talk &quot;So, they decided to find the force that would cause the end of the world... and destroy it.&quot;&gt;&gt; \

[[Listen to Zyr-&gt;Zyr1][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
&lt;&lt;Zyr2Talk &quot;The last I heard of the kingdom of Netheryn, they had gathered a massive army in the center of their capital city.&quot;&gt;&gt; \
&lt;img src=&quot;Images/ScarletVale/tower14.jpg&quot; width=600 /&gt;

&lt;&lt;Zyr2Talk &quot;Their archmages had created a portal like none seen before. Or, I believe, since. A portal to the Void.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;The Void?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;Of course. What could possibly be fated to undo Tylae&#39;s Creation? Why, &lt;i&gt;Void&lt;/i&gt; of course. Nothingness. The natural end of all existence. The army of Netheryn planned to kill it.&quot;&gt;&gt; \
&lt;img src=&quot;Images/Outskirts/misc3.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;So what happened?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;I do not know. My hypothesis is that they lost. Badly. That explains the lack of visitors for one thousand, four hundred, thirty-three years. But the world has not been consumed by the Void, so someone must have sealed the portal before it was too late.&quot;&gt;&gt; \

And &lt;i&gt;that&lt;/i&gt; must be the portal that the Redeemer wants to open. &lt;span class=&quot;water&quot;&gt;&lt;b&gt;Zyr&lt;/b&gt;&lt;/span&gt; has given you a lot to think about. You decide to leave him be while you ponder what you&#39;ve learned.

[[Leave-&gt;Tower1][$p = 5]]

&lt;&lt;set $towerlibrary = 1&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $towerlibrary gte 1&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
You stand before &lt;span class=&quot;water&quot;&gt;&lt;b&gt;Zyr&lt;/b&gt;&lt;/span&gt;, the Arcane Librarian.
&lt;img src=&quot;Images/ScarletVale/zyr1.jpg&quot; width=500 /&gt;

&lt;&lt;Zyr2Talk &quot;Ah, $name $title. Do you have another question? Or perhaps you would like to borrow a book?&quot;&gt;&gt; \

[[What can I find in the Tower&#39;s Prison?-&gt;Zyr1][$p = 1]]
[[What can I find in the Tower&#39;s Armory?-&gt;Zyr1][$p = 2]]
[[What can I find in the Tower&#39;s Observatory?-&gt;Zyr1][$p = 3]]
&lt;&lt;if $valequest eq 11&gt;&gt;[[Have you seen an elf girl in the Tower?-&gt;Zyr1][$p = 4]]
&lt;&lt;elseif ($towerlibrary eq 1) and ($valequest lt 13)&gt;&gt;[[I need to get into the Observatory-&gt;Zyr1][$p = 5]]&lt;&lt;/if&gt;&gt;

[[Return-&gt;Tower1][$p = 5]]
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;What can I find in the Tower&#39;s Prison?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;I&#39;m afraid all of the prisoners have long since expired. There is a ghost down there, but that is all.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Tell me about this ghost.&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;There is nothing to tell - I have no record of his life or afterlife. He seems quite violent, though. I would recommend against speaking to him.&quot;&gt;&gt; \

[[Return-&gt;Zyr1][$p = 0]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;HeroTalk &quot;What can I find in the Tower&#39;s Armory?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;There used to be a well-stocked set of magical armor and every kind of weapon. Now, there is only rust. Well, that and the shrine of Hestus.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Shrine of Hestus?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;Yes, Hestus, the God of metal. The last armorer was a pious man, and built an altar to Hestus. It is odd - all these years, and the shrine has not decayed. It is still pristine.&quot;&gt;&gt; \

[[Return-&gt;Zyr1][$p = 0]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;HeroTalk &quot;What can I find in the Tower&#39;s Observatory?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;The Stellar Telescope! Well, if you had arrived eight hundred years ago, at least. It has since fallen apart. Oh, poor Ryz...&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Ryz?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;Yes, Ryz, the Arcane Observer. I&#39;m afraid that once his beloved telescope broke, he lost his mind. I at least have my books to keep my company but Ryz... if you encounter him, I advise great caution. He is as violent as he is insane.&quot;&gt;&gt; \

[[Return-&gt;Zyr1][$p = 0]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;HeroTalk &quot;Have you seen an elf girl in tower? I&#39;m looking for her.&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;Elf girl? Naya. Female. Nineteen years old. Afraid, yet determined.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Yes - her! Where is she?&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;Last I saw, she was heading to the Observatory.&quot;&gt;&gt; \

[[Return-&gt;Zyr1][$p = 0]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;HeroTalk &quot;Zyr - Naya&#39;s locked herself in the Observatory.&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;Naya. Female. Nineteen years old. Afraid, yet-.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Yes - that one.&quot;&gt;&gt; \
&lt;&lt;Zyr2Talk &quot;Such a shame. Ryz will surely destroy her. He lost his mind eight hundred years ago. It&#39;s actually a fascinating tale-&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Zyr. I need to get into the Observatory.&quot;&gt;&gt; \

[[Zyr considers your request-&gt;Zyr1][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
&lt;&lt;Zyr2Talk &quot;&lt;i&gt;Most curious&lt;/i&gt;! It is my duty to ensure visitors have full access to the Tower, and that includes the Observatory. One moment.&quot;&gt;&gt; \
&lt;span class=&quot;water&quot;&gt;&lt;b&gt;Zyr&lt;/b&gt;&lt;/span&gt; marches off into the library. Not too much time later, he returns.
&lt;&lt;Zyr2Talk &quot;I have not touched this key in several centuries. Thankfully I keep a very organized inventory.&quot;&gt;&gt; \
From his shimmering arms, he hands you a key to the Observatory.
&lt;img src=&quot;Images/ScarletVale/tower15.jpg&quot; width=500 /&gt;

&lt;&lt;Zyr2Talk &quot;Do be careful, $name $title. Ryz the Arcane Observer is beyond your formidable power. Given the chance, he &lt;i&gt;will&lt;/i&gt; kill you.&quot;&gt;&gt; \

[[Return-&gt;Zyr1][$p = 0]]

&lt;&lt;set $valequest = 13&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="77" name="Observatory1" tags="" position="1248,1103" size="100,100">&lt;&lt;if $valequest eq 11&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
You walk down the hallway, careful not to step where the ancient stone has begun to crumble. Beyond the yawning windows, the Deep Woods spreads out before you, seemingly without end.

&lt;&lt;if $nayalove eq 12&gt;&gt; Then you turn a corner, and you see her. The thief. The girl who paralyzed and you left you for dead. She&#39;s constricted, held in place by tight green vines.
&lt;img src=&quot;Images/Other/naya7.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Naya.&quot;&gt;&gt; \
She stares at you, looking rather more angry than helpless.

[[Demand she tell you where the gem is-&gt;Observatory1][$p = 50, $i = 1]]
[[Cut the vines holding her-&gt;Observatory1][$p = 50, $i = 2]]

&lt;&lt;else&gt;&gt;\
\
Then you turn a corner, and you see her.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=500 /&gt;

The thief. The girl who paralyzed and you left you for dead. She&#39;s fiddling with a heavy metal door, trying to get it open. She hasn&#39;t noticed you yet.

&lt;&lt;HeroTalk &quot;Naya.&quot;&gt;&gt; \
She turns at the the sound of her name. It gives you some small amount of pleasure to see her pale at the sight of you.

[[... or is she looking behind you?-&gt;Observatory1][$p = 1]]&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 50&gt;&gt;\
\
&lt;&lt;if $i eq 1&gt;&gt;You draw your $weapon.
&lt;&lt;HeroTalk &quot;If you want to live, you&#39;ll tell me where you&#39;ve hidden the gem.&quot;&gt;&gt; \
Her reply is to spit directly onto your face.
&lt;&lt;HeroTalk &quot;Elf manners never cease to impress me.&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;You draw your $weapon, and proceed to cut &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; free of the vines binding her. She drops to her knees with a thud.
&lt;&lt;HeroTalk &quot;Be at ease, Naya - I don&#39;t mean you any harm. Now, the gem...&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
\
She opens her mouth to respond, before her eyes widen. She&#39;s staring at something behind you.

[[Turn around-&gt;Observatory1][$p = 1]]
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
\&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You turn around just in time to dodge a scythe. &lt;&lt;if ($nayalove eq 12) and ($i eq 1)&gt;&gt;It ends up cutting &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; free, instead.&lt;&lt;else&gt;&gt;It strikes the ground beside you.&lt;&lt;/if&gt;&gt;
&lt;img src=&quot;Images/ScarletVale/plant7.jpg&quot; width=500 /&gt;

&lt;&lt;ScarletBloodletterTalk &quot;Interloper!&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;I don&#39;t have time for this!&quot;&gt;&gt; \
\
&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ScarletBloodletterStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Find Naya-&gt;Observatory1][$p = 21]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;elseif $p eq 21&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;tower1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;tower&quot;&gt;&gt;\
When you look back to &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, she&#39;s gotten the door open and is stepping inside. In fact, she&#39;s closing it behind her.
&lt;&lt;NayaTalk &quot;I&#39;m sorry. I have to do this.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Naya - wait!&quot;&gt;&gt; \
She seals the door shut.
&lt;img src=&quot;Images/ScarletVale/tower17.jpg&quot; width=500 /&gt;

You pull at the door with all your might, but it&#39;s no use. Without a key, you can&#39;t get inside.
&lt;&lt;if $towerlibrary eq 0&gt;&gt;&lt;&lt;HeroTalk &quot;There must be a key somewhere in this Tower.&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;There must be a key somewhere in this Tower. Perhaps Zyr would know.&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\

[[Return-&gt;Tower1][$p = 6]]
\
&lt;&lt;set $valequest = 12&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $valequest gte 12&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
You&#39;re standing before the locked door to the Observatory. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; and the Redeemer&#39;s dark gem await just beyond.
&lt;img src=&quot;Images/ScarletVale/tower17.jpg&quot; width=500 /&gt;

&lt;&lt;if $valequest gte 13&gt;&gt;[[Use Zyr&#39;s key-&gt;Observatory1][$p = 1]] &lt;&lt;/if&gt;&gt;
[[Return-&gt;Tower1][$p = 6]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
The door opens without a sound. With a small shove, the ancient Observatory is revealed.
&lt;img src=&quot;Images/ScarletVale/tower18.jpg&quot; width=750 /&gt;

You&#39;re not entirely sure what you&#39;re looking at. Golden rods slowly turn throughout the room, carrying with them floating, spinning spheres. The central one - the one that seems to be on fire - almost acts like a miniature sun. The others could be planets and moons. Maybe.

And there, lying still before an ancient telescope, is &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.

Blood coats her hair. She isn&#39;t moving.
&lt;&lt;HeroTalk &quot;Naya!&quot;&gt;&gt;\
You rush across the room, falling to your knees at her side and drawing up her head. &lt;&lt;if $nayalove eq 12&gt;&gt;Without meaning to, your other hand takes hold of her bottom. It&#39;s firm and supple.
&lt;video loop muted autoplay src=&quot;Images/Other/fondle3.mp4&quot;&gt;&lt;/video&gt;

Realizing what you&#39;re doing, you pull back your hand.&lt;&lt;/if&gt;&gt;
&lt;&lt;HeroTalk &quot;The gem, Naya. Where is it?&quot;&gt;&gt;\
In an instant, she opens her eyes. She is conscious, and very, very afraid.
&lt;&lt;NayaTalk &quot;Don&#39;t. Move.&quot;&gt;&gt;\
You freeze in place. As you do, you hear something. &lt;i&gt;Humming&lt;/i&gt;.

Only, it isn&#39;t like &lt;span class=&quot;water&quot;&gt;&lt;b&gt;Zyr&#39;s&lt;/b&gt;&lt;/span&gt; humming at all.
&lt;&lt;Ryz1Talk &quot;&lt;i&gt;Hmm, hmm, hmm... rend and tear. Hmm, hmm, hmm... kill them all...&lt;/i&gt;&quot;&gt;&gt;\

[[Slowly turn your head-&gt;Observatory1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle5_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
Crossing the room, singing a maddening tune, as another arcane construct. 
&lt;img src=&quot;Images/ScarletVale/ryz1.jpg&quot; width=600 /&gt;

&lt;span class=&quot;water&quot;&gt;&lt;b&gt;Ryz&lt;/b&gt;&lt;/span&gt;, the Arcane Observer.
&lt;&lt;Ryz2Talk &quot;$name $title. Welcome to the Observatory. Would you like to be split into four pieces, or seven?&quot;&gt;&gt;\
You rise to your feet. As you do, you draw your $weapon.
&lt;&lt;Ryz2Talk &quot;You wish to fight? Fighting is forbidden in the Observatory. The punishment is a slow, painful death. &lt;i&gt;How delightful!&lt;/i&gt;&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;RyzStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;
\
You defeated $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

&lt;&lt;Ryz2Talk &quot;Clarity, at last...&quot;&gt;&gt;\
You feel stronger from your victory - you gain $enemyexp Experience Points!

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You find the the Celestial Greaves! &lt;span class=&quot;water&quot;&gt;&lt;b&gt;Ryz&#39;s&lt;/b&gt;&lt;/span&gt; power and fortitude glow within.

[[Go to Naya-&gt;Observatory2][$p = 0]]

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $legsinventory.push($celestialgreaves)&gt;&gt;\

\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="78" name="Observatory2" tags="" position="1248,1229" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;\
When you turn to her, she&#39;s already on her feet and facing you. Though blood drips from a gash along her temple, she seems ready, almost defiant.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=500 /&gt;

&lt;&lt;NayaTalk &quot;You&#39;re persistent.&quot;&gt;&gt; \
Still reeling from your battle with &lt;span class=&quot;water&quot;&gt;&lt;b&gt;Ryz&lt;/b&gt;&lt;/span&gt;, you take a moment to catch your breath.
&lt;&lt;HeroTalk &quot;That makes two of us. Now, give me the crystal, and I will let you leave. Trust me, you don&#39;t want to be here when the Deathguard arrive.&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;Why should I give you the gem? Do you even know what it is? what it is &lt;i&gt;capable of&lt;/i&gt;?&quot;&gt;&gt; \

[[Answer her-&gt;Observatory2][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
After  all you&#39;ve learned from &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&lt;/b&gt;&lt;/span&gt;, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, and &lt;span class=&quot;water&quot;&gt;&lt;b&gt;Zyr&lt;/b&gt;&lt;/span&gt;, you know &lt;i&gt;exactly&lt;/i&gt; what the crystal is capable of.
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=350 /&gt;

&lt;&lt;HeroTalk &quot;It&#39;s a key to the Void, Naya. I need it.&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;Why?&quot;&gt;&gt; \
You grunt in exasperation. Is she really going to make you kill her?
&lt;&lt;HeroTalk &quot;Because my king ordered me to deal with the Redeemer.&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;Your king? &lt;i&gt;That murdering tyrant&lt;/i&gt;!?&quot;&gt;&gt; \
Your hand tightens on your $weapon.
&lt;&lt;HeroTalk &quot;Give me the crystal, and you will live. Trust me, Naya.&quot;&gt;&gt;\
That word, &lt;i&gt;trust&lt;/i&gt;, seems to set her over the edge. In a blur of movement, she draws an arrow and aims it at your forehead.
&lt;img src=&quot;Images/ScarletVale/misc1.jpg&quot; width=600 /&gt;

&lt;&lt;NayaTalk &quot;Trust? How could I ever trust a human, after Hadamshal?&quot;&gt;&gt;\

[[Hadamshal...-&gt;Observatory2][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;\
@@.delayed;Hadamshal...@@

@@.delayed;...@@

@@.delayed;...@@

@@.delayed;&lt;img src=&quot;Images/ScarletVale/hadamshal1.jpg&quot; width=650 /&gt;
@@

@@.delayed;&lt;i&gt;[[Twelve years ago...-&gt;Observatory2][$p = 3]]&lt;/i&gt;@@

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;i&gt;It was supposed to be peaceful.

After years of diplomatic and military pressure, the last free elven principality of Hadamshal was to swear fealty to the kingdom. In exchange for peace and security, the elves would recognize human hegemony and pay tribute to the king.

You were only eighteen years old - a fledgling $class looking to prove yourself. As such, you were selected to take part in the grand escort of the king&#39;s ambassador to the palace in Hadamshal. 
&lt;img src=&quot;Images/ScarletVale/hadamshal2.jpg&quot; width=650 /&gt;

[[It was supposed to be peaceful.-&gt;Observatory2][$p = 4]]&lt;/i&gt;

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;i&gt;It all happened so quickly.

One moment, you were escorting the ambassador through the palace gates. Then, before you could blink, an elven dagger had been thrust into the ambassador&#39;s neck.
&lt;img src=&quot;Images/ScarletVale/hadamshal3.jpg&quot; width=500 /&gt;

Elven treachery. The order was given to find the assassin, but that quickly turned into a battle in the palace. The elves tried to defend themselves, and then reinforcements from the kingdom poured in.

[[In the end, Hadamshal burned, and the elves were scattered to the winds.-&gt;Observatory2][$p = 5]]&lt;/i&gt;

&lt;&lt;elseif $p eq 5&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;\
You blink away the memory. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; seems to be deciding whether to loose an arrow into your heart.
&lt;&lt;HeroTalk &quot;You were at Hadamshal?&quot;&gt;&gt;\
She nods, almost snarling.
&lt;&lt;HeroTalk &quot;Hadamshal was a tragedy. There was no honor or victory in its destruction.&quot;&gt;&gt;\
You sheathe your $weapon and fall to one knee.
&lt;&lt;HeroTalk &quot;Let me destroy the crystal, Naya. Please. No good can come in keeping it.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;You... you want to destroy it?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course.&quot;&gt;&gt;\
She blinks, then lowers her bow.
&lt;&lt;NayaTalk &quot;So do I.&quot;&gt;&gt;\

[[What?-&gt;Observatory2][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
&lt;&lt;HeroTalk &quot;Truly?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Truly. I came to the Tower of Zyr for the Catalyst in Ryz&#39;s telescope.&quot;&gt;&gt;\
She gestures to the telescope behind her.
&lt;img src=&quot;Images/ScarletVale/misc2.jpg&quot; width=400 /&gt;

&lt;&lt;NayaTalk &quot;Only a Netheryn Catalyst can destroy the Void Gem - the crystal the Redeemer seeks. But the Catalyst in this telescope is broken. It&#39;s useless.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Is there any other Catalyst in the Deep Woods?&quot;&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; nods.
&lt;&lt;NayaTalk &quot;Yes. According Zyr, there is one Catalyst that might still function. It-&quot;&gt;&gt;\

[[Her voice trails off-&gt;Observatory2][$p = 7]]

&lt;&lt;elseif $p eq 7&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;deathguard1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;deathguard&quot;&gt;&gt;\
\
The heavy &lt;i&gt;thud&lt;/i&gt; of steel boots against the cold stone floor. The whisper of a blade drawn from its sheathe. Before you turn around, you know who you&#39;ll see.

&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; and the Deathguard.
&lt;img src=&quot;Images/Character/deathguard1.jpg&quot; width=500 /&gt;

&lt;&lt;DomitusTalk &quot;$name - draw your weapon. It seems we&#39;ve found our elf bitch.&quot;&gt;&gt;\
He points his sword at &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s &lt;/b&gt;&lt;/span&gt; chest.
&lt;&lt;DomitusTalk &quot;Princess Naya of Hadamshal - your head will be a fine gift to the king.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Captain Domitus, this elf is needed for my quest. You cannot have her.&quot;&gt;&gt;\
&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; tilts his head, curious.
&lt;&lt;DomitusTalk &quot;I am a captain of the Deathguard. All elves are mine to subjugate.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;This is bigger than your petty bloodlust, Domitus! The world is at stake!&quot;&gt;&gt;\

[[Silence follows-&gt;Observatory2][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
There&#39;s a long, silent moment. Slowly, &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; shifts his sword, until its edge points at you.
&lt;&lt;DomitusTalk &quot;Careful, $name. Your words stink of heresy.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I was ordered by the king to defeat the Deep Wood&#39;s evil. Nothing I do in his name can be heresy.&quot;&gt;&gt;\
&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; turns to his soldiers.
&lt;&lt;DomitusTalk &quot;Look, men. Look how conviving elves can be. $name $title has been corrupted by their foul influence.&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;Death to the heretic!&quot;&gt;&gt;\
He looks back to you.
&lt;&lt;DomitusTalk &quot;Allow me to demonstrate the might of the Deathguard.&quot;&gt;&gt;\
Beside you, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; draws an arrow.
&lt;&lt;HeroTalk &quot;Naya, stay back.&quot;&gt;&gt;\

[[She doesn&#39;t-&gt;Observatory2][$p = 9]]

&lt;&lt;elseif $p eq 9&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle5_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;I ran at Hadamshal. I&#39;m not running anymore. Here.&quot;&gt;&gt;\
She tosses you a glowing potion. It restores your ailing health.
&lt;&lt;set $a = $maxhealth*0.9&gt;&gt;\
&lt;&lt;if $currenthealth lt $a&gt;&gt; &lt;&lt;set $currenthealth = $a&gt;&gt; &lt;&lt;else&gt;&gt; &lt;&lt;set $currenthealth = $maxhealth&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;HeroTalk &quot;Prepare yourself, Domitus - we won&#39;t go down lightly!&quot;&gt;&gt;\
&lt;&lt;DomitusTalk &quot;Good. I expect nothing less from the princess of Hadamshal and her doomed protector.&quot;&gt;&gt;\
\
&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;Domitus1Stats&gt;&gt; 
&lt;&lt;Naya1Stats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You defeated $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points! 
You gain the Sword of Judgement! Unrelenting power burns in the hardened steel.

[[Captain Domitus rises-&gt;Observatory2][$p = 21]]

&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $weaponinventory.push($swordofjudgement)&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;elseif $p eq 21&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;deathguard1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;deathguard&quot;&gt;&gt;\

Blood seeps from &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&#39;s&lt;/b&gt;&lt;/span&gt; dented helmet.
&lt;&lt;DomitusTalk &quot;Not bad, $name. It seems I underestimated your power.&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;Captain! You&#39;re bleeding!&quot;&gt;&gt;\
&lt;&lt;DomitusTalk &quot;I know that, imbecile! Now, lock these heretics in this room and bring this tower down!&quot;&gt;&gt;\
From his cloak, he pulls out a large, menacing-looking bomb.
&lt;img src=&quot;Images/ScarletVale/bomb1.jpg&quot; width=450 /&gt;
&lt;&lt;DomitusTalk &quot;Pray to the Gods for mercy, $name, for I will give you none.&quot;&gt;&gt;\
You charge at the door, but the Deathguard are too quick. It slams shut before you can make it, locking you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; inside. You try your key, but it&#39;s clear that the Deathguard have barred the door from the other side.

[[We&#39;re trapped!-&gt;Observatory2][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;tower1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;tower&quot;&gt;&gt;\

&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; scans the room, looking for some means of escape, but it is clear that there&#39;s none. The Deathguard are going to destroy the Tower of Zyr in a massive explosion, and you&#39;re trapped on the top floor.

Unless...
&lt;&lt;HeroTalk &quot;Zyr! Can you hear me?&quot;&gt;&gt;\
The disembodied voice of the Arcane Librarian floats into your mind.
&lt;&lt;Zyr2Talk &quot;Of course, $name $title. I have full telepathic access across my entire tower. I sensed Ryz&#39;s passing. I am most grateful that you released him from his long madness.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Your tower is about to come crashing down to the forest floor. Come to the observatory, release us, and the three of us can escape together.&quot;&gt;&gt;\
&lt;&lt;Zyr2Talk &quot;I&#39;m afraid that&#39;s not possible, $name $title. My creators have restricted me to the tower. I cannot leave. And besides, my books are here.&quot;&gt;&gt;\
You curse under your breath.
&lt;&lt;HeroTalk &quot;&lt;i&gt;Forget about the damned books&lt;/i&gt;!&quot;&gt;&gt;\
&lt;&lt;Zyr2Talk &quot;I cannot leave... but...&quot;&gt;&gt;\
There&#39;s a wild rumbling beneath your feet. 

[[The first bomb has gone off-&gt;Observatory2][$p = 23]]

&lt;&lt;elseif $p eq 23&gt;&gt;\
&lt;&lt;HeroTalk &quot;But?!&quot;&gt;&gt;\
&lt;&lt;Zyr2Talk &quot;If I could divert the teleportation field from the lower hall... yes... &lt;i&gt;how curious&lt;/i&gt;! I may be able to remove you from the tower-&quot;&gt;&gt;\
Another explosion. The tower is falling apart.
&lt;img src=&quot;Images/Scarletvale/bomb2.jpg&quot; width=500 /&gt;

&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; looks at you and mouths &lt;i&gt;&#39;What&#39;s happening?&#39;&lt;/i&gt;
&lt;&lt;HeroTalk &quot;Do it, Zyr! Get us out, &lt;i&gt;now&lt;/i&gt;!&quot;&gt;&gt;\
&lt;&lt;Zyr2Talk &quot;But I don&#39;t know where you&#39;ll end up.&quot;&gt;&gt;\
Your stomach lurches as the floor beneath your feet splinters, and the whole tower starts to lean...
&lt;&lt;HeroTalk &quot;&lt;i&gt;NOW, ZYR!&lt;/i&gt;&quot;&gt;&gt;\

[[Everything turns white-&gt;Observatory2][$p = 24]]
\
\
&lt;&lt;set $valequest = 15&gt;&gt;\
&lt;&lt;set $frozenquest = 1&gt;&gt;\
&lt;&lt;set $currenthealth = 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 24&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;\

Chapter 2 @@.delayed;...@@

@@.delayed;...@@

@@.delayed;...@@

@@.delayed;Complete.@@

@@.delayed;[[Continue-&gt;Interlude2][$p = 0]]
 @@
\
&lt;&lt;set $check3 = random(1,4)&gt;&gt;\
&lt;&lt;if $check3 eq 1&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Scholar&lt;/b&gt; in a new game to start off with 500 exp!&lt;/i&gt;@@
&lt;&lt;elseif $check3 eq 2&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Hero of Hadamshal&lt;/b&gt; in a new game to start off with increased stats!&lt;/i&gt;@@
&lt;&lt;elseif $check3 eq 3&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Silverblooded&lt;/b&gt; in a new game to start off with 20 base armor!&lt;/i&gt;@@
&lt;&lt;elseif $check3 eq 4&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Hedge Knight&lt;/b&gt; in a new game to start off with a full set of iron armor!&lt;/i&gt;@@
&lt;&lt;/if&gt;&gt;\
\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="79" name="AllyBattle1" tags="" position="732,26" size="100,100">&lt;&lt;if $p eq 10&gt;&gt; &lt;&lt;Aura&gt;&gt;\
\
You and $allyname are fighting $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;i&gt;&lt;&lt;ItemAbilityRun&gt;&gt;&lt;&lt;if ($battlecount eq 0) and ($setbonus gte 1)&gt;&gt;&lt;&lt;SetBonus&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/i&gt;
\
&lt;&lt;if $allyturn eq 1&gt;&gt; &lt;&lt;set $allyturn = 0&gt;&gt; &lt;&lt;else&gt;&gt; &lt;&lt;set $allyturn = 1&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;if $stun lte 0&gt;&gt; &lt;&lt;set $action = &quot;notstun&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;if $stun gte 1&gt;&gt;&lt;&lt;set $action = &quot;stun&quot;&gt;&gt;&lt;&lt;set $stun -= 1&gt;&gt;You are stunned, and cannot take action!&lt;&lt;else&gt;&gt;\
\
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt;&lt;b&gt;Combat Points&lt;/b&gt;: $combatpoints / 5 
&lt;&lt;/if&gt;&gt;\
&lt;b&gt;General Actions&lt;/b&gt;:
&lt;&lt;link &quot;Attack&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;attack&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;if $flee eq 1&gt;&gt;&lt;&lt;link &quot;Flee&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;flee&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;i&gt;You cannot flee from this battle!&lt;/i&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;td&gt;\
&lt;b&gt;Class Abilities&lt;/b&gt;:
&lt;&lt;for _i to 0; _i lt $abilityinventory.length; _i++&gt;&gt;\
&lt;&lt;print $abilityinventory[_i].name&gt;&gt; (Mana cost: $abilityinventory[_i].mana )\
&lt;&lt;capture _i&gt;&gt;\
		&lt;&lt;if $currentmana lt $abilityinventory[_i].mana&gt;&gt;&lt;i&gt;Not enough mana&lt;/i&gt;&lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($combatpoints lt $abilityinventory[_i].combatcost)&gt;&gt;&lt;i&gt;Not enough Combat Points&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;ability&quot;&gt;&gt; &lt;&lt;set $ability = $abilityinventory[_i].widgetname&gt;&gt; &lt;&lt;set $abilitymana = $abilityinventory[_i].mana&gt;&gt; &lt;&lt;set $abilitylevel = $abilityinventory[_i].level&gt;&gt; &lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;/td&gt;\
&lt;td&gt;\
&lt;b&gt;Items ($potioncount / 10)&lt;/b&gt;:
&lt;&lt;if $potioncount gte 10&gt;&gt;&lt;i&gt;You can only drink up to 10 potions in a single battle!&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;&lt;for _i to 0; _i lt $iteminventory.length; _i++&gt;&gt;\
&lt;&lt;print $iteminventory[_i].name&gt;&gt; (Quantity: &lt;&lt;print $iteminventory[_i].quantity&gt;&gt;) \
&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $iteminventory[_i].quantity lte 0&gt;&gt; &lt;i&gt;None left&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt; &lt;&lt;set $action = &quot;item&quot;&gt;&gt; &lt;&lt;set $item = $iteminventory[_i].name&gt;&gt;
			&lt;&lt;set $iteminventory[_i].quantity -= 1&gt;&gt;\
			&lt;&lt;set $itemstrength = $iteminventory[_i].strength&gt;&gt;\
			&lt;&lt;set $itemagility = $iteminventory[_i].agility&gt;&gt;\
			&lt;&lt;set $itemwillpower = $iteminventory[_i].willpower&gt;&gt;\
			&lt;&lt;set $itemarmor = $iteminventory[_i].armor&gt;&gt;\
			&lt;&lt;set $itemhealth = $iteminventory[_i].health&gt;&gt;\
			&lt;&lt;set $itemmana = $iteminventory[_i].mana&gt;&gt;\
			&lt;&lt;set $itemevadescore = $iteminventory[_i].evadescore&gt;&gt;\
			&lt;&lt;set $potioncount += 1&gt;&gt;\
			&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;/td&gt;\
&lt;/table&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;stun&quot;&gt;&gt;&lt;&lt;if $allyturn eq 1&gt;&gt;&lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 13&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;
\
&lt;&lt;set $battlecount += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 11&gt;&gt; 
You and $allyname are fighting a $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;

&lt;&lt;if $action eq &quot;attack&quot;&gt;&gt;You attempt to hit the $enemyname with your $weapon!

&lt;&lt;AttackAttempt&gt;&gt;
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;You deal damage to the $enemyname!

&lt;&lt;AttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;flee&quot;&gt;&gt;You attempt to flee from the $enemyname!

&lt;&lt;FleeAttempt&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;ability&quot;&gt;&gt;&lt;&lt;Ability $ability&gt;&gt;&lt;&lt;/Ability&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $action eq &quot;item&quot;&gt;&gt;You used your $item!
&lt;&lt;ItemImage $item 150&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;
&lt;&lt;ItemUse&gt;&gt;
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;The enemy is slain! Victory!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $action eq &quot;flee success&quot;&gt;&gt;&lt;&lt;link &quot;You escape!&quot; $passage&gt;&gt;&lt;&lt;set $p = 19&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $allyturn eq 1&gt;&gt;&lt;&lt;link &quot;Ally turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 13&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;\

&lt;&lt;elseif $p eq 12&gt;&gt; \
You and $allyname are fighting a $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;EnemyStun&gt;&gt;
\
&lt;&lt;if $enemyaction eq &quot;attack&quot;&gt;&gt;The $enemyname attacks you!

&lt;&lt;EnemyAttackAttempt&gt;&gt;

&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;The $enemyname deals damage to you!

&lt;&lt;EnemyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if ($enemyaction neq &quot;stun&quot;) and ($enemyaction neq &quot;attack&quot;) and ($enemyaction neq &quot;attack success&quot;) and ($enemyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;EnemyAbility $enemyaction&gt;&gt;&lt;&lt;/EnemyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]]&lt;&lt;elseif $allycurrenthealth lte 0&gt;&gt;[[Your ally is slain!-&gt;Game Over]]&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Player turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;\
\
&lt;&lt;elseif $p eq 13&gt;&gt;\
\
\
\
You and $allyname are fighting a $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;set $allyaction = $allyability.pluck()&gt;&gt;\
&lt;&lt;set $allyability.push($allyaction)&gt;&gt;

&lt;&lt;if $allyaction eq &quot;attack&quot;&gt;&gt;$allyname attacks $enemyname

&lt;&lt;AllyAttackAttempt&gt;&gt;

&lt;&lt;if $allyaction eq &quot;attack success&quot;&gt;&gt;The $allyname deals damage to $enemyname!

&lt;&lt;AllyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if ($allyaction neq &quot;attack&quot;) and ($allyaction neq &quot;attack success&quot;) and ($allyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;AllyAbility $allyaction&gt;&gt;&lt;&lt;/AllyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $enemycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;The enemy is slain! Victory!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;\
\

&lt;&lt;elseif $p eq 19&gt;&gt; 
You flee from the $enemyname - better to bandage your wounds and do battle another day than foolishly fight to the death.

As you near the safety of the cabin, you realize your coin purse is a bit lighter than before. Some gold pieces must have fallen out while you were running away.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $goldloss = $enemymaxgold&gt;&gt; \
&lt;&lt;set $gold -= $goldloss&gt;&gt; \
\
&lt;&lt;BattleEnd&gt;&gt;\
\
\
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
This page should not come up, as you should be out of the $passage passage and into the $returnpassage passage.

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="80" name="Ally Abilities" tags="widget" position="202,1026" size="100,100">ALLY ABILITIES

&lt;&lt;widget &quot;BurningVolley&quot;&gt;&gt;\
$allyname launches a volley of burning arrows!
&lt;&lt;AllyAbilityImage $allyaction 350&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allyagility&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $enemyarmor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lt 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;set $enemystrength -= 5&gt;&gt;\
&lt;&lt;set $enemyagility -= 5&gt;&gt;\

The first arrow deals $abilityvalue damage - $enemyname&#39;s armor reduces the damage taken - $enemyname takes $abilityvalue2 damage!

The second arrow deals $abilityvalue damage - $enemyname&#39;s armor reduces the damage taken - $enemyname takes $abilityvalue2 damage!

The third arrow deals $abilityvalue damage - $enemyname&#39;s armor reduces the damage taken - $enemyname takes $abilityvalue2 damage!

$enemyname loses 5 strength!
$enemyname loses 5 agility!
\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;CallToArms&quot;&gt;&gt;\
$allyname calls on you to strive for victory!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower/5&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialstrength += $abilityvalue&gt;&gt;\
&lt;&lt;set $specialarmor += $abilityvalue&gt;&gt;\

You gain $abilityvalue strength!
You gain $abilityvalue armor!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;CalmedHeart&quot;&gt;&gt;\
$allyname saps the rage from $enemyname&#39;s heart!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower/4&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemystrength -= $abilityvalue&gt;&gt;\

$enemyname loses $abilityvalue strength!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;GoldenFist&quot;&gt;&gt;\
$allyname strikes the $enemyname with a golden fist!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allystrength/4&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $allymaxdamage&gt;&gt;\
&lt;&lt;set $abilityvalue3 = $allystrength/15&gt;&gt;\
&lt;&lt;set $abilityvalue3 = Math.round($abilityvalue3)&gt;&gt;\
&lt;&lt;set $enemystrength -= $abilityvalue3&gt;&gt;\

The punch breaks $enemyname&#39;s armor by $abilityvalue!
The punch deals $abilityvalue2 damage to $enemyname!
The punch reduces $enemyname&#39;s strength by $abilityvalue3!

&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt;\

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;GoldenHeart&quot;&gt;&gt;\
$allyname bestows upon you the heart of the golden golems! Your lifeforce surges!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue2 = $allywillpower/10&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $specialwillpower += $abilityvalue2&gt;&gt;\
&lt;&lt;set $abilityvalue = $allywillpower*2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth += $abilityvalue&gt;&gt;\

You gain $abilityvalue2 willpower!
You gain $abilityvalue health!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;GoldenWall&quot;&gt;&gt;\
&lt;&lt;if $allycurrenthealth gte 250&gt;&gt;$allyname uses its blood to forge a golden wall around you!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialarmor += $abilityvalue&gt;&gt;\
&lt;&lt;set $allycurrenthealth -= $abilityvalue&gt;&gt;\

You gain $abilityvalue armor!
$allyname loses $abilityvalue health!
\
&lt;&lt;else&gt;&gt;$allyname hardens its golden skin!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $allycurrenthealth += $abilityvalue&gt;&gt;\

$allyname gains $abilityvalue health!
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;IceShatterArrow&quot;&gt;&gt;\
$allyname launches an arrow of piercing ice!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $allymaxdamage&gt;&gt;\

The arrow reduces $enemyname&#39;s armor by $abilityvalue!
The arrow deals $abilityvalue2 damage to $enemyname!

&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue&gt;&gt;\

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Inspire&quot;&gt;&gt;\
$allyname calls upon the ghosts of Hadamshal to lend you aid!
&lt;&lt;AllyAbilityImage $allyaction 400&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower/6&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialstrength += $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility += $abilityvalue&gt;&gt;\
&lt;&lt;set $specialwillpower += $abilityvalue&gt;&gt;\
&lt;&lt;set $specialarmor += $abilityvalue&gt;&gt;\

You gain $abilityvalue strength!
You gain $abilityvalue agility!
You gain $abilityvalue willpower!
You gain $abilityvalue armor!
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;LuminousShield&quot;&gt;&gt;\
$allyname surrounds you in a shield of light!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialarmor += $abilityvalue&gt;&gt;\

You gain $abilityvalue armor!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;PotionOfCourage&quot;&gt;&gt;\
$allyname throws you a potion of courage. Tastes like fresh coffee!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower/10&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $allywillpower/6&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $specialstrength += $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility += $abilityvalue&gt;&gt;\
&lt;&lt;set $specialarmor += $abilityvalue2&gt;&gt;\

You gain $abilityvalue strength!
You gain $abilityvalue agility!
You gain $abilityvalue2 armor!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;PotionOfChaos&quot;&gt;&gt;\
$allyname throws a potion filled with chaos at $enemyname - it explodes with an elemental burst!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $allywillpower/20&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemystrength -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemyagility -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemywillpower -= $abilityvalue2&gt;&gt;\

$enemyname loses $abilityvalue health!
$enemyname loses $abilityvalue2 strength!
$enemyname loses $abilityvalue2 agility!
$enemyname loses $abilityvalue2 willpower!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;PotionOfHolyFire&quot;&gt;&gt;\
$allyname throws a potion filled with holy fire at $enemyname - it burns the undead!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower/2&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $allywillpower/10&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemystun += 1&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue2&gt;&gt;\

$enemyname loses $abilityvalue health!
$enemyname loses $abilityvalue2 armor!
$enemyname is stunned!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;PotionOfLife&quot;&gt;&gt;\
$allyname tosses you a powerful healing potion. Tastes fantastic!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower*1.25&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth += $abilityvalue&gt;&gt;\

You gain $abilityvalue health!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;SpiritBlade&quot;&gt;&gt;\
$allyname&#39;s blade glows with magic!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $allystrength += $abilityvalue&gt;&gt;\
&lt;&lt;set $allyagility += $abilityvalue&gt;&gt;\

$allyname gains $abilityvalue strength!
$allyname gains $abilityvalue agility!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Starfire&quot;&gt;&gt;\
$allyname unleashes an arrow of pure starfire!
&lt;&lt;AllyAbilityImage $allyaction 350&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allyagility*2&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $allystrength&gt;&gt;\

The arrow reduces $enemyname&#39;s armor by $abilityvalue2!
The arrow deals $abilityvalue damage to $enemyname!
$enemyname is stunned!

&lt;&lt;set $enemycurrenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemystun += 1&gt;&gt;\

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;StunDart&quot;&gt;&gt;\
$allyname sends out a paralyzing dart!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $enemystun += 1&gt;&gt;\

$enemyname is stunned!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;TylaesGrace&quot;&gt;&gt;\
$allyname bestows you with Tylae&#39;s grace!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower/6&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $specialstrength += $abilityvalue&gt;&gt;\
&lt;&lt;set $specialagility += $abilityvalue&gt;&gt;\
&lt;&lt;set $specialwillpower += $abilityvalue&gt;&gt;\

You gain $abilityvalue strength!
You gain $abilityvalue agility!
You gain $abilityvalue willpower!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;TylaesLight&quot;&gt;&gt;\
$allyname bestows you with Tylae&#39;s light!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allywillpower*3&gt;&gt;\
&lt;&lt;set $currenthealth += $abilityvalue&gt;&gt;\

You gain $abilityvalue health!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Volley&quot;&gt;&gt;\
$allyname launches a volley of arrows!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $allyagility*0.75&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $enemyarmor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lt 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\

The first arrow deals $abilityvalue damage - $enemyname&#39;s armor reduces the damage taken - $enemyname takes $abilityvalue2 damage!

The second arrow deals $abilityvalue damage - $enemyname&#39;s armor reduces the damage taken - $enemyname takes $abilityvalue2 damage!

The third arrow deals $abilityvalue damage - $enemyname&#39;s armor reduces the damage taken - $enemyname takes $abilityvalue2 damage!

&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Whirlwind&quot;&gt;&gt;\
$allyname delivers a series of strikes in rapid succession!
&lt;&lt;AllyAbilityImage $allyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = ($allyagility*0.3) + ($allystrength*0.3)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $enemyarmor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lt 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\

The first strike deals $abilityvalue damage - $enemyname&#39;s armor reduces the damage taken - $enemyname takes $abilityvalue2 damage!

The second strike deals $abilityvalue damage - $enemyname&#39;s armor reduces the damage taken - $enemyname takes $abilityvalue2 damage!

The third strike deals $abilityvalue damage - $enemyname&#39;s armor reduces the damage taken - $enemyname takes $abilityvalue2 damage!

The fourth strike deals $abilityvalue damage - $enemyname&#39;s armor reduces the damage taken - $enemyname takes $abilityvalue2 damage!

&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth -= $abilityvalue2&gt;&gt;\

&lt;&lt;/widget&gt;&gt;\

ENEMY ALLY ABILITIES

&lt;&lt;widget &quot;EvilIceShatterArrow&quot;&gt;&gt;\
$enemyallyname launches an arrow of piercing ice at you!
&lt;&lt;AllyAbilityImage $enemyallyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemyallywillpower/3&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemyallymaxdamage&gt;&gt;\

The arrow reduces your armor by $abilityvalue!
The arrow deals $abilityvalue2 damage to you!

&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue&gt;&gt;\

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;EvilStunDart&quot;&gt;&gt;\
$enemyallyname hits you with a paralyzing dart!
&lt;&lt;AllyAbilityImage $enemyallyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $stun += 1&gt;&gt;\

You are stunned!

&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;EvilVolley&quot;&gt;&gt;\
$enemyallyname launches a volley of arrows at you!
&lt;&lt;AllyAbilityImage $enemyallyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemyallyagility*0.75&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $abilityvalue - $armor&gt;&gt;\
&lt;&lt;if $abilityvalue2 lt 0&gt;&gt; &lt;&lt;set $abilityvalue2 = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\

The first arrow deals $abilityvalue damage - your armor reduces the damage taken - you take $abilityvalue2 damage!

The second arrow deals $abilityvalue damage - your armor reduces the damage taken - you take $abilityvalue2 damage!

The third arrow deals $abilityvalue damage - your armor reduces the damage taken - you take $abilityvalue2 damage!

&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue2&gt;&gt;\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;EvilDarkBrotherhood&quot;&gt;&gt;\
$enemyallyname feeds its ally void energy!
&lt;&lt;AllyAbilityImage $enemyallyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemyallywillpower&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;
&lt;&lt;set $abilityvalue2 = $enemyallywillpower/5&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue2&gt;&gt;\
&lt;&lt;set $enemyagility += $abilityvalue2&gt;&gt;\
\
$enemyname gains $abilityvalue health!
$enemyname gains $abilityvalue2 strength!
$enemyname gains $abilityvalue2 agility!
\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;EvilViciousness&quot;&gt;&gt;\
$enemyallyname strikes with darkened claw and sharpened fang!
&lt;&lt;AllyAbilityImage $enemyallyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemyallystrength + ($enemyallyagility/2)&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemyallystrength/4&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
&lt;&lt;set $specialarmor -= $abilityvalue2&gt;&gt;\

You take $abilityvalue damage!
You lose $abilityvalue2 armor!
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Rejuvenate&quot;&gt;&gt;\
$enemyallyname uses dark magic to rejevenate $enemyname!
&lt;&lt;AllyAbilityImage $enemyallyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemyallywillpower*2&gt;&gt;\
&lt;&lt;set $enemycurrenthealth += $abilityvalue&gt;&gt;
\
$enemyname gains $abilityvalue health!
&lt;&lt;if $enemystun gte 1&gt;&gt; $enemyname is no longer stunned!&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $enemystun gte 1&gt;&gt; &lt;&lt;set $enemystun = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;RegalGlory&quot;&gt;&gt;\
$enemyallyname bestows $enemyname with the old glory of Netheryn!
&lt;&lt;AllyAbilityImage $enemyallyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemyallywillpower/10&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $enemywillpower += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyagility += $abilityvalue&gt;&gt;\

$enemyname gains $abilityvalue agility!
$enemyname gains $abilityvalue willpower!
&lt;&lt;if $enemystun gte 1&gt;&gt; $enemyname is no longer stunned!&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $enemystun gte 1&gt;&gt; &lt;&lt;set $enemystun = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
\
\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Grandeur&quot;&gt;&gt;\
$enemyallyname fills $enemyname with the grandeur of the Void!
&lt;&lt;AllyAbilityImage $enemyallyaction 250&gt;&gt;&lt;&lt;/AllyAbilityImage&gt;&gt;
&lt;&lt;set $abilityvalue = $enemyallywillpower/11&gt;&gt;\
&lt;&lt;set $abilityvalue2 = $enemyallywillpower/7&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $abilityvalue2 = Math.round($abilityvalue2)&gt;&gt;\
&lt;&lt;set $enemystrength += $abilityvalue&gt;&gt;\
&lt;&lt;set $enemyarmor += $abilityvalue2&gt;&gt;\

$enemyname gains $abilityvalue strength!
$enemyname gains $abilityvalue2 armor!
&lt;&lt;if $enemystun gte 1&gt;&gt; $enemyname is no longer stunned!&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $enemystun gte 1&gt;&gt; &lt;&lt;set $enemystun = 0&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
\
\
&lt;&lt;/widget&gt;&gt;\






















</tw-passagedata><tw-passagedata pid="81" name="Ally Stat Blocks" tags="widget nobr" position="203,658" size="100,100">ALLY STAT BLOCKS

&lt;&lt;widget &quot;BabarStats&quot;&gt;&gt;
&lt;&lt;set $allyname = &quot;Babar Ogho&quot;&gt;&gt;
&lt;&lt;set $allymaxhealth = 800&gt;&gt;
&lt;&lt;set $allycurrenthealth = 800&gt;&gt;
&lt;&lt;set $allystrength = 30&gt;&gt;
&lt;&lt;set $allyagility = 10&gt;&gt;
&lt;&lt;set $allywillpower = 80&gt;&gt;
&lt;&lt;set $allybaseevade = 35&gt;&gt;
&lt;&lt;set $allyevadescore = $allyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $allyarmor = 20&gt;&gt;
&lt;&lt;set $allymindamage = 5&gt;&gt;
&lt;&lt;set $allymaxdamage = 10&gt;&gt;
&lt;&lt;set $allymingold = 5000&gt;&gt;
&lt;&lt;set $allymaxgold = 6000&gt;&gt;
&lt;&lt;set $allyminexp = 100&gt;&gt;
&lt;&lt;set $allymaxexp = 200&gt;&gt;
&lt;&lt;set $allyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $allyimage = &quot;merchant3&quot;&gt;&gt;
&lt;&lt;set $allyability = []&gt;&gt;
&lt;&lt;set $allyability.push(&quot;PotionOfLife&quot;, &quot;PotionOfLife&quot;, &quot;PotionOfCourage&quot;, &quot;PotionOfHolyFire&quot;, &quot;PotionOfChaos&quot;)&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Naya1Stats&quot;&gt;&gt;
&lt;&lt;set $allyname = &quot;Naya&quot;&gt;&gt;
&lt;&lt;set $allymaxhealth = 300&gt;&gt;
&lt;&lt;set $allycurrenthealth = 300&gt;&gt;
&lt;&lt;set $allystrength = 20&gt;&gt;
&lt;&lt;set $allyagility = 50&gt;&gt;
&lt;&lt;set $allywillpower = 30&gt;&gt;
&lt;&lt;set $allybaseevade = 50&gt;&gt;
&lt;&lt;set $allyevadescore = $allyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $allyarmor = 15&gt;&gt;
&lt;&lt;set $allymindamage = 30&gt;&gt;
&lt;&lt;set $allymaxdamage = 40&gt;&gt;
&lt;&lt;set $allymingold = 100&gt;&gt;
&lt;&lt;set $allymaxgold = 200&gt;&gt;
&lt;&lt;set $allyminexp = 100&gt;&gt;
&lt;&lt;set $allymaxexp = 200&gt;&gt;
&lt;&lt;set $allyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $allyimage = &quot;naya1&quot;&gt;&gt;
&lt;&lt;set $allyability = []&gt;&gt;
&lt;&lt;set $allyability.push(&quot;attack&quot;, &quot;StunDart&quot;, &quot;IceShatterArrow&quot;, &quot;Volley&quot;)&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Naya2Stats&quot;&gt;&gt;
&lt;&lt;set $allyname = &quot;Princess Naya of Hadamshal&quot;&gt;&gt;
&lt;&lt;set $allymaxhealth = 500&gt;&gt;
&lt;&lt;set $allycurrenthealth = 500&gt;&gt;
&lt;&lt;set $allystrength = 30&gt;&gt;
&lt;&lt;set $allyagility = 85&gt;&gt;
&lt;&lt;set $allywillpower = 50&gt;&gt;
&lt;&lt;set $allybaseevade = 70&gt;&gt;
&lt;&lt;set $allyevadescore = $allyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $allyarmor = 50&gt;&gt;
&lt;&lt;set $allymindamage = 75&gt;&gt;
&lt;&lt;set $allymaxdamage = 125&gt;&gt;
&lt;&lt;set $allymingold = 100&gt;&gt;
&lt;&lt;set $allymaxgold = 200&gt;&gt;
&lt;&lt;set $allyminexp = 100&gt;&gt;
&lt;&lt;set $allymaxexp = 200&gt;&gt;
&lt;&lt;set $allyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $allyimage = &quot;naya1&quot;&gt;&gt;
&lt;&lt;set $allyability = []&gt;&gt;
&lt;&lt;set $allyability.push(&quot;attack&quot;, &quot;Starfire&quot;, &quot;BurningVolley&quot;, &quot;Inspire&quot;)&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Nendel1Stats&quot;&gt;&gt;
&lt;&lt;set $allyname = &quot;Nendel&quot;&gt;&gt;
&lt;&lt;set $allymaxhealth = 450&gt;&gt;
&lt;&lt;set $allycurrenthealth = 450&gt;&gt;
&lt;&lt;set $allystrength = 45&gt;&gt;
&lt;&lt;set $allyagility = 45&gt;&gt;
&lt;&lt;set $allywillpower = 45&gt;&gt;
&lt;&lt;set $allybaseevade = 50&gt;&gt;
&lt;&lt;set $allyevadescore = $allyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $allyarmor = 30&gt;&gt;
&lt;&lt;set $allymindamage = 50&gt;&gt;
&lt;&lt;set $allymaxdamage = 75&gt;&gt;
&lt;&lt;set $allymingold = 100&gt;&gt;
&lt;&lt;set $allymaxgold = 200&gt;&gt;
&lt;&lt;set $allyminexp = 100&gt;&gt;
&lt;&lt;set $allymaxexp = 200&gt;&gt;
&lt;&lt;set $allyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $allyimage = &quot;nendel1&quot;&gt;&gt;
&lt;&lt;set $allyability = []&gt;&gt;
&lt;&lt;set $allyability.push(&quot;attack&quot;, &quot;SpiritBlade&quot;, &quot;Whirlwind&quot;, &quot;CallToArms&quot;)&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;OriStats&quot;&gt;&gt;
&lt;&lt;set $allyname = &quot;Oriazus the Resplendant&quot;&gt;&gt;
&lt;&lt;set $allymaxhealth = 1000&gt;&gt;
&lt;&lt;set $allycurrenthealth = 1000&gt;&gt;
&lt;&lt;set $allystrength = 100&gt;&gt;
&lt;&lt;set $allyagility = 10&gt;&gt;
&lt;&lt;set $allywillpower = 100&gt;&gt;
&lt;&lt;set $allybaseevade = 15&gt;&gt;
&lt;&lt;set $allyevadescore = $allyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $allyarmor = 50&gt;&gt;
&lt;&lt;set $allymindamage = 60&gt;&gt;
&lt;&lt;set $allymaxdamage = 120&gt;&gt;
&lt;&lt;set $allymingold = 100&gt;&gt;
&lt;&lt;set $allymaxgold = 200&gt;&gt;
&lt;&lt;set $allyminexp = 100&gt;&gt;
&lt;&lt;set $allymaxexp = 200&gt;&gt;
&lt;&lt;set $allyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $allyimage = &quot;ori1&quot;&gt;&gt;
&lt;&lt;set $allyability = []&gt;&gt;
&lt;&lt;set $allyability.push(&quot;attack&quot;, &quot;attack&quot;, &quot;GoldenWall&quot;, &quot;GoldenWall&quot;, &quot;GoldenFist&quot;, &quot;GoldenFist&quot;, &quot;GoldenHeart&quot;)&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Witch1Stats&quot;&gt;&gt;
&lt;&lt;set $allyname = &quot;Scyllia, Priestess of Tylae&quot;&gt;&gt;
&lt;&lt;set $allymaxhealth = 500&gt;&gt;
&lt;&lt;set $allycurrenthealth = 500&gt;&gt;
&lt;&lt;set $allystrength = 10&gt;&gt;
&lt;&lt;set $allyagility = 30&gt;&gt;
&lt;&lt;set $allywillpower = 50&gt;&gt;
&lt;&lt;set $allybaseevade = 50&gt;&gt;
&lt;&lt;set $allyevadescore = $allyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $allyarmor = 10&gt;&gt;
&lt;&lt;set $allymindamage = 25&gt;&gt;
&lt;&lt;set $allymaxdamage = 35&gt;&gt;
&lt;&lt;set $allymingold = 100&gt;&gt;
&lt;&lt;set $allymaxgold = 200&gt;&gt;
&lt;&lt;set $allyminexp = 100&gt;&gt;
&lt;&lt;set $allymaxexp = 200&gt;&gt;
&lt;&lt;set $allyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $allyimage = &quot;witch1&quot;&gt;&gt;
&lt;&lt;set $allyability = []&gt;&gt;
&lt;&lt;set $allyability.push(&quot;TylaesLight&quot;, &quot;LuminousShield&quot;, &quot;TylaesGrace&quot;, &quot;CalmedHeart&quot;)&gt;&gt;
&lt;&lt;/widget&gt;&gt;

ENEMY ALLY STAT BLOCKS

&lt;&lt;widget &quot;NayaEnemyStats&quot;&gt;&gt;
&lt;&lt;set $enemyallyname = &quot;Naya&quot;&gt;&gt;
&lt;&lt;set $enemyallymaxhealth = 300&gt;&gt;
&lt;&lt;set $enemyallycurrenthealth = 300&gt;&gt;
&lt;&lt;set $enemyallystrength = 20&gt;&gt;
&lt;&lt;set $enemyallyagility = 50&gt;&gt;
&lt;&lt;set $enemyallywillpower = 30&gt;&gt;
&lt;&lt;set $enemyallybaseevade = 50&gt;&gt;
&lt;&lt;set $enemyallyevadescore = $enemyallyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyallyarmor = 15&gt;&gt;
&lt;&lt;set $enemyallymindamage = 30&gt;&gt;
&lt;&lt;set $enemyallymaxdamage = 40&gt;&gt;
&lt;&lt;set $enemyallymingold = 100&gt;&gt;
&lt;&lt;set $enemyallymaxgold = 200&gt;&gt;
&lt;&lt;set $enemyallyminexp = 100&gt;&gt;
&lt;&lt;set $enemyallymaxexp = 200&gt;&gt;
&lt;&lt;set $enemyallyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $enemyallyimage = &quot;naya1&quot;&gt;&gt;
&lt;&lt;set $enemyallyability = []&gt;&gt;
&lt;&lt;set $enemyallyability.push(&quot;EvilStunDart&quot;, &quot;EvilIceShatterArrow&quot;, &quot;EvilVolley&quot;)&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;VoidGoblinEnemyStats&quot;&gt;&gt;
&lt;&lt;set $enemyallyname = &quot;Void Goblin&quot;&gt;&gt;
&lt;&lt;set $enemyallymaxhealth = 500&gt;&gt;
&lt;&lt;set $enemyallycurrenthealth = 500&gt;&gt;
&lt;&lt;set $enemyallystrength = 40&gt;&gt;
&lt;&lt;set $enemyallyagility = 65&gt;&gt;
&lt;&lt;set $enemyallywillpower = 40&gt;&gt;
&lt;&lt;set $enemyallybaseevade = 75&gt;&gt;
&lt;&lt;set $enemyallyevadescore = $enemyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyallyarmor = 35&gt;&gt;
&lt;&lt;set $enemyallymindamage = 40&gt;&gt;
&lt;&lt;set $enemyallymaxdamage = 50&gt;&gt;
&lt;&lt;set $enemyallymingold = 140&gt;&gt;
&lt;&lt;set $enemyallymaxgold = 160&gt;&gt;
&lt;&lt;set $enemyallyminexp = 130&gt;&gt;
&lt;&lt;set $enemyallymaxexp = 140&gt;&gt;
&lt;&lt;set $enemyallyregion = &quot;DarkHeart&quot;&gt;&gt;
&lt;&lt;set $enemyallyimage = &quot;void3&quot;&gt;&gt;
&lt;&lt;set $enemyallyability = []&gt;&gt;
&lt;&lt;set $enemyallyability.push(&quot;EvilDarkBrotherhood&quot;, &quot;EvilViciousness&quot;)&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;Domedra1Stats&quot;&gt;&gt;
&lt;&lt;set $enemyallyname = &quot;Queen Domedra of Netheryn&quot;&gt;&gt;
&lt;&lt;set $enemyallymaxhealth = 3000&gt;&gt;
&lt;&lt;set $enemyallycurrenthealth = 3000&gt;&gt;
&lt;&lt;set $enemyallystrength = 30&gt;&gt;
&lt;&lt;set $enemyallyagility = 70&gt;&gt;
&lt;&lt;set $enemyallywillpower = 120&gt;&gt;
&lt;&lt;set $enemyallybaseevade = 60&gt;&gt;
&lt;&lt;set $enemyallyevadescore = $enemyallyagility + $enemybaseevade&gt;&gt;
&lt;&lt;set $enemyallyarmor = 50&gt;&gt;
&lt;&lt;set $enemyallymindamage = 70&gt;&gt;
&lt;&lt;set $enemyallymaxdamage = 125&gt;&gt;
&lt;&lt;set $enemyallymingold = 100&gt;&gt;
&lt;&lt;set $enemyallymaxgold = 200&gt;&gt;
&lt;&lt;set $enemyallyminexp = 100&gt;&gt;
&lt;&lt;set $enemyallymaxexp = 200&gt;&gt;
&lt;&lt;set $enemyallyregion = &quot;Character&quot;&gt;&gt;
&lt;&lt;set $enemyallyimage = &quot;domedra1&quot;&gt;&gt;
&lt;&lt;set $enemyallyability = []&gt;&gt;
&lt;&lt;set $enemyallyability.push(&quot;Rejuvenate&quot;, &quot;RegalGlory&quot;, &quot;Grandeur&quot;)&gt;&gt;
&lt;&lt;/widget&gt;&gt;
















</tw-passagedata><tw-passagedata pid="82" name="Item Abilities" tags="widget" position="201,1154" size="100,100">ITEM ABILITIES

&lt;&lt;widget &quot;AgilityGain1&quot;&gt;&gt;\
You gain 1 agility!\
&lt;&lt;set $specialagility += 1&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Champion1&quot;&gt;&gt;\
You gain 1 strength and 4 health!\
&lt;&lt;set $specialstrength += 1&gt;&gt;\
&lt;&lt;set $currenthealth += 4&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Crush1&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;Your enemy loses 3 armor!!\
&lt;&lt;set $enemyarmor -= 3&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Crush2&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;Your enemy loses 5 armor!!\
&lt;&lt;set $enemyarmor -= 5&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Dragon1&quot;&gt;&gt;\
&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;You gain 2 strength and 2 willpower!\
&lt;&lt;set $specialstrength += 2&gt;&gt;\
&lt;&lt;set $specialwillpower += 2&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Dragon2&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;You gain 8 mana and 8 health!\
&lt;&lt;set $currentmana += 8&gt;&gt;\
&lt;&lt;set $currenthealth += 8&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Dragon3&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $check = $maxhealth/4&gt;&gt;\
&lt;&lt;if $currenthealth lte $check&gt;&gt;Health too low for effect to take place!\
&lt;&lt;else&gt;&gt;\
&lt;&lt;set $abilityvalue = $strength/10&gt;&gt;\
&lt;&lt;set $abilityvalue = Math.round($abilityvalue)&gt;&gt;\
&lt;&lt;set $currenthealth -= $abilityvalue&gt;&gt;\
The Dragon Axe feeds on your blood! You take $abilityvalue damage!\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Heal1&quot;&gt;&gt;\
You gain 2 heath!\
&lt;&lt;set $currenthealth += 2&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Heal2&quot;&gt;&gt;\
You gain 4 heath!\
&lt;&lt;set $currenthealth += 4&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Heal3&quot;&gt;&gt;\
You gain 6 heath!\
&lt;&lt;set $currenthealth += 6&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Madness1&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;Your enemy loses 1 strength, agility, and willpower!\
&lt;&lt;set $enemystrength -= 1&gt;&gt;\
&lt;&lt;set $enemyagility -= 1&gt;&gt;\
&lt;&lt;set $enemywillpower -= 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Mana1&quot;&gt;&gt;\
You gain 2 mana!\
&lt;&lt;set $currentmana += 2&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Mana2&quot;&gt;&gt;\
You gain 4 mana!\
&lt;&lt;set $currentmana += 4&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Mana3&quot;&gt;&gt;\
You gain 6 mana!\
&lt;&lt;set $currentmana += 6&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;ManaReap1&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;You gain 10 mana!\
&lt;&lt;set $currentmana += 10&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Naughty1&quot;&gt;&gt;\
So naughty! You gain 2 gold and 2 exp!\
&lt;&lt;set $gold += 2&gt;&gt;\
&lt;&lt;set $exp += 2&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Naughty2&quot;&gt;&gt;\
So naughty! You gain 4 gold and 4 exp!\
&lt;&lt;set $gold += 4&gt;&gt;\
&lt;&lt;set $exp += 4&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Royal1&quot;&gt;&gt;\
You gain 1 strength, 1 agility, and 1 willpower!\
&lt;&lt;set $specialstrength += 1&gt;&gt;\
&lt;&lt;set $specialagility += 1&gt;&gt;\
&lt;&lt;set $specialwillpower += 1&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Spring1&quot;&gt;&gt;\
You gain 3 mana and 3 health!\
&lt;&lt;set $currentmana += 3&gt;&gt; &lt;&lt;set $currenthealth += 3&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;StrengthGain1&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
You gain 1 strength!\
&lt;&lt;set $specialstrength += 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Tortoise1&quot;&gt;&gt;\
&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;You gain 1 armor!\
&lt;&lt;set $specialarmor += 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Tortoise2&quot;&gt;&gt;\
&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;You gain 2 armor!\
&lt;&lt;set $specialarmor += 2&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Unshakeable&quot;&gt;&gt;\
&lt;&lt;if $stun gte 1&gt;&gt;\
You cannot be stunned!\
&lt;&lt;set $stun = 0&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Void1&quot;&gt;&gt;\
You gain 2 mana and 2 health!\
&lt;&lt;set $currentmana += 2&gt;&gt; &lt;&lt;set $currenthealth += 2&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;WillpowerGain1&quot;&gt;&gt;\
You gain 1 willpower!\
&lt;&lt;set $specialwillpower += 1&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Bloodlust&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Bloodlust&quot;&gt;&gt;\
&lt;&lt;set $abilityvalue = $maxhealth/3&gt;&gt;\
&lt;&lt;if $currenthealth lt $abilityvalue&gt;&gt;&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;You gain 10 strength!\
&lt;&lt;set $specialstrength += 10&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;else&gt;&gt;You have already used this ability this battle!\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Bloodlust2&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Bloodlust2&quot;&gt;&gt;\
&lt;&lt;set $abilityvalue = $maxhealth/3&gt;&gt;\
&lt;&lt;if $currenthealth lt $abilityvalue&gt;&gt;&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;You gain 12 strength!\
&lt;&lt;set $specialstrength += 12&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Combat1&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Combat1&quot;&gt;&gt;\
&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;You gain 1 Combat Point!\
&lt;&lt;set $combatpoints += 1&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Combat2&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Combat2&quot;&gt;&gt;\
&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;You gain 1 Combat Point!\
&lt;&lt;set $combatpoints += 1&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Cyclone&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Cyclone&quot;&gt;&gt;\
&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;You gain 1 Combat Point!\
&lt;&lt;set $combatpoints += 1&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
The cyclone grows! You gain 1 agility! $enemyname loses 1 agility!\
&lt;&lt;set $specialagility += 1&gt;&gt; &lt;&lt;set $enemyagility -= 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Death1&quot;&gt;&gt;\
&lt;&lt;set $abilityvalue = random(1,5)&gt;&gt;\
&lt;&lt;if $abilityvalue eq 1&gt;&gt;\
Death&#39;s Visage turns on you! You take 25 damage! &lt;&lt;set $currenthealth -= 25&gt;&gt; \
&lt;&lt;elseif $abilityvalue eq 2&gt;&gt;\
Death&#39;s Visage is silent.
&lt;&lt;elseif $abilityvalue gte 3&gt;&gt;\
Death&#39;s Visage burns your enemy and deals 25 damage! &lt;&lt;set $enemycurrenthealth -= 25&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Dreadknight1&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $abilityvalue = random(1,3)&gt;&gt;\
&lt;&lt;if $abilityvalue eq 1&gt;&gt;\
Dreadful strike! $enemyname&#39;s stun limit increases by 1!
&lt;&lt;set $enemystunlimit += 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $enemyaction eq &quot;attack failure&quot;&gt;&gt;\
Feast of shadow! You gain 15 mana! \
&lt;&lt;set $currentmana += 15&gt;&gt;\
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Faith&quot;&gt;&gt;\
&lt;&lt;set $maxdamage = $willpower&gt;&gt;\
&lt;&lt;set $mindamage = $willpower/2&gt;&gt;\
You gain 10 health!\
&lt;&lt;set $currenthealth += 10&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Frostfang&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $abilityvalue = random(1,6)&gt;&gt;\
&lt;&lt;if $abilityvalue gte 6&gt;&gt;\
Frostfang&#39;s magic has frozen your foe! $enemyname is stunned!\
&lt;&lt;set $enemystun += 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;GhostBlade&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;GhostBlade&quot;&gt;&gt;\
&lt;&lt;if $combatpoints eq 3&gt;&gt;\
&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;You gain two combat points!\
&lt;&lt;set $combatpoints += 2&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Holy&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Holy&quot;&gt;&gt;\
&lt;&lt;set $check = $maxhealth/10&gt;&gt;\
&lt;&lt;if $currenthealth lt $check&gt;&gt;\
&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;Tylae intervenes! You are restored to full health!\
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
You gain 10 health!\
&lt;&lt;set $currenthealth += 10&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Judgement1&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Judgement1&quot;&gt;&gt;\
&lt;&lt;set $check55 = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;if $enemycurrenthealth lt $check55&gt;&gt;\
&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;Your foe has been judged! You gain 15 strength!\
&lt;&lt;set $specialstrength += 15&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Judgement&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Judgement&quot;&gt;&gt;\
&lt;&lt;set $check55 = $enemymaxhealth/2&gt;&gt;\
&lt;&lt;if $enemycurrenthealth lt $check55&gt;&gt;\
&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;Your foe has been judged! You gain 15 strength!\
&lt;&lt;set $specialstrength += 15&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Lightbringer&quot;&gt;&gt;\
You gain 4 health and 4 mana! &lt;&lt;set $currenthealth += 4&gt;&gt; &lt;&lt;set $currentmana += 4&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
You gain 1 willpower and 1 armor! &lt;&lt;set $specialwillpower += 1&gt;&gt; &lt;&lt;set $specialarmor += 1&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Lilith1&quot;&gt;&gt;\
Lilith&#39;s soul fills you with dark energy! You gain 20 health and mana!\
&lt;&lt;set $currentmana += 20&gt;&gt; &lt;&lt;set $currenthealth += 20&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
Lilith demands to see your naked flesh! $enemyname&#39;s armor drops by 10! Your armor drops by 10!
&lt;&lt;set $enemyarmor -= 10&gt;&gt;\
&lt;&lt;set $specialarmor -= 10&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if ($enemyaction eq &quot;attack success&quot;) and ($armor lte 1)&gt;&gt;\
Lilith loves to be punished! You gain 4 strength, 4 agility, 4 willpower, and 10 armor!
&lt;&lt;set $specialstrength += 4&gt;&gt;\
&lt;&lt;set $specialagility += 4&gt;&gt;\
&lt;&lt;set $specialwillpower += 4&gt;&gt;\
&lt;&lt;set $specialarmor += 10&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Ravenblade&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $abilityvalue = random(1,4)&gt;&gt;\
&lt;&lt;if $abilityvalue gte 4&gt;&gt;\
The Ravenblade sings! You gain 1 Combat Point!\
&lt;&lt;set $combatpoints += 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Rebuke&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $check1 = $maxhealth*0.75&gt;&gt;\
&lt;&lt;set $check2 = $maxhealth*0.5&gt;&gt;\
&lt;&lt;set $check3 = $maxhealth*0.25&gt;&gt;\
&lt;&lt;if $currenthealth gte $check2&gt;&gt;\
By Karhan&#39;s fury, you gain 1 strength! $enemyname loses 1 strength!\
&lt;&lt;set $specialstrength += 1&gt;&gt; &lt;&lt;set $enemystrength -= 1&gt;&gt;\
&lt;&lt;elseif $currenthealth gte $check2&gt;&gt;\
By Karhan&#39;s fury, you gain 2 strength! $enemyname loses 2 strength!\
&lt;&lt;set $specialstrength += 2&gt;&gt; &lt;&lt;set $enemystrength -= 2&gt;&gt;\
&lt;&lt;elseif $currenthealth gte $check3&gt;&gt;\
By Karhan&#39;s fury, you gain 3 strength! $enemyname loses 3 strength!\
&lt;&lt;set $specialstrength += 3&gt;&gt; &lt;&lt;set $enemystrength -= 3&gt;&gt;\
&lt;&lt;else&gt;&gt;\
By Karhan&#39;s fury, you gain 4 strength! $enemyname loses 4 strength!\
&lt;&lt;set $specialstrength += 4&gt;&gt; &lt;&lt;set $enemystrength -= 4&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Recharge&quot;&gt;&gt;\
&lt;&lt;if $battlecount eq 4&gt;&gt;Celestial magic flows through you! You restore 100 mana!\
&lt;&lt;set $currentmana += 100&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Restore1&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Restore1&quot;&gt;&gt;\
&lt;&lt;set $abilityvalue = $maxhealth/4&gt;&gt;\
&lt;&lt;if $currenthealth lt $abilityvalue&gt;&gt;&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;You restore 400 health!\
&lt;&lt;set $currenthealth += 400&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;else&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
You gain 3 health!\
&lt;&lt;set $currenthealth += 3&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Rune&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
The Runeblade hungers! You lose 12 mana!
&lt;&lt;set $currentmana -= 12&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Serpent1&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $abilityvalue = random(1,3)&gt;&gt;\
&lt;&lt;if $abilityvalue eq 1&gt;&gt;\
You gain 1 strength! &lt;&lt;set $specialstrength += 1&gt;&gt; \
&lt;&lt;elseif $abilityvalue eq 2&gt;&gt;\
You gain 1 agility! &lt;&lt;set $specialagility += 1&gt;&gt; \
&lt;&lt;elseif $abilityvalue eq 3&gt;&gt;\
You gain 1 willpower! &lt;&lt;set $specialwillpower += 1&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $abilityvalue2 = random(1,3)&gt;&gt;\
&lt;&lt;if $abilityvalue2 eq 1&gt;&gt;\
Your enemy loses 1 strength! &lt;&lt;set $enemystrength -= 1&gt;&gt; \
&lt;&lt;elseif $abilityvalue2 eq 2&gt;&gt;\
Your enemy loses 1 agility! &lt;&lt;set $enemyagility -= 1&gt;&gt; \
&lt;&lt;elseif $abilityvalue2 eq 3&gt;&gt;\
Your enemy loses 1 willpower! &lt;&lt;set $enemywillpower -= 1&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Silence1&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
Behold the fury! $enemyname&#39;s armor drops by 8!
&lt;&lt;set $enemyarmor -= 8&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $enemyaction eq &quot;attack failure&quot;&gt;&gt;\
Behold the silence! You gain 1 Combat Point! \
&lt;&lt;set $combatpoints += 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Skull1&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Skull1&quot;&gt;&gt;\
&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt;You lose 100 health and gain 100 mana!\
&lt;&lt;set $currentmana += 100&gt;&gt;\
&lt;&lt;set $currenthealth -= 100&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Sunsworn&quot;&gt;&gt;\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
&lt;&lt;set $abilityvalue = random(1,3)&gt;&gt;\
&lt;&lt;if $abilityvalue eq 1&gt;&gt;\
You gain 1 strength! &lt;&lt;set $specialstrength += 1&gt;&gt; \
&lt;&lt;elseif $abilityvalue eq 2&gt;&gt;\
You gain 1 agility! &lt;&lt;set $specialagility += 1&gt;&gt; \
&lt;&lt;elseif $abilityvalue eq 3&gt;&gt;\
You gain 1 willpower! &lt;&lt;set $specialwillpower += 1&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
You gain 1 armor! &lt;&lt;set $specialarmor += 1&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Trickster&quot;&gt;&gt;\
You gain 1 agility! &lt;&lt;set $specialagility += 1&gt;&gt; \
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
You gain steal 5 health and 5 mana! &lt;&lt;set $currentmana += 5&gt;&gt; &lt;&lt;set $currenthealth += 5&gt;&gt; &lt;&lt;set $enemycurrenthealth -= 5&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Victorious&quot;&gt;&gt;\
You gain 1 agility and 1 strength! &lt;&lt;set $specialstrength += 1&gt;&gt; &lt;&lt;set $specialagility += 1&gt;&gt; \
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;\
Your enemy loses 1 strength! &lt;&lt;set $enemystrength -= 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Wing1&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Wing1&quot;&gt;&gt;\
&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;You gain 20 evade score!\
&lt;&lt;set $specialevadescore += 20&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;\

&lt;&lt;widget &quot;Winter1&quot;&gt;&gt;\
&lt;&lt;set $itemability = &quot;Winter1&quot;&gt;&gt;\
&lt;&lt;set $check98 = $maxhealth/4&gt;&gt;\
&lt;&lt;if $currenthealth lt $check98&gt;&gt;\
&lt;&lt;if not $itemabilitycount.includes($itemability)&gt;&gt;You gain 200 mana and 30 armor!\
&lt;&lt;set $currentmana += 200&gt;&gt;\
&lt;&lt;set $specialarmor += 30&gt;&gt;\
&lt;&lt;set $itemabilitycount.push($itemability)&gt;&gt;\
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
You gain 25 mana!\
&lt;&lt;set $currentmana += 25&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

SET BONUSES

&lt;&lt;widget &quot;SetBonus&quot;&gt;&gt;\
&lt;&lt;if $setbonus eq 1&gt;&gt;\
Set of the Lightbringer activated! Iulius is with you!
&lt;&lt;set $specialwillpower += 20&gt;&gt;\
&lt;&lt;set $specialarmor += 50&gt;&gt;\
You gain 20 willpower!
You gain 50 armor!
\
\
&lt;&lt;elseif $setbonus eq 2&gt;&gt;\
Set of the Trickster activated! Sathael is with you!
&lt;&lt;set $specialagility += 20&gt;&gt;\
&lt;&lt;set $combatpoints = 5&gt;&gt;\
You gain 20 agility!
You gain 5 combat points!
\
\
&lt;&lt;elseif $setbonus eq 3&gt;&gt;\
Set of the Victorious activated! Myridia is with you!
&lt;&lt;set $specialstrength += 20&gt;&gt;\
&lt;&lt;set $currentmana += 500&gt;&gt;\
You gain 20 strength!
You gain 500 mana!
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;\

























</tw-passagedata><tw-passagedata pid="83" name="Interlude2" tags="" position="1250,1341" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;\
Your thoughts shift through a liquid haze.

Consciousness slips. @@.delayed;Frays.@@ @@.delayed;Fades Away.@@

@@.delayed;Memories...@@

@@.delayed;&lt;&lt;KingTalk &quot;$name... you will have your chance. I am sending you to the Deep Woods&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;OldHeroTalk &quot;Of course, my lord. What would you have me do?&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;KingTalk &quot;An evil rises, there. My advisors tell me not to worry, but my dreams...&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;OldHeroTalk &quot;Dreams, my lord?&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;KingTalk &quot;Never mind. Make ready for the journey. This is your last chance, $name. Succeed... or do not return.&quot;&gt;&gt; @@ \

@@.delayed; [[Awaken-&gt;Interlude2][$p = 1]]
@@

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;\
\
You awaken to sunlight, streaming into your cabin. You&#39;re lying on your bed, your wounds from your battle with &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; bandaged.
&lt;img src=&quot;Images/Locations/morning2.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;What... where am I?&quot;&gt;&gt;\
The next moment, the serene face of the elf girl, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, looms over you.
&lt;&lt;NayaTalk &quot;We&#39;re in your cabin. We arrived yesterday - do you not remember?&quot;&gt;&gt;\
All you remember is a flash of light - and then blinding pain.
&lt;&lt;NayaTalk &quot;Zyr saved us. I believe he reached into your thoughts and found the nearest place you viewed as safe, and used all his power to send us there. Just before the spell went off, a piece of masonry struck your head.&quot;&gt;&gt;\
That explains that pulsing pain. You&#39;re lucky to be alive.
&lt;&lt;HeroTalk &quot;And Zyr? Where is he?&quot;&gt;&gt;\
The elf girl shakes her head.
&lt;&lt;NayaTalk &quot;I scouted the tower this morning. Zyr... there&#39;s nothing left.&quot;&gt;&gt;\

[[Just then, the door to your cabin opens-&gt;Interlude2][$p = 2]]
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
&lt;&lt;set $daynumber += 1&gt;&gt;\
&lt;&lt;set $time = &quot;Morning&quot;&gt;&gt;\
&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; enter your cabin. With four people in your bed room, it&#39;s packed to the brim.
&lt;img src=&quot;Images/Character/team1.jpg&quot; width=800 /&gt;

&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;MerchantTalk &quot;By sand and sun - he lives! You are truly blessed with good fortune, friend!&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;MerchantTalk &quot;By sand and sun - she lives! You are truly blessed with good fortune, friend!&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;WitchTalk &quot;Blessed by the Gods, more likely.&quot;&gt;&gt;\
You shake your head - then regret doing so, from the pain that follows.
&lt;&lt;HeroTalk &quot;I wasn&#39;t able to destroy the crystal.&quot;&gt;&gt;\

[[Naya perks up-&gt;Interlude2][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;NayaTalk &quot;True, but I&#39;d say we were still successful.&quot;&gt;&gt;\
She pulls out the Void Gem from her pouch.
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=400 /&gt;

&lt;&lt;NayaTalk &quot;We evaded the Redeemer &lt;i&gt;and&lt;/i&gt; the Deathguard. And better still, Zyr told me where a working Catalyst can be found. All we need to do now is get there.&quot;&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/span&gt; leans over your ear.
&lt;&lt;MerchantTalk &quot;This spritely little elf has been making herself at home since she appeared here with you yesterday. Wise men don&#39;t trust teleporting elves... perhaps we should have her in chains, no?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;We can trust Naya. Our goals are the same: to destroy the Void Gem before the Redeemer opens the portal in Netheryn.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Wise words, $name. We must set aside the bad blood between our peoples if we&#39;re to defeat the Redeemer.&quot;&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; smiles sweetly at &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;WitchTalk &quot;Tell us, your grace. Where is the last Catalyst?&quot;&gt;&gt;\

[[Naya answers-&gt;Interlude2][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;main_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;main&quot;&gt;&gt;\
\
&lt;&lt;NayaTalk &quot;In the north of the Deep Woods is a place called the Frozen Hills. It&#39;s a cold, desolate place, where the dead do not rest easy. There we&#39;ll find the Winter Palace - a Netheryn fortress that holds a working Catalyst. We find that Palace, we can end the threat of the Void for good.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Excellent. I will set up a series of wards around the cabin. The Redeemer is likely looking for you, Naya, but you and the gem will be hidden from him so long as my magic lasts.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;And I will gather a new shipment of weapons and armor from the Capital. $name, my friend, you will need powerful artifacts to brave this next adventure, no?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;New armor would help. So would a discount.&quot;&gt;&gt;\
The merchant balks. 
&lt;&lt;MerchantTalk &quot;Bah! You will ruin me!&quot;&gt;&gt;\
You smirk, then rise from the bed. Already, your strength is returning.
&lt;&lt;HeroTalk &quot;Enough talk, then. Onward!&quot;&gt;&gt;\

[[Onward!-&gt;Cabin][$p = 0]]

&lt;&lt;MerchantInventory3&gt;&gt;\
&lt;&lt;set $nayastatus = 10&gt;&gt;\
&lt;&lt;set $witchstatus = 10&gt;&gt;\
&lt;&lt;set $merchantstatus = 10&gt;&gt;\

&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt; &lt;&lt;set $paladinabilityinventory.push($wrathofgod, $holyaura, $radiantbolt)&gt;&gt; &lt;&lt;/if&gt;&gt; \
&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt; &lt;&lt;set $soldierabilityinventory.push($bullrush, $brashendurance, $heroicstrike)&gt;&gt; &lt;&lt;/if&gt;&gt; \
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt; &lt;&lt;set $rogueabilityinventory.push($deadlyfocus, $bladestorm, $sapwill)&gt;&gt; &lt;&lt;/if&gt;&gt; \

\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="84" name="Frozen Hills Entry" tags="" position="1459,170" size="100,100">You arrive at the edge of the Frozen Hills. 

In this icy wasteland, the evil of the Deep Woods can be felt in full force. Little lives in this barren land, and the dead do not rest. 
&lt;img src=&quot;Images/FrozenHills/frozen5.jpg&quot; width=750 /&gt;

&lt;&lt;if $frozenquest gte 30&gt;&gt;With &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; slain, the Frozen Hills will heal in time. For now, the walking dead still wander, their power slowly fading away.&lt;&lt;elseif $frozenquest gte 10&gt;&gt;With the beacons activated, the Winter Palace has been revealed.&lt;&lt;else&gt;&gt;Somewhere in these desolate hills the Winter Palace hides. If the Void Gem is to be destroyed, the palace must be found.&lt;&lt;/if&gt;&gt;
\
&lt;&lt;nobr&gt;&gt;

&lt;&lt;set $frozeneventinventory = []&gt;&gt;

&lt;&lt;if $frozenquest eq 1&gt;&gt; &lt;&lt;set $frozeneventinventory.push(&quot;FrozenDay1&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $frozenquest eq 2&gt;&gt; &lt;&lt;set $frozeneventinventory.push(&quot;Camp&quot;, &quot;Camp&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $frozenquest eq 3&gt;&gt; &lt;&lt;set $frozeneventinventory.push(&quot;Nendel1&quot;, &quot;Nendel1&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $frozenquest eq 5&gt;&gt; &lt;&lt;set $frozeneventinventory.push(&quot;Beacon1&quot;, &quot;Beacon1&quot;, &quot;Beacon1&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $frozenquest eq 6&gt;&gt; &lt;&lt;set $frozeneventinventory.push(&quot;Beacon2&quot;, &quot;Beacon2&quot;, &quot;Beacon2&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $frozenquest eq 7&gt;&gt; &lt;&lt;set $frozeneventinventory.push(&quot;Messenger1&quot;, &quot;Messenger1&quot;, &quot;Messenger1&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $frozenquest eq 8&gt;&gt; &lt;&lt;set $frozeneventinventory.push(&quot;Beacon3&quot;, &quot;Beacon3&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($frozenquest gte 2)&gt;&gt; &lt;&lt;set $frozeneventinventory.push(&quot;SkeletalSoldierAttack&quot;, &quot;SkeletalMageAttack&quot;, &quot;SkeletalArcherAttack&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($frozenquest gte 2) and ($oristatus eq 3)&gt;&gt;&lt;&lt;set $frozeneventinventory.push(&quot;Ori3&quot;, &quot;Ori3&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($frozenquest gte 2) and ($merchantstatus eq 11)&gt;&gt; &lt;&lt;set $frozeneventinventory.push(&quot;SpringOfLife&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($frozenquest gte 3) and ($frozensword eq 0)&gt;&gt; &lt;&lt;set $frozeneventinventory.push(&quot;Frostfang&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($frozenquest gte 3) and ($frozentreasure eq 0)&gt;&gt; &lt;&lt;set $frozeneventinventory.push(&quot;FrozenTreasure&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;


&lt;&lt;set $event = $frozeneventinventory.pluck()&gt;&gt;\

&lt;&lt;/nobr&gt;&gt;
\
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $event eq &quot;FrozenDay1&quot;&gt;&gt; [[Venture Forth!-&gt;FrozenDay1]]
&lt;&lt;elseif ($frozenquest gte 3) and ($lewdshrine eq 2) and ($lewdmode eq 1)&gt;&gt; [[Venture Forth!-&gt;LewdShrine3]]
&lt;&lt;elseif ($frozenquest lte 9) and ($lewdmode eq 1) and ($gender eq &quot;male&quot;) and ($nayalove eq 17) and ($frozenquest gte 5)&gt;&gt; [[Venture Forth!-&gt;Naya Attack]]
&lt;&lt;elseif $event eq &quot;SkeletalSoldierAttack&quot;&gt;&gt; [[Venture Forth!-&gt;SkeletalSoldierAttack]]
&lt;&lt;elseif $event eq &quot;SkeletalMageAttack&quot;&gt;&gt; [[Venture Forth!-&gt;SkeletalMageAttack]]
&lt;&lt;elseif $event eq &quot;SkeletalArcherAttack&quot;&gt;&gt; [[Venture Forth!-&gt;SkeletalArcherAttack]]

&lt;&lt;elseif $event eq &quot;Ori3&quot;&gt;&gt; [[Venture Forth!-&gt;Ori3]]
&lt;&lt;elseif $event eq &quot;SpringOfLife&quot;&gt;&gt; [[Venture Forth!-&gt;SpringOfLife]]
&lt;&lt;elseif $event eq &quot;Frostfang&quot;&gt;&gt; [[Venture Forth!-&gt;Frostfang]]
&lt;&lt;elseif $event eq &quot;FrozenTreasure&quot;&gt;&gt; [[Venture Forth!-&gt;FrozenTreasure]]
&lt;&lt;elseif $event eq &quot;Camp&quot;&gt;&gt; [[Venture Forth!-&gt;Camp]]
&lt;&lt;elseif $event eq &quot;Nendel1&quot;&gt;&gt; [[Venture Forth!-&gt;Nendel1]]
&lt;&lt;elseif $event eq &quot;Beacon1&quot;&gt;&gt; [[Venture Forth!-&gt;Beacon1]]
&lt;&lt;elseif $event eq &quot;Beacon2&quot;&gt;&gt; [[Venture Forth!-&gt;Beacon2]]
&lt;&lt;elseif $event eq &quot;Messenger1&quot;&gt;&gt; [[Venture Forth!-&gt;Messenger1]]
&lt;&lt;elseif $event eq &quot;Beacon3&quot;&gt;&gt; [[Venture Forth!-&gt;Beacon3]]

&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if ($frozenquest gte 10)&gt;&gt;[[Venture to Winter Palace-&gt;Palace Entrance]]&lt;&lt;/if&gt;&gt;
[[Back-&gt;Outside the Cabin]] 
\
&lt;&lt;set $p = 0&gt;&gt;\</tw-passagedata><tw-passagedata pid="85" name="Naya2" tags="" position="603,982" size="100,100">&lt;&lt;if $frozenquest gte 10&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; is missing. Her tree is empty.
&lt;img src=&quot;Images/Locations/tree1.jpg&quot; width=650 /&gt;

[[Return-&gt;Outside the Cabin]]

&lt;&lt;else&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
\
\
&lt;&lt;if $time eq &quot;Night&quot;&gt;&gt;It is late, and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; is asleep. 
&lt;img src=&quot;Images/Locations/night3.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;I&#39;ll visit her in the morning.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;else&gt;&gt;\
&lt;&lt;if $music neq &quot;naya&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You approach &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; tree. 
&lt;img src=&quot;Images/Locations/tree1.jpg&quot; width=650 /&gt;

&lt;&lt;if ($lewdmode eq 1) and ($gender eq &quot;male&quot;) and ($nayalove eq 18)&gt;&gt;&lt;&lt;else&gt;&gt;[[Speak to Naya-&gt;Naya2][$p = 1]]&lt;&lt;/if&gt;&gt;
[[Return-&gt;Outside the Cabin]]
&lt;&lt;if ($lewdmode eq 1) and ($gender eq &quot;male&quot;) and ($nayalove eq 14)&gt;&gt;\
[[Give Naya the black rose-&gt;Naya Lewd][$p = 9]]&lt;&lt;elseif ($lewdmode eq 1) and ($gender eq &quot;male&quot;) and ($nayalove eq 18)&gt;&gt;\
[[Speak to Naya about the kiss-&gt;Naya Lewd][$p = 20]]
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;NayaTalk &quot;Need something?&quot;&gt;&gt;\
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

[[Ask about the goblin cave-&gt;Naya2][$p = 2]]
[[Ask about Hadamshal-&gt;Naya2][$p = 3]]
[[Ask about the Void Gem-&gt;Naya2][$p = 4]]
&lt;&lt;if $frozenquest gte 5&gt;&gt;[[Ask about Nendel-&gt;Naya2][$p = 5]]
[[Ask about the Redeemer-&gt;Naya2][$p = 6]]
[[Return-&gt;Outside the Cabin]]
&lt;&lt;else&gt;&gt;[[Return-&gt;Outside the Cabin]]&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;HeroTalk &quot;I wanted to talk about the goblin cave.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;What&#39;s there to talk about?&quot;&gt;&gt;\
You cross your arms.
&lt;&lt;HeroTalk &quot;You paralyzed me. Left me for dead.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;That was mercy. For all I knew, you worked for the Redeemer. But I don&#39;t kill people who can&#39;t fight back. That, at least, separates me from humans.&quot;&gt;&gt;\

[[Ask something else-&gt;Naya2][$p = 1]]
[[Leave her be-&gt;Outside the Cabin][$p = 0]] 

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;HeroTalk &quot;I wanted to talk about Hadamshal.&quot;&gt;&gt;\
Her lips twist into a frown.
&lt;&lt;NayaTalk &quot;No.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Naya, I was there. It sounds like you were, too. A princess, in fact-&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;&lt;i&gt;I said &#39;No.&#39;&lt;/i&gt;&quot;&gt;&gt;\
A sore spot for the girl, clearly.

[[Ask something else-&gt;Naya2][$p = 1]]
[[Leave her be-&gt;Outside the Cabin][$p = 0]] 

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;HeroTalk &quot;I wanted to talk about the Void Gem.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;I&#39;m no expert on the crystal. I&#39;m just keeping it safe until we find the Catalyst.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Can I see it?&quot;&gt;&gt;\
She takes a quick step backwards.
&lt;&lt;NayaTalk &quot;Certainly not. The Void Gem is a manipulative little demon that wants nothing more than to open the dark portal.&quot;&gt;&gt;\
You draw back your hand.
&lt;&lt;HeroTalk &quot;Really?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;By my life, I swear it. It will take someone as resolute and daring as you and twist all your ambition for its own ill ends.&quot;&gt;&gt;\
You remember &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&lt;/b&gt;&lt;/span&gt;, the Goblin King.
&lt;&lt;HeroTalk &quot;Of course... that&#39;s why Gresh had his most loyal minions keep him locked in his chamber.&quot;&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; nods, a distant sadness taking her stare.
&lt;&lt;NayaTalk &quot;It must have taken all of Gresh&#39;s willpower to resist the Gem. And even then, it drove him mad.&quot;&gt;&gt;\

[[Ask something else-&gt;Naya2][$p = 1]]
[[Leave her be-&gt;Outside the Cabin][$p = 0]] 

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;HeroTalk &quot;I wanted to talk about Nendel.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;If you want to learn about Nendel, talk to him.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;But I wanted &lt;i&gt;your&lt;/i&gt; perspective on him.&quot;&gt;&gt;\
She nearly rolls her eyes, then stops herself.
&lt;&lt;NayaTalk &quot;Prince Nendel&#39;lar was the wisest, kindest, bravest prince Hadamshal had ever borne. It was he who pushed my father to negotiate with the human kingdom.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;And after Hadamshal?&quot;&gt;&gt;\
She frowns. 
&lt;&lt;NayaTalk &quot;He took the fall personally. He... he hasn&#39;t yet forgiven himself for what happened.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;It wasn&#39;t his fault.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;So I&#39;ve told him, a thousand times.&quot;&gt;&gt;\

[[Ask something else-&gt;Naya2][$p = 1]]
[[Leave her be-&gt;Outside the Cabin][$p = 0]] 
\
&lt;&lt;elseif $p eq 6&gt;&gt;\
&lt;&lt;HeroTalk &quot;The Redeemer - how did you and Nendel learn about him, and his plans?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;My brother is a scholar of elven lore. He learned plenty about Netheryn and its mysterious fall before the libraries of Hadamshal burned.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;So when the Void starting spreading in the Deep Woods...&quot;&gt;&gt;\
She nods, gesturing out into the wilderness. 
&lt;&lt;NayaTalk &quot;He knew someone was trying to reopen the Dark Portal.&quot;&gt;&gt;\
You think on that for a moment.
&lt;&lt;HeroTalk &quot;Who is the Redeemer?&quot;&gt;&gt;\
She frowns, almost annoyed at the question. 
&lt;&lt;NayaTalk &quot;What does it matter? He is madness incarnate, hellbent on engulfing the world in darkness. He is our enemy.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course.&quot;&gt;&gt;\

[[Ask something else-&gt;Naya2][$p = 1]]
[[Leave her be-&gt;Outside the Cabin][$p = 0]] 
\
&lt;&lt;elseif $p eq 7&gt;&gt;\

\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="86" name="Naya1" tags="" position="1432,906" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $music neq &quot;naya&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $time eq &quot;Night&quot;&gt;&gt;It is late, and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; is asleep. 
&lt;img src=&quot;Images/Locations/night3.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;I&#39;ll visit her in the morning.&quot;&gt;&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;else&gt;&gt;\
&lt;&lt;if $music neq &quot;naya&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
Looking for &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, you come upon a rather unusual looking tree. It&#39;s trunk has been hollowed out, and odd lights blink serenely from within. To the best of your knowledge, it&#39;s a fair attempt at an ancient elven lodging.
&lt;img src=&quot;Images/Locations/tree1.jpg&quot; width=650 /&gt;

[[Call for Naya-&gt;Naya1][$p = 1]]
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 1&gt;&gt;\
\
The moment you open your mouth to call out, a finger taps you on the shoulder. Turning, you see she&#39;s snuck up on you.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;
&lt;&lt;HeroTalk &quot;How are elves so quiet?&quot;&gt;&gt; \
&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;&lt;NayaTalk &quot;Why are humans so loud? I suppose paladins are used to shouting prayers across the battlefield. Maybe Iulius is hard of hearing.&quot;&gt;&gt; \
&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;&lt;&lt;NayaTalk &quot;Why are humans so loud? Maybe it&#39;s just the price of being a warrior. Lugging around that heavy armor and that blade... you&#39;re not exactly a subtle one.&quot;&gt;&gt; \
&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;&lt;NayaTalk &quot;Why are humans so loud? Granted, you&#39;re maybe the quietest of your people I&#39;ve ever met. Sathael must smile upon you, rogue.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
She sizes you up, from your boots to your forehead.
&lt;&lt;NayaTalk &quot;You wanted something?&quot;&gt;&gt;

[[Are you settling in alright?-&gt;Naya1][$p = 2, $a = 1]]
[[Tell me more of the Winter Palace-&gt;Naya1][$p = 2, $b = 1]]

&lt;&lt;set $a = 0&gt;&gt;\
&lt;&lt;set $b = 0&gt;&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;if $a eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;Are you settling in alright?&quot;&gt;&gt;\
She shrugs, clearly a bit uncomfortable with the question.
&lt;&lt;NayaTalk &quot;You have odd friends, $name. Babar&#39;s nice enough, but I get the sense there&#39;s a deep sadness beneath his babble and bluster.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;ve thought much the same, but he&#39;s proven himself a worthy friend.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;And Scyllia... well, I don&#39;t trust mages. Still, she helped me find the Tower of Zyr, at great risk to her own life. I can trust her intentions, if not her magic itself. But...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;But?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;The hardest part of settling in is just having people around. Even decent people. I&#39;ve been alone for long time.&quot;&gt;&gt;\
&lt;&lt;set $a = 2&gt;&gt;\
&lt;&lt;elseif $b eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;Tell me more of the Winter Palace.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;I wish I had more to tell. It&#39;s a Netheryn fortress, hidden somewhere in the Frozen Hills. And it&#39;s home to the last functioning Catalyst.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Right... and how are we to find it?&quot;&gt;&gt;\
She shakes her head, uncertain.
&lt;&lt;NayaTalk &quot;You&#39;d think a massive fortress would be easy to find... but apparently, it&#39;s quite elusive. I suspect magic is involved.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;If only we had access to Zyr and his library...&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;If only...&quot;&gt;&gt;\
&lt;&lt;set $b eq 2&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $a eq 0&gt;&gt;[[Are you settling in alright?-&gt;Naya1][$p = 2, $a = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Are you settling in alright?&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $b eq 0&gt;&gt;[[Tell me more of the Winter Palace-&gt;Naya1][$p = 2, $b = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Tell me more of the Winter Palace&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if ($lewdmode eq 1) and ($gender eq &quot;male&quot;) and ($nayalove eq 12)&gt;&gt;[[Leave her be-&gt;Naya1][$p = 10]]&lt;&lt;else&gt;&gt;[[Leave her be-&gt;Outside the Cabin]]&lt;&lt;/if&gt;&gt;

&lt;&lt;set $nayastatus = 11&gt;&gt;\
\
&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;if $music neq &quot;naya&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
When you approach &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; tree, you spot the elf girl leaning against it, stringing her bow.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;You have a brother named Nendel.&quot;&gt;&gt;\
She stops what she&#39;s doing.
&lt;&lt;NayaTalk &quot;He found you, did he?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I saved him from a troll. He claims he&#39;s been working with you from the start to destroy the Void Gem.&quot;&gt;&gt;\
She slowly meets your eye. She seems resolute, even defiant.
&lt;&lt;NayaTalk &quot;You want to know why I kept him a secret.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course.&quot;&gt;&gt;\

[[Naya answers-&gt;Naya1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;NayaTalk &quot;It&#39;s true - we have been working together to deal with the Redeemer. But we operate separately. Easier to stay hidden, that way.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Fine. But why not mention him?&quot;&gt;&gt;\
She crosses her arms.
&lt;&lt;NayaTalk &quot;Suppose you, or Scyllia, or Babar - any of you humans - decided to turn on me. Better to keep my brother in a secret, so I could flee to him if need be.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You really think we&#39;d betray you?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;With humans, I don&#39;t take chances.&quot;&gt;&gt;\

[[Tell her about Nendel&#39;s lead-&gt;Naya1][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;HeroTalk &quot;Nendel claims to know a way to find the Winter Palace. Do you think it&#39;s worth pursuing?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Of course. In addition to being a skilled swordsman and a talented wizard, my brother is a scholar of elven lore. If anyone knows the secrets of the Winter Palace, it&#39;s him.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Then I&#39;ll work with him, for now.&quot;&gt;&gt;\
She nods, then turns to enter her tree.
&lt;&lt;HeroTalk &quot;Naya?&quot;&gt;&gt;\
She pauses at the threshold.
&lt;&lt;HeroTalk &quot;If we&#39;re to succeed, we &lt;i&gt;all&lt;/i&gt; need to trust each other.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;I...&quot;&gt;&gt;\

[[She shakes her head, then leaves you-&gt;Outside the Cabin]] 

&lt;&lt;set $frozenquest = 5&gt;&gt;\
\
&lt;&lt;elseif $p eq 10&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
As you walk away from &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; tree, you think back to the conversation the two of you had at the top of the Tower of Zyr. 
&lt;&lt;HeroTalk &quot;She&#39;s been alone since Hadamshal, the poor thing. She&#39;s hardly more than a child. No wonder she has trust issues. If only...&quot;&gt;&gt;\
You remember the feeling of her perfect little elf ass. That accidental groping her panties and supple skin.
&lt;video loop muted autoplay src=&quot;Images/Other/fondle3.mp4&quot;&gt;&lt;/video&gt;

There must be something you can do to lift her spirits, and get closer to her. Perhaps the best thing to do would be to buy a gift for her. &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; likely has something for sale.

[[Leave-&gt;Outside the Cabin]] 
\
&lt;&lt;set $nayalove = 13&gt;&gt;\
&lt;&lt;set $specialinventory.push($blackrose)&gt;&gt;

\
\
\
\
&lt;&lt;/if&gt;&gt;\
\
\</tw-passagedata><tw-passagedata pid="87" name="DeathguardAttack" tags="" position="1101,2138" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You are wandering through the Scarlet Vale when a horn sounds from behind you.

Drawing your $weapon, you turn around in time to see a soldier of the Deathguard marching towards you
&lt;img src=&quot;Images/Character/deathguard3.jpg&quot; width=450 /&gt;

&lt;&lt;DeathguardTalk &quot;$name $title, you have formally accused of heresy. You are ordered to relinquish your weapons and return to the capital for a trial.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;That&#39;s not happening.&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;Then your life is forefeit!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;DeathguardSoldierStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="88" name="FrozenDay1" tags="" position="1437,290" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;\
You begin your first foray into the Frozen Hills with a keen sense of purpose, verging on optimism.
&lt;&lt;HeroTalk &quot;I need only find the Catalyst, now that Naya is on my side and holds the Void Gem. We&#39;re getting close...&quot;&gt;&gt;\
As you venture deeper into the northern woodland, the snow begins to fall, and an icy chill seeps into your bones. The eternal hold of winter over these hills and woodlands feels most unnatural. A dark magic is afoot...
&lt;img src=&quot;Images/FrozenHills/frozen6.jpg&quot; width=700 /&gt;

After getting accustomed to the frost, you work your way through the trees, eager to find some high vantage point. From there, it should not be overly difficult to spot the Winter Palace. Palaces tend to stick out in view, even from afar.

[[Then the wind picks up-&gt;FrozenDay1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
It is no natural wind. It spins around you, flinging snow into your face and stealing away your sight. It hisses and swirls, thick with malice.

Then from the depths of it, a haunted voice howls.
&lt;&lt;Lich1Talk &quot;&lt;i&gt;Thou are not welcome in mine eternal domain&lt;/i&gt;...&quot;&gt;&gt;\
You spin around, seeking the source of the voice. It appears to be the wind itself.
&lt;&lt;Lich1Talk &quot;&lt;i&gt;By mine right as heir to the Kingdom of Netheryn, I command thee: turn back!&lt;/i&gt;!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I cannot turn back! I seek the Winter Palace!&quot;&gt;&gt;\

[[You await a response-&gt;FrozenDay1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
The wind returns, and with it, an answer.
&lt;&lt;Lich1Talk &quot;&lt;i&gt;Such insolence! Thy punishment is death!&lt;/i&gt;!&quot;&gt;&gt;\
Then, from blinding blizzard, a figure approaches.
&lt;img src=&quot;Images/FrozenHills/misc1.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;Who goes there!?&quot;&gt;&gt;\
Your voice is lost to the storm.

At first you think it might be human - but the closer it comes, then more your horror grows.

That is no living human - it is one of the walking dead!
&lt;img src=&quot;Images/FrozenHills/dead5.jpg&quot; width=550 /&gt;

&lt;&lt;SkeletalSoldierTalk &quot;Death to all who oppose the heir of Netheryn!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalSoldierStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;\
The skeleton falls to the frozen ground, as the dark necromancy that holds it together begins to fail.
&lt;&lt;HeroTalk &quot;Tell me, creature - who is the heir of Netheryn?&quot;&gt;&gt;\
&lt;&lt;SkeletalSoldierTalk &quot;Master... I have failed thee...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Answer me!&quot;&gt;&gt;\
It lies still - dead at last. 
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

With a curse, you kick the skull of your foe, then leave it in the snow. It seems the lord of the Winter Palace has little interest in welcoming you inside.
&lt;&lt;HeroTalk &quot;This &#39;heir of Netheryn&#39; is a powerful necromancer. Breaking into his palace won&#39;t be easy...&quot;&gt;&gt;\

For now, you must return to your cabin and rest.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt; \
&lt;&lt;set $frozenquest = 2&gt;&gt;\
&lt;&lt;set $frozentreasure = 0&gt;&gt;\
&lt;&lt;set $frozensword = 0&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="89" name="SkeletalSoldierAttack" tags="" position="1437,409" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You are wandering through the Frozen Hills when the shuffling stomp of a soldier on the march catches your attention. Something&#39;s coming your way.

Drawing your $weapon, you stand your ground as the creature approaches. A well-armed skeleton - another minion of the heir of Netheryn.
&lt;img src=&quot;Images/FrozenHills/dead5.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Take me to your master.&quot;&gt;&gt;\
&lt;&lt;SkeletalSoldierTalk &quot;&lt;i&gt;Only upon thy death, intruder&lt;/i&gt;.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalSoldierStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="90" name="SkeletalMageAttack" tags="" position="1435,528" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You are wandering through the Frozen Hills when a volley of hail strikes the ground beneath your feet. This is no natural storm - you&#39;re under attack.

Racing forwards, you spot your foe - an undead minion of the heir of Netheryn, blessed with foul magic.
&lt;img src=&quot;Images/FrozenHills/dead7.jpg&quot; width=450 /&gt;

&lt;&lt;SkeletalMageTalk &quot;&lt;i&gt;The time has come, intruder, for thee to die and be reborn in service to my master&lt;/i&gt;.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You&#39;ll have to kill me first.&quot;&gt;&gt;\
&lt;&lt;SkeletalMageTalk &quot;&lt;i&gt;That is the plan...&lt;/i&gt;.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalMageStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="91" name="Ori3" tags="" position="1436,779" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;You are wandering through the Frozen Hills when the ground beneath your feet begins to shake. The stomp feels familiar

&lt;&lt;HeroTalk &quot;Ori, is that you?&quot;&gt;&gt; \

[[The trees start to shiver-&gt;Ori3][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
The shaking of the ground becomes a rhythmic &lt;i&gt;stomp&lt;/i&gt;, &lt;i&gt;stomp&lt;/i&gt; as the golem draws near. The trees ahead shiver, then are pulled asunder by &lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Oriazus the Resplendant&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/ori1.jpg&quot; width=450 /&gt;

&lt;&lt;OriTalk &quot;Little one. You survived the Tower&#39;s destruction.&quot;&gt;&gt;\
The golem seems to be smiling, judging by the cracks forming on its golden visage.
&lt;&lt;HeroTalk &quot;Barely.&quot;&gt;&gt;\
&lt;&lt;OriTalk &quot;Yet still you seek your doom. Still you fight the Deep Woods&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course. The Redeemer&#39;s designs must be dealt with. The Void Gem must be destroyed.&quot;&gt;&gt;\
The golem sighs, flecks of gold flittering forth from its mouth. 
&lt;&lt;OriTalk &quot;This is a fight you cannot win, little one.&quot;&gt;&gt;\
\
&lt;&lt;set $a = 0&gt;&gt;\
&lt;&lt;set $b = 0&gt;&gt;\
&lt;&lt;set $c = 0&gt;&gt;\

[[Why are you so sure I&#39;ll fail?-&gt;Ori3][$p = 2, $a = 1]]
[[Where is the Winter Palace?-&gt;Ori3][$p = 2, $b = 1]]
[[Do you have anything to trade?-&gt;Ori3][$p = 2, $c = 1]]


&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;if $a eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;Why are you so sure I&#39;ll fail?&quot;&gt;&gt;\
&lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Ori&lt;/b&gt;&lt;/span&gt; blinks at you. Slowly.
&lt;&lt;OriTalk &quot;There used to be more like me. Golden Golems. Some fought. I hid.&quot;&gt;&gt;\
Silence. &lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Ori&lt;/b&gt;&lt;/span&gt; looks towards the sky, then back at you.
&lt;&lt;OriTalk &quot;Now there is but one Golden Golem. Oriazus, the Resplendant. I know a lost cause when I see one, little one.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I look forward to proving you wrong.&quot;&gt;&gt;\
&lt;&lt;OriTalk &quot;I will miss your bravado. Misplaced, and yet... amusing.&quot;&gt;&gt;\
&lt;&lt;set $a = 2&gt;&gt;\
\
&lt;&lt;elseif $b eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;Where is the Winter Palace? These Frozen Hills are only so large, yet I haven&#39;t run into it yet.&quot;&gt;&gt;\
&lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Ori&lt;/b&gt;&lt;/span&gt; shakes its massive head. Pebbles tumble to the ground as it does. 
&lt;&lt;OriTalk &quot;The Winter Palace is a magic thing. You cannot find it because it does not wish to be found.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;There must be some solution.&quot;&gt;&gt;\
&lt;&lt;OriTalk &quot;Must there? Little one, this magic is older than man. It is beyond you. &quot;&gt;&gt;\
The golem shakes it head sighs, clearly aware that you won&#39;t heed its advice.
&lt;&lt;set $b = 2&gt;&gt;\
\
&lt;&lt;elseif $c eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;Do you have anything to trade?&quot;&gt;&gt;\
The golem perks up at the question.
&lt;&lt;OriTalk &quot;I found two little morsels, of late. I could not decide which to eat. Perhaps I could trade for one... and eat the other.&quot;&gt;&gt;\
In one hand, it reveals a dark cloak that seems to drip shadows out onto the forest floor.
&lt;img src=&quot;Images/Armor/Assassin&#39;s Armor.jpg&quot; width=450 /&gt;

In the other hand, it reveals a splendid suit of armor from the far south, showcasing minor Gods of battle and bloodshed.
&lt;img src=&quot;Images/Armor/Gladiator Armor.jpg&quot; width=450 /&gt;

&lt;&lt;set $c = 2&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $a eq 0&gt;&gt;[[Why are you so sure I&#39;ll fail?-&gt;Ori3][$p = 2, $a = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Why are you so sure I&#39;ll fail?&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $b eq 0&gt;&gt;[[Where is the Winter Palace?-&gt;Ori3][$p = 2, $b = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Where is the Winter Palace?&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $c eq 0&gt;&gt;[[Do you have anything to trade?-&gt;Ori3][$p = 2, $c = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Do you have anything to trade?&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $c eq 2&gt;&gt;[[Trade with Ori-&gt;Ori3][$p = 3]]&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Ori&lt;/b&gt;&lt;/span&gt; once more shows you the two pieces of armor.
&lt;img src=&quot;Images/FrozenHills/misc3.jpg&quot; width=750 /&gt;

But he&#39;s only willing to part with one.
&lt;&lt;HeroTalk &quot;Hm... which to take?&quot;&gt;&gt;\

[[Trade for the Assassin&#39;s Armor-&gt;Ori3][$p = 4, $a = 1]]
[[Trade for the Gladiator Armor-&gt;Ori3][$p = 4, $a = 2]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;OriTalk &quot;A fine choice, little one.&quot;&gt;&gt;\
&lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Ori&lt;/b&gt;&lt;/span&gt; then proceeds to stuff the &lt;&lt;if $a eq 1&gt;&gt;Gladiator Armor&lt;&lt;else&gt;&gt;Assassin&#39;s Armor&lt;&lt;/if&gt;&gt; in its mouth, consuming it in one gulp.
&lt;&lt;OriTalk &quot;Delicious. Now, what can you offer for this remaining morsel?&quot;&gt;&gt;\

&lt;&lt;if $gold gte 350&gt;&gt;[[Offer 350 gold for the armor-&gt;Ori3][$p = 5, $i = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer 350 gold for the armor&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $gold gte 200&gt;&gt;[[Offer 200 gold for the armor-&gt;Ori3][$p = 5, $i = 2]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer 200 gold for the armor&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $gold gte 100&gt;&gt;[[Offer 100 gold for the armor-&gt;Ori3][$p = 5, $i = 3]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer 100 gold for the armor&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[To battle!-&gt;Ori3][$p = 5, $i = 4]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;You take out 350 gold pieces from your purse.
&lt;&lt;HeroTalk &quot;Will this do?&quot;&gt;&gt;\
Its carven lips crack into a smile.
&lt;&lt;OriTalk &quot;A meal to be remembered! Very kind, little one.&quot;&gt;&gt;\

Soon you&#39;ve poured the gold into its massive palm and collected the armor as payment. You watch, amused, as the behemoth swallows the gold before belching out a gust of yellow flame.
&lt;&lt;OriTalk &quot;Scrumptious.&quot;&gt;&gt;\

[[Ask Ori for aid in your quest-&gt;Ori3][$p = 6]]
&lt;&lt;set $gold -= 350&gt;&gt;

&lt;&lt;elseif $i eq 2&gt;&gt;You take out 200 gold pieces from your purse.
&lt;&lt;HeroTalk &quot;Will this do?&quot;&gt;&gt;\
Its carven lips crack into a smile.
&lt;&lt;OriTalk &quot;A fair offer, little one. I accept.&quot;&gt;&gt;\

Soon you&#39;ve poured the gold into its massive palm and collected the armor as payment. You watch, amused, as the behemoth swallows the gold before belching out a gust of yellow flame.
&lt;&lt;OriTalk &quot;Mmm... remarkably tasty.&quot;&gt;&gt;\

[[Ask Ori for aid in your quest-&gt;Ori3][$p = 6]]
&lt;&lt;set $gold -= 200&gt;&gt;

&lt;&lt;elseif $i eq 3&gt;&gt;You take out 100 gold pieces from your purse.
&lt;&lt;HeroTalk &quot;Will this do?&quot;&gt;&gt;\
It studies the gold, then slowly nods its head.
&lt;&lt;OriTalk &quot;A small meal... but a fine one. I accept.&quot;&gt;&gt;\

Soon you&#39;ve poured the gold into its massive palm and collected the armor as payment. You watch, amused, as the behemoth swallows the gold before belching out a gust of yellow flame.
&lt;&lt;OriTalk &quot;Nothing can compare.&quot;&gt;&gt;\

[[Ask Ori for aid in your quest-&gt;Ori3][$p = 6]]
&lt;&lt;set $gold -= 100&gt;&gt;

&lt;&lt;elseif $i eq 5&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle2_bgm&quot; volume 0.5 play loop&gt;&gt;\
\
Enough prattling. You&#39;re here to cleanse the Deep Woods of hideous creatures such as this.

&lt;&lt;HeroTalk &quot;Vile thing - have at thee!&quot;&gt;&gt;\
As you raise your $weapon, the behemoth sighs.
&lt;&lt;OriTalk &quot;I will destroy you. If I must.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;OriStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $oristatus = 1&gt;&gt;\

&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 6&gt;&gt;\
&lt;&lt;HeroTalk &quot;Ori - would you aid me in my quest? Surely you know the Redeemer must be stopped. And if I should fall, I would want you to stand in my place.&quot;&gt;&gt;\
The golem stares past you, unblinking. Then it slowly shakes its head.
&lt;&lt;OriTalk &quot;I cannot. I am weak.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You&#39;re a &lt;i&gt;golem&lt;/i&gt;! You eat &lt;i&gt;metal&lt;/i&gt;! If you&#39;re weak, then I&#39;m nothing.&quot;&gt;&gt;\
&lt;&lt;OriTalk &quot;I... &lt;i&gt;hmm&lt;/i&gt;... I am sorry, little one.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Character/ori1.jpg&quot; width=450 /&gt;

Then it stomps off, its heavy footfalls rattling the ground long after it is out of view.

&lt;i&gt;You gained 100 exp!&lt;/i&gt;

[[You decide it&#39;s about time you returned to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $oristatus = 4&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $a eq 1&gt;&gt;&lt;&lt;set $chestinventory.push($assassinsarmor)&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $chestinventory.push($gladiatorarmor)&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;\
\
You have slain &lt;b&gt;Ori the Resplendent&lt;/b&gt;!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $oristatus = 0&gt;&gt;

&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="92" name="Palace Entrance" tags="" position="1583,175" size="100,100">&lt;&lt;if $frozenquest gte 30&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;\
You stand before the ruins of the Winter Palace.
&lt;img src=&quot;Images/FrozenHills/palace18.jpg&quot; width=700 /&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;elseif $frozenquest eq 10&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $music neq &quot;palace&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;palace&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
Upon setting out from your cabin, it doesn&#39;t take you long to spot the Winter Palace. It is a grand structure of black stone, perched precariously on a crumbling hill. It wasn&#39;t there yesterday, but by the beacons&#39; power it has been fixed in place. &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; has nowhere to run.
&lt;img src=&quot;Images/FrozenHills/palace1.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;This is it.&quot;&gt;&gt; \
Behind you, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; shivers under the howling winds and drifting snow.
&lt;&lt;MerchantTalk &quot;You don&#39;t suppose he has a fire going, do you?&quot;&gt;&gt; \

[[Ignoring him, you approach the Palace-&gt;Palace Entrance][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
The winds only grow fiercer, the snows thicker, as you and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; ascend the winding stair that hugs the mountainside. To your left, the drop seems endless.
&lt;&lt;HeroTalk &quot;Tell me, Babar - what kind a man is this Duke Carnax?&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Richer than a king, of course. A powerful necromancer, too. But this I only learned later, yes? When I first met him, he was different.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Oh?&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Clever with his words, always seeming to be on your side. He could sell sand to a rattlesnake, you might say. He turned me against my own brother - though the blame is my own, I admit. He is a clever fiend.&quot;&gt;&gt; \
A master manipulator and a supreme necromancer. Truly a formidable foe.
&lt;&lt;HeroTalk &quot;What do you make of his proposal to Naya?&quot;&gt;&gt; \
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; laughs.
&lt;&lt;MerchantTalk &quot;She&#39;s a pretty little elf - &lt;i&gt;is what I&#39;d think, if I were thirty years younger&lt;/i&gt;! Carnax is beyond such pleasures - he probably wants her blood for some dark ritual. &lt;i&gt;Or worse&lt;/i&gt;. He must be stopped, $name!&quot;&gt;&gt; \
&lt;&lt;if $nayalove eq 21&gt;&gt;You sigh, your mind drifting to the sight of &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; on your bed.
&lt;&lt;MerchantTalk &quot;You&#39;ve fallen for her, haven&#39;t you? Bah, don&#39;t you deny it! I see it in your eyes. This is a dangerous game, no? Loving a princess?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Dangerous or not, it means nothing if she dies in this damned palace. Come, Babar.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
\
[[The Palace door stands before you-&gt;Palace Entrance][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;img src=&quot;Images/FrozenHills/palace4.jpg&quot; width=500 /&gt;

You and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; stare long and hard at the sealed door.
&lt;&lt;MerchantTalk &quot;Do we knock?&quot;&gt;&gt; \
As if in answer, the wind howls over your heads.
&lt;&lt;Lich1Talk &quot;&lt;i&gt;Enter at thy peril.  Hither lies only death and sorrow&lt;/i&gt;.&quot;&gt;&gt; \
Then, slowly, the doors creak open.

[[Enter-&gt;Palace1][$p = 0]]

&lt;&lt;set $frozenquest = 11&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $frozenquest gte 11&gt;&gt;\
&lt;&lt;if $music neq &quot;palace&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;palace&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You&#39;re standing before the Winter Palace. Behind you waits &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;, cursing and shivering.
&lt;img src=&quot;Images/FrozenHills/palace1.jpg&quot; width=500 /&gt;

[[Enter the Palace-&gt;Palace1][$p = 0]]
[[Return to your cabin-&gt;Outside the Cabin]] 
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="93" name="SkeletalArcherAttack" tags="" position="1437,657" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You are wandering through the Frozen Hills when an arrow lands just between your feet.

Looking to the trees beyond the path, you spot your foe - an undead minion of the heir of Netheryn, wielding a well-crafted bow.
&lt;img src=&quot;Images/FrozenHills/dead1.jpg&quot; width=450 /&gt;

&lt;&lt;SkeletalArcherTalk &quot;&lt;i&gt;Such a fine pelt, thy skin will make, to adorn my master&#39;s halls.&lt;/i&gt;.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Perish, fiend!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalArcherStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;victory1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;victory&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="94" name="SpringOfLife" tags="" position="1433,1032" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;if $music neq &quot;frozen&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

As you venture through the Frozen Hills, you come upon an icy river. Thirsty from your sojourn, you kneel before it, force a hole through the ice with your $weapon, and take a deep drink.

It is cuttingly cold, but fresh and clean.
&lt;img src=&quot;Images/FrozenHills/spring5.jpg&quot; width=700 /&gt;

It&#39;s as you&#39;re drinking that you feel something, brushing against your shoulder.

&lt;i&gt;Warmth&lt;/i&gt;.

It&#39;s almost like a high-banked fire, or the &lt;i&gt;sun&lt;/i&gt; itself, is glowing in that direction, out of sight beyond the river&#39;s bend.

[[Investigate-&gt;SpringOfLife][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
Moving slowly to avoid making sound, you stalk the river, then follow a small tributory stream into the hillside. The warmth grows stronger, suggesting that you&#39;re on the right track.

Then, drawing back a few river reeds, you see you&#39;ve found it.

The Spring of Life.
&lt;img src=&quot;Images/FrozenHills/spring6.jpg&quot; width=650 /&gt;

The waters shimmer and glow, exuding a serene kind of warmth you&#39;ve never felt before. The eternal winter of the Frozen Hills seems to have little power over the secluded spring.

And there, standing over the water, watching you with grim resolve, is a stag.

[[Approach-&gt;SpringOfLife][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
As you approach, the stag stomps a hoof upon the ground.
&lt;img src=&quot;Images/FrozenHills/spring7.jpg&quot; width=450 /&gt;

Then it speaks.
&lt;&lt;GuardianTalk &quot;&lt;i&gt;Cain&#39;helien ainu tal.&lt;/i&gt;.&quot;&gt;&gt;\
Elvish. It speaks elvish. Thankfully, it seems to notice your lack of understanding.
&lt;&lt;GuardianTalk &quot;You are not welcome here, human.&quot;&gt;&gt;\
After getting over your shock at hearing an animal speak - and eloquently, at that - you give the stag a small bow.
&lt;&lt;HeroTalk &quot;I mean you no harm. I only seek a single vial of the Spring&#39;s water.&quot;&gt;&gt;\
&lt;&lt;GuardianTalk &quot;This Spring was a bridegift to the Queen of Netheryn. It is not yours to take.&quot;&gt;&gt;\
You sigh. Elves and their magic...

[[Reason with the stag-&gt;SpringOfLife][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;HeroTalk &quot;The Queen of Netheryn has been dead for over a thousand years. She doesn&#39;t need this water.&quot;&gt;&gt;\
&lt;&lt;GuardianTalk &quot;It matters not. For fourteen hundred years I have guarded this spring. So shall I remain for eternity.&quot;&gt;&gt;\
The Guardian won&#39;t budge. It&#39;s time to get creative.

[[Slay the Guardian-&gt;SpringOfLife][$p = 4]]
[[Secretly steal a vial of the Spring&#39;s water-&gt;SpringOfLife][$p = 5]]
[[Appeal to the Guardian&#39;s sense of duty-&gt;SpringOfLife][$p = 6]]

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle5_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
You draw your $weapon.
&lt;&lt;HeroTalk &quot;I&#39;m sorry. The power of this Spring will aid me in defeating the Redeemer. Your vigil is over.&quot;&gt;&gt;\
&lt;&lt;GuardianTalk &quot;Like all humans, it is your nature to conquer and despoil. Come - let us lock horns. &lt;i&gt;Nethe&#39;ryn Sulthu&#39;dar&lt;/i&gt;!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SpringGuardianStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 5&gt;&gt;\
Nodding your head, you depart from the Spring.

At least, for a while, you do. Then, as night falls over the Frozen Hills, you return. &lt;&lt;set $time = &quot;Night&quot;&gt;&gt;
&lt;img src=&quot;Images/FrozenHills/spring9.jpg&quot; width=550 /&gt;

Crawling on your hands and knees, you make your slow way closer to the Spring, halt every now and then to listen for the Guardian.

Soon, the water is before your eyes. Then it&#39;s just a matter of filling a vial.

&lt;b&gt;Agility Check&lt;/b&gt;
&lt;&lt;AgilityCheck 110&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;In a moment, the deed is done! The vial is yours!

&lt;i&gt;The Gods marvel at your guile! You gain 2 Agility!&lt;/i&gt;

[[Satisfied, you sneak your way back to the cabin-&gt;Outside the Cabin][$p = 0]]

&lt;&lt;set $merchantstatus = 12&gt;&gt;\
&lt;&lt;set $baseagility += 2&gt;&gt;\
\
&lt;&lt;elseif $action eq &quot;failure&quot;&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle5_bgm&quot; volume 0.5 play loop&gt;&gt;\

Just before you fill the vial, a hoof kicks it out of your hand.

The Guardian!
&lt;&lt;GuardianTalk &quot;Now your life is forfeit, human. &lt;i&gt;Nethe&#39;ryn Sulthu&#39;dar&lt;/i&gt;!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SpringGuardianStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
\
\
&lt;&lt;/if&gt;&gt;\
\
\
\
&lt;&lt;elseif $p eq 6&gt;&gt;\
You decide to appeal to the Guardian&#39;s sense of duty.
&lt;&lt;HeroTalk &quot;To stand guard for over a millennia... that is impressive. The Queen would be proud.&quot;&gt;&gt;\
To this, the Guardian says nothing.
&lt;&lt;HeroTalk &quot;But the Queen is gone. Netheryn is gone. Now a fiend named the Redeemer seeks to unleash the doom of Netheryn upon the whole world. And it is my duty to stop him.&quot;&gt;&gt;\
&lt;&lt;GuardianTalk &quot;What befalls humans is none of my concern.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;But what of your duty to your Queen? Would she want you to stand idly by while the Redeemer desecrated her land? Would she let the Void be unleashed, unopposed.&quot;&gt;&gt;\
&lt;&lt;GuardianTalk &quot;...&quot;&gt;&gt;\

&lt;b&gt;Willpower Check&lt;/b&gt;
&lt;&lt;WillpowerCheck 90&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;After a moment&#39;s pause, the Guardian bows its head.
&lt;&lt;GuardianTalk &quot;If this Spring would aid you in your fight against the Redeemer... then I cannot stand in your way.&quot;&gt;&gt;\
After a respectful nod of your head, you kneel before the Spring and fill a vial full of its water. Just as you turn to leave, the Guardian speaks once more.
&lt;&lt;GuardianTalk &quot;Blessings of Netheryn upon you, human.&quot;&gt;&gt;\

&lt;i&gt;The blessing of the Guardian fills your soul! You gain 2 Willpower!&lt;/i&gt;

[[Vial in hand, you return to the cabin-&gt;Outside the Cabin][$p = 0]]

&lt;&lt;set $merchantstatus = 12&gt;&gt;\
&lt;&lt;set $basewillpower += 2&gt;&gt;\

&lt;&lt;elseif $action eq &quot;failure&quot;&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle5_bgm&quot; volume 0.5 play loop&gt;&gt;\

The Guardian stomps its hooves.
&lt;&lt;GuardianTalk &quot;No! I will not be fooled by human deceit! &lt;i&gt;Nethe&#39;ryn Sulthu&#39;dar&lt;/i&gt;!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SpringGuardianStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;\
You defeated the $enemyname!

The Guardian falls to the ground, its lifeblood spilling from a mortal wound.
&lt;&lt;GuardianTalk &quot;After all these years... I failed...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You left me no choice.&quot;&gt;&gt;\
&lt;&lt;GuardianTalk &quot;Hmm... only in death... does duty end...&quot;&gt;&gt;\
Its eyes slowly shut. It is gone.
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

You find the Mask of the Guardian!

After resting from the battle, you fill a vial full of the Spring&#39;s water. It shimmers with ancient power.
&lt;img src=&quot;Images/FrozenHills/spring3.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;Babar... this had better be worth it.&quot;&gt;&gt;\

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $merchantstatus = 12&gt;&gt;\
&lt;&lt;set $headinventory.push($maskoftheguardian)&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="95" name="Camp" tags="" position="1433,1156" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;if $music neq &quot;frozen&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You venture deep into the Frozen Hills. Cold, silent woods pass you by as the sun watches, a pale candle far beyond the clouds. The woods you soon leave behind, now climbing peaks of ice. Your pace slows as the snow gathers nearly waist-high.
&lt;img src=&quot;Images/FrozenHills/frozen3.jpg&quot; width=700 /&gt;

After a long hike you pause, catching your breath on a hilltop. The land below is vast and cold. Snow, and trees, and barren crags... but no castle.

You cannot find the Winter Palace.
&lt;&lt;HeroTalk &quot;How could this be? Could Zyr be mistaken?&quot;&gt;&gt;\
That seems unlikely. The strange Librarian seemed to know his books. The Palace is simply &lt;i&gt;hidden&lt;/i&gt;. You suspect the very same force tha has raised the dead shields it from you. It does not want to be found.

[[Continue your search-&gt;Camp][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
The sun descends in the West, and the sky dims. The way back to your cabin is slow, and night seeps in, swallowing the light. Soon you&#39;re trudging through the dark, your fingers never far from your $weapon.

Then you catch sight of a curious thing. A lone, fitful light. A campfire.
&lt;img src=&quot;Images/FrozenHills/camp1.jpg&quot; width=700 /&gt;

You approach slowly, recognizing this might be some kind of trap. Then again, the walking dead of the Frozen Hills haven&#39;t appeared overly clever, so far.

Soon you&#39;re close enough to the campfire to feel its warmth against your cheeks. The campsite is empty - but the fire is fresh, and its maker can&#39;t be far. 

[[Wait for the fire-maker to return-&gt;Camp][$p = 2, $i = 1]]
[[Leave before you are seen-&gt;Camp][$p = 2, $i = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;You opt to wait for whoever made the fire to return. Time slips by, as you watch the fire and count the stars. Oddly enough, the flames very dim, the warmth never dies. Magic must be involved.

Eventually, you realize the fire-maker might not be returning, tonight. Stretching your stiff limbs, you decide to return to the cabin.
&lt;&lt;else&gt;&gt;You decide to leave before you are seen. Whoever made this fire might be hostile, or in the employ of the Redeemer.
&lt;&lt;/if&gt;&gt;\

As you return to your cabin, you can&#39;t help but feel uneasy. As if you&#39;re being watched.

From the trees beyond the campfire, a lone figure shakes his head.
&lt;&lt;Redeemer3Talk &quot;This complicates things...&quot;&gt;&gt;\

[[...-&gt;Outside the Cabin]] 
\
&lt;&lt;set $frozenquest = 3&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="96" name="Nendel1" tags="" position="1435,1270" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;if $music neq &quot;frozen&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
Another day in the Frozen Hills. Another fruitless search for the Winter Palace. You&#39;ve found hardly a mark of civilization, let alone a palace hiding in the wilds.

By chance, you stumble upon another campsite, similarly empty.
&lt;img src=&quot;Images/FrozenHills/camp2.jpg&quot; width=650 /&gt;

It seems the mysterious hermit is still wandering the hills, just like you are. Maybe this time the two of you will meet.

You look around, spotting nothing - no living person, no sign of any tracks.

Then, from beyond the trees, a shout.
&lt;&lt;Redeemer3Talk &quot;Stay back! I&#39;m warning you!&quot;&gt;&gt;\

A low growl answers the voice. Someone&#39;s out there. And they&#39;re in danger!

[[Pursue the sound-&gt;Nendel1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
You break into a sprint, and soon find the source of the sounds. A man, fending off a troll!

Not quite a man, actually. At least, not &lt;i&gt;human&lt;/i&gt; man. The troll&#39;s foe is an elf.
&lt;img src=&quot;Images/Character/nendel1.jpg&quot; width=450 /&gt;

&lt;&lt;Redeemer3Talk &quot;Don&#39;t make me resort to violence!&quot;&gt;&gt;\
The elf shouts this to the troll. The troll&#39;s answer, of course, is it swat him like a fly and send him tumbling through the snow.

[[Draw your weapon-&gt;Nendel1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle4_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\

You step between the downed elf and the troll.
&lt;&lt;FrostTrollTalk &quot;Lookie &#39;ere... another elf, eager ta die.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;m not an elf.&quot;&gt;&gt;\
&lt;&lt;FrostTrollTalk &quot;Shame... elves taste better den &#39;umans.&quot;&gt;&gt;\
The troll stands its full height and unleashes a massive roar.
&lt;img src=&quot;Images/FrozenHills/frosttroll1.jpg&quot; width=500 /&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;FrostTrollStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;\
The frost troll falls to ground, its strength at last extinguished.
&lt;&lt;FrostTrollTalk &quot;Stupid... &#39;uman...&quot;&gt;&gt;\

Once its finally dead, you turn around to see the elf has picked himself up and looks shaken, but unwounded.
&lt;img src=&quot;Images/Character/nendel1.jpg&quot; width=450 /&gt;

&lt;&lt;Redeemer3Talk &quot;You... I know you.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;That&#39;s unlikely.&quot;&gt;&gt;\
He drops into a formal bow.
&lt;&lt;Redeemer3Talk &quot;Forgive me - I&#39;m being ungrateful. First, my name is Nendel - you know my younger sister, Naya. She described you to me, not too long ago. She mentioned she left you in a cave.&quot;&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; has a brother? She never mentioned him. They do look alike, but then again most elves do.
&lt;&lt;HeroTalk &quot;Naya and I working together, now.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Then you, too, seek the Catalyst?&quot;&gt;&gt;\
You blink. The elf is remarkably well-informed.
&lt;&lt;Redeemer3Talk &quot;Come back to my camp. I sense we have much to discuss.&quot;&gt;&gt;\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Follow Nendel-&gt;Nendel1][$p = 21]]

&lt;&lt;BattleEnd&gt;&gt;\
\
\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
\
As you follow &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; back to his camp, you remind yourself to keep you guard up. You can&#39;t trust him until you confirm his story with &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, back in your cabin.
&lt;img src=&quot;Images/FrozenHills/camp2.jpg&quot; width=650 /&gt;

&lt;&lt;Redeemer3Talk &quot;Before we begin, might I have your name?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I am called $name $title. $name will do.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Very well, $name. I have a lead on how to find the Winter Palace, and the Catalyst within... but I can tell from your stare that you don&#39;t trust me.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You&#39;ve given me little reason to. And I have many enemies.&quot;&gt;&gt;\
He almost laughs, then stops himself.
&lt;&lt;Redeemer3Talk &quot;As do I. Very well - ask your questions. I will prove my worth in my answers, I&#39;m certain.&quot;&gt;&gt;\

[[You&#39;re Naya&#39;s brother?-&gt;Nendel1][$p = 22, $a = 1]]
[[What are you doing out here?-&gt;Nendel1][$p = 22, $b = 1]]
[[Why should I believe a single word you say?-&gt;Nendel1][$p = 22, $c = 1]]
\
&lt;&lt;set $a = 0&gt;&gt;\
&lt;&lt;set $b = 0&gt;&gt;\
&lt;&lt;set $c = 0&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 22&gt;&gt;\
&lt;&lt;if $a eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;You&#39;re Naya&#39;s brother? Truly?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Since the day she was born, yes. I was once called Nendel&#39;lar, prince of Hadamshal, and heir to the throne...&quot;&gt;&gt;\
He sighs deeply, remembering the past.
&lt;&lt;Redeemer3Talk &quot;But that was a long time ago. Now I am just Nendel.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;She never mentioned you.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;As you might have already realized, my sister mentions very little of anything. She&#39;s a closed book.&quot;&gt;&gt;\
He sees the uncertainty in your glare.
&lt;&lt;Redeemer3Talk &quot;She left me a letter. Here.&quot;&gt;&gt;\
He tosses it at your feet.
&lt;img src=&quot;Images/FrozenHills/camp3.png&quot; width=800 /&gt;

The letter does seem to back up &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&#39;s&lt;/b&gt;&lt;/span&gt; claim.
&lt;&lt;set $a = 2&gt;&gt;\
\
&lt;&lt;elseif $b eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;What are you doing out here?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;The same as you, I suspect. I seek a Netheryn Catalyst. The &lt;i&gt;last&lt;/i&gt; Netheryn Catalyst, perhaps. It&#39;s locked away in the Winter Palace.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;And how could you possibly know that?&quot;&gt;&gt;\
He smirks. 
&lt;&lt;Redeemer3Talk &quot;Zyr&#39;s Tower is not the only source of Netheryn lore. I learned of the Winter Palace in the libraries of Hadamshal. I never thought I&#39;d have to seek it out, but here we are.&quot;&gt;&gt;\
&lt;&lt;set $b = 2&gt;&gt;\
\
&lt;&lt;elseif $c eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;Why should I believe a single word you say?&quot;&gt;&gt;\
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; perks up at the question.
&lt;&lt;Redeemer3Talk &quot;No wonder you&#39;ve survived the Deep Woods for so long. You&#39;re tough as steel.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Answer me. For all I know you work for the Redeemer. He has much to gain from drawing out Naya - and the Void Gem.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;You&#39;re not wrong. But heed me, $name - the Redeemer is my sworn enemy. His destruction is my priority, just as it is Naya&#39;s.&quot;&gt;&gt;\
He seems to be telling the truth. But elves are known for exactly such trickery.
&lt;&lt;HeroTalk &quot;Hmm...&quot;&gt;&gt;\
&lt;&lt;set $c = 2&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $a eq 0&gt;&gt;[[You&#39;re Naya&#39;s brother?-&gt;Nendel1][$p = 22, $a = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;You&#39;re Naya&#39;s brother?&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $b eq 0&gt;&gt;[[What are you doing out here?-&gt;Nendel1][$p = 22, $b = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;What are you doing out here?&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $c eq 0&gt;&gt;[[Why should I believe a single word you say?-&gt;Nendel1][$p = 22, $c = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Why should I believe a single word you say?&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if ($c eq 2) and ($b eq 2) and ($a eq 2)&gt;&gt;[[Consider your options-&gt;Nendel1][$p = 23]]&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 23&gt;&gt;\
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; has spoken well in his defense. He is likely who he claims to be. Still, a letter can be forged. And the Redeemer is likely a master of deceit.
&lt;&lt;HeroTalk &quot;I will go to Naya, and see what she thinks.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Very well. If you decide to trust me, and you wish to find the Winter Palace, meet me back here. Then our work can begin.&quot;&gt;&gt;\

You leave &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; and make your way back to the cabin. He does not try to follow you.

[[Go back to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $frozenquest = 4&gt;&gt;\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="97" name="Dragon1" tags="" position="1435,1389" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
After you arrive, you scout the ruins. No sign of a dragon - besides a rather large pile of bones gathering within the broken Tower&#39;s base. No sign of &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, either.

At least, until you spot a mouse sitting on a mushroom, while staring at you expectantly.
&lt;img src=&quot;Images/ScarletVale/mouse2.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;There you are. I trust you haven&#39;t been waiting long?&quot;&gt;&gt;\
The mouse gives a small shrug.
&lt;&lt;HeroTalk &quot;Right. Let&#39;s get on with this, then.&quot;&gt;&gt;\

[[Use the Dragonhorn-&gt;Dragon1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
Taking a deep breath, you heft the Dragonhorn and set it to your lips.
&lt;img src=&quot;Images/Items/Dragonhorn.jpg&quot; width=500 /&gt;

The sound that follows is almost too low for your ears to catch. What you can feel, however, is the ground rattling beneath your feet, and the shivering of what remains of Zyr&#39;s Tower.

Then comes a voracious roar, and the beating of heavy wings. A shadow swoops overhead. Before you can look up, the figure is past you, and lands with a heavy crash upon the ground. 

A red dragon, looking none too pleased at what you&#39;ve done.
&lt;img src=&quot;Images/FrozenHills/dragon2.jpg&quot; width=600 /&gt;

[[Face the beast-&gt;Dragon1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;ZaradrasTalk &quot;Foolish mortal. That horn is not a plaything.&quot;&gt;&gt;\
Its voice is the cackle of fire and bellow of fresh flame. Smoke rises from between its blade-like teeth.
&lt;&lt;HeroTalk &quot;This tower is not yours to roost in. Begone!&quot;&gt;&gt;\
&lt;&lt;ZaradrasTalk &quot;You dare command Zaradras, the Envious Flame? I was eating stronger humans than you long before you were born. You&#39;ve made a terrible error.&quot;&gt;&gt;\
Beside you, there is a burst of smoke. From it rises &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, staff in hand.
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

&lt;&lt;ZaradrasTalk &quot;Ah, the priestess of Tylae. Do you know, witch, that your Goddess made my kind first?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Even the Gods can err, then.&quot;&gt;&gt;\

[[Zaradras puffs out its wings-&gt;Dragon1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dragon1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dragon&quot;&gt;&gt;\
&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Zaradras&lt;/b&gt;&lt;/span&gt; lets out a flame-filled roar.
&lt;&lt;ZaradrasTalk &quot;Enough! I obey no one - not even the Gods! I shall feast on you both!&quot;&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; raises her staff, its gem shining with white light.
&lt;&lt;WitchTalk &quot;Stand firm, $name! The Goddess is with us!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ZaradrasStats&gt;&gt; 
&lt;&lt;Witch1Stats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;witch1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;witch&quot;&gt;&gt;\
&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Zaradras&lt;/b&gt;&lt;/span&gt; falters.
&lt;&lt;ZaradrasTalk &quot;Bested by mortals... &lt;i&gt;impossible...&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Now, $name! Finish this!&quot;&gt;&gt;\
You charge, brandishing your $weapon and leaping upon &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Zaradras&#39;s&lt;/b&gt;&lt;/span&gt; neck. Too weak to resist, the dragon does nothing as you split its throat open, and let its lifeblood spill upon the ground.
&lt;img src=&quot;Images/FrozenHills/dragon4.jpg&quot; width=650 /&gt;
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[It is done-&gt;Dragon1][$p = 21]]
\
&lt;&lt;BattleEnd&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
As you lean over the dragon&#39;s corpse, heaving, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; sets her knife against its chest and cuts deep. Soon she&#39;s pulled out what must be the creature&#39;s heart.
&lt;img src=&quot;Images/FrozenHills/dragon5.jpg&quot; width=350 /&gt;

&lt;&lt;WitchTalk &quot;This was a great victory, $name.&quot;&gt;&gt;\
You slouch down to the fround, slick with the dragon&#39;s blood.
&lt;&lt;HeroTalk &quot;I suppose it was...&quot;&gt;&gt;\
She kneels beside you and taps your shoulder. In an instant, your wounds are healed.
&lt;&lt;WitchTalk &quot;Come find me back at your cabin - once you&#39;ve washed the stink of blood from your skin, maybe.&quot;&gt;&gt;\

[[Go back to the cabin-&gt;Outside the Cabin]] 

\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $witchstatus = 14&gt;&gt;\
&lt;&lt;set $dragon = 1&gt;&gt;
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="98" name="Beacon1" tags="" position="1437,1505" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;if $music neq &quot;frozen&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
As you journey through the Frozen Hills, you spot &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&#39;s&lt;/b&gt;&lt;/span&gt; camp. Unlike last time, the elf is actually beside the fire. He rises upon spotting you.
&lt;img src=&quot;Images/Character/nendel1.jpg&quot; width=450 /&gt;

&lt;&lt;Redeemer3Talk &quot;$name. I imagine seeing you hear means you&#39;ve decided to trust me?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Our goals appear aligned. You said you knew how to find the Winter Palace?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Of course. Allow me to explain.&quot;&gt;&gt;\

[[He gestures for you to sit.-&gt;Beacon1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
You sit onto a log on the other side of campfire.
&lt;&lt;Redeemer3Talk &quot;The Winter Palace, unlike most palaces, &lt;i&gt;moves&lt;/i&gt;.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;That sounds unlikely.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Netheryn magic is impressive, yes. The Palace uses the power of the Catalyst it holds to blink across the Frozen Hills. Wherever the foes of the Palace are, the Palace &lt;i&gt;isn&#39;t&lt;/i&gt;. It presents a problem, but it also means-&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;- the Catalyst is in working condition. We can use it to destroy the Void Gem.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Exactly.&quot;&gt;&gt;\

[[How do we get into the Winter Palace?-&gt;Beacon1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;It&#39;s no easy task to get into a moving Palace. But I know of a way to override its magic. I can force it to come to a stop.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Go on.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;The Netheryn mages crafted three beacons across the Frozen Hills. If all three beacons are activated, the Winter Palace is forced to ground.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;And you can activate the beacons?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;I believe so. And I know where the first beacon is, too.&quot;&gt;&gt;\
You rise.
&lt;&lt;HeroTalk &quot;Lead the way.&quot;&gt;&gt;\

[[To the beacon!-&gt;Beacon1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; leads you deep into the Frozen Hills. The woods you soon leave behind. Instead, the two of you climb over ice-laden peaks in search of your quarry.
&lt;img src=&quot;Images/FrozenHills/frozen1.jpg&quot; width=700 /&gt;

At last, as the sun leans towards the west, you spot it in the distance. An old, snow-covered ruin crowning the next hill.
&lt;img src=&quot;Images/FrozenHills/beacon1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;That&#39;s the beacon?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;This is the first beacon. They each look different, apparently. Though they&#39;re all made of stone, at least.&quot;&gt;&gt;\
The two of you climb the final hill, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; taking the lead with you just behind him. Soon you&#39;re amongst the ruins. The very tallest stone, stretching up towards the heavens, is covered in Elven script.

&lt;&lt;Redeemer3Talk &quot;Once I begin the encantation, I&#39;ll need full concentration to finish it. Just do your best to ensure I&#39;m not disturbed.&quot;&gt;&gt;\

[[Begin-&gt;Beacon1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; places his hand against the stone and begins to chant. The moment he does, you feel the wind rising. The air seems to grow colder.

Something&#39;s coming.

Then, a voice:
&lt;&lt;Lich1Talk &quot;&lt;i&gt;Still you pursue thy doom? Still you disobey?&lt;/i&gt;&quot;&gt;&gt;\
You draw your $weapon.
&lt;&lt;Lich1Talk &quot;&lt;i&gt;Then thy end hast come.&lt;/i&gt;&quot;&gt;&gt;\
An arrow flies past your nose.
&lt;&lt;HeroTalk &quot;What!?&quot;&gt;&gt;\

[[Face your assailant-&gt;Beacon1][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\

Your enemy is an archer, long dead.
&lt;img src=&quot;Images/FrozenHills/dead1.jpg&quot; width=450 /&gt;

&lt;&lt;SkeletalArcherTalk &quot;&lt;i&gt;The heir of Netheryn has forbidden defilement of the beacons&lt;/i&gt;!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Try to stop us.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalArcherStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 0&gt;&gt; \

&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;&lt;if $battletotal eq 0&gt;&gt;\
The skeleton crumbles.
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $battletotal += 1&gt;&gt; \

Just as it does, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; pulls his hand off the beacon.
&lt;&lt;Redeemer3Talk &quot;It&#39;s done. This beacon is lit. We should-&quot;&gt;&gt;\
His words die in his throat. Looking where he stares, you see the problem.

There&#39;s a heavily armored skeletal soldier running your way.
&lt;img src=&quot;Images/FrozenHills/dead3.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;This might pose a problem.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Come, we&#39;ll face him together! To arms!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;SkeletalKnightStats&gt;&gt; \
&lt;&lt;Nendel1Stats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
\
\
&lt;&lt;elseif $battletotal eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;\
Once the skeletal knight finally falls apart, you check to see if &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; is well. He seems unaffected by the melee.
&lt;&lt;Redeemer3Talk &quot;The heir of Netheryn, I should have known.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You know the necromancer who rules this land?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;We met, once. It didn&#39;t end well for me. I&#39;m still working to piece together exactly what he is after. At the very least, we know he&#39;s opposed to our lighting of the beacons.&quot;&gt;&gt;\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

[[What now?-&gt;Beacon1][$p = 21]]
\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;/if&gt;&gt;
\
\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;What now? Two beacons still elude us.&quot;&gt;&gt;\
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; gestures into the frozen wilderness.
&lt;&lt;Redeemer3Talk &quot;I will seek them out, and find you each time I&#39;ve located one. Best we activate them together.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Agreed. Come, we&#39;ll rest over at my cabin. Naya will be glad to see you.&quot;&gt;&gt;\
Yet when you walk away, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; does not follow.
&lt;img src=&quot;Images/Character/nendel1.jpg&quot; width=450 /&gt;
&lt;&lt;Redeemer3Talk &quot;My thanks, $name. You&#39;re a hospitable human...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;But?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;But I prefer my own company. Naya understands.&quot;&gt;&gt;\
He breathes deeply of the icy air.
&lt;&lt;Redeemer3Talk &quot;Watch over her. I&#39;ll find you when it&#39;s time.&quot;&gt;&gt;\

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $frozenquest = 6&gt;&gt;\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="99" name="Beacon2" tags="" position="1438,1626" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;if $music neq &quot;frozen&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
As you journey through the Frozen Hills, you spot a familiar face.
&lt;img src=&quot;Images/Character/nendel1.jpg&quot; width=450 /&gt;

&lt;&lt;Redeemer3Talk &quot;It&#39;s time.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You&#39;ve found the second beacon?&quot;&gt;&gt;\
He nods, then gestures for you to follow.
&lt;&lt;Redeemer3Talk &quot;It&#39;s quite the hike - let&#39;s move while there&#39;s daylight.&quot;&gt;&gt;\

[[Follow Nendel-&gt;Beacon2][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; leads you deep into the Frozen Hills. The woods you soon leave behind. Passing the woods, you come upon a long, frozen coast, bordering a vast and ice-filled lake. Its beauty and size is enough to take your breath away.
&lt;img src=&quot;Images/FrozenHills/frozen2.jpg&quot; width=700 /&gt;

&lt;&lt;Redeemer3Talk &quot;I&#39;ve learned something about this heir of Netheryn. Nothing too impressive, but I believe we really are dealing with an elf - perhaps a descendant of Netheryn, like me and Naya.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I thought you were Hadamshal royalty.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Yes, but the Hadamshal royal line traces its blood back to Netheryn. It seems when the Void consumed that old kingdom, some nobles fled to what became Hadamshal.&quot;&gt;&gt;\
A curious tale.
&lt;&lt;HeroTalk &quot;And this &#39;heir,&#39; - he&#39;s your relation?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;I do not know. Could it be his family hid in the Winter Palace, fourteen hundred years ago, and... waited? If only we could speak to him.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;m sure we will, soon enough.&quot;&gt;&gt;\

[[Carry on-&gt;Beacon2][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
As afternoon sunlight glitters on the silent, frozen lake, you spot a curious marvel - a tower of stone, dotted with many holes. From them, the wind warps and &lt;i&gt;sings&lt;/i&gt;, a distant, warbling croon. It&#39;s enough to set your mind on edge.
&lt;img src=&quot;Images/FrozenHills/beacon3.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;This is it?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;It must be. I can feel the same old magic as the first beacon. The activation won&#39;t take me long. Just make sure nothing comes inside.&quot;&gt;&gt;\
Just before entering, he casts a long, guarded look at the still waters of the lake.
&lt;&lt;Redeemer3Talk &quot;And don&#39;t make any noise.&quot;&gt;&gt;\
Without another word, he disappears into the strange tower.

[[Stand guard-&gt;Beacon2][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
The wind howls across the shore, biting at your skin. Even breathing hurts. It&#39;s getting colder.

Then from the wind rises a sinister voice.
&lt;&lt;Lich1Talk &quot;&lt;i&gt;Doth thee seek thy doom, human?&lt;/i&gt;&quot;&gt;&gt;\
You look around, but the voice comes from every direction at once.
&lt;&lt;HeroTalk &quot;I seek your Catalyst.&quot;&gt;&gt;\
&lt;&lt;Lich1Talk &quot;&lt;i&gt;Mine own inheritance is a gift beyond thy grasp.  Begone!&lt;/i&gt;&quot;&gt;&gt;\

[[Something&#39;s rising from the ice-&gt;Beacon2][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
From the ice rises a skeletal figure, wielding a staff.
&lt;img src=&quot;Images/FrozenHills/dead7.jpg&quot; width=450 /&gt;

&lt;&lt;SkeletalMageTalk &quot;&lt;i&gt;Do not defile the beacons!&lt;/i&gt;!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalMageStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 0&gt;&gt; \

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;
The skeleton mage crumbles, its bones falling into the icy lake.
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\

Just as it does, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; walks out of the tower.
&lt;&lt;Redeemer3Talk &quot;What was all that noise? I told you to &lt;i&gt;be quiet&lt;/i&gt;.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I was attacked. The necromancer sent-&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;&lt;i&gt;Hush!&lt;/i&gt;&quot;&gt;&gt;\
The two of you stand in perfect stillness.

Then, bubbles start rising from the lake.
&lt;img src=&quot;Images/FrozenHills/misc4.jpg&quot; width=450 /&gt;

[[Something&#39;s coming-&gt;Beacon2 Battle][$p = 0]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="100" name="Beacon2 Battle" tags="" position="1440,1741" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
The bubbling increases. &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; draws his blade.
&lt;&lt;HeroTalk &quot;You never told me &lt;i&gt;why&lt;/i&gt; I needed to be quiet.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;There are creatures in the Deep Woods far older than elves. Have courage, $name.&quot;&gt;&gt;\
Something is coming out of the water!

[[Draw your weapon-&gt;Beacon2 Battle][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
From the depths rises a thing of slime and teeth and grey, glittering scales. It is unlike anything you&#39;ve ever seen. Its face - if it even has a face - seems to writhe with deep wisdom and old hatred. 
&lt;img src=&quot;Images/FrozenHills/krakenspawn1.jpg&quot; width=550 /&gt;

&lt;&lt;KrakenTalk &quot;&lt;i&gt;Fahf ah &#39;drn l&#39; gotha ch&#39;nglui&#39;ahog shuggog.&lt;/i&gt;&quot;&gt;&gt;\
Its voice is the howl of the dying and choking of drowning men. Its mouth clearly was never meant to speak above the waves. You feel your mind spinning, and force your grip on your $weapon to stay firm.
&lt;&lt;KrakenTalk &quot;&lt;i&gt;H&#39; ahornah tharanak ya n&#39;gha, mgng Y&#39; ahnythor l&#39; ah&#39;gotha h&#39; ah&#39;mgehye!&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;We face it together! With me, $name! Now!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;KrakenspawnStats&gt;&gt; \
&lt;&lt;Nendel1Stats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;\
The creature releases one last gurgling deathrattle, then sinks beneath the waves.
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $legsinventory.push($greavesofthedeep)&gt;&gt;\
You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

You find the Greaves of the Deep!

Once the two of you catch your breath, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; gestures for you to follow.
&lt;&lt;Redeemer3Talk &quot;Quickly, before its fellows learn of its death.&quot;&gt;&gt;\

[[Leave the lake behind-&gt;Beacon2 Battle][$p = 21]]
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
\
The walk back from the second beacon is long. Still wounded from your fight with the sea creature, you can barely keep up with &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&#39;s&lt;/b&gt;&lt;/span&gt; pace.

At last, the two of you come to a stop. The moon is bright in the sky. The sun has long since fallen.
&lt;img src=&quot;Images/FrozenHills/frozen8.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;What &lt;i&gt;was&lt;/i&gt; that?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;I&#39;m not entirely sure. An old enemy of the elves of Netheryn, if the old tomes of Hadamshal&#39;s library are to be believed.&quot;&gt;&gt;\
You get the sense he&#39;s not telling you everything.
&lt;&lt;HeroTalk &quot;What did it say to us?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;I cannot speak its foul tongue. Forget about it, $name. You fought valiantly. We survived. That&#39;s what matters.&quot;&gt;&gt;\
He&#39;s likely right. 
&lt;&lt;HeroTalk &quot;One more beacon.&quot;&gt;&gt;\
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; smiles.
&lt;&lt;Redeemer3Talk &quot;The Catalyst is close. Soon, this will all be over. I will seek you out, once I find it.&quot;&gt;&gt;\

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $frozenquest = 7&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="101" name="Messenger1" tags="" position="1440,1860" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;if $music neq &quot;frozen&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You wander through the Frozen Hills, keeping a careful eye out for the walking dead. You find yourself in a tall, silent woodland. Little light breaks through the dense tracery of barren trees.
&lt;img src=&quot;Images/FrozenHills/frozen7.jpg&quot; width=700 /&gt;

Then, you hear the thudding of hooves. A horse approaches.

[[Stand ready for anything-&gt;Messenger1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
Soon you catch sight of the horse - and its rider. Dressed in the finery of the kingdom, it&#39;s clear this is no minion of the heir of Netheryn. It&#39;s an agent of the King.

The rider - a woman, close in age to you - drops from her horse and gives you a quick appraisal.
&lt;img src=&quot;Images/Character/messenger1.jpg&quot; width=450 /&gt;

&lt;&lt;MessengerTalk &quot;Are you $startingname $startingtitle?&quot;&gt;&gt;\
&lt;&lt;if $gender eq &quot;female&quot; and $fem eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;By way of ancient magic, my body has changed and my name along with it. I am $name $title, now. But yes, I was once the man you speak of&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;I am.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $gender eq &quot;female&quot; and $fem eq 1&gt;&gt;&lt;&lt;MessengerTalk &quot;That sound sso absurd, I&#39;m inclined to believe you. The Deep Woods&#39; magic is as grand as it is strange. Well, $name, I am Brunhilde, messenger of the King.&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;MessengerTalk &quot;I am Brunhilde, messenger of the King.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
She unrolls a fine scroll of parchment.
&lt;&lt;MessengerTalk &quot;The King has requested your immediate presence in his hall. Captain Domitus of the Deathguard has accused you of treason, and you are to stand trial in the Capital.&quot;&gt;&gt;\
Of course. &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Domitus&lt;/b&gt;&lt;/span&gt; must have learned that you survived the destruction of the Tower of Zyr.

[[Respond to Brunhilde-&gt;Messenger1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;HeroTalk &quot;My quest here is not finished. I cannot leave.&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;You were sent here on the King&#39;s orders. Those orders are hereby revoked. Your only duty now is to return with me to the Capital.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;No.&quot;&gt;&gt;\
You&#39;re as surprised by the words as &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; is. You, disobey the King?

But upon reflection, it makes perfect sense.
&lt;&lt;HeroTalk &quot;If I were to return to the Capital - even if I were found innocent - it would be too late. The evil of the Deep Woods would flood the Kingdom, and wipe it from the face of world.&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;I see...&quot;&gt;&gt;\

[[Brunhilde hesitates-&gt;Messenger1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; seem about to point her sword at you, but can&#39;t quite bring herself to do it.
&lt;&lt;HeroTalk &quot;What happens now?&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;If you refuse, I&#39;m to bring you back by force.&quot;&gt;&gt;\
A long, quiet moment follows. Faint flecks of snow drift between the two of you. Your fingers flex just above your sheathed $weapon.
&lt;&lt;MessengerTalk &quot;Suppose I tried to capture you, but you fled. Escaped. I would have to report your refusal to the king. And you would be judged guilty in absentia.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;That seems only fair.&quot;&gt;&gt;\

[[Brunhilde lets out a breath.-&gt;Messenger1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;MessengerTalk &quot;Then I will leave you be, $name. And perhaps I will wish you luck.&quot;&gt;&gt;\
Just as she climbs onto her horse, she looks back at you.
&lt;&lt;MessengerTalk &quot;My understanding was that you came here on a quest of redemption. But now you will be forever marked a traitor - why remain, if redemption is no longer possible?&quot;&gt;&gt;\

[[Respond-&gt;Messenger1][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;&lt;&lt;if $music neq &quot;main&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;main_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;main&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;HeroDisplay&gt;&gt;

&lt;&lt;HeroTalk &quot;You don&#39;t understand at all, then.&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;Oh?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;This was never about my redemption in the eyes of the King, or the Kingdom. I will redeem myself in my own eyes, and the eyes of the Gods. Nothing else matters, anymore.&quot;&gt;&gt;\
She nods, then carefully unclasps the amulet hanging around her neck. She tosses it onto the snow at your feet.
&lt;&lt;if $gender eq &quot;female&quot; and $fem eq 1&gt;&gt;&lt;&lt;MessengerTalk &quot;Farewell, $name, and good luck. Oh, and welcome to the world of womanhood - I&#39;m sure you&#39;ll find it the fairer of the two. Now, beware - if you ever return to the Kingdom, you will be hanged.&quot;&gt;&gt; &lt;&lt;else&gt;&gt; &lt;&lt;MessengerTalk &quot;Farewell, $name, and good luck. Now, beware - if you ever return to the Kingdom, you will be hanged.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

[[Watch her leave-&gt;Messenger1][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
Once she leaves, you kneel and pick up the necklace she dropped. You recognize it as a Royal Amulet - a powerful artifact given to the King&#39;s most trusted agents. It will serve you well.
&lt;img src=&quot;Images/Armor/Royal Amulet.jpg&quot; width=300 /&gt;

&lt;&lt;HeroTalk &quot;There is no going back, now. Not that there ever was.&quot;&gt;&gt;\

&lt;i&gt;You gained the Royal Amulet!

You gained 100 exp!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 
\
&lt;&lt;set $frozenquest = 8&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $headinventory.push($royalamulet)&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="102" name="Beacon3" tags="" position="1442,1981" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;if $music neq &quot;frozen&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
As you journey through the Frozen Hills, you spot a familiar face.
&lt;img src=&quot;Images/Character/nendel1.jpg&quot; width=450 /&gt;

&lt;&lt;Redeemer3Talk &quot;$name... I&#39;ve found it.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;The last beacon?&quot;&gt;&gt;\
He nods.
&lt;&lt;Redeemer3Talk &quot;Come. It&#39;s quite the journey.&quot;&gt;&gt;\

[[Follow Nendel-&gt;Beacon3][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; leads you deep into the Frozen Hills. As the evening lengthens, you are further into the Hills than you have been before. Up yawning cliffs, the two of you climb, seeking out the last beacon.
&lt;img src=&quot;Images/FrozenHills/frozen4.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;I&#39;ve been meaning to ask you something.&quot;&gt;&gt;\
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; does not stop climbing.
&lt;&lt;Redeemer3Talk &quot;Go ahead and ask, then.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;What happened to you and Naya, the day Hadamshal fell?&quot;&gt;&gt;\
He stops. There&#39;s a brief shivering all along his spine. Then he goes still.
&lt;&lt;Redeemer3Talk &quot;I was there, at my father&#39;s side, the moment a young human warrior split his skull in two. With my father dead, my retainers pulled me away - tied my arms and legs so I wouldn&#39;t run back to his body. They hauled me out of Hadamshal, along with my sister.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;m sorry.&quot;&gt;&gt;\
He shakes his head. 
&lt;&lt;Redeemer3Talk &quot;Don&#39;t be. I will see Hadamshal avenged, in time. Come, $name. Daylight wanes.&quot;&gt;&gt;\

[[Find the beacon-&gt;Beacon3][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
Soon enough you come upon it - the final beacon. It sits at the crest of a tall, lonesome mountain. Evening sunlight shines upon its western flank. Tired from the day&#39;s journey, you can&#39;t help but slow down at the sight of it.
&lt;img src=&quot;Images/FrozenHills/beacon4.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;Finally.&quot;&gt;&gt;\
You and &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; trudge up the final path and arrive breathlessly at the beacon&#39;s base. A single doorway leads into the darkened tower.
&lt;&lt;Redeemer3Talk &quot;I sense a deep calm across the Frozen Hills. I doubt the heir of Netheryn is watching us. Keep guard... but I suspect we won&#39;t be disturbed.&quot;&gt;&gt;\

[[He walks into the tower-&gt;Beacon3][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
While you&#39;re glad to hear &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&#39;s&lt;/b&gt;&lt;/span&gt; optimism, you don&#39;t share it. Each beacon&#39;s activation has been a bloodsoaked affair, and this will be no different.

Weapon drawn, you stand ready for the inevitable attack.

[[To battle!-&gt;Beacon3][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
...but no battle comes.

Soon, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; emerges from the tower.
&lt;&lt;Redeemer3Talk &quot;It is done.&quot;&gt;&gt;\
Just as he says those words, an image appears in your mind. You can see it, clear as day - a massive, sprawling fortress, somewhere in the Frozen Hills.
&lt;img src=&quot;Images/FrozenHills/palace3.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;Did you see that?&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Yes! Like a ship&#39;s anchor, the beacons have forced the Winter Palace to hold in one place. We&#39;ve done it!&quot;&gt;&gt;\

[[The wind rises-&gt;Beacon3][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;&lt;&lt;if $music neq &quot;palace&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;palace&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

And with the icy wind comes a cold, sinister voice.
&lt;&lt;Lich1Talk &quot;&lt;i&gt;So it hast cometh to this.  Death thee desires, and death thee shalt have.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;That... doesn&#39;t sound good.&quot;&gt;&gt;\

Then, as the wind dies, a new sound emerges.
&lt;&lt;HeroTalk &quot;Do you hear... wings?&quot;&gt;&gt;\

[[A shadow falls upon you-&gt;Beacon3][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dragon1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
Above you, a massive creature looms.
&lt;img src=&quot;Images/FrozenHills/dragon6.jpg&quot; width=700 /&gt;

&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;&lt;HeroTalk &quot;Iulius, protect me.&quot;&gt;&gt;\
&lt;&lt;elseif $class eq &quot;rogue&quot;&gt;&gt;&lt;&lt;HeroTalk &quot;Sathael, guide me.&quot;&gt;&gt;\
&lt;&lt;elseif $class eq &quot;soldier&quot;&gt;&gt;&lt;&lt;HeroTalk &quot;Myridia, lend me your strength.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;SkeletalDragonTalk &quot;&lt;i&gt;No God can save you, now. You shall share my horrid fate!&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Hah - we shall see!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;SpecialAllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalDragonStats&gt;&gt; \
&lt;&lt;Nendel1Stats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;\
The wind rises.
&lt;&lt;Lich1Talk &quot;&lt;i&gt;Enough, Nivraxus. Return to thy master.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;SkeletalDragonTalk &quot;&lt;i&gt;Grah! Better to die in battle than serve!&lt;/i&gt;&quot;&gt;&gt;\

The undead dragon takes off in a great gust of air. You watch as it flies into the night.

&lt;&lt;Redeemer3Talk &quot;Well, that will do.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I doubt we&#39;ve seen that last of that beast.&quot;&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;Likely not. But today we scored a great victory - the path to the Winter Palace is open. Tell Naya as soon as you can. I will meet you at the Palace.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Thank you, Nendel. I will see you at the gates.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $frozenquest = 9&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="103" name="SpecialAllyBattle1" tags="" position="959,17" size="100,100">&lt;&lt;if $p eq 10&gt;&gt; &lt;&lt;Aura&gt;&gt;\
\
You and $allyname are fighting $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;i&gt;&lt;&lt;ItemAbilityRun&gt;&gt;&lt;&lt;if ($battlecount eq 0) and ($setbonus gte 1)&gt;&gt;&lt;&lt;SetBonus&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/i&gt;
\
&lt;&lt;if $allyturn eq 1&gt;&gt; &lt;&lt;set $allyturn = 0&gt;&gt; &lt;&lt;else&gt;&gt; &lt;&lt;set $allyturn = 1&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;if $stun lte 0&gt;&gt; &lt;&lt;set $action = &quot;notstun&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;if $stun gte 1&gt;&gt;&lt;&lt;set $action = &quot;stun&quot;&gt;&gt;&lt;&lt;set $stun -= 1&gt;&gt;You are stunned, and cannot take action!&lt;&lt;else&gt;&gt;\
\
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt;&lt;b&gt;Combat Points&lt;/b&gt;: $combatpoints / 5 
&lt;&lt;/if&gt;&gt;\
&lt;b&gt;General Actions&lt;/b&gt;:
&lt;&lt;link &quot;Attack&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;attack&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;if $flee eq 1&gt;&gt;&lt;&lt;link &quot;Flee&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;flee&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;i&gt;You cannot flee from this battle!&lt;/i&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;td&gt;\
&lt;b&gt;Class Abilities&lt;/b&gt;:
&lt;&lt;for _i to 0; _i lt $abilityinventory.length; _i++&gt;&gt;\
&lt;&lt;print $abilityinventory[_i].name&gt;&gt; (Mana cost: $abilityinventory[_i].mana )\
&lt;&lt;capture _i&gt;&gt;\
		&lt;&lt;if $currentmana lt $abilityinventory[_i].mana&gt;&gt;&lt;i&gt;Not enough mana&lt;/i&gt;&lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($combatpoints lt $abilityinventory[_i].combatcost)&gt;&gt;&lt;i&gt;Not enough Combat Points&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;ability&quot;&gt;&gt; &lt;&lt;set $ability = $abilityinventory[_i].widgetname&gt;&gt; &lt;&lt;set $abilitymana = $abilityinventory[_i].mana&gt;&gt; &lt;&lt;set $abilitylevel = $abilityinventory[_i].level&gt;&gt; &lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;/td&gt;\
&lt;td&gt;\
&lt;b&gt;Items ($potioncount / 10)&lt;/b&gt;:
&lt;&lt;if $potioncount gte 10&gt;&gt;&lt;i&gt;You can only drink up to 10 potions in a single battle!&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;&lt;for _i to 0; _i lt $iteminventory.length; _i++&gt;&gt;\
&lt;&lt;print $iteminventory[_i].name&gt;&gt; (Quantity: &lt;&lt;print $iteminventory[_i].quantity&gt;&gt;) \
&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $iteminventory[_i].quantity lte 0&gt;&gt; &lt;i&gt;None left&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt; &lt;&lt;set $action = &quot;item&quot;&gt;&gt; &lt;&lt;set $item = $iteminventory[_i].name&gt;&gt;
			&lt;&lt;set $iteminventory[_i].quantity -= 1&gt;&gt;\
			&lt;&lt;set $itemstrength = $iteminventory[_i].strength&gt;&gt;\
			&lt;&lt;set $itemagility = $iteminventory[_i].agility&gt;&gt;\
			&lt;&lt;set $itemwillpower = $iteminventory[_i].willpower&gt;&gt;\
			&lt;&lt;set $itemarmor = $iteminventory[_i].armor&gt;&gt;\
			&lt;&lt;set $itemhealth = $iteminventory[_i].health&gt;&gt;\
			&lt;&lt;set $itemmana = $iteminventory[_i].mana&gt;&gt;\
			&lt;&lt;set $itemevadescore = $iteminventory[_i].evadescore&gt;&gt;\
			&lt;&lt;set $potioncount += 1&gt;&gt;\
			&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;/td&gt;\
&lt;/table&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;stun&quot;&gt;&gt;&lt;&lt;if $allyturn eq 1&gt;&gt;&lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 13&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;

&lt;&lt;AllyBattleTable&gt;&gt;
\
&lt;&lt;set $battlecount += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 11&gt;&gt; 
You and $allyname are fighting a $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;

&lt;&lt;if $action eq &quot;attack&quot;&gt;&gt;You attempt to hit the $enemyname with your $weapon!

&lt;&lt;AttackAttempt&gt;&gt;
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;You deal damage to the $enemyname!

&lt;&lt;AttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;flee&quot;&gt;&gt;You attempt to flee from the $enemyname!

&lt;&lt;FleeAttempt&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;ability&quot;&gt;&gt;&lt;&lt;Ability $ability&gt;&gt;&lt;&lt;/Ability&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $action eq &quot;item&quot;&gt;&gt;You used your $item!
&lt;&lt;ItemImage $item 150&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;
&lt;&lt;ItemUse&gt;&gt;
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth lt $enemyspecialhealth&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $enemycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;The enemy is slain! Victory!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $action eq &quot;flee success&quot;&gt;&gt;&lt;&lt;link &quot;You escape!&quot; $passage&gt;&gt;&lt;&lt;set $p = 19&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $allyturn eq 1&gt;&gt;&lt;&lt;link &quot;Ally turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 13&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;\

&lt;&lt;elseif $p eq 12&gt;&gt; \
You and $allyname are fighting a $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;EnemyStun&gt;&gt;
\
&lt;&lt;if $enemyaction eq &quot;attack&quot;&gt;&gt;The $enemyname attacks you!

&lt;&lt;EnemyAttackAttempt&gt;&gt;

&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;The $enemyname deals damage to you!

&lt;&lt;EnemyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if ($enemyaction neq &quot;stun&quot;) and ($enemyaction neq &quot;attack&quot;) and ($enemyaction neq &quot;attack success&quot;) and ($enemyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;EnemyAbility $enemyaction&gt;&gt;&lt;&lt;/EnemyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]]&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Player turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;\
\
&lt;&lt;elseif $p eq 13&gt;&gt;\
\
\
\
You and $allyname are fighting a $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;set $allyaction = $allyability.pluck()&gt;&gt;\
&lt;&lt;set $allyability.push($allyaction)&gt;&gt;

&lt;&lt;if $allyaction eq &quot;attack&quot;&gt;&gt;$allyname attacks $enemyname

&lt;&lt;AllyAttackAttempt&gt;&gt;

&lt;&lt;if $allyaction eq &quot;attack success&quot;&gt;&gt;The $allyname deals damage to $enemyname!

&lt;&lt;AllyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if ($allyaction neq &quot;attack&quot;) and ($allyaction neq &quot;attack success&quot;) and ($allyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;AllyAbility $allyaction&gt;&gt;&lt;&lt;/AllyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $enemycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;The enemy is slain! Victory!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;\
\

&lt;&lt;elseif $p eq 19&gt;&gt; 
You flee from the $enemyname - better to bandage your wounds and do battle another day than foolishly fight to the death.

As you near the safety of the cabin, you realize your coin purse is a bit lighter than before. Some gold pieces must have fallen out while you were running away.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $goldloss = $enemymaxgold&gt;&gt; \
&lt;&lt;set $gold -= $goldloss&gt;&gt; \
\
&lt;&lt;BattleEnd&gt;&gt;\
\
\
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
This page should not come up, as you should be out of the $passage passage and into the $returnpassage passage.

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="104" name="Invitations" tags="" position="601,1108" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;if $music neq &quot;frozen&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
The moment you wake up, something feels... &lt;i&gt;cold&lt;/i&gt;. On your back, between your shoulderblades, there&#39;s a distinct sense of frost, like a frozen finger is pressing ever so gently against your skin.

Then you see something. A new scroll, sitting at your desk.
&lt;img src=&quot;Images/FrozenHills/misc5.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;How did that get there?&quot;&gt;&gt;\

[[Read the scroll-&gt;Invitations][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;
You do not recognize the seal. The writing within is short, and you read it out loud.
&lt;&lt;HeroTalk &quot;&#39;To $name $title. You are hereby invited to the Winter Palace. There, all shall be revealed. Ignore this invite at your peril. Signed: Duke Carnax.&#39;&quot;&gt;&gt;\
You read it again, your confusion rising. As you read it, the ice on your back grows colder.

[[There&#39;s a knock at the door-&gt;Invitations][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
Standing at your door, looking like he&#39;s seen a ghost, is &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

In his hands is a scroll, much like the one you hold.
&lt;&lt;MerchantTalk &quot;By sand and sun - you were invited, too!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Babar, what&#39;s going on? Who is Duke Carnax?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;I... well... I...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Speak.&quot;&gt;&gt;\

[[Babar shuts the door-&gt;Invitations][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;if $music neq &quot;babar&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;babar_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;babar&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;MerchantTalk &quot;It is time I came clean...&quot;&gt;&gt;\
The merchant slumps into the nearest chair.
&lt;&lt;MerchantTalk &quot;I told you I was a poor rascal once, yes? Until a mysterious benefactor provided me with enough gold to start my business in earnest.&quot;&gt;&gt;\
You remember him saying something of that sort.
&lt;&lt;HeroTalk &quot;Yes, all you had to do was sell him a stone.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Outskirts/soulstone1.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;I... it was not &lt;i&gt;just&lt;/i&gt; a stone. The benefactor asked me to set the stone against my brother&#39;s heart while he slept, then sell it the next morning. And that&#39;s what I did.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;And?&quot;&gt;&gt;\

[[Babar stares at the floor-&gt;Invitations][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;MerchantTalk &quot;The stone was a &lt;i&gt;soulstone&lt;/i&gt; - and it swallowed my brother&#39;s soul, that night. I sold my brother&#39;s soul for five thousand gold pieces. And I sold it to Duke Carnax.&quot;&gt;&gt;\
He raises the invitation above his head. Tears stream from his eyes
&lt;&lt;HeroTalk &quot;You couldn&#39;t have known-&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;&lt;i&gt;I knew! Of course I knew!&lt;/i&gt; But my brother, Zabil, he was always the better of the two of us. A great warrior! While I was a poor merchant. I sold his soul to the Duke and I was &lt;i&gt;happy&lt;/i&gt; to do it!&quot;&gt;&gt;\
&lt;img src=&quot;Images/Character/zabil1.jpg&quot; width=450 /&gt;

[[Help Babar see reason-&gt;Invitations][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;HeroTalk &quot;You did a terrible deed. But Babar, I remember meeting a merchant facing off against goblins in the Deep Woods. A merchant willing to die to right his wrong and reclaim his brother&#39;s soul.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;... yes, I suppose I did that...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Come, friend. The Winter Palace is revealed and the Duke is waiting for us. We&#39;ll go together, and take the soulstone and the Catalyst!&quot;&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; wipes the tears from his face.
&lt;&lt;MerchantTalk &quot;Yes... by sun and sands, yes! He wishes to taunt us with an invitation? &lt;i&gt;Hah&lt;/i&gt;! He will regret it! I&#39;m with you, $name!&quot;&gt;&gt;\

[[To the Winter Palace!-&gt;Invitations][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;&lt;&lt;if $music neq &quot;frozen&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
The moment you and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; leave the cabin, you spot &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, waiting for you.
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;We have a problem.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Did you receive a letter from this &#39;Duke Carnax?&#39;&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;No, but Naya did. I found it in her tree, this morning.&quot;&gt;&gt;\
She holds up a scroll and reads it to you.
&lt;&lt;WitchTalk &quot;To the fair princess Naya&#39;driel of Hadamshal. I understand you are in need of my Palace&#39;s Catalyst. I, too, am in need of something. A bride, pure of elven blood. Be my eternal wife, and the Catalyst is yours. Tell no one. Attend immediately. With love: Duke Carnax.&quot;&gt;&gt;\
&lt;&lt;if $nayalove eq 21&gt;&gt;&lt;&lt;HeroTalk &quot;His eternal wife? That bastard...&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
Beside you, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; groans.
&lt;&lt;HeroTalk &quot;She&#39;s already gone?&quot;&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; nods.
&lt;&lt;WitchTalk &quot;There&#39;s more.&quot;&gt;&gt;\

[[More?-&gt;Invitations][$p = 7]]

&lt;&lt;elseif $p eq 7&gt;&gt;\
She holds up the scroll.
&lt;img src=&quot;Images/FrozenHills/misc6.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;These scrolls are cursed. I bet the two of you feel a cold pressure against your back, don&#39;t you?&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Yes! How did you know?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;This Duke Carnax is clearly an accomplished wizard. By opening your scroll, you were afflicted with a Curse of Withering. Until the curse is broken - likely by obeying it, and meeting Carnax in his Palace - you will slowly wither away.&quot;&gt;&gt;\
You mutter under your breath, berating yourself for falling for such a stupid bit of magic.
&lt;&lt;HeroTalk &quot;The invitation is a trap, then.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Of course, but you have little choice but to spring it. Naya and the Void Gem are &lt;i&gt;already in the Palace&lt;/i&gt;. Babar, $name, both of you need to rescue her, and the Gem, as soon as possible.&quot;&gt;&gt;\
After a bit more discussion, you prepare to travel to the Winter Palace. Naya, your curse, and the destruction of the Void Gem - everything will be dealt with, there.

&lt;i&gt;You gain 150 exp!&lt;/i&gt;

[[Onward!-&gt;Outside the Cabin]] 

&lt;&lt;set $frozenquest = 10&gt;&gt;\
&lt;&lt;set $exp += 150&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="105" name="Frostfang" tags="" position="1440,2105" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;\

As you wander through the Frozen Hills, you spot a curious sight. A long bridge of stone, crossing a deep frozen valley. At its end, the bridge leads to an ice cave. The shame of the cave&#39;s entrance sends a shiver down your spine - it appears to be some kind of face, carved into the stone. 
&lt;img src=&quot;Images/FrozenHills/frozen9.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;Elf ruins... this could be dangerous...&quot;&gt;&gt;\

[[Investigate the ruin-&gt;Frostfang][$p = 1]]
[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;set $i = 0&gt;&gt;\

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;if $i eq 0&gt;&gt;Steeling yourself, you enter the cave. Within is vast network of interlocking tunnels, all formed of ice. Light from holes in the distant ceiling dance upon the walls, turning the caverns into glistening troves of iridescent crystal.&lt;&lt;else&gt;&gt;Somehow, you find yourself back at the start of cave!&lt;&lt;/if&gt;&gt;
&lt;img src=&quot;Images/FrozenHills/frozen10.jpg&quot; width=650 /&gt;

&lt;&lt;if $i eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;Focus, $name... there must be a correct path...&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
\
It would be easy to get lost in a place like this.

[[Follow the upper cavern-&gt;Frostfang][$p = 2]]
[[Follow the central cavern-&gt;Frostfang][$p = 1, $i = 1]]
[[Follow the lower cavern-&gt;Frostfang][$p = 4]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
You continue to traverse the ice cave. The tunnel grows wider, the further you wander. It is less cold, this deep in the cave, and ice slowly gives way to stone.
&lt;img src=&quot;Images/FrozenHills/frozen11.jpg&quot; width=650 /&gt;

More paths... which to take?

[[Follow the right path-&gt;Frostfang][$p = 1, $i = 1]]
[[Take the left path-&gt;Frostfang2][$p = 0]]
[[Turn around and leave the cave-&gt;Frostfang][$p = 4]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;shrine&quot;&gt;&gt;\
At last, it seems you&#39;ve found the cave&#39;s end. It appears to be a burial chamber. Likely for an ancient elven warrior of great repute.
&lt;img src=&quot;Images/FrozenHills/frozen11.jpg&quot; width=700 /&gt;

The trouble is, you&#39;re not alone. Hacking at the tomb&#39;s lid is a well-armored skeleton wielding a massive halberd.
&lt;img src=&quot;Images/FrozenHills/dead3.jpg&quot; width=450 /&gt;

&lt;&lt;SkeletalNightTalk &quot;&lt;i&gt;Give me thy treasure, ghost. The master demands it&lt;/i&gt;.&quot;&gt;&gt;\
As you approach the skeletal knight, a second voice fills the chamber.
&lt;&lt;ElvenGhostTalk &quot;&lt;i&gt;A challenger approaches. Two knights, but onl a single blade. Let us see who stands victorious&lt;/i&gt;.&quot;&gt;&gt;\
The skeletal knight faces you, then bursts out into grisly laughter.
&lt;&lt;SkeletalNightTalk &quot;&lt;i&gt;Trifling human. I will break thee in twain.&lt;/i&gt;.&quot;&gt;&gt;\
&lt;&lt;Don&#39;t be so sure! &quot;&lt;i&gt;Give me thy treasure, ghost. The master demands it&lt;/i&gt;.&quot;&gt;&gt;\

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
Following your chosen path, you soon realize that you&#39;re going in circles. After muttering a few curses, you try to double-back the way you came...

... only to see that you&#39;re being followed by a walking corpse!
&lt;img src=&quot;Images/FrozenHills/dead5.jpg&quot; width=450 /&gt;

&lt;&lt;SkeletalSoldierTalk &quot;&lt;i&gt;Death to all who oppose the heir!&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Perish, fiend!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalSoldierStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;\
The skeleton falls, collapsing into a pile of bones.

After catching your breath, you find the exit to the cave. You wish to return and explore it once more, but not until after you&#39;ve rested.
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Return to the cabin-&gt;Outside the Cabin]] 
\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\

\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="106" name="Frostfang2" tags="" position="1440,2235" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battke&quot;&gt;&gt;\
At last, it seems you&#39;ve found the cave&#39;s end. It appears to be a burial chamber. Likely for an ancient elven warrior of great repute.
&lt;img src=&quot;Images/FrozenHills/frozen11.jpg&quot; width=700 /&gt;

The trouble is, you&#39;re not alone. Hacking at the tomb&#39;s lid is a well-armored skeleton wielding a massive halberd.
&lt;img src=&quot;Images/FrozenHills/dead3.jpg&quot; width=450 /&gt;

&lt;&lt;SkeletalKnightTalk &quot;&lt;i&gt;Give me thy treasure, ghost. The master demands it&lt;/i&gt;.&quot;&gt;&gt;\
As you approach the skeletal knight, a second voice fills the chamber.
&lt;&lt;ElvenGhostTalk &quot;&lt;i&gt;A challenger approaches. Two knights, both armed for battle. Let us see who stands victorious&lt;/i&gt;.&quot;&gt;&gt;\
The skeletal knight faces you, then bursts out into grisly laughter.
&lt;&lt;SkeletalKnightTalk &quot;&lt;i&gt;Trifling human. I will break thee in twain.&lt;/i&gt;.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Don&#39;t be so sure!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalKnightStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;shrine&quot;&gt;&gt;\
At last, the skeletal knight collapses, as the last of the dark magic that held it together fades away.

Afterwards, you lean against the cold wall of the chamber, winded from the melee. It&#39;s then that you notice shimmering lights coming together, and a figure taking form.
&lt;img src=&quot;Images/FrozenHills/ghost1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Who are you?&quot;&gt;&gt;\
&lt;&lt;ElvenGhostTalk &quot;&lt;i&gt;Once I was a soldier of Netheryn - few could match my strength, or my genius on the field of battle. Many victories did I win for my kingdom...&lt;/i&gt;.&quot;&gt;&gt;\
The ghost shakes his head.
&lt;&lt;ElvenGhostTalk &quot;&lt;i&gt;But I could not stand against the Void. I fell, like so many before me.&lt;/i&gt;.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Rest easy, ghost. I will end the threat of the Void, I swear it.&quot;&gt;&gt;\

[[The ghost does not appear to believe you-&gt;Frostfang2][$p = 21]]

&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;&lt;ElvenGhostTalk &quot;&lt;i&gt;How could a human prevail where the strength of elves faltered? You are doomed&lt;/i&gt;.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Then I will die. But until my last breath, I carry on.&quot;&gt;&gt;\
The ghost stares at you for a long moment, then begins to smile.
&lt;&lt;ElvenGhostTalk &quot;&lt;i&gt;Well said. Take up my sword, then, brave human. Let it serve you as it once served me&lt;/i&gt;.&quot;&gt;&gt;\

The tomb opens, and from it rises a blade, glowing with power.
&lt;img src=&quot;Images/weapons/frostfang.jpg&quot; width=450 /&gt;

&lt;&lt;ElvenGhostTalk &quot;&lt;i&gt;Take Frostfang, and begone, human. I must rest...&lt;/i&gt;.&quot;&gt;&gt;\

You feel stronger from your victory - you gain $enemyexp Experience Points!

You gain the blade Frostfang! It burns with the power of ice!

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $weaponinventory.push($frostfang)&gt;&gt;\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $frozensword = 1&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="107" name="FrozenTreasure" tags="" position="1443,2356" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;frozen1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;frozen&quot;&gt;&gt;\

As you wander through the Frozen Hills, you find yourself in a thick forest of barren trees and ice-filled streams. It is hard going, and you eventually must stop and rest.
&lt;img src=&quot;Images/FrozenHills/frozen6.jpg&quot; width=650 /&gt;

It is as you&#39;re resting that you spot something sticking out from a nearby patch of snow. Curious, you approach to get a better look.

[[Something hides within the snow-&gt;FrozenTreasure][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
Once you&#39;re close enough to see, mutter a curse.
&lt;img src=&quot;Images/FrozenHills/misc2.jpg&quot; width=500 /&gt;

A skeleton of a lone adventurer who met their end in this icy wasteland. Not a good way to go. At least the skeleton hasn&#39;t been brought back as an undead servant to the heir of Netheryn.

As you stare at the skeleton, you notice it is wearing a fine golden ring. It would be a shame to let such a treasure go to waste...

[[Take the ring and leave-&gt;FrozenTreasure][$p = 2, $i = 1]]
[[Bury the skeleton-&gt;FrozenTreasure][$p = 2, $i = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;You take the ring, slip it into your pocket, and continue on your way. You&#39;ve no time to give the bones a proper burial, and the dead have no need for gold.

&lt;i&gt;You gained 400 gold!&lt;/i&gt;

[[Onwards-&gt;Outside the Cabin]] 

&lt;&lt;set $gold += 400&gt;&gt;\
&lt;&lt;set $frozentreasure = 1&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $i eq 2&gt;&gt;You draw a small shovel from your pack and begin to dig through the frozen ground. It&#39;s tough work, but the dead adventurer deserves nothing less.

Once the deed is done, you fall to one knee and pray.
&lt;&lt;HeroTalk &quot;Oh holy Tylae... return this soul to your embrace, and give it the peace it deserves.&quot;&gt;&gt;\

&lt;i&gt;The Gods notice your act of piety! You gained 1 willpower!&lt;/i&gt;

[[Onwards-&gt;Outside the Cabin]] 

&lt;&lt;set $basewillpower += 1&gt;&gt;\
&lt;&lt;set $frozentreasure = 1&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
\
\
&lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="108" name="Palace1" tags="" position="1576,294" size="100,100">\
&lt;&lt;if $music neq &quot;palace&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play loop&gt;&gt; &lt;&lt;set $music = &quot;palace&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $p eq 0&gt;&gt;You are standing in the great vestibule of the Winter Palace. Behind you are the Palace doors.
&lt;img src=&quot;Images/FrozenHills/palace2.jpg&quot; width=550 /&gt;

&lt;&lt;if $frozenquest eq 11&gt;&gt;Standing guard at the end of the entryway is a solid-looking skeletal knight dressed ready for war. The knight stares at you from empty eye sockets.

[[Show the knight your invitation-&gt;WPBattle1][$p = 0]]
[[Return-&gt;Palace Entrance][$p = 0]]

&lt;&lt;else&gt;&gt;\
[[Enter the grand hall-&gt;Palace1][$p = 1]]
[[Return-&gt;Palace Entrance][$p = 0]]
\
&lt;&lt;/if&gt;&gt;
\
&lt;&lt;elseif $p eq 1&gt;&gt;You are standing in the grand hall of the Winter Palace. It is quiet, and terribly cold.
&lt;img src=&quot;Images/FrozenHills/palace6.jpg&quot; width=700 /&gt;

&lt;&lt;if $frozenquest eq 12&gt;&gt;\
Leaning against the rail on the landing above you, a wight watches you with eyes of blue flame. Part skeleton, part spirit, he seems at ease in the Palace, as if he spent his mortal life within its walls.

[[Approach the wight-&gt;Wight1][$p = 0]]
[[Return-&gt;Palace1][$p = 0]]
\
&lt;&lt;set $palacestudy = 0&gt;&gt;\
&lt;&lt;set $palacedining = 0&gt;&gt;\
&lt;&lt;set $palacedancing = 0&gt;&gt;\
&lt;&lt;set $palacedungeon = 0&gt;&gt;\
\
\
&lt;&lt;else&gt;&gt;\
From here, you can explore the Palace.
[[Explore the study-&gt;Palace1][$p = 2]]
[[Explore the dining hall-&gt;Palace1][$p = 3]]
[[Explore the dancing hall-&gt;Palace1][$p = 4]]
[[Explore the dungeons-&gt;Palace1][$p = 5]]
&lt;&lt;if $frozenquest gte 20&gt;&gt;[[Advance to the courtyard-&gt;Palace1][$p = 10]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Advance to the courtyard&lt;/span&gt;&lt;&lt;/if&gt;&gt;
Or, you can [[return to your cabin-&gt;Outside the Cabin]] 
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;You stand within the study of the Winter Palace. Most of the books have fallen to ruin. It does not seem like &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; uses the room often. One book is open, seemingly abandoned on a desk.
&lt;img src=&quot;Images/FrozenHills/palace9.jpg&quot; width=650 /&gt;

[[Examine the book-&gt;Study][$p = 0, $i = 0]]
[[Return-&gt;Palace1][$p = 1]]
\
&lt;&lt;elseif $p eq 3&gt;&gt;You stand within the Winter Palace&#39;s dining hall. It has certainly seen better days. Likely &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; and his minions no longer require food.
&lt;img src=&quot;Images/FrozenHills/palace8.jpg&quot; width=650 /&gt;

&lt;&lt;if $palacedining eq 0&gt;&gt;There is something &lt;i&gt;slithering&lt;/i&gt; under the table. If you listen closely, you can here heavy breathing.

[[Look under the table-&gt;WPBattle2][$p = 0]]
[[Return-&gt;Palace1][$p = 1]]

&lt;&lt;elseif $palacedining eq 1&gt;&gt;\
&lt;&lt;if $palacedungeon eq 1&gt;&gt;[[Help Babar collect ingredients-&gt;Palace1][$p = 6]]&lt;&lt;/if&gt;&gt;
[[Return-&gt;Palace1][$p = 1]]
\
\
&lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 4&gt;&gt;You stand within the Winter Palace&#39;s dancing hall. You can ever so faintly hear a ghostly orchestra play a fine, haunting melody.
&lt;img src=&quot;Images/FrozenHills/palace7.jpg&quot; width=650 /&gt;

&lt;&lt;if $palacedancing eq 0&gt;&gt;Slowly a figure appears through the gloom. A woman, swaying from side to side.
&lt;&lt;ElvenLadyGhostTalk &quot;&lt;i&gt;Come, dear... dance with me...&lt;/i&gt;&quot;&gt;&gt; \

[[Dance with her-&gt;Dance][$p = 0]]
[[Return-&gt;Palace1][$p = 1]]

&lt;&lt;elseif $palacedancing eq 1&gt;&gt;The ghostly elf stares at you from the gloom.
&lt;&lt;ElvenLadyGhostTalk &quot;&lt;i&gt;Won&#39;t you dance with me?&lt;/i&gt;&quot;&gt;&gt; \
[[Dance with her-&gt;Dance][$p = 0]]
[[Return-&gt;Palace1][$p = 1]]

&lt;&lt;else&gt;&gt;[[Return-&gt;Palace1][$p = 1]]&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 5&gt;&gt;You stand within the cold dungeon of the Winter Palace.
&lt;img src=&quot;Images/FrozenHills/palace10.jpg&quot; width=650 /&gt;

&lt;&lt;if $palacedungeon eq 0&gt;&gt;In the cell around the corner, you hear the thumping footfalls of something heavy, pacing.

[[Explore the dungeon-&gt;WPBattle3][$p = 0]]
[[Return-&gt;Palace1][$p = 1]]

&lt;&lt;else&gt;&gt;[[Check on Nendel-&gt;Palace1][$p = 7]]
&lt;&lt;if $palacedungeon eq 3&gt;&gt;[[Return-&gt;Wight1][$p = 4, $i = 0]]&lt;&lt;else&gt;&gt;[[Return-&gt;Palace1][$p = 1]]&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 6&gt;&gt;You and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; scour the dining room for ingredients. It turns out to be surprisingly well stocked.
&lt;img src=&quot;Images/FrozenHills/misc10.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;Perfect - I have everything I need for Nendel&#39;s potion. This could wake up a sleeping giant...&quot;&gt;&gt; \

[[Return-&gt;Palace1][$p = 3]]

&lt;&lt;set $palacedungeon = 2&gt;&gt;\
\
&lt;&lt;elseif $p eq 7&gt;&gt;You and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; look over to &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt;. &lt;&lt;if $palacedungeon lt 3&gt;&gt;He looks unwell, and does not respond to his name.&lt;&lt;else&gt;&gt;He seems to be doing better.
&lt;img src=&quot;Images/Character/nendel1.jpg&quot; width=450 /&gt;

&lt;&lt;Redeemer3Talk &quot;Go on ahead. Once I catch my breath, I&#39;ll be right behind you.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $palacedungeon eq 2&gt;&gt;[[Heal Nendel-&gt;Palace1][$p = 8]]&lt;&lt;/if&gt;&gt;
[[Return-&gt;Palace1][$p = 5]]
&lt;&lt;elseif $p eq 8&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; open&#39;s &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&#39;s&lt;/b&gt;&lt;/span&gt; mouth and lets the hastily brewed potion pour down his throat.

The elf starts to cough, then shoots up from the ground.
&lt;&lt;Redeemer3Talk &quot;That&#39;s disgusting! What are you doing?&quot;&gt;&gt; \
The merchant puffs out his chest.
&lt;&lt;MerchantTalk &quot;Bringing you back from the brink of death!&quot;&gt;&gt; \
&lt;&lt;Redeemer3Talk &quot;Oh... thank you, then. $name, I didn&#39;t see you there. You have my thanks for saving my life a second time.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;What are you doing here? What happened?&quot;&gt;&gt; \

[[Nendel shakes his head-&gt;Palace1][$p = 9]]

&lt;&lt;set $palacedungeon = 3&gt;&gt;\

&lt;&lt;elseif $p eq 9&gt;&gt;\
&lt;&lt;Redeemer3Talk &quot;When I received the invitation from Duke Carnax, I realized it was a trap, of course, but feared for the Void Gem - and my sister. When I arrived, they were already beyond my reach.&quot;&gt;&gt; \
He gestures out beyond the dungeon.
&lt;&lt;Redeemer3Talk &quot;We have to stop them...&quot;&gt;&gt; \
He tries to stand, then falls to his knees.
&lt;&lt;Redeemer3Talk &quot;Damn... still weak.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Rest here for now. We&#39;ll see if we can find a way to the Duke, and then come back for you.&quot;&gt;&gt; \

[[Return-&gt;Palace1][$p = 5]]

&lt;&lt;elseif $p eq 10&gt;&gt;You and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; stand at one edge of a long, dark courtyard. Beyond it, the cathedral looms over all. The wedding between &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; must be stopped.
&lt;img src=&quot;Images/FrozenHills/palace5.jpg&quot; width=650 /&gt;

Just as you mean to go forward, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; grabs your arm.
&lt;&lt;MerchantTalk &quot;I have been struck with a terrible feeling, friend! If we go forward, I fear there will be no going back. We&#39;d best heal, gather potions, and equip the finest armor first, no?&quot;&gt;&gt; \

[[Continue-&gt;WPBattle4][$p = 0]]
[[Retreat-&gt;Palace1][$p = 1]]
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="109" name="WPBattle1" tags="" position="1582,538" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
\
You approach the knight. It tightens its skeletal fists against its halberd as you do.
&lt;img src=&quot;Images/FrozenHills/dead3.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;We are here to see Duke Carnax.&quot;&gt;&gt; \
Its jaw swings open.
&lt;&lt;SkeletalKnightTalk &quot;&lt;i&gt;Invitation?&lt;/i&gt;&quot;&gt;&gt; \
After sharing a look, you and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; hand the skeleton your invitations. It takes one look at them, then tears them to pieces.
&lt;&lt;SkeletalKnightTalk &quot;&lt;i&gt;These won&#39;t do.&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Why not?&quot;&gt;&gt; \
&lt;&lt;SkeletalKnightTalk &quot;&lt;i&gt;Thy hasn&#39;t heard? Anon, the royal wedding comes. Wedding guests only, until it is through.&lt;/i&gt;&quot;&gt;&gt; \
A royal wedding? It appears &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; is already inside. You hope she knows what she&#39;s doing.

[[Demand entry-&gt;WPBattle1][$p = 1, $i = 1]]
[[Look to Babar to get you inside-&gt;WPBattle1][$p = 1, $i = 2]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
\
&lt;&lt;if $i eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;I am an agent of the bride. You will let me inside now, or suffer for it.&quot;&gt;&gt; \
The knight stands its full height. 
&lt;&lt;SkeletalKnightTalk &quot;&lt;i&gt;Mine own orders art clear.  None may halt the royal wedding. En garde!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;elseif $i eq 2&gt;&gt;\
You nudge &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;MerchantTalk &quot;Ah, right... fair, chivalrous knight, perhaps you would be interested in an artifact.&quot;&gt;&gt; \
From his robes, be pulls forth a fine looking belt.
&lt;img src=&quot;Images/FrozenHills/misc7.jpg&quot; width=400 /&gt;
&lt;&lt;MerchantTalk &quot;It is said that this belt lends its wearer the strength of a giant.&quot;&gt;&gt; \
&lt;&lt;SkeletalKnightTalk &quot;&lt;i&gt;Thee holds a grand belt.  Perhaps if thee giveth it to me, I could cast a blind eye...&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;I&#39;d sell it for no less than five hundred gold pieces.&quot;&gt;&gt; \
&lt;&lt;SkeletalKnightTalk &quot;&lt;i&gt;Five hundred!? Such insult!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;
The skeletal knight attacks!

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalKnightStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;palace&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points! You gain $enemygold gold pieces!
&lt;&lt;HeroTalk &quot;I could have used your help.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Me? Fight in a battle? Your wit is sharp as ever, $name...&quot;&gt;&gt; 

[[Continue-&gt;Palace1][$p = 0]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $frozenquest = 12&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="110" name="Wight1" tags="" position="1587,655" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
You approach the wight, your $weapon drawn and ready.
&lt;img src=&quot;Images/FrozenHills/count1.jpg&quot; width=500 /&gt;

&lt;&lt;CountTalk &quot;&lt;i&gt;Armed and eft for combat? How... heroic.&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Where is Naya?&quot;&gt;&gt; \
&lt;&lt;CountTalk &quot;&lt;i&gt;The bride? Negotiating her bride-price, of course. The girl drives a hard bargain.  Something about a Catalyst.&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Take me to her.&quot;&gt;&gt; \
&lt;&lt;CountTalk &quot;&lt;i&gt;How rude! Has&#39;t thee not the decency to bow before Count Barsenes? While I lived, humans knew how to act before their betters.&lt;/i&gt;&quot;&gt;&gt; \
Before &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; can even tilt his head, you stop him.
&lt;&lt;HeroTalk &quot;Take me to Naya.&quot;&gt;&gt; \
&lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Count Barsenes&lt;/b&gt;&lt;/span&gt; laughs, his echo turning sinister as it bounces through the hall.
&lt;&lt;CountTalk &quot;&lt;i&gt;Thee has&#39;t any power here, human.  I hold the key, and I duel not with peasants.&lt;/i&gt;&quot;&gt;&gt; \

The count disappears.

[[Now what?-&gt;Wight1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; starts pacing, shivering all the while.
&lt;&lt;MerchantTalk &quot;Maybe Naya knows what she&#39;s doing, no? Marry Carnax, destroy the Void Gem, and then run away while he sleeps.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Do you really think Duke Carnax will let her get away with that?&quot;&gt;&gt; \
He pales, then slowly shakes his head.
&lt;&lt;HeroTalk &quot;There must be other path through the Palace. We&#39;ll scour every damned hall.&quot;&gt;&gt; \

[[Time to explore-&gt;Palace1][$p = 1]]

&lt;&lt;set $frozenquest = 13&gt;&gt;\
\

&lt;&lt;elseif $p eq 4&gt;&gt;\
You are standing in the grand hall of the Winter Palace. It is quiet, and terribly cold.
&lt;img src=&quot;Images/FrozenHills/palace6.jpg&quot; width=700 /&gt;

&lt;&lt;if $i eq 3&gt;&gt;Leaning against the rail on the landing above you, &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Count Barsenes&lt;/b&gt;&lt;/span&gt; watches you with eyes of blue flame.

[[Challenge the Count-&gt;Wight1][$p = 6]]&lt;&lt;/if&gt;&gt;
[[Explore study-&gt;Wight1][$p = 5]]
[[Explore dining hall-&gt;Wight1][$p = 5]]
[[Explore dancing hall-&gt;Wight1][$p = 5]]
[[Explore the dungeons-&gt;Wight1][$p = 5]]
&lt;&lt;if $frozenquest gte 20&gt;&gt;[[Advance to the courtyard-&gt;Palace1][$p = 10]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Advance to the courtyard&lt;/span&gt;&lt;&lt;/if&gt;&gt;
Or, you can [[return to your cabin-&gt;Wight1][$p = 5]] 
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
You open the door leading out of the grand hall...

... only to step into the grand hall.
&lt;img src=&quot;Images/FrozenHills/palace6.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;That can&#39;t be right.&quot;&gt;&gt; \
&lt;&lt;if $i eq 1&gt;&gt;&lt;&lt;MerchantTalk &quot;Foul magic! We must try another door!&quot;&gt;&gt; \
&lt;&lt;elseif $i eq 2&gt;&gt;&lt;&lt;MerchantTalk &quot;Have we tried the dancing hall? Maybe we should try the dancing hall?&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;MerchantTalk &quot;Well, this is most confusing, no?&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\

[[Try something else-&gt;Wight1][$p = 4]]

&lt;&lt;if $i lte 3&gt;&gt; &lt;&lt;set $i += 1&gt;&gt; &lt;&lt;else&gt;&gt; &lt;&lt;set $i = 0&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 6&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle7_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Enough, Barsenes! Let us through.&quot;&gt;&gt; \
The count glowers at you.
&lt;img src=&quot;Images/FrozenHills/count1.jpg&quot; width=500 /&gt;

&lt;&lt;CountTalk &quot;&lt;i&gt;Let thee through? After what thee did to mine own golems?&lt;/i&gt;&quot;&gt;&gt; \
He floats down to the floor of the grand hall. From its sheathe rises a glittering rapier. The count stands ready for battle.
&lt;&lt;CountTalk &quot;&lt;i&gt;Thy presence hast grown irksome.  Thy life, doubly so.  Have at thee, human! Cry havoc!&lt;/i&gt;&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;BarsenesStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;palace&quot;&gt;&gt;\
\
You have defeated $enemyname! 
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points! You gain $enemygold gold pieces!

You found &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Count Barsenes&#39;s&lt;/b&gt;&lt;/span&gt; rapier, Ravenblade!

[[Confront the Count-&gt;Wight1][$p = 21]]

&lt;&lt;set $weaponinventory.push($ravenblade)&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $frozenquest = 20&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;elseif $p eq 21&gt;&gt;\
The Count lies on the ground, mewling. 

&lt;&lt;CountTalk &quot;&lt;i&gt;Best&#39;d by a peasant. How trite&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;This is your own fault.&quot;&gt;&gt; \
&lt;&lt;CountTalk &quot;&lt;i&gt;I wast doom&#39;d from the first. I did warn the Queen of the danger, but to no avail. Dear Carnax granted me safety from the Void, but at what cost?&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;What is he talking about? A Queen?&quot;&gt;&gt; \
&lt;&lt;CountTalk &quot;&lt;i&gt;Queen Domedra... I spit on thy grave.&lt;/i&gt;&quot;&gt;&gt; \

&lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Count Barsenes&lt;/b&gt;&lt;/span&gt; drifts away. It is unclear whether he has died, or simply fled. Either way, once he&#39;s gone the doorway to the courtyard slowly opens.

[[Onwards-&gt;Palace1][$p = 1]]
\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="111" name="WPBattle2" tags="" position="1582,782" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
\
You slowly lower yourself to look under the table. You don&#39;t like what you find.
&lt;img src=&quot;Images/FrozenHills/misc8.jpg&quot; width=500 /&gt;

Fresh blood. Lots of it.
&lt;&lt;HeroTalk &quot;Something was bleeding here. Something big. It&#39;s gone, though.&quot;&gt;&gt; \
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; kicks your leg.
&lt;&lt;MerchantTalk &quot;$name... I think it came back.&quot;&gt;&gt; \

[[Rise-&gt;WPBattle2][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
When you stand up, you don&#39;t like what you see.
&lt;img src=&quot;Images/FrozenHills/golem1.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;A blood golem! Babar, stay back!&quot;&gt;&gt; \
&lt;&lt;BloodGolemTalk &quot;&lt;i&gt;GRAAAAAAHHHHHH!!!&lt;/i&gt;&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;BloodGolemStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;palace&quot;&gt;&gt;\
\
You slay the $enemyname! It proceeds to melt down into a pile of red sludge.
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points! You gain $enemygold gold pieces!

You found the Bloodknight Armor!
&lt;&lt;HeroTalk &quot;What a mess...&quot;&gt;&gt; \
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; pokes at the pile of gore with his boot.
&lt;&lt;MerchantTalk &quot;At least I&#39;m not hungry, anymore...&quot;&gt;&gt; 

[[Continue-&gt;Palace1][$p = 1]]

&lt;&lt;set $chestinventory.push($bloodknightarmor)&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $palacedining = 1&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="112" name="Dance" tags="" position="1588,904" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
Lowering your weapon, you approach the ghost, drop into a low bow, and offer her your hand.
&lt;img src=&quot;Images/FrozenHills/ghost3.jpg&quot; width=450 /&gt;

&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;ElvenLadyGhostTalk &quot;&lt;i&gt;Such a gentleman...&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;ElvenLadyGhostTalk &quot;&lt;i&gt;Two women dancing? Such a scandal...&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\

She takes your hand, her fingers passing partially through your own and sending a chill through your veins.

Then the music begins to play.

[[Dance-&gt;Dance][$p = 1]]
\
&lt;&lt;set $palacedancing = 1&gt;&gt;\

&lt;&lt;elseif $p eq 1&gt;&gt;\
The ghost turns out to be a formidable dancer, leading you through a variety of forms, the orchestra changing its pace without pause. From the edge of the hall, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; taps his boot to the music.

&lt;b&gt;Agility Check&lt;/b&gt;
&lt;&lt;AgilityCheck 100&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;You impress the ghost with your peerless skill. Taking the lead, you guide her through a series of slow spins, your fingers entwined with her own. 
&lt;img src=&quot;Images/FrozenHills/misc9.jpg&quot; width=450 /&gt;

[[The music ends-&gt;Dance][$p = 2]]

&lt;&lt;elseif $action eq &quot;failure&quot;&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;\
Stumbling, you trip over your own foot.

The music stops. The ghost does not look pleased.

[[Apologize for your error-&gt;Dance][$p = 3]]
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 2&gt;&gt;\
As you and the ghost bow, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; breaks into applause.
&lt;&lt;ElvenLadyGhostTalk &quot;&lt;i&gt;Such elegance. Take this - a token of my affection.&lt;/i&gt;&quot;&gt;&gt;
A pair of boots appears on the floor, seemingly from nowhere. 

When you look up from the boots, the ghost has disappeared.

You gained the Dancer&#39;s Boots!

You gain 125 exp!

[[Return-&gt;Palace1][$p = 4]]

&lt;&lt;set $exp += 125&gt;&gt;\
&lt;&lt;set $palacedancing = 2&gt;&gt;\
&lt;&lt;set $feetinventory.push($dancersboots)&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 3&gt;&gt;\
Before you can speak, the ghost rushes at you with a petrifying scream!
&lt;img src=&quot;Images/FrozenHills/ghost5.jpg&quot; width=550 /&gt;

You and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; are thrown from the dancing hall!

You lose 100 health!
\
&lt;&lt;set $currenthealth -= 100&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain-&gt;Game Over]] &lt;&lt;else&gt;&gt;[[Return-&gt;Palace1][$p = 1]]&lt;&lt;/if&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="113" name="WPBattle3" tags="" position="1589,1021" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You turn the corner and step into the cell. There, lying on the cold floor, is &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;Redeemer3Talk &quot;$name... stay back...&quot;&gt;&gt; \
Just then, a creature rises from the shadows. It stands tall, its shoulders rising past your head - not a single skeleton, but a monster built of the bones of many victims!
&lt;img src=&quot;Images/FrozenHills/golem3.jpg&quot; width=500 /&gt;

&lt;&lt;MerchantTalk &quot;By sun and sands!&quot;&gt;&gt; \
&lt;&lt;BoneGolemTalk &quot;&lt;i&gt;GRAAAAAAHHHHHH!!!&lt;/i&gt;&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;BoneGolemStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;palace&quot;&gt;&gt;\
\
You slay the $enemyname! It collapses into a pile of bones at your feet.
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points! You gain $enemygold gold pieces!

You found the Skull Gauntlets!
&lt;&lt;HeroTalk &quot;So many bones.&quot;&gt;&gt; \
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; pokes at the pile of bones with his boot.
&lt;&lt;MerchantTalk &quot;Too many, in fact.&quot;&gt;&gt; 

[[Help Nendel-&gt;WPBattle3][$p = 21]]

&lt;&lt;set $handsinventory.push($skullgauntlets)&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $palacedungeon = 1&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
You kneel down before &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;HeroTalk &quot;Nendel, we need to move! Duke Carnax has your sister, and the Void Gem!&quot;&gt;&gt; \
He does not respond. He seems heavily bruised, and likely unconscious.
&lt;&lt;MerchantTalk &quot;This won&#39;t do! We need this elf&#39;s strength to defeat Duke Carnax. Perhaps I can whip up a quick potion of awakening... I&#39;ll need a few ingredients.&quot;&gt;&gt; 
You rise.
&lt;&lt;HeroTalk &quot;At the cabin?&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;No, no - the Palace dining room!&quot;&gt;&gt; 

[[Return-&gt;Palace1][$p = 5]]
\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="114" name="WPBattle4" tags="" position="1591,1142" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;set time = &quot;Night&quot;&gt;&gt;\
\
You and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; run across the courtyard. You feel strangely vulnerable, with the dark sky so open above you.

When you are only halfway through the courtyard, the door to the cathedral bursts open. Out steps a tall elf, draped in fine robes.

It appears you&#39;ve at last found &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/FrozenHills/lich3.jpg&quot; width=500 /&gt;

&lt;&lt;Lich2Talk &quot;&lt;i&gt;Who dares interrupt this most holy union?&lt;/i&gt;&quot;&gt;&gt; \
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; pulls at your sleeve.
&lt;&lt;MerchantTalk &quot;It&#39;s him! By the black moon - it&#39;s Carnax!&quot;&gt;&gt; \
You nod, then step forward.
&lt;&lt;HeroTalk &quot;Duke Carnax, your plot to steal the Void Gem is over. Give in to my demands, and you might be spared your life.&quot;&gt;&gt; \
&lt;&lt;Lich2Talk &quot;&lt;i&gt;$name, doth thee truly believe to be in control, here?  Thee shall never touch the Gem, nor the Catalyst, nor mine own bride again.&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Then I will strike you down!.&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;No.&quot;&gt;&gt; \

[[Naya?-&gt;WPBattle4][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
She steps out from the Cathedral, walks forward three steps, and links arms with &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;No, $name. I have agreed. The Gem is his. The world soon shall be his. Begone.&quot;&gt;&gt; \
You eyes widen in shock. &lt;&lt;if $nayalove eq 21&gt;&gt;Your heart burns at the sight of her touching that decrepit fiend.&lt;&lt;/if&gt;&gt;
&lt;&lt;MerchantTalk &quot;This can&#39;t be...&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Naya! The Gem must be destroyed!&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;No, $name. I have agreed. The Gem is his. The world soon shall be his. Begone.&quot;&gt;&gt; \
That&#39;s... odd. She said the same thing again.
&lt;&lt;HeroTalk &quot;What... what is your name?&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;No, $name. I have agreed. The Gem is his. The world soon shall be his. Begone.&quot;&gt;&gt; \
The duke sighs, then snaps his fingers. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; turns around and dutifully returns to the Cathedral.
&lt;&lt;Lich2Talk &quot;&lt;i&gt;The hypnosis spell is imperfect.  Nay matter, the lady shall marry, and then the Gem shall mine by right.&lt;/i&gt;&quot;&gt;&gt; \

[[Kill the duke-&gt;WPBattle4][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dragon1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
You draw your $weapon.

&lt;&lt;HeroTalk &quot;You are a monster, Carnax. Your life is forfeit.&quot;&gt;&gt; \
&lt;&lt;Lich2Talk &quot;&lt;i&gt;Oh? Is it?&lt;/i&gt;&quot;&gt;&gt; \

At that moment, you hear something above. A pattern of rushing wind. Wings, beating in the night.
&lt;&lt;MerchantTalk &quot;By the sands!&quot;&gt;&gt; \
&lt;img src=&quot;Images/FrozenHills/dragon6.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;You again!?&quot;&gt;&gt; \
&lt;&lt;SkeletalDragonTalk &quot;&lt;i&gt;Now we finish what began at the beacon!&lt;/i&gt;&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalDragonStats&gt;&gt; \
&lt;&lt;set $enemycurrenthealth = $enemyspecialhealth&gt;&gt;
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \

&lt;&lt;elseif $p eq 20&gt;&gt;\
The dragon utters a horrid roar as it starts to shatter.
&lt;&lt;SkeletalDragonTalk &quot;&lt;i&gt;Death at last! But with one last effort, I shall take you with me!&lt;/i&gt;&quot;&gt;&gt;\

The undead dragon smashes its head against the courtyard ground. There is a terrible trembling... and then the stones beneath your feet break apart.
&lt;&lt;HeroTalk &quot;BABAR - MOVE!&quot;&gt;&gt; \
But before either of you can act, you&#39;re in freefall.
&lt;img src=&quot;Images/FrozenHills/misc11.jpg&quot; width=550 /&gt;

[[...-&gt;Palace2][$p = 0]]
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="115" name="Palace2" tags="" position="1593,1272" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;\
Your thoughts shift through a liquid haze.

Consciousness slips. @@.delayed;Frays.@@ @@.delayed;Fades Away.@@

&lt;&lt;if $nayalove eq 21&gt;&gt;@@.delayed;&lt;&lt;NayaTalk &quot;$name... please...&quot;&gt;&gt; @@ \
@@.delayed; @@ \&lt;&lt;else&gt;&gt;@@.delayed;Memories...@@

@@.delayed;&lt;&lt;KingTalk &quot;$name... you failed me!&quot;&gt;&gt; @@ \
@@.delayed; @@ \
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $nayalove eq 21&gt;&gt;@@.delayed;&lt;&lt;HeroTalk &quot;Naya! Hold on!&quot;&gt;&gt; @@
@@.delayed; @@ \&lt;&lt;else&gt;&gt;@@.delayed;&lt;&lt;HeroTalk &quot;No I haven&#39;t. Not yet.&quot;&gt;&gt; @@
@@.delayed; @@ \
&lt;&lt;/if&gt;&gt;\

@@.delayed; [[Force yourself to wake up-&gt;Palace2][$p = 1]]
@@

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;redeemer&quot;&gt;&gt;\
\
When you open your eyes, you&#39;re in what looks to be an ancient elven crypt. &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; is lying on his side a few paces from you, rubbing his hip and groaning. The courtyard lies many paces above you - far too high to climb.

After moving a bit to make sure no bones are broken, you rise and look around the crypt. 
&lt;img src=&quot;Images/FrozenHills/palace11.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;What is this place?&quot;&gt;&gt; \
It is far more beautiful than any other elven ruin you have seen in the Deep Woods. Its majesty is greater than even Hadamshal before its destruction.

The entire crypt seems to be the resting place of one single elf. You see the tomb at the far side of the crypt.

[[Investigate-&gt;Palace2][$p = 2]]

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;You approach the tomb, a strange sense of foreboding growing in your gut with every step.
&lt;img src=&quot;Images/FrozenHills/palace12.jpg&quot; width=500 /&gt;

The tomb is inscribed with elven words. Thankfully, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; soon joins you, staring in glum curiosity.
&lt;&lt;MerchantTalk &quot;How strange... the tomb reads: &#39;&lt;i&gt;Here lies Queen Domedra, who dared to try and slay Void itself. For this crime against nature, once-glorious Netheryn was destroyed. For this crime against her people, Queen Domedra was buried alive.&#39;&lt;/i&gt;&quot;&gt;&gt; \
You can&#39;t help but shiver at the words.
&lt;&lt;HeroTalk &quot;They buried their own Queen alive?&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;It sounds like she was the start of everything - the creation of the Void Gem, the evil in the Deep Woods... she is the source.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;And now the Redeemer seeks to finish what she started.&quot;&gt;&gt; \

[[Devise a plan-&gt;Palace2][$p = 50]]

&lt;&lt;elseif $p eq 50&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;palace&quot;&gt;&gt;\
\
&lt;&lt;if $nayalove eq 21&gt;&gt;&lt;&lt;HeroTalk &quot;Enough dithering. Naya can still be saved. the Void Gem can still be destroyed.&quot;&gt;&gt; \&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Enough dithering. Carnax can still be stopped. The Void Gem can still be destroyed.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;
&lt;&lt;MerchantTalk &quot;Agreed! We must see this through to the end, friend. I believe I saw a passage back to the surface, at the front of the crypt. There is also an odd red stone you might want to take a look at.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Good. So long as we breathe, hope remains.&quot;&gt;&gt; \

[[Onwards!-&gt;Palace2][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;if $music neq &quot;palace&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;palace&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You are standing in a vast, ancient crypt. It is the final resting place of &lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Queen Domedra&lt;/b&gt;&lt;/span&gt; of Netheryn.
&lt;img src=&quot;Images/FrozenHills/palace11.jpg&quot; width=700 /&gt;

[[Talk to Babar-&gt;Palace2][$p = 4]]
[[Touch the heartstone-&gt;Palace2][$p = 5]]
[[Leave-&gt;Palace2][$p = 6]]

&lt;&lt;elseif $p eq 4&gt;&gt;You approach &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;. Despite the harrowing journey through the Winter Palace, the merchant looks to be in surprisingly good spirits. It seems all this danger and excitement has awakened a bit of bravery within him.
&lt;&lt;HeroTalk &quot;Babar, how are you holding up?&quot;&gt;&gt; \
&lt;&lt;if $merchantlove gte 26&gt;&gt;&lt;&lt;MerchantTalk &quot;My dear, with you around, I am always filled with hope. Lead on.&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;MerchantTalk &quot;I am well, friend. Lead the way.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \

[[Return-&gt;Palace2][$p = 3]]
&lt;&lt;if ($lewdmode eq 1) and ($merchantlove eq 26)&gt;&gt;[[Kiss him-&gt;Merchant Lewd][$p = 58]] &lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 5&gt;&gt;\
You approach the heartstone - a welcome find, in a place like this.
&lt;img src=&quot;Images/ScarletVale/crystalheart2.jpg&quot; width=500 /&gt;

&lt;i&gt;Your health is fully restored!&lt;/i&gt;

[[Return-&gt;Palace2][$p = 3]]

&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 6&gt;&gt;\
You are within a long, winding staircase, leading from &lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Queen Domedra&#39;s&lt;/b&gt;&lt;/span&gt; crypt to the cathedral of the Winter Palace.
&lt;img src=&quot;Images/FrozenHills/palace13.jpg&quot; width=650 /&gt;

&lt;&lt;if $frozenquest eq 20&gt;&gt;A group of undead minions patrol the stairwell. You will need to defeat them if you wish to ascend.

[[Attack-&gt;WPBattle5][$p = 0]]
[[Return to the crypt-&gt;Palace2][$p = 3]]
&lt;&lt;else&gt;&gt;\
[[Ascend to the cathedral-&gt;Palace2][$p = 7]]
[[Return to the crypt-&gt;Palace2][$p = 3]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 7&gt;&gt;You stand within a transept of the cathedral. Beyond, the great nave awaits.
&lt;img src=&quot;Images/FrozenHills/palace14.jpg&quot; width=550 /&gt;

&lt;&lt;if $frozenquest eq 21&gt;&gt;\
A powerful-looking spirit, dressed in a fine suit of armor, stands between you and the wedding ceremony. The only way around is through.

[[Challenge the fearsome spirit-&gt;WPBattle6][$p = 0]]
[[Return to the crypt-&gt;Palace2][$p = 3]]
&lt;&lt;else&gt;&gt;With &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Zabil&#39;s&lt;/b&gt;&lt;/span&gt; spirit put to rest, the time has come to save &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; and destroy the Void Gem once and for all.

[[Face off against the great necromancer-&gt;Carnax1][$p = 0]]
[[Return to the crypt-&gt;Palace2][$p = 3]]
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 8&gt;&gt;





















&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="116" name="WPBattle5" tags="" position="1593,1391" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle6_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You run up the stairs, $weapon in hand.

The first of the undead is quick to spot you.
&lt;img src=&quot;Images/FrozenHills/dead5.jpg&quot; width=500 /&gt;

&lt;&lt;SkeletalSoldierTalk &quot;&lt;i&gt;Halt, in the name of the Duke!&lt;/i&gt;&quot;&gt;&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalSoldierStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 1&gt;&gt; \

&lt;&lt;elseif $p eq 20&gt;&gt;\
\
&lt;&lt;if $battletotal eq 1&gt;&gt;The skeleton falls to pieces. Just as it does, an arrow flies past your ear.
&lt;img src=&quot;Images/FrozenHills/dead1.jpg&quot; width=500 /&gt;
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;SkeletalArcherTalk &quot;&lt;i&gt;A pox upon thee, human!&lt;/i&gt;&quot;&gt;&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalArcherStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 2&gt;&gt; \

&lt;&lt;elseif $battletotal eq 2&gt;&gt;The archer falls apart. There&#39;s only one enemy left.
&lt;img src=&quot;Images/FrozenHills/dead7.jpg&quot; width=450 /&gt;
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;SkeletalMageTalk &quot;&lt;i&gt;If I must perish, then I perish in service to mine own lord!&lt;/i&gt;&quot;&gt;&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SkeletalMageStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 3&gt;&gt; \
\
&lt;&lt;set $iteminventory[0].quantity += 1&gt;&gt;\

&lt;&lt;elseif $battletotal eq 3&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;palace&quot;&gt;&gt;\
\
The mage dies with a final loathsome hiss. The stairwell falls silent.
&lt;&lt;BattleEnd&gt;&gt;\

The way to the cathedral is open.
&lt;&lt;set $enemygold = 250&gt;&gt;\
&lt;&lt;set $enemyexp = 225&gt;&gt; \

You loot the corpse of your fallen foes. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Continue-&gt;Palace2][$p = 6]]
\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
\
&lt;&lt;set $frozenquest = 21&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="117" name="WPBattle6" tags="" position="1593,1506" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;babar_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;babar&quot;&gt;&gt;\
\
The armored spirit looks like a formidable opponent. This won&#39;t be easy.
&lt;img src=&quot;Images/Character/zabil2.jpg&quot; width=450 /&gt;

Just as you approach your foe, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; pushes you aside and runs up to it.
&lt;&lt;MerchantTalk &quot;By the sands... could it be?&quot;&gt;&gt; \

The spirit tightens it grip on its flail.
&lt;&lt;Zabil1Talk &quot;&lt;i&gt;Yes, brother. It is I.&lt;/i&gt;&quot;&gt;&gt; \
Only then do you notice the gem, floating beneath the blue fire that swirls from the armor.
&lt;img src=&quot;Images/Outskirts/soulstone1.jpg&quot; width=450 /&gt;

The spirit truly &lt;i&gt;is&lt;/i&gt; &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Zabil&#39;s&lt;/b&gt;&lt;/span&gt; soul, forced into servitude to &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt;!

&lt;&lt;MerchantTalk &quot;Brother...&quot;&gt;&gt; \
&lt;&lt;Zabil1Talk &quot;&lt;i&gt;Tell me, Babar. Was it a worthy trade? Five thousand gold pieces. Was that the worth of my freedom? My life? My soul?&lt;/i&gt;&quot;&gt;&gt; \
Tears fall from &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; cheeks.
&lt;&lt;MerchantTalk &quot;No. That soulstone may as well have been a blade in your heart.&quot;&gt;&gt; \
&lt;&lt;Zabil1Talk &quot;&lt;i&gt;Allow me to return the favor, then.&lt;/i&gt;&quot;&gt;&gt; \

[[Zabil strikes Babar across the face-&gt;WPBattle6][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;merchant_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;merchant&quot;&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; wipes the blood from his face.

Then, he starts to laugh.
&lt;&lt;MerchantTalk &quot;I can never atone for what I did, my dear Zabil. But I can try. Every day from this one onwards, I can try to be a better man. Starting now. Starting by saving you from this prison!&quot;&gt;&gt; \
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; draws his dagger and stands tall against his brother.
&lt;&lt;MerchantTalk &quot;Zabil Ogho, hear me now! This time, I will not let you down!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ZabilStats&gt;&gt; \
&lt;&lt;BabarStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;babar_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;babar&quot;&gt;&gt;\
The suit of armor trips under your and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; relentless blows. The soulstone slips free.
&lt;img src=&quot;Images/Outskirts/soulstone1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Now, Babar - finish this!&quot;&gt;&gt; \
The merchant charges at the stone, dagger in hand. The blade goes flying down-
&lt;img src=&quot;Images/Outskirts/soulstone2.jpg&quot; width=700 /&gt;

[[...-&gt;WPBattle6][$p = 21]]
\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
As quickly as it came, the flash of purple light dissipates. When your eyes readjust to the darkness, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Zabil&lt;/b&gt;&lt;/span&gt; is gone. The Soulstone, too, is no more. Its fragments litter the cold floor of the cathedral.

&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; still breathes - exhausted, but alive.
&lt;&lt;HeroTalk &quot;Is it... done?&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;I do not know...&quot;&gt;&gt; \
Just then, a faint light fills the transcept. From it, a translucent figure appears.
&lt;img src=&quot;Images/Character/zabil1.jpg&quot; width=450 /&gt;

&lt;&lt;Zabil2Talk &quot;&lt;i&gt;Yes, little brother... it is done.&lt;/i&gt;&quot;&gt;&gt; \
The figure of &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Zabil&lt;/b&gt;&lt;/span&gt; starts to fade away.
&lt;&lt;MerchantTalk &quot;Brother! Please, I beg your forgiveness.&quot;&gt;&gt; \
&lt;&lt;Zabil2Talk &quot;&lt;i&gt;Then you have it. Be well, Babar... be well...&lt;/i&gt;&quot;&gt;&gt; \
He is gone.

[[Speak to Babar-&gt;WPBattle6][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
&lt;&lt;HeroTalk &quot;Babar. Are you alright?&quot;&gt;&gt; \
The merchant shrugs. There are tears streaming from his face, but he cannot help but smile.
&lt;&lt;MerchantTalk &quot;It was good to hear his voice, friend. Maybe that&#39;s all I wanted. To hear him again.&quot;&gt;&gt; \
He sighs.
&lt;&lt;MerchantTalk &quot;But the work is only half done. Carnax must pay. Are you with me, friend?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Aye, Babar. To the bitter end. Onwards!&quot;&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $headinventory.push($helmofthechampion)&gt;&gt;\
Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

You find the Helm of the Champion!

[[Return to the crypt to heal-&gt;Palace2][$p = 3]]
\
&lt;&lt;set $frozenquest = 22&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="118" name="Carnax1" tags="" position="1594,1624" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;
\
You and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; walk into the nave of the Winter Palace&#39;s grand cathedral, weapons drawn. 
&lt;img src=&quot;Images/FrozenHills/palace15.jpg&quot; width=700 /&gt;

There, in the middle of reading their vows, are &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.

&lt;&lt;MerchantTalk &quot;Carnax, you worm! I&#39;ve been dreaming of this day for twenty years!&quot;&gt;&gt; \
The duke studies &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; with cold, unblinking eyes.
&lt;&lt;Lich2Talk &quot;&lt;i&gt;Did it sting, babar, to slay thy brother a second time?&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Your words are as empty as your heart.&quot;&gt;&gt; \
&lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; sighs, then gestures at &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;Lich2Talk &quot;&lt;i&gt;It seems they approve not of our match.  Come, dear.  Their souls shall serve as our wedding feast.&lt;/i&gt;&quot;&gt;&gt; \

[[Naya nods-&gt;Carnax1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle7_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\

&lt;&lt;if $nayalove eq 21&gt;&gt;&lt;&lt;HeroTalk &quot;Naya, listen to the sound of my voice. Fight against the necromancer&#39;s spell!&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;I must obey... I...&quot;&gt;&gt; \
She blinks. A touch of lucidity returns to her gaze.
&lt;&lt;NayaTalk &quot;Where am I? What happened?&quot;&gt;&gt; \
But &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; snaps his fingers, and the spell shackles her will once more.
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Naya, stop this madness. Wake up!&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;I must obey... I must obey...&quot;&gt;&gt; \
She&#39;s fully under the power of &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Carnax&#39;s&lt;/b&gt;&lt;/span&gt; dark magic.
&lt;&lt;/if&gt;&gt;\
&lt;img src=&quot;Images/FrozenHills/lich5.jpg&quot; width=700 /&gt;

&lt;&lt;Lich2Talk &quot;&lt;i&gt;This day marks the start of my dominion. Anon, the Void shall obey me. Then the world shall bow to Carnax, or face oblivion!&lt;/i&gt;&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;EnemyAllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;CarnaxStats&gt;&gt; \
&lt;&lt;BabarStats&gt;&gt; \
&lt;&lt;NayaEnemyStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;palace1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;palace&quot;&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; eyes flutter before she falls to the ground.
&lt;&lt;Lich2Talk &quot;&lt;i&gt;Useless wench - I need more life energy!&lt;/i&gt;&quot;&gt;&gt; \
Sensing his own vulnerability, &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Carnax&lt;/b&gt;&lt;/span&gt; floats up high above the ground, and flees onto the roof of the cathedral. You and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; rush towards &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; body.

The merchant cradles the elf girl, then checks her pulse.
&lt;&lt;MerchantTalk &quot;She lives... barely. I will try my best to revive her.&quot;&gt;&gt; \
&lt;&lt;if $nayalove eq 21&gt;&gt;You want nothing more to hold her as &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; brings her back, but you cannot. &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Carnax&lt;/b&gt;&lt;/span&gt; must be stopped. &lt;&lt;/if&gt;&gt;You rise, then spot a spiraling staircase leading up to the roof.
&lt;&lt;MerchantTalk &quot;$name - where are you going!?&quot;&gt;&gt; \
\
&lt;&lt;HeroTalk &quot;I&#39;m finishing this.&quot;&gt;&gt; \
As you set foot on the stairs, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; tosses you a potion. A quick drink of it restores your vitality.

[[Pursue Carnax-&gt;Carnax2][$p = 0]]

&lt;&lt;set $check = $maxhealth*0.9&gt;&gt;\
&lt;&lt;if $currenthealth lt $check&gt;&gt; &lt;&lt;set $currenthealth = $check&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="119" name="EnemyAllyBattle1" tags="" position="847,21" size="100,100">&lt;&lt;if $p eq 10&gt;&gt; &lt;&lt;Aura&gt;&gt;\
\
You and $allyname are fighting $enemyname and $enemyallyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;i&gt;&lt;&lt;ItemAbilityRun&gt;&gt;&lt;&lt;if ($battlecount eq 0) and ($setbonus gte 1)&gt;&gt;&lt;&lt;SetBonus&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/i&gt;
\
&lt;&lt;if $allyturn eq 1&gt;&gt; &lt;&lt;set $allyturn = 0&gt;&gt; &lt;&lt;else&gt;&gt; &lt;&lt;set $allyturn = 1&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;if $stun lte 0&gt;&gt; &lt;&lt;set $action = &quot;notstun&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;if $stun gte 1&gt;&gt;&lt;&lt;set $action = &quot;stun&quot;&gt;&gt;&lt;&lt;set $stun -= 1&gt;&gt;You are stunned, and cannot take action!&lt;&lt;else&gt;&gt;\
\
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt;&lt;b&gt;Combat Points&lt;/b&gt;: $combatpoints / 5 
&lt;&lt;/if&gt;&gt;\
&lt;b&gt;General Actions&lt;/b&gt;:
&lt;&lt;link &quot;Attack&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;attack&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;if $flee eq 1&gt;&gt;&lt;&lt;link &quot;Flee&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;flee&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;i&gt;You cannot flee from this battle!&lt;/i&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;td&gt;\
&lt;b&gt;Class Abilities&lt;/b&gt;:
&lt;&lt;for _i to 0; _i lt $abilityinventory.length; _i++&gt;&gt;\
&lt;&lt;print $abilityinventory[_i].name&gt;&gt; (Mana cost: $abilityinventory[_i].mana )\
&lt;&lt;capture _i&gt;&gt;\
		&lt;&lt;if $currentmana lt $abilityinventory[_i].mana&gt;&gt;&lt;i&gt;Not enough mana&lt;/i&gt;&lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($combatpoints lt $abilityinventory[_i].combatcost)&gt;&gt;&lt;i&gt;Not enough Combat Points&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;ability&quot;&gt;&gt; &lt;&lt;set $ability = $abilityinventory[_i].widgetname&gt;&gt; &lt;&lt;set $abilitymana = $abilityinventory[_i].mana&gt;&gt; &lt;&lt;set $abilitylevel = $abilityinventory[_i].level&gt;&gt; &lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;/td&gt;\
&lt;td&gt;\
&lt;b&gt;Items ($potioncount / 10)&lt;/b&gt;:
&lt;&lt;if $potioncount gte 10&gt;&gt;&lt;i&gt;You can only drink up to 10 potions in a single battle!&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;&lt;for _i to 0; _i lt $iteminventory.length; _i++&gt;&gt;\
&lt;&lt;print $iteminventory[_i].name&gt;&gt; (Quantity: &lt;&lt;print $iteminventory[_i].quantity&gt;&gt;) \
&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $iteminventory[_i].quantity lte 0&gt;&gt; &lt;i&gt;None left&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt; &lt;&lt;set $action = &quot;item&quot;&gt;&gt; &lt;&lt;set $item = $iteminventory[_i].name&gt;&gt;
			&lt;&lt;set $iteminventory[_i].quantity -= 1&gt;&gt;\
			&lt;&lt;set $itemstrength = $iteminventory[_i].strength&gt;&gt;\
			&lt;&lt;set $itemagility = $iteminventory[_i].agility&gt;&gt;\
			&lt;&lt;set $itemwillpower = $iteminventory[_i].willpower&gt;&gt;\
			&lt;&lt;set $itemarmor = $iteminventory[_i].armor&gt;&gt;\
			&lt;&lt;set $itemhealth = $iteminventory[_i].health&gt;&gt;\
			&lt;&lt;set $itemmana = $iteminventory[_i].mana&gt;&gt;\
			&lt;&lt;set $itemevadescore = $iteminventory[_i].evadescore&gt;&gt;\
			&lt;&lt;set $potioncount += 1&gt;&gt;\
			&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;/td&gt;\
&lt;/table&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;stun&quot;&gt;&gt;&lt;&lt;if $allyturn eq 1&gt;&gt;&lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 13&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $allyturn eq 0&gt;&gt;&lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 14&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;\
\
&lt;&lt;EnemyAllyBattleTable&gt;&gt;\
\
&lt;&lt;set $battlecount += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 11&gt;&gt; 
You and $allyname are fighting $enemyname and $enemyallyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;

&lt;&lt;if $action eq &quot;attack&quot;&gt;&gt;You attempt to hit the $enemyname with your $weapon!

&lt;&lt;AttackAttempt&gt;&gt;
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;You deal damage to the $enemyname!

&lt;&lt;AttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;flee&quot;&gt;&gt;You attempt to flee from the $enemyname!

&lt;&lt;FleeAttempt&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;ability&quot;&gt;&gt;&lt;&lt;Ability $ability&gt;&gt;&lt;&lt;/Ability&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $action eq &quot;item&quot;&gt;&gt;You used your $item!
&lt;&lt;ItemImage $item 150&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;
&lt;&lt;ItemUse&gt;&gt;
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;The enemy is slain! Victory!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $action eq &quot;flee success&quot;&gt;&gt;&lt;&lt;link &quot;You escape!&quot; $passage&gt;&gt;&lt;&lt;set $p = 19&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $allyturn eq 1&gt;&gt;&lt;&lt;link &quot;Ally turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 13&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $allyturn eq 0&gt;&gt;&lt;&lt;link &quot;Enemy&#39;s Ally turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 14&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;\
\
&lt;&lt;EnemyAllyBattleTable&gt;&gt;\
\
&lt;&lt;elseif $p eq 12&gt;&gt; \
You and $allyname are fighting $enemyname and $enemyallyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;EnemyStun&gt;&gt;
\
&lt;&lt;if $enemyaction eq &quot;attack&quot;&gt;&gt;The $enemyname attacks you!

&lt;&lt;EnemyAttackAttempt&gt;&gt;

&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;The $enemyname deals damage to you!

&lt;&lt;EnemyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if ($enemyaction neq &quot;stun&quot;) and ($enemyaction neq &quot;attack&quot;) and ($enemyaction neq &quot;attack success&quot;) and ($enemyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;EnemyAbility $enemyaction&gt;&gt;&lt;&lt;/EnemyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]]&lt;&lt;elseif $allycurrenthealth lte 0&gt;&gt;[[Your ally is slain!-&gt;Game Over]]&lt;&lt;elseif $enemyallycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;Naya has fallen!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Player turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;\
\
&lt;&lt;EnemyAllyBattleTable&gt;&gt;\
\
&lt;&lt;elseif $p eq 13&gt;&gt;\
\
\
You and $allyname are fighting $enemyname and $enemyallyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;set $allyaction = $allyability.pluck()&gt;&gt;\
&lt;&lt;set $allyability.push($allyaction)&gt;&gt;

&lt;&lt;if $allyaction eq &quot;attack&quot;&gt;&gt;$allyname attacks $enemyname

&lt;&lt;AllyAttackAttempt&gt;&gt;

&lt;&lt;if $allyaction eq &quot;attack success&quot;&gt;&gt;The $allyname deals damage to $enemyname!

&lt;&lt;AllyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if ($allyaction neq &quot;attack&quot;) and ($allyaction neq &quot;attack success&quot;) and ($allyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;AllyAbility $allyaction&gt;&gt;&lt;&lt;/AllyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $enemycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;The enemy is slain! Victory!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;\
\
&lt;&lt;EnemyAllyBattleTable&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 14&gt;&gt;
You and $allyname are fighting $enemyname and $enemyallyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;set $enemyallyaction = $enemyallyability.pluck()&gt;&gt;\
&lt;&lt;set $enemyallyability.push($enemyallyaction)&gt;&gt;
\
\
&lt;&lt;if ($enemyallyaction neq &quot;attack&quot;) and ($enemyallyaction neq &quot;attack success&quot;) and ($enemyallyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;AllyAbility $enemyallyaction&gt;&gt;&lt;&lt;/AllyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]]&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;AllyBattleTable&gt;&gt;\
\
&lt;&lt;EnemyAllyBattleTable&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 19&gt;&gt; 
You flee from the $enemyname - better to bandage your wounds and do battle another day than foolishly fight to the death.

As you near the safety of the cabin, you realize your coin purse is a bit lighter than before. Some gold pieces must have fallen out while you were running away.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $goldloss = $enemymaxgold&gt;&gt; \
&lt;&lt;set $gold -= $goldloss&gt;&gt; \
\
&lt;&lt;BattleEnd&gt;&gt;\
\
\
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
This page should not come up, as you should be out of the $passage passage and into the $returnpassage passage.

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="120" name="Carnax2" tags="" position="1588,1742" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;
\
Reaching the top of the stairs, you find yourself on the crumbling roof of the Winter Palace. Below, the Frozen Hills spread far across the horizon. The sky is clear of cloud, and the full moon shines from above.
&lt;img src=&quot;Images/FrozenHills/palace16.jpg&quot; width=700 /&gt;

&lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; leans against a pillar, clearly struggling to stand.

&lt;&lt;Lich2Talk &quot;&lt;i&gt;By slaying me, thee simply aid the redeemer. I only seek to rule the world. He shalt destroy it.&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Then I will slay you both.&quot;&gt;&gt; \
&lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Carnax&lt;/b&gt;&lt;/span&gt; pulls out the Void Gem.
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=400 /&gt;

&lt;&lt;Lich2Talk &quot;&lt;i&gt;By this gem was&#39;t Netheryn doom&#39;d.  Oh, Queen Domedra, why did thee risk the kingdom so? In seeking eternity, the lady damn&#39;d us all.&lt;/i&gt;&quot;&gt;&gt; \
The duke starts to shake with fury. His eyes glow with arcane power.
&lt;&lt;Lich2Talk &quot;&lt;i&gt;Only I can redeem mine own kingdom!  Only I am fit to rule! Curse thee, and curse the Redeemer!&lt;/i&gt;&quot;&gt;&gt; \

[[The duke draws on the Void Gem&#39;s dark power-&gt;Carnax2][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle7_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\

You step back, horrified, as &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; reveals his true form.
&lt;img src=&quot;Images/FrozenHills/lich1.jpg&quot; width=450 /&gt;

&lt;&lt;Lich3Talk &quot;&lt;i&gt;Tremble and despair, $name! I am Carnax, heir of Netheryn! I am eternal!&lt;/i&gt;&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;SpecialBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;Carnax2Stats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 0&gt;&gt; \

&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;&lt;if $battletotal eq 0&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
Just as &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Carnax&lt;/b&gt;&lt;/span&gt; prepares a devastating attack, a spirit blade strikes him on the shoulder. Turning, you spot &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/nendel1.jpg&quot; width=450 /&gt;

&lt;&lt;Lich3Talk &quot;&lt;i&gt;You! I should have known you&#39;d turn up!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;Redeemer3Talk &quot;Come, $name. Let us finish this.&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;Carnax2Stats&gt;&gt; \
&lt;&lt;Nendel1Stats&gt;&gt; \
&lt;&lt;set $enemycurrenthealth = $enemyspecialhealth&gt;&gt;\
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
\
&lt;&lt;set $battletotal = 1&gt;&gt;\
\
&lt;&lt;elseif $battletotal eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;redeemer&quot;&gt;&gt;\
&lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Carnax&lt;/b&gt;&lt;/span&gt; starts to burn up, his energy at last exhausted.
&lt;&lt;Lich3Talk &quot;&lt;i&gt;So this is how it ends... best&#39;d by the likes of thee.  Barsenes... help me...&lt;/i&gt;&quot;&gt;&gt; \
Then he is gone. All that remains where he stood is the Void Gem.
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $weaponinventory.push($staffofwinter)&gt;&gt;\
Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

You find the the Staff of Winter!

[[Speak to Nendel-&gt;Carnax2][$p = 21]]
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; picks up the Void Gem, staring at it with a blank, puzzled expression.
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;Nendel, your sister-&quot;&gt;&gt; \
&lt;&lt;Redeemer3Talk &quot;I know. Go to her, make sure she&#39;s okay. I will bring the Void Gem to the Catalyst. The time of its destruction is at hand.&quot;&gt;&gt; \

[[Agree with Nendel-&gt;Carnax2][$p = 22, $i = 1]]
[[Insist you be the one to destroy the Gem-&gt;Carnax2][$p = 22, $i = 2]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;Very well, we&#39;ll come find you once Naya is on her feet.&quot;&gt;&gt; \
&lt;&lt;Redeemer3Talk &quot;Good. This shouldn&#39;t take long.&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;\
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&#39;s&lt;/b&gt;&lt;/span&gt; decisions strike you as odd.
&lt;&lt;HeroTalk &quot;She&#39;s your sister, Nendel. Shouldn&#39;t you see to her health?&quot;&gt;&gt; \
He grimaces, not taking his eye off the gem.
&lt;&lt;Redeemer3Talk &quot;Do you know how to operate a Netheryn Catalyst? No? Then I must be the one to deal with the Gem. Go help Naya, and do not delay any further.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;

[[Go to Naya-&gt;Carnax2][$p = 23]]
\
\
&lt;&lt;elseif $p eq 23&gt;&gt;\
When you return to the Cathedral, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; is just getting to her feet, with &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; help.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;She&#39;s okay, $name. A bit wobbly, but she will recover.&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;$name! You have to forgive me. I&#39;ve put our whole plan in danger.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Naya-&quot;&gt;&gt; \
She stops you.
&lt;&lt;NayaTalk &quot;Let me finish. When I received the Duke&#39;s letter, I thought my own life was a small cost to pay for the destruction of the Void Gem. I soon realized Carnax had no intention of breaking the Gem, but by then his magic had gotten to me.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;You acted recklessly, but it doesn&#39;t matter. Duke Carnax is dead.&quot;&gt;&gt; \
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; leaps in the air and cries out in joy. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; just glances around, looking for something.
&lt;&lt;NayaTalk &quot;If Carnax is dead, where is the Void Gem?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Nendel is dealing with it.&quot;&gt;&gt; \

[[She goes pale-&gt;Carnax2][$p = 24]]

&lt;&lt;elseif $p eq 24&gt;&gt;\
\
&lt;&lt;NayaTalk &quot;... Nendel? &lt;i&gt;My brother&lt;/i&gt;?&quot;&gt;&gt; \
Something in her tone puts you on edge.
&lt;&lt;HeroTalk &quot;... yes.&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;&lt;i&gt;NO!&lt;/i&gt;&quot;&gt;&gt; \

&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; rushes out of the Cathedral.

[[Follow her-&gt;Carnax2][$p = 25]]

&lt;&lt;elseif $p eq 25&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer2_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;redeemer&quot;&gt;&gt;\
When you arrive in the Palace&#39;s treasure room a moment after &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, it is already too late.
&lt;img src=&quot;Images/FrozenHills/misc13.jpg&quot; width=650 /&gt;

The entire room is engulfed in flames.
&lt;&lt;HeroTalk &quot;What? &lt;i&gt;How&lt;/i&gt;?&quot;&gt;&gt; \
The Catalyst has been smashed into pieces. You watch as the fire consumes it. Beside you, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; stares with paralyzed, abject terror.

Then you understand.
&lt;&lt;HeroTalk &quot;... it was Nendel. It was always him.&quot;&gt;&gt; \
From the depths of the room, a figure rises. The fire doesn&#39;t seem to harm him.
&lt;&lt;Redeemer4Talk &quot;Yes, $name. I am the Redeemer. And thanks to you, the last threat to the Void Gem is gone. The destruction of this world is certain, now.&quot;&gt;&gt; \
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; falls to her knees.
&lt;&lt;NayaTalk &quot;Brother...&quot;&gt;&gt; \
&lt;&lt;Redeemer4Talk &quot;Don&#39;t fret, little sister. We shall be reunited with Mother and Father soon. The world will pay for what happened to Hadamshal.&quot;&gt;&gt; \
Filled with fury, you charge at &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt;. Yet just as you near him, he draws deeper into the flames.

[[Chase him-&gt;Carnax2][$p = 26]]

&lt;&lt;elseif $p eq 26&gt;&gt;\
Smoke fills your lungs. Coughing, gasping, you chase after him. &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; grasps your shoulder.
&lt;&lt;MerchantTalk &quot;$name - this is folly! The whole Palace is on fire! We need to escape!&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;&lt;i&gt;He has the Gem&lt;/i&gt;!&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Dying here won&#39;t change that!&quot;&gt;&gt; \

[[Retreat-&gt;Carnax2][$p = 27]]
[[Pursue Nendel-&gt;Game Over]] 

&lt;&lt;set $currenthealth = 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 27&gt;&gt;\
As the sun rises in the east, you, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;, and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; flee from the Winter Palace. 

At a safe distance, you turn back. The entire Palace is aflame.
&lt;img src=&quot;Images/FrozenHills/palace17.jpg&quot; width=650 /&gt;

&lt;&lt;NayaTalk &quot;Brother... what have you done?&quot;&gt;&gt; \
&lt;&lt;if $nayalove eq 21&gt;&gt;You touch her shoulder.
&lt;&lt;HeroTalk &quot;How could you, Naya? How could you lie to me?&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;You scowl at the elf girl.
&lt;&lt;HeroTalk &quot;Why did you lie to me, Naya?&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
&lt;&lt;NayaTalk &quot;I... &lt;i&gt;$name!?&lt;/i&gt;&quot;&gt;&gt; \
The world shifts. Your vision swims. All the trials of the night are finally taking their toll.

[[Collapse-&gt;Carnax2][$p = 28]]

&lt;&lt;elseif $p eq 28&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;\

Chapter 3 @@.delayed;...@@

@@.delayed;...@@

@@.delayed;...@@

@@.delayed;Complete.@@

@@.delayed;[[Continue-&gt;Interlude3][$p = 0]]
 @@
 
&lt;&lt;set $check3 = random(1,3)&gt;&gt;\
&lt;&lt;if $check3 eq 1&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Crusader&lt;/b&gt; in a new game to start off with a full set of blessed armor and a holy warhammer!&lt;/i&gt;@@
&lt;&lt;elseif $check3 eq 2&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Insane&lt;/b&gt; in a new game to start off with very high strength and agility, but terribly low willpower!&lt;/i&gt;@@
&lt;&lt;elseif $check3 eq 3&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Arcane Preserver&lt;/b&gt; in a new game to start off with the Arcane Scythe and the Cloak of Zyr!&lt;/i&gt;@@
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
\
\</tw-passagedata><tw-passagedata pid="121" name="Study" tags="" position="1584,410" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
You and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; peer over the book.
&lt;img src=&quot;Images/FrozenHills/misc12.jpg&quot; width=500 /&gt;

&lt;&lt;if $i eq 0&gt;&gt;\
&lt;&lt;MerchantTalk &quot;I&#39;ve studied a bit of the Elven language, if you&#39;d like me to try and read it...&quot;&gt;&gt; \
\
&lt;&lt;elseif $i eq 1&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; reads the earliest passage.
&lt;&lt;MerchantTalk &quot;&lt;i&gt;For over one thousand years, I have maintained my vigil. Cursed to live eternal. Cursed to guard eternal. Even Netheryn&#39;s fall did not put an end to my duty. With every year that passes, my disgust for the living grows. Every time I foray beyond the Palace, I find them more frail, more deceitful, more unworthy...&lt;/i&gt;&quot;&gt;&gt; \

This is clearly the journal of &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt;.

&lt;&lt;elseif $i eq 2&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; reads the second passage.
&lt;&lt;MerchantTalk &quot;&lt;i&gt;Barsenes, my sole true companion, has perhaps lost his mind. He rants and raves about our prisoner, how she seeks to escape her prison, how her body must be burned. Those were not our orders. My duty endures... but my mind slips... years... decades... centuries...&lt;/i&gt;&quot;&gt;&gt; \

&lt;&lt;elseif $i eq 3&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; reads the third passage.
&lt;&lt;MerchantTalk &quot;&lt;i&gt;Yesterday, a strange fellow visited me. Noble of blood, wise and learned in magic. He called himself the Redeemer, and asked for my help in journeying to the Old City of Netheryn. He would not tell me why. I refused him. No good can come of that place. The portal is shut. The Void Gem has disappeared. He should leave the past, the portal, and ME alone!&lt;/i&gt;&quot;&gt;&gt; \

&lt;&lt;elseif $i eq 4&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; reads the fourth passage.
&lt;&lt;MerchantTalk &quot;&lt;i&gt;Ever since the Redeemer visited me, my already fragile mind feels near to breaking. I forget, sometimes, my duty. Who am I guarding? A Queen&#39;s corpse? Why? From what? I am the last duke of Netheryn. Am I not its heir? Am I not owed fealty? Power? The right to RULE!?&lt;/i&gt;&quot;&gt;&gt; \

It seems that &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; was not always so mad with power. The Redeemer somehow corrupted his mind.

&lt;&lt;elseif $i eq 5&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; reads the last passage.
&lt;&lt;MerchantTalk &quot;&lt;i&gt;The Redeemer has the Void Gem! Somehow, he found it! No matter, no matter at all. I will take it from him... yes. The idiot wishes to destroy the world with the Void&#39;s power. Fool! I shall rule it! As it my right! I AM DUKE CARNAX - HEIR TO NETHERYN! LORD OF ALL!&lt;/i&gt;&quot;&gt;&gt; \

There is nothing else after this entry, but for crude drawings of men and women bowing before the duke.
&lt;&lt;/if&gt;&gt;

[[Read the first entry-&gt;Study][$i = 1]]
[[Read the second entry-&gt;Study][$i = 2]]
[[Read the third entry-&gt;Study][$i = 3]]
[[Read the fourth entry-&gt;Study][$i = 4]]
[[Read the last entry-&gt;Study][$i = 5]]
[[Return-&gt;Palace1][$p = 2]]
\
&lt;&lt;if $witchlove eq 18&gt;&gt;[[You spot Lilith&#39;s Kiss-&gt;Witch Lewd][$p = 43]] &lt;&lt;/if&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="122" name="SpecialBattle1" tags="" position="1075,19" size="100,100">&lt;&lt;if $p eq 10&gt;&gt; &lt;&lt;Aura&gt;&gt;\
\
You are fighting $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;i&gt;&lt;&lt;ItemAbilityRun&gt;&gt;&lt;&lt;if ($battlecount eq 0) and ($setbonus gte 1)&gt;&gt;&lt;&lt;SetBonus&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/i&gt;
\
&lt;&lt;if $stun lte 0&gt;&gt; &lt;&lt;set $action = &quot;notstun&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;if $stun gte 1&gt;&gt;&lt;&lt;set $action = &quot;stun&quot;&gt;&gt;&lt;&lt;set $stun -= 1&gt;&gt;You are stunned, and cannot take action!&lt;&lt;else&gt;&gt;\
\
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt;&lt;b&gt;Combat Points&lt;/b&gt;: $combatpoints / 5 
&lt;&lt;/if&gt;&gt;\
&lt;b&gt;General Actions&lt;/b&gt;:
&lt;&lt;link &quot;Attack&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;attack&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;if $flee eq 1&gt;&gt;&lt;&lt;link &quot;Flee&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;flee&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;i&gt;You cannot flee from this battle!&lt;/i&gt;&lt;&lt;/if&gt;&gt;

&lt;table class=&quot;stat-table&quot;&gt;\
&lt;td&gt;\
&lt;b&gt;Class Abilities&lt;/b&gt;:
&lt;&lt;for _i to 0; _i lt $abilityinventory.length; _i++&gt;&gt;\
&lt;&lt;print $abilityinventory[_i].name&gt;&gt; (Mana cost: $abilityinventory[_i].mana )\
&lt;&lt;capture _i&gt;&gt;\
		&lt;&lt;if $currentmana lt $abilityinventory[_i].mana&gt;&gt;&lt;i&gt;Not enough mana&lt;/i&gt;&lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($combatpoints lt $abilityinventory[_i].combatcost)&gt;&gt;&lt;i&gt;Not enough Combat Points&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;ability&quot;&gt;&gt; &lt;&lt;set $ability = $abilityinventory[_i].widgetname&gt;&gt; &lt;&lt;set $abilitymana = $abilityinventory[_i].mana&gt;&gt; &lt;&lt;set $abilitylevel = $abilityinventory[_i].level&gt;&gt; &lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;/td&gt;\
&lt;td&gt;\
&lt;b&gt;Items ($potioncount / 10)&lt;/b&gt;:
&lt;&lt;if $potioncount gte 10&gt;&gt;&lt;i&gt;You can only drink up to 10 potions in a single battle!&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;&lt;for _i to 0; _i lt $iteminventory.length; _i++&gt;&gt;\
&lt;&lt;print $iteminventory[_i].name&gt;&gt; (Quantity: &lt;&lt;print $iteminventory[_i].quantity&gt;&gt;) \
&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $iteminventory[_i].quantity lte 0&gt;&gt; &lt;i&gt;None left&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt; &lt;&lt;set $action = &quot;item&quot;&gt;&gt; &lt;&lt;set $item = $iteminventory[_i].name&gt;&gt;
			&lt;&lt;set $iteminventory[_i].quantity -= 1&gt;&gt;\
			&lt;&lt;set $itemstrength = $iteminventory[_i].strength&gt;&gt;\
			&lt;&lt;set $itemagility = $iteminventory[_i].agility&gt;&gt;\
			&lt;&lt;set $itemwillpower = $iteminventory[_i].willpower&gt;&gt;\
			&lt;&lt;set $itemarmor = $iteminventory[_i].armor&gt;&gt;\
			&lt;&lt;set $itemhealth = $iteminventory[_i].health&gt;&gt;\
			&lt;&lt;set $itemmana = $iteminventory[_i].mana&gt;&gt;\
			&lt;&lt;set $itemevadescore = $iteminventory[_i].evadescore&gt;&gt;\
			&lt;&lt;set $potioncount += 1&gt;&gt;\
			&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;/td&gt;\
&lt;/table&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;stun&quot;&gt;&gt; &lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;
\
&lt;&lt;set $battlecount += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 11&gt;&gt; 
You are fighting a $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;

&lt;&lt;if $action eq &quot;attack&quot;&gt;&gt;You attempt to hit the $enemyname with your $weapon!

&lt;&lt;AttackAttempt&gt;&gt;
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;You deal damage to the $enemyname!

&lt;&lt;AttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;flee&quot;&gt;&gt;You attempt to flee from the $enemyname!

&lt;&lt;FleeAttempt&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;ability&quot;&gt;&gt;&lt;&lt;Ability $ability&gt;&gt;&lt;&lt;/Ability&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $action eq &quot;item&quot;&gt;&gt;You used your $item!
&lt;&lt;ItemImage $item 150&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;
&lt;&lt;ItemUse&gt;&gt;
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth lt $enemyspecialhealth&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $enemycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;The enemy is slain! Victory!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $action eq &quot;flee success&quot;&gt;&gt;&lt;&lt;link &quot;You escape!&quot; $passage&gt;&gt;&lt;&lt;set $p = 19&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\

&lt;&lt;elseif $p eq 12&gt;&gt; 
You are fighting a $enemyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;EnemyStun&gt;&gt;
\
&lt;&lt;if $enemyaction eq &quot;attack&quot;&gt;&gt;The $enemyname attacks you!

&lt;&lt;EnemyAttackAttempt&gt;&gt;

&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;The $enemyname deals damage to you!

&lt;&lt;EnemyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if ($enemyaction neq &quot;stun&quot;) and ($enemyaction neq &quot;attack&quot;) and ($enemyaction neq &quot;attack success&quot;) and ($enemyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;EnemyAbility $enemyaction&gt;&gt;&lt;&lt;/EnemyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]]&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Player turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;

&lt;&lt;elseif $p eq 19&gt;&gt; 
You flee from the $enemyname - better to bandage your wounds and do battle another day than foolishly fight to the death.

As you near the safety of the cabin, you realize your coin purse is a bit lighter than before. Some gold pieces must have fallen out while you were running away.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $goldloss = $enemymaxgold&gt;&gt; \
&lt;&lt;set $gold -= $goldloss&gt;&gt; \
\
&lt;&lt;BattleEnd&gt;&gt;\
\
\
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
This page should not come up, as you should be out of the $passage passage and into the $returnpassage passage.

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="123" name="Interlude3" tags="" position="1594,1864" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;\
Your thoughts shift through a liquid haze.

Consciousness slips. @@.delayed;Frays.@@ @@.delayed;Fades Away.@@

@@.delayed;Memories...@@

@@.delayed;&lt;&lt;OldHeroTalk &quot;My lord, I leave for the Deep Woods today.&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;KingTalk &quot;And?&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;OldHeroTalk &quot;Last we spoke, you mentioned a dream you had. Was it about my mission?&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;KingTalk &quot;Yes... yes it was. My advisors tell me to ignore it, yet I cannot. $name, I have dreamed that all my mistakes, all my failings, have come to fester in the Deep Woods.&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;OldHeroTalk &quot;I do not understand.&quot;&gt;&gt; @@ \
@@.delayed; @@ \

@@.delayed; [[...-&gt;Interlude3][$p = 1]] 
@@

&lt;&lt;elseif $p eq 1&gt;&gt;\
@@.delayed; @@ \
@@.delayed;&lt;&lt;KingTalk &quot;Do you remember Hadamshal? That last bastion of the Elves? You proved yourself a hero the day it fell.&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;OldHeroTalk &quot;Yes, my lord.&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;KingTalk &quot;We created something evil, that day. Me by giving the order, you by following it through. The Deep Woods... that is where the wrong must be righted.&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;OldHeroTalk &quot;You speak in riddles, but such is the way with dreams. I will purge the Deep Woods, if doing so will clear your conscience.&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;KingTalk &quot;&lt;i&gt;My&lt;/i&gt; conscience? $startingname... what of &lt;i&gt;yours&lt;/i&gt;?&quot;&gt;&gt; @@ \

@@.delayed; [[Awaken-&gt;Interlude3][$p = 2]] 
@@

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;redeemer&quot;&gt;&gt;\
\
You awaken to sunlight, streaming into your cabin. You&#39;re lying on your bed, your wounds from your battle with &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt; bandaged. Burns cover much of your body.
&lt;img src=&quot;Images/Locations/morning2.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;What... what happened?&quot;&gt;&gt;\
The next moment, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, looms over you.
&lt;&lt;NayaTalk &quot;You&#39;re awake.&quot;&gt;&gt;\
At the sight of her face, it all comes rushing back. The battle with &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt;. &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&#39;s&lt;/b&gt;&lt;/span&gt; betrayal. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; lies.
&lt;&lt;HeroTalk &quot;You-&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Be still, $name. I will tell you everything.&quot;&gt;&gt;\

[[She begins-&gt;Interlude3][$p = 3]]

&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
&lt;&lt;set $daynumber += 1&gt;&gt;\
&lt;&lt;set $time = &quot;Morning&quot;&gt;&gt;\
\
&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;NayaTalk &quot;When Hadamshal fell, I lost everything. My parents. My home. My people. Only Nendel and I remained.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Thankfully, some of our servants thought to rescue some gold pieces and jewels to pay off bribes and keep us safe from the Deathguard. One of those jewels... was the Void Gem.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;My brother is a scholar in Elven lore. He knew all about the fall of Netheryn. But he, like everyone else, thought the Void Gem lost to time. As it turns out, Netheryn refugees - our ancestors - brought the Gem with them when then fled to Hadamshal, fourteen hundred years ago. It was locked away and forgotten about.&quot;&gt;&gt;\

[[She takes a breath-&gt;Interlude3][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;NayaTalk &quot;My brother became obsessed with finding a way to destroy the Void Gem. He saw it as too dangerous to leave intact. The way I see it, he could not forgive himself for the destruction of Hadamshal and our parents&#39; deaths. The quest to destroy the Gem distracted him. Made him feel like he was doing good.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Character/nendel1.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;The change happened so slowly, not even I noticed it. The Gem &lt;i&gt;does not want to be destroyed&lt;/i&gt;. It wormed its way into my brother&#39;s mind. It found his darkest emotions - his guilt, his anger - and used them to its advantage.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;As time passed, his hatred for humans grew. His quest shifted from destroying the Gem to &lt;i&gt;using&lt;/i&gt; it - reactivating the Dark Portal and letting the Void consume the world. He wished to finish what Netheryn started.&quot;&gt;&gt;\

[[She looks at you-&gt;Interlude3][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;NayaTalk &quot;It was Gresh, the Goblin King, who saved us all. In the last moment, as the Dark Portal opened, he stole the Void Gem from my brother and fled.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Outskirts/gresh1.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;Once the Gem was out of his possession, a bit of Nendel&#39;s former self returned. We agreed to work together to find a Catalyst and destroy the Void Gem. Of course &lt;i&gt;he&lt;/i&gt; would never go near the Gem. He would simply help me from afar...&quot;&gt;&gt;\
Tears well in her eyes. She blinks them away.
&lt;&lt;NayaTalk &quot;But now the Gem is in control of Nendel once more. In fact, I fear it always was.&quot;&gt;&gt;\

[[Ask her why she didn&#39;t say this earlier-&gt;Interlude3][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;\

&lt;&lt;HeroTalk &quot;Why didn&#39;t you tell me this before? I could have helped.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Don&#39;t lie to me, $name. You would have stabbed Nendel in the back to prevent the world&#39;s destruction.&quot;&gt;&gt;\
She&#39;s not wrong.
&lt;&lt;NayaTalk &quot;I... I know I was a fool. I&#39;ve put everything in peril. But you have to understand, $name - he&#39;s all I have left. For most of my life, it&#39;s only been him and me. What good is the world to me, without him? I had to try... I had to...&quot;&gt;&gt;\

[[Forgive Naya-&gt;Interlude3][$p = 7, $i = 1]]
[[Do not forgive Naya-&gt;Interlude3][$p = 7, $i = 2]]

&lt;&lt;elseif $p eq 7&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;\
&lt;&lt;if $nayalove eq 21&gt;&gt;&lt;&lt;HeroTalk &quot;Naya - perhaps I haven&#39;t told you how much you mean to me. You could plunge a knife into my heart, and with my final moments I would confess my love for you.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Love...?&quot;&gt;&gt;\
Just as she starts to cry, your lips meet hers.
&lt;video loop muted autoplay src=&quot;Images/Other/kiss4.mp4&quot;&gt;&lt;/video&gt;

After a long, tender moment, you pull back.
&lt;&lt;HeroTalk &quot;But now there&#39;s something we must do.&quot;&gt;&gt;\
&lt;&lt;set $nayalove = 22&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;You were put in an impossible situation, Naya. You need no one&#39;s forgiveness... but for what it&#39;s worth, you have mine.&quot;&gt;&gt;\
\
You set a hand on her shoulder.
&lt;&lt;HeroTalk &quot;But you know what we have to do now, right? There can be no  hesitation for what&#39;s to come.&quot;&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;else&gt;&gt;\
&lt;&lt;HeroTalk &quot;You&#39;ve put us all in grave danger, Naya. I can&#39;t forgive you...&quot;&gt;&gt;\
\
You set a hand on her shoulder.
&lt;&lt;HeroTalk &quot;There is only one atonement for an error like this. Do you understand?&quot;&gt;&gt;\
&lt;&lt;set $nayalove = 5&gt;&gt;\
&lt;&lt;/if&gt;&gt;
She takes a deep breath, then nods.
&lt;&lt;NayaTalk &quot;My brother needs to die.&quot;&gt;&gt;\

[[Plan your next move-&gt;Interlude3][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;main_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;main&quot;&gt;&gt;\

Soon you, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; are gathered outside your cabin.
&lt;img src=&quot;Images/Character/team1.jpg&quot; width=750 /&gt;

&lt;&lt;NayaTalk &quot;Nendel will have returned to the Dark Heart of Netheryn - the ruins of the old capital, in the center of the Deep Woods. Luckily, the ritual to reactivate the Portal won&#39;t be easy to do alone. We might be able to catch him.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Then we have but one path to follow. The Dark Heart is a befouled land, thick with the worst kind of Voidspawn. It will be a hard journey, but we must fight our way through to the Portal, before it&#39;s too late.&quot;&gt;&gt;\
&lt;&lt;MerchantTalk &quot;$name, I will see you equipped with the finest weapons and armor seen across the land. You shall be armed like the heroes of old!&quot;&gt;&gt;\
You nod to each in turn.
&lt;&lt;HeroTalk &quot;This is it... our final chance to stop the Redeemer. Come, friends - onwards! Into the Dark Heart of the Woods!&quot;&gt;&gt;\

[[Onwards!-&gt;Outside the Cabin][$p = 0]] 
\
&lt;&lt;set $frozenquest = 30&gt;&gt;\
&lt;&lt;set $finalquest = 1&gt;&gt;\
&lt;&lt;set $countdown = 20&gt;&gt;\
\
&lt;&lt;MerchantInventory4&gt;&gt;\
&lt;&lt;set $nayastatus = 20&gt;&gt;\
&lt;&lt;set $witchstatus = 20&gt;&gt;\
&lt;&lt;set $merchantstatus = 20&gt;&gt;\
&lt;&lt;set $voidcount = 0&gt;&gt;\
\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="124" name="Dark Heart Entry" tags="" position="1794,177" size="100,100">You arrive at the edge of the Dark Heart of Netheryn.

This is the Deep Woods&#39; corrupted heart, and the seat of the long-dormant evil the Redeemer wishes to reawaken. The Void&#39;s influence is obvious, here. The sun cannot be seen. The ground cries out in anguish. The land stretches and frays as the very seams of reality are pulled apart.  
&lt;img src=&quot;Images/DarkHeart/dark1.jpg&quot; width=750 /&gt;

Somewhere within this blighted land, the Redeemer strives to reopen the Dark Portal. For the sake of the world, he must be stopped - no matter the cost.
\
&lt;&lt;nobr&gt;&gt;

&lt;&lt;set $darkeventinventory = []&gt;&gt;

&lt;&lt;if $finalquest eq 1&gt;&gt; &lt;&lt;set $darkeventinventory.push(&quot;DarkDay1&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if ($finalquest eq 3)&gt;&gt; &lt;&lt;set $darkeventinventory.push(&quot;GateApproach&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($finalquest gte 3) and ($oristatus eq 4)&gt;&gt; &lt;&lt;set $darkeventinventory.push(&quot;Ori4&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if ($finalquest gte 2) and ($finalgold eq 1)&gt;&gt; &lt;&lt;set $darkeventinventory.push(&quot;FinalGold&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if ($finalquest gte 3)&gt;&gt; &lt;&lt;set $darkeventinventory.push(&quot;VoidSentinelAttack&quot;, &quot;VoidGoblinAttack&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;


&lt;&lt;set $event = $darkeventinventory.pluck()&gt;&gt;\

&lt;&lt;/nobr&gt;&gt;
\
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $event eq &quot;DarkDay1&quot;&gt;&gt; [[Venture Forth!-&gt;DarkDay1]]
&lt;&lt;elseif $event eq &quot;VoidSentinelAttack&quot;&gt;&gt;[[Venture Forth!-&gt;VoidSentinelAttack]]
&lt;&lt;elseif $event eq &quot;VoidGoblinAttack&quot;&gt;&gt;[[Venture Forth!-&gt;VoidGoblinAttack]]
&lt;&lt;elseif $event eq &quot;Ori4&quot;&gt;&gt;[[Venture Forth!-&gt;Ori4]]
&lt;&lt;elseif $event eq &quot;FinalGold&quot;&gt;&gt;[[Venture Forth!-&gt;FinalGold]]
&lt;&lt;elseif $event eq &quot;GateApproach&quot;&gt;&gt;[[Venture Forth!-&gt;GateApproach]]

&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if ($finalquest gte 5) and ($finalquest lt 9)&gt;&gt;[[Venture to the Shadow Gate-&gt;ShadowGate]]&lt;&lt;elseif $finalquest eq 11&gt;&gt;[[Enter the Shadow Gate-&gt;Assassin]]&lt;&lt;elseif $finalquest gte 9&gt;&gt;[[Enter the Shadow Gate-&gt;CommandCenter]]&lt;&lt;/if&gt;&gt;
[[Back-&gt;Outside the Cabin]] 
\
&lt;&lt;set $p = 0&gt;&gt;\</tw-passagedata><tw-passagedata pid="125" name="Naya3" tags="" position="599,1218" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
\
\
&lt;&lt;if $time eq &quot;Night&quot;&gt;&gt;It is late, and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; is asleep. 
&lt;img src=&quot;Images/Locations/night3.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;I&#39;ll visit her in the morning.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;else&gt;&gt;\
&lt;&lt;if $music neq &quot;naya&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You approach &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; tree. 
&lt;img src=&quot;Images/Locations/tree1.jpg&quot; width=650 /&gt;

[[Speak to Naya-&gt;Naya3][$p = 1]]
[[Return-&gt;Outside the Cabin]]
&lt;&lt;if $nayalove eq 22&gt;&gt;[[Speak to Naya about your relationship-&gt;Naya Lewd][$p = 37]]&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;NayaTalk &quot;$name, how can I help?&quot;&gt;&gt;\
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

[[Ask about Hadamshal-&gt;Naya3][$p = 2]]
[[Ask about her life after Hadamshal-&gt;Naya3][$p = 4]]
[[Ask about Nendel&#39;s fall-&gt;Naya3][$p = 5]]
[[Ask about the Dark Heart of Netheryn-&gt;Naya3][$p = 7]]
&lt;&lt;if $domituslives eq 0&gt;&gt;[[Ask about Captain Domitus-&gt;Naya3][$p = 12]]&lt;&lt;/if&gt;&gt;
[[Return-&gt;Outside the Cabin]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;HeroTalk &quot;I wanted to talk about Hadamshal.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;I owe you that much. What would like to know?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Nendel was there in thick of the fight. He told me he saw his father, the king, fall.&quot;&gt;&gt;\
She glowers.
&lt;&lt;NayaTalk &quot;He was &lt;i&gt;my&lt;/i&gt; father, too.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course. Where were you, that dark day?&quot;&gt;&gt;\

[[She remembers-&gt;Naya3][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;NayaTalk &quot;I was only six years old. The servants kept me hidden in the crypts, underground.&quot;&gt;&gt;\
She shuts her eyes, remembering.
&lt;&lt;NayaTalk &quot;There was a secret passage out of the city, from the crypts. Me and Nendel were smuggled through it... but tell me, $name: You said you were part of the attack on Hadamshal. What was your role?&quot;&gt;&gt;\
You stiffen at the question.
&lt;&lt;HeroTalk &quot;I was a new recruit. When the battle began, I was thrown into the front and fought for my life.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;I see.&quot;&gt;&gt;\
She lets a long a sigh, letting the past return to where it belongs.
&lt;&lt;NayaTalk &quot;For what it&#39;s worth, I&#39;m glad you lived.&quot;&gt;&gt;\

[[Ask something else-&gt;Naya3][$p = 1]]
[[Leave her be-&gt;Outside the Cabin][$p = 0]] 

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;HeroTalk &quot;I wanted to ask about your life after Hadamshal. What was it like?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Considerably different from being a princess, I assure you. Of course, I&#39;ve spent most of my childhood on the run - so honestly, it quickly felt normal. Nendel, though, he never got used to it. He always yearned to somehow reclaim his birthright.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You call it normal, but it must have been a rough road.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Of course, but we had friends - Elves and humans alike. They managed to keep us one step ahead of the Deathguard. Barely.&quot;&gt;&gt;\

[[Ask something else-&gt;Naya3][$p = 1]]
[[Leave her be-&gt;Outside the Cabin][$p = 0]] 

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;HeroTalk &quot;I wanted to ask about Nendel&#39;s fall. How does so bright a person change into the Redeemer?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;How does a river erode a mountainside? Little by little. Ultmately, the Void Gem feeds on negative emotions. Without him realizing, it fed on his guilt, his deep-seated anger, for years. He lost his humor, his kindness, his hope. He stopped seeing humans as people. They were simply enemies, to be destroyed.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Did he resist it?&quot;&gt;&gt;\
She nods.
&lt;&lt;NayaTalk &quot;I like to believe he did. I like to believe he fought against it for ten years. But he never confided anything in me. He thought I had enough to worry about... if only...&quot;&gt;&gt;\

[[She stops herself-&gt;Naya3][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
&lt;&lt;NayaTalk &quot;I was going to say, &lt;i&gt;if only I could speak to him again, I could bring him back.&lt;/i&gt;&quot;&gt;&gt;\
She shakes her head.
&lt;&lt;NayaTalk &quot;That&#39;s the very same foolishness that got us into this mess in the first place. My brother is gone. The Redeemer is all that remains... and he must be destroyed.&quot;&gt;&gt;\

[[Ask something else-&gt;Naya3][$p = 1]]
[[Leave her be-&gt;Outside the Cabin][$p = 0]] 

&lt;&lt;elseif $p eq 7&gt;&gt;\
&lt;&lt;HeroTalk &quot;What do you know about the Dark Heart of Netheryn?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;I&#39;m no historian - that was my brother&#39;s talent. But I know a little. It was once the Capital of the kingdom of Netheryn. A grand city, full of ancient trees and gleaming towers, right in the heart of the Deep Woods.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;And now?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;When the Netheryn mages first opened the Dark Portal, it was in the Capital. The Void consumed the city. Feasted on the souls of its populace. Twisted and warped its towers, its trees. It is a blighted land, where the laws of the mundane world do not always apply.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;... I see. I will be cautious.&quot;&gt;&gt;\

[[Ask something else-&gt;Naya3][$p = 1]]
[[Leave her be-&gt;Outside the Cabin][$p = 0]] 
\
&lt;&lt;elseif $p eq 8&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;
It&#39;s &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, looking surprisingly hopeful.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;I know how to navigate the Dark Heart of Netheryn.&quot;&gt;&gt;\
You gesture her inside.
&lt;&lt;HeroTalk &quot;Go on.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;The Void&#39;s corruption doesn&#39;t &lt;i&gt;literally&lt;/i&gt; mix up the lay of the land - it&#39;s more subtle. It bends, frays, and eventually tears at the threads of Tylae&#39;s creation.&quot;&gt;&gt;\
Such theological matters are beyond you.
&lt;&lt;HeroTalk &quot;What does that mean?&quot;&gt;&gt;\

[[Naya explains-&gt;Naya3][$p = 9]]

&lt;&lt;elseif $p eq 9&gt;&gt;\
&lt;&lt;NayaTalk &quot;It means the fabric of reality is loose in the Deep Woods&#39; heart - and we can use that to our advantage.&quot;&gt;&gt;\
At your blank look, she sighs.
&lt;&lt;NayaTalk &quot;The threads of the world are yours for the taking, $name. If you &lt;i&gt;think&lt;/i&gt; about a location, it will be &lt;i&gt;drawn&lt;/i&gt; to you. Distance no longer matters. Getting anywhere in the Dark Heart is a matter of fate, luck, and sheer force of will.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;So if I think of the Dark Portal...&quot;&gt;&gt;\
But &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; shakes her head.
&lt;&lt;NayaTalk &quot;It&#39;s not teleportation, it&#39;s more a bending of the world. We&#39;ll have to do it landmark by landmark, until we get to the Temple of Eternity.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;And what&#39;s the first landmark?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;It&#39;s called the Shadow Gate.&quot;&gt;&gt;\

[[The Shadow Gate?-&gt;Naya3][$p = 10]]

&lt;&lt;elseif $p eq 10&gt;&gt;\
&lt;&lt;NayaTalk &quot;It is the entryway into the old Capital of Netheryn. If we&#39;re to get to the Dark Portal, we first need to cross the gate.&quot;&gt;&gt;\
&lt;img src=&quot;Images/DarkHeart/misc3.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;So if I think of this gate, I&#39;ll arrive there?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;It took my brother a few tries to get the hang of it, but... yes. I&#39;ll try the same, and we&#39;ll see who succeeds first.&quot;&gt;&gt;\

You see little reason to delay any further. the Shadow Gate awaits.

[[Onwards!-&gt;Outside the Cabin]] 
\
&lt;&lt;set $finalquest = 3&gt;&gt;\
\
&lt;&lt;elseif $p eq 11&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;

When you speak with &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, she doesn&#39;t seem to take the news well.
&lt;&lt;NayaTalk &quot;The Deathguard... always getting in the way. We don&#39;t have time to fight with them. &quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Perhaps we could negotiate with them... bring them to our side?&quot;&gt;&gt;\
She shakes her head.
&lt;&lt;NayaTalk &quot;Don&#39;t be a fool, $name. I&#39;m an elf, and you&#39;re wanted for treason against your Kingdom.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;We have to try.&quot;&gt;&gt;\

[[Depart-&gt;Outside the Cabin]] 
\
&lt;&lt;set $finalquest = 5&gt;&gt;\
\
&lt;&lt;elseif $p eq 12&gt;&gt;\
&lt;&lt;HeroTalk &quot;I wanted to speak to you about Domitus. What he said-&quot;&gt;&gt;\
She shakes her head.
&lt;&lt;NayaTalk &quot;A dark revelation, but it does not weigh on my heart. In fact, I was glad to hear it.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Glad?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;It always hurt me, to think some headstrong elf would attack a human ambassador on a mission of peace. The truth - that it was human cruelty, not elven malice - that destroyed Hadamshal, it... fits. It puts me at peace.&quot;&gt;&gt;\

[[And as for Domitus?-&gt;Naya3][$p = 13]]

&lt;&lt;elseif $p eq 13&gt;&gt;\
&lt;&lt;HeroTalk &quot;When Domitus confessed, your reaction was swift.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;He was dying, anyway. What I did was mercy.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;More than mercy. You avenged your homeland.&quot;&gt;&gt;\
She sighs, then looks down at her empty palms.
&lt;&lt;NayaTalk &quot;And what did I get for my vengence? Nothing. If only my brother could understand that.&quot;&gt;&gt;\

[[Ask something else-&gt;Naya3][$p = 1]]
[[Leave her be-&gt;Outside the Cabin][$p = 0]] 

&lt;&lt;elseif $p eq 14&gt;&gt;


































&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="126" name="DarkDay1" tags="" position="1800,287" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
You begin your first foray into the Dark Heart of Netheryn full of grim purpose and dauntless resolve. The Redeemer &lt;i&gt;will&lt;/i&gt; be found. He &lt;i&gt;will&lt;/i&gt; be stopped. Failure is not an option.

Ready for anything, you push deep into the haunted woodland. You&#39;ve never seen anything quite like the rotted heart of the Deep Woods. Light is dim, even at midday. A cold, dark shroud blankets everything, chilling your soul with every breath. Everything feels dead, or rotting.
&lt;img src=&quot;Images/DarkHeart/dark2.jpg&quot; width=700 /&gt;

[[Get your bearings-&gt;DarkDay1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
You do your best to get your bearings - to find a landmark, and gain a better sense of direction. Yet this proves to be an impossible task. The sky is a slate of writhing darkness. Your sense of north tends to &lt;i&gt;drift&lt;/i&gt;, though that should be impossible. Following any one direction sends you in circles.
&lt;&lt;HeroTalk &quot;Something is terribly wrong with this place.&quot;&gt;&gt;\

[[From the dark, you hear cruel laughter-&gt;DarkDay1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
You draw your $weapon, ready for combat.
&lt;&lt;HeroTalk &quot;Who&#39;s there? Show yourself!&quot;&gt;&gt;\
More laughter. This time from behind you. Gritting your teeth, you circle slowly - around you is nothing but warped trees, blocking your sight.
&lt;&lt;VoidGoblinTalk &quot;&lt;i&gt;Too late... too late... $name is far too late.&lt;/i&gt;&quot;&gt;&gt;\
A second voice picks up the song.
&lt;&lt;VoidGoblinTalk &quot;&lt;i&gt;Too late... too late... and now it&#39;s time to die.&lt;/i&gt;&quot;&gt;&gt;\

[[Your enemies show themselves-&gt;DarkDay1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle8_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
They step out from behind the trees. Your eyes struggle to make sense of what your seeing. The rough shape of a goblin, but with skin that shifts and slips like mist.
&lt;img src=&quot;Images/DarkHeart/void3.jpg&quot; width=450 /&gt;

&lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&#39;s&lt;/b&gt;&lt;/span&gt; kin, swallowed by the Void.
&lt;&lt;VoidGoblinTalk &quot;&lt;i&gt;You never should have come here.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;ve no time for trading taunts. Either attack, or flee.&quot;&gt;&gt;\
&lt;&lt;VoidGoblinTalk &quot;&lt;i&gt;So confident. Too confident. Your soul we will eat. Your body shall serve the Void!&lt;/i&gt;&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;EnemyAllyBattle2&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidGoblinStats&gt;&gt; 
&lt;&lt;VoidGoblinEnemyStats&gt;&gt; 

&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
The goblins fall to the ground, screaming hideously as their bodies break apart. Long after they&#39;re gone, their dying cries echo through the wood.
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

Then, you hear someone approaching from behind.
&lt;&lt;HeroTalk &quot;What now...&quot;&gt;&gt;\

[[Face your foe-&gt;DarkDay1][$p = 21]]

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
Turning, you see its only &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;This place is a nightmare.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Agreed. And it won&#39;t be easy to find the Dark Portal. Have you felt it, how &lt;i&gt;place&lt;/i&gt; seems to have no meaning here? The woods shift around us, sending us in circles.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;ve felt it. There must be some solution.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Yes, my brother figured out a way to deal with the trouble. Let me think on it - I&#39;ll find you in the morning.&quot;&gt;&gt;\

[[You and Naya decide to return to the cabin-&gt;DarkDay1][$p = 22]]

&lt;&lt;set $finalquest = 2&gt;&gt;\
&lt;&lt;set $finalgold = 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 22&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;i&gt;
@@.delayed;Meanwhile...@@

@@.delayed;... in the ruins of the Winter Palace@@
&lt;/i&gt;
@@.delayed;[[...-&gt;DarkDay1][$p = 23]] @@

&lt;&lt;elseif $p eq 23&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer2_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;redeemer&quot;&gt;&gt;\
\
Deep in the charred ruins of the Winter Palace, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/span&gt; walks through an ancient crypt.
&lt;img src=&quot;Images/FrozenHills/palace11.jpg&quot; width=750 /&gt;

&lt;&lt;Redeemer4Talk &quot;Fourteen hundred years ago, the wise Queen Domedra commanded her mages to open a portal to the Void. And to vanquish it.&quot;&gt;&gt; \
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/span&gt; approaches the single cursed tomb at the far end of the crypt.
&lt;&lt;Redeemer4Talk &quot;But the mages were betrayed. For the Queen had no intention of vanquishing the Void. No, she knew such a thing was impossible.&quot;&gt;&gt; \
He sets his hands upon the cold stone. Old magic stirs within.
&lt;&lt;Redeemer4Talk &quot;She did not care. For Queen Domedra would rather end the world, than imagine a world where she did not rule.&quot;&gt;&gt; \
He taps the stone.
&lt;&lt;Redeemer4Talk &quot;Right, Domedra?&quot;&gt;&gt; \

[[The stone begins to vibrate-&gt;DarkDay1][$p = 24]]

&lt;&lt;elseif $p eq 24&gt;&gt;\
He nods, knowingly, as the vibration grows.
&lt;&lt;Redeemer4Talk &quot;For her crimes, she was locked within the Winter Palace. Not alive. Not dead. Doomed to watch the world live on without her. Though Netheryn fell... the world survived...&quot;&gt;&gt; \
&lt;img src=&quot;Images/FrozenHills/palace12.jpg&quot; width=500 /&gt;

&lt;&lt;Redeemer4Talk &quot;Domedra! As heir to Hadamshal and Netheryn, heed my words! Your curse is through! Rise, Domedra. &lt;i&gt;Rise, and aid me in finishing what you started!&lt;/i&gt;&quot;&gt;&gt; \
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/span&gt; raises the Void Gem over the tomb.
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=450 /&gt;

[[The Gem flashes, and the tomb crumbles-&gt;DarkDay1][$p = 25]]

&lt;&lt;elseif $p eq 25&gt;&gt;\
From the ruins rises a single figure - a queen, as noble and beautiful as the day she was buried. She wears a funeral dress, and is adorned with an ancient, black crown.
&lt;img src=&quot;Images/Character/domedra1.jpg&quot; width=450 /&gt;

&lt;&lt;DomedraTalk &quot;... I am awakened.&quot;&gt;&gt; \
&lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Domedra&lt;/b&gt;&lt;/span&gt; looks around the ruined crypt.
&lt;&lt;DomedraTalk &quot;... so foul, the air has grown. Tainted by human lungs.&quot;&gt;&gt; \
She eyes her savior.
&lt;&lt;DomedraTalk &quot;Long have I slept, Prince Nendel&#39;ar of Hadamshal. But I dreamed. Cursed to dream of the fall of elves. Cursed to watch this wretched world limp on, sick beyond all healing.&quot;&gt;&gt; \
&lt;&lt;Redeemer4Talk &quot;Now the time has come to end it. The Void Gem is ours. The portal need only be reopened.&quot;&gt;&gt; \
&lt;&lt;DomedraTalk &quot;We shall not waste time. The Temple of Eternity awaits.&quot;&gt;&gt; \

[[Without another word, the two leave the Winter Palace-&gt;Outside the Cabin]] 
\
\
\
\
\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="127" name="ShadowGate" tags="" position="1934,180" size="100,100">&lt;&lt;if $finalquest eq 5&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;deathguard1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\

As you near the Shadow Gate, you spot &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, spying on the gate - and the Deathguard - from afar.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Naya, what do your elf eyes see?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Actually, elven eyes are only as good as human eyes. Sometimes worse.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Oh.&quot;&gt;&gt;\
Together, the two of you study the war camp that stands before the Shadow Gate. The Deathguard have set up four catapults, but the siege engines don&#39;t seem to be having any effect against the Gate or the wall.
&lt;&lt;HeroTalk &quot;A magic Gate needs to be handled with magic. This siege is a waste of time.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;So, shall we go down and tell them that?&quot;&gt;&gt;\
You don&#39;t see any other option. You only pray that &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Domitus&lt;/b&gt;&lt;/span&gt; is in a good mood.

[[Approach the camp-&gt;ShadowGate][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
As you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; approach the camp, it isn&#39;t long before the scouts spot you.
&lt;img src=&quot;Images/DarkHeart/misc3.jpg&quot; width=600 /&gt;
&lt;&lt;DeathguardTalk &quot;The elf bitch and the traitor! They&#39;re here!&quot;&gt;&gt;\
Thirty soldiers come running, weapons bared. You stand your ground, not even flinching, as you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; are quickly surrounded.
&lt;&lt;HeroTalk &quot;I need to speak to your captain.&quot;&gt;&gt;\
&lt;&lt;if ($fem eq 1) and ($gender eq &quot;female&quot;)&gt;&gt;&lt;&lt;DeathguardTalk &quot;Our captain&#39;s orders are to kill you on sight. Although, I&#39;m, pretty sure the traitor was a man. You have his eyes, but...&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;DeathguardTalk &quot;Our captain&#39;s orders are to kill you on sight.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if ($fem eq 1) and ($gender eq &quot;female&quot;)&gt;&gt;&lt;&lt;HeroTalk &quot;Man or woman, I&#39;m still the one who defeated Domitus in the Tower of Zyr. Will one of you succeed where he failed?&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;I bested him in the Tower of Zyr. Which of you wants to try me first?&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
There&#39;s a bit of grumbling from the Deathguard soldiers.
&lt;&lt;DeathguardTalk &quot;I&#39;ll bring the captain.&quot;&gt;&gt;\

[[Wait for Domitus-&gt;ShadowGate][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
It doesn&#39;t take long for &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; to arrive.
&lt;img src=&quot;Images/Character/deathguard1.jpg&quot; width=600 /&gt;

&lt;&lt;if ($fem eq 1) and ($gender eq &quot;female&quot;)&gt;&gt;&lt;&lt;DomitusTalk &quot;$startingname $startingtitle - or, I suppose its $name $title, now. And Naya of Hadamshal, too. The king eagerly awaits both of your severed heads.&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;DomitusTalk &quot;$name $title, and Naya of Hadamshal. The king eagerly awaits both of your severed heads.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
But then a woman steps beside him. &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt;, the king&#39;s messenger.
&lt;img src=&quot;Images/Character/messenger1.jpg&quot; width=450 /&gt;

&lt;&lt;MessengerTalk &quot;No, Domitus. Our new orders are only to stop the evil in the Deep Woods. We have no quarry with these two.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Brunhilde, you&#39;re a welcome sight.&quot;&gt;&gt;\
She gives you a brief dip of her chin.
&lt;&lt;MessengerTalk &quot;We all share an enemy in the Redeemer. Come, let us speak.&quot;&gt;&gt;\

[[Domitus turns on her-&gt;ShadowGate][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;DomitusTalk &quot;Careful, Brunhilde. You may represent the king, but my word is law among the Deathguard.&quot;&gt;&gt;\
He turns back to you.
&lt;&lt;DomitusTalk &quot;And &lt;i&gt;you&lt;/i&gt;, $name. I&#39;ve been meaning to finish what we started in that cursed Tower. The Redeemer can wait. You and I - we finish this - now!&quot;&gt;&gt;\

[[Duel Domitus-&gt;DomitusBattle][$p = 0, $i = 1]]
[[Try to make him see reason-&gt;DomitusBattle][$p = 0, $i = 2]]

&lt;&lt;elseif $p eq 4&gt;&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $finalquest eq 7&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
As you approach the Shadow Gate, you spot &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/team2.jpg&quot; width=700 /&gt;

&lt;&lt;WitchTalk &quot;So, we&#39;ve allied with the Deathguard.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Desperate times bring desperate measures.&quot;&gt;&gt;\
They see you approach.
&lt;&lt;HeroTalk &quot;Are you ready?&quot;&gt;&gt;\
The priestess nods.
&lt;&lt;WitchTalk &quot;By Tylae&#39;s light, we shall succeed.&quot;&gt;&gt;\

[[Descend to the camp-&gt;ShadowGate][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
Before you looms the Shadow Gate. Somehow, it seems even taller than yesterday. Your eyes are playing tricks on you, or perhaps reality is bending in favor of the Redeemer.
&lt;img src=&quot;Images/DarkHeart/misc3.jpg&quot; width=600 /&gt;

The Deathguard stand ready, their shields facing the Gate. At their head, &lt;&lt;if $domituslives eq 1&gt;&gt;&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt;&lt;&lt;else&gt;&gt;&lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; &lt;&lt;/if&gt;&gt; looks ready for anything.

You and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; step between them and the gate. She raises her staff over her head.
&lt;&lt;WitchTalk &quot;Once I begin the spell, the Gate will react in self-defense. All manner of horrors may pour from it. I must be protected.&quot;&gt;&gt;\
&lt;&lt;if $domituslives eq 1&gt;&gt;&lt;&lt;DomitusTalk &quot;Then you&#39;re in luck, witch. Slaying horrors is what Deathguard are best at.&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;We shall not falter!&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;MessengerTalk &quot;The Deathguard will hold. Isn&#39;t that right, men?&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;Yes, Lady Brunhilde!&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;HeroTalk &quot;Then we are ready. Scyllia, open this gate!&quot;&gt;&gt;\

[[She begins-&gt;ShadowGate][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle8_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
A globe of light forms around &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;. Then, from her hand, a fiery beam of light surges forth.
&lt;img src=&quot;Images/DarkHeart/savewitch4.jpg&quot; width=400 /&gt;

The moment the beam strikes the Shadow Gate, there&#39;s a horrid roar from within. Shadows gather at its base, forming into nightmare-things, all darkness and blades and unblinking eyes.
&lt;img src=&quot;Images/DarkHeart/misc6.jpg&quot; width=500 /&gt;

A powerful force of Voidspawn. at least two hundred of them.

They charge.
&lt;&lt;HeroTalk &quot;Hold your ground! Protect the priestess!&quot;&gt;&gt;\
&lt;&lt;if $domituslives eq 1&gt;&gt;&lt;&lt;DomitusTalk &quot;HOLD! I WILL CUT DOWN ANY MAN WHO FLEES!&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;MessengerTalk &quot;Stand firm - in the name of the King!&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

[[Battle is joined-&gt;ShadowGate][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
The charging Voidspawn crash into the Deathguard. The two sides lock into a fierce melee, neither daring to give an inch. You stand closest to &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, ready to take down any foe who makes it to her sphere of light.

Just as one of the Voidspawn leaps over a reeling Deathguard soldier and charges at you, it takes an elf-arrow in its throat. The next moment, it turns to dust.
&lt;&lt;HeroTalk &quot;Hail, Naya!&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;An easy target!&quot;&gt;&gt;\

&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; beam of light is burning through the Shadow Gate. It&#39;s working!
&lt;img src=&quot;Images/DarkHeart/savewitch5.jpg&quot; width=650 /&gt;

[[The Gate opens-&gt;ShadowGate][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
The weakened Gate opens, but not in defeat. From its darkened gap, a &lt;i&gt;thing&lt;/i&gt; emerges - a monster, a servant of the Void. It is formed of writhing smoke and far too many limbs. It sees &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, and cries out with a scream so horrid, even the Deathguard falter.
&lt;img src=&quot;Images/DarkHeart/greatvoid1.jpg&quot; width=500 /&gt;

&lt;&lt;WitchTalk &quot;There it is, $name. The creature from my dreams.&quot;&gt;&gt;\
The monster crawls forward on its many hands, swatting aside any Deathguard soldier foolish enough to get in its way. It&#39;s charging straight for the priestess.

[[Get between it and Scyllia-&gt;Gatekeeper][$p = 0]]
&lt;&lt;if $witchlove gte 22&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Fall back and let her face it alone&lt;/span&gt;&lt;&lt;else&gt;&gt;[[Fall back and let her face it alone-&gt;Game Over]] &lt;&lt;/if&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="128" name="Notes" tags="" position="199,1721" size="100,100">- Library
- chest in dark heart
</tw-passagedata><tw-passagedata pid="129" name="SnakeBattle1" tags="" position="932,886" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
The troll&#39;s skeleton lies where you left it. It seems of the creatures of this cave system have feasted on its flesh, for only bones remain of it.
&lt;&lt;HeroTalk &quot;You fought admirably. For a troll, at least.&quot;&gt;&gt;\

[[Retrieve its skull-&gt;SnakeBattle1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;Kneeling, you take hold of the skull. It&#39;s surprisingly heavy. Trolls must be incredibly thick-headed.
&lt;img src=&quot;Images/Outskirts/troll3.jpg&quot; width=450 /&gt;

After dropping the skull into your pack, a strange sense of foreboding strikes you. Like you&#39;re being watched. Rationally, you know you&#39;re the only living thing left in the abandoned goblin nest.

And yet, the feeling lingers.

[[It&#39;s time to leave-&gt;GoblinNest1][$p = 4]] 

&lt;&lt;set $witchstatus = 23&gt;&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
Just you step towards the entry chamber, the ground begins to shake.

The &lt;i&gt;whole cave&lt;/i&gt; is shaking. It takes all your will just to kep your footing.

Something&#39;s coming, from the depths. Something big.

[[Stand your ground-&gt;SnakeBattle1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
The closer it comes, the clearer the approaching shape appears. Long, bulky, and formed and scale and sinew. It is a serpent of the depths - those snakes of old myth that live deep in the bowels of the world.
&lt;img src=&quot;Images/Outskirts/serpent1.jpg&quot; width=550 /&gt;

Rising before you, it takes the full breadth of the cave to hold it. From its mouth comes a low, threatening hiss.

&lt;&lt;SerpentTalk &quot;You dare return? Truly?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I mean you no harm, beast.&quot;&gt;&gt;\
It stares at you, unblinking.
&lt;&lt;SerpentTalk &quot;But you have harmed me already. Before your slaughter, this place was rich with goblin meat. Now they are scattered.&quot;&gt;&gt;\
Saliva drips from the serpent&#39;s mouth.

[[Bribe the serpent-&gt;SnakeBattle1][$p = 4, $i = 1]]
[[Reason with the serpent-&gt;SnakeBattle1][$p = 4, $i = 2]]
[[Attack the serpent-&gt;SnakeBattle1][$p = 4, $i = 3]]

&lt;&lt;elseif $p eq 4&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dragon1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dragon&quot;&gt;&gt;\
\
&lt;&lt;if $i eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;If I&#39;ve offended you, allow me to make it right.&quot;&gt;&gt;\
&lt;&lt;SerpentTalk &quot;Oh, you will. I haven&#39;t tasted human in quite some time. This will be meal to remember!&quot;&gt;&gt;\
\
&lt;&lt;elseif $i eq 2&gt;&gt;\
&lt;&lt;HeroTalk &quot;Goblins migrate from place to place. Whether I attacked them doesn&#39;t matter - they&#39;d have left soon anyway.&quot;&gt;&gt;\
&lt;&lt;SerpentTalk &quot;Such a delectable little lie. I wonder, will you taste as good? This will be meal to remember!&quot;&gt;&gt;\
\
&lt;&lt;else&gt;&gt;You don&#39;t bother trading words with the beast. From the moment it laid eyes on you, it had made up its mind.
&lt;&lt;HeroTalk &quot;Come, then. I&#39;ve slain worse than you.&quot;&gt;&gt;\
&lt;&lt;SerpentTalk &quot;I doubt it...&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;SerpentStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;\
\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;witch1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;witch&quot;&gt;&gt;\
the serpent falters.
&lt;&lt;SerpentTalk &quot;So... hungry...&quot;&gt;&gt;\
Then it curls up and dies.
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

You find the Serpent Boots! 

[[It is done-&gt;GoblinNest1][$p = 3]]
\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $witchstatus = 24&gt;&gt;\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $feetinventory.push($serpentboots)&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="130" name="WorldEnds" tags="" position="398,1410" size="100,100">&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer2_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;redeemer&quot;&gt;&gt;\
Stepping outside, you see it&#39;s too late. The portal has opened.

The world is being consumed.
&lt;img src=&quot;Images/DarkHeart/end1.jpg&quot; width=800 /&gt;

&lt;&lt;HeroTalk &quot;... I&#39;ve failed...&quot;&gt;&gt;\
The void widens, swallowing everything.

[[Shut your eyes-&gt;Game Over]] </tw-passagedata><tw-passagedata pid="131" name="EnemyAllyBattle2" tags="" position="1203,18" size="100,100">&lt;&lt;if $p eq 10&gt;&gt; &lt;&lt;Aura&gt;&gt;\
\
You are fighting $enemyname and $enemyallyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;i&gt;&lt;&lt;ItemAbilityRun&gt;&gt;&lt;&lt;if ($battlecount eq 0) and ($setbonus gte 1)&gt;&gt;&lt;&lt;SetBonus&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/i&gt;
\
&lt;&lt;if $allyturn eq 1&gt;&gt; &lt;&lt;set $allyturn = 0&gt;&gt; &lt;&lt;else&gt;&gt; &lt;&lt;set $allyturn = 1&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;if $stun lte 0&gt;&gt; &lt;&lt;set $action = &quot;notstun&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;if $stun gte 1&gt;&gt;&lt;&lt;set $action = &quot;stun&quot;&gt;&gt;&lt;&lt;set $stun -= 1&gt;&gt;You are stunned, and cannot take action!&lt;&lt;else&gt;&gt;\
\
&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt;&lt;b&gt;Combat Points&lt;/b&gt;: $combatpoints / 5 
&lt;&lt;/if&gt;&gt;\
&lt;b&gt;General Actions&lt;/b&gt;:
&lt;&lt;link &quot;Attack&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;attack&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;if $flee eq 1&gt;&gt;&lt;&lt;link &quot;Flee&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;flee&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;i&gt;You cannot flee from this battle!&lt;/i&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;table class=&quot;stat-table&quot;&gt;\
&lt;td&gt;\
&lt;b&gt;Class Abilities&lt;/b&gt;:
&lt;&lt;for _i to 0; _i lt $abilityinventory.length; _i++&gt;&gt;\
&lt;&lt;print $abilityinventory[_i].name&gt;&gt; (Mana cost: $abilityinventory[_i].mana )\
&lt;&lt;capture _i&gt;&gt;\
		&lt;&lt;if $currentmana lt $abilityinventory[_i].mana&gt;&gt;&lt;i&gt;Not enough mana&lt;/i&gt;&lt;&lt;elseif ($class eq &quot;rogue&quot;) and ($combatpoints lt $abilityinventory[_i].combatcost)&gt;&gt;&lt;i&gt;Not enough Combat Points&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt;&lt;&lt;set $action = &quot;ability&quot;&gt;&gt; &lt;&lt;set $ability = $abilityinventory[_i].widgetname&gt;&gt; &lt;&lt;set $abilitymana = $abilityinventory[_i].mana&gt;&gt; &lt;&lt;set $abilitylevel = $abilityinventory[_i].level&gt;&gt; &lt;&lt;/link&gt;&gt; &lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;/td&gt;\
&lt;td&gt;\
&lt;b&gt;Items ($potioncount / 10)&lt;/b&gt;:
&lt;&lt;if $potioncount gte 10&gt;&gt;&lt;i&gt;You can only drink up to 10 potions in a single battle!&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;&lt;for _i to 0; _i lt $iteminventory.length; _i++&gt;&gt;\
&lt;&lt;print $iteminventory[_i].name&gt;&gt; (Quantity: &lt;&lt;print $iteminventory[_i].quantity&gt;&gt;) \
&lt;&lt;capture _i&gt;&gt;\
	&lt;&lt;if $iteminventory[_i].quantity lte 0&gt;&gt; &lt;i&gt;None left&lt;/i&gt;&lt;&lt;else&gt;&gt; &lt;&lt;link &quot;Use&quot; $passage&gt;&gt;&lt;&lt;set $p = 11&gt;&gt; &lt;&lt;set $action = &quot;item&quot;&gt;&gt; &lt;&lt;set $item = $iteminventory[_i].name&gt;&gt;
			&lt;&lt;set $iteminventory[_i].quantity -= 1&gt;&gt;\
			&lt;&lt;set $itemstrength = $iteminventory[_i].strength&gt;&gt;\
			&lt;&lt;set $itemagility = $iteminventory[_i].agility&gt;&gt;\
			&lt;&lt;set $itemwillpower = $iteminventory[_i].willpower&gt;&gt;\
			&lt;&lt;set $itemarmor = $iteminventory[_i].armor&gt;&gt;\
			&lt;&lt;set $itemhealth = $iteminventory[_i].health&gt;&gt;\
			&lt;&lt;set $itemmana = $iteminventory[_i].mana&gt;&gt;\
			&lt;&lt;set $itemevadescore = $iteminventory[_i].evadescore&gt;&gt;\
			&lt;&lt;set $potioncount += 1&gt;&gt;\
			&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;\
&lt;&lt;/for&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;/td&gt;\
&lt;/table&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;stun&quot;&gt;&gt;&lt;&lt;if $allyturn eq 1&gt;&gt;&lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $allyturn eq 0&gt;&gt;&lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 14&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Do Nothing!&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
\
&lt;&lt;EnemyAllyBattleTable&gt;&gt;\
\
&lt;&lt;set $battlecount += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 11&gt;&gt; 
You  are fighting $enemyname and $enemyallyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;

&lt;&lt;if $action eq &quot;attack&quot;&gt;&gt;You attempt to hit the $enemyname with your $weapon!

&lt;&lt;AttackAttempt&gt;&gt;
\
&lt;&lt;if $action eq &quot;attack success&quot;&gt;&gt;You deal damage to the $enemyname!

&lt;&lt;AttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $action eq &quot;flee&quot;&gt;&gt;You attempt to flee from the $enemyname!

&lt;&lt;FleeAttempt&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $action eq &quot;ability&quot;&gt;&gt;&lt;&lt;Ability $ability&gt;&gt;&lt;&lt;/Ability&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if $action eq &quot;item&quot;&gt;&gt;You used your $item!
&lt;&lt;ItemImage $item 150&gt;&gt;&lt;&lt;/ItemImage&gt;&gt;
&lt;&lt;ItemUse&gt;&gt;
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $enemycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;The enemy is slain! Victory!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $action eq &quot;flee success&quot;&gt;&gt;&lt;&lt;link &quot;You escape!&quot; $passage&gt;&gt;&lt;&lt;set $p = 19&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $allyturn eq 1&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;elseif $allyturn eq 0&gt;&gt;&lt;&lt;link &quot;Enemy&#39;s Ally turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 14&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;EnemyAllyBattleTable&gt;&gt;\
\
&lt;&lt;elseif $p eq 12&gt;&gt; \
You are fighting $enemyname and $enemyallyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;EnemyStun&gt;&gt;
\
&lt;&lt;if $enemyaction eq &quot;attack&quot;&gt;&gt;The $enemyname attacks you!

&lt;&lt;EnemyAttackAttempt&gt;&gt;

&lt;&lt;if $enemyaction eq &quot;attack success&quot;&gt;&gt;The $enemyname deals damage to you!

&lt;&lt;EnemyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if ($enemyaction neq &quot;stun&quot;) and ($enemyaction neq &quot;attack&quot;) and ($enemyaction neq &quot;attack success&quot;) and ($enemyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;EnemyAbility $enemyaction&gt;&gt;&lt;&lt;/EnemyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]]&lt;&lt;elseif $enemyallycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;the enemy&#39;s ally is slain!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Player turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;EnemyAllyBattleTable&gt;&gt;\
\
&lt;&lt;elseif $p eq 13&gt;&gt;\
\
\
You are fighting $enemyname and $enemyallyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;set $allyaction = $allyability.pluck()&gt;&gt;\
&lt;&lt;set $allyability.push($allyaction)&gt;&gt;

&lt;&lt;if $allyaction eq &quot;attack&quot;&gt;&gt;$allyname attacks $enemyname

&lt;&lt;AllyAttackAttempt&gt;&gt;

&lt;&lt;if $allyaction eq &quot;attack success&quot;&gt;&gt;The $allyname deals damage to $enemyname!

&lt;&lt;AllyAttackDamage&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
\
&lt;&lt;if ($allyaction neq &quot;attack&quot;) and ($allyaction neq &quot;attack success&quot;) and ($allyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;AllyAbility $allyaction&gt;&gt;&lt;&lt;/AllyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $enemycurrenthealth lte 0&gt;&gt;&lt;&lt;link &quot;The enemy is slain! Victory!&quot; $returnpassage&gt;&gt;&lt;&lt;set $p = 20&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;EnemyAllyBattleTable&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 14&gt;&gt;
You are fighting $enemyname and $enemyallyname!
&lt;&lt;EnemyImage $enemyregion $enemyimage 300&gt;&gt;&lt;&lt;/EnemyImage&gt;&gt;
\
&lt;&lt;set $enemyallyaction = $enemyallyability.pluck()&gt;&gt;\
&lt;&lt;set $enemyallyability.push($enemyallyaction)&gt;&gt;
\
\
&lt;&lt;if ($enemyallyaction neq &quot;attack&quot;) and ($enemyallyaction neq &quot;attack success&quot;) and ($enemyallyaction neq &quot;attack failure&quot;)&gt;&gt;\
&lt;&lt;AllyAbility $enemyallyaction&gt;&gt;&lt;&lt;/AllyAbility&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]]&lt;&lt;else&gt;&gt;&lt;&lt;link &quot;Enemy turn&quot; $passage&gt;&gt;&lt;&lt;set $p = 12&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;EnemyBattleTable&gt;&gt;\
\
&lt;&lt;EnemyAllyBattleTable&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 19&gt;&gt; 
You flee from the $enemyname - better to bandage your wounds and do battle another day than foolishly fight to the death.

As you near the safety of the cabin, you realize your coin purse is a bit lighter than before. Some gold pieces must have fallen out while you were running away.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $goldloss = $enemymaxgold&gt;&gt; \
&lt;&lt;set $gold -= $goldloss&gt;&gt; \
\
&lt;&lt;BattleEnd&gt;&gt;\
\
\
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
This page should not come up, as you should be out of the $passage passage and into the $returnpassage passage.

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="132" name="VoidSentinelAttack" tags="" position="1802,420" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle8_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You are wandering through the Dark Heart when the shadows appear to draw together ahead of you. Slowly, a creature of darkness forms, hatred in its stare.
&lt;img src=&quot;Images/DarkHeart/void1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;You will not stand in my way.&quot;&gt;&gt;\
&lt;&lt;VoidSentinelTalk &quot;&lt;i&gt;I need only slow you down.&lt;/i&gt;.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidSentinelStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

&lt;&lt;if $merchantstatus eq 22&gt;&gt;You gather a vial of void resin!
&lt;&lt;set $voidresin +=1&gt;&gt;\
&lt;&lt;if $voidresin gte 3&gt;&gt;You have enough resin, and should give it all to &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="133" name="VoidGoblinAttack" tags="" position="1800,545" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle8_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
You are wandering through the Dark Heart when hideous laughter echoes from the trees. Void goblins, gathering around you.
&lt;img src=&quot;Images/DarkHeart/void3.jpg&quot; width=450 /&gt;

&lt;&lt;VoidGoblinTalk &quot;&lt;i&gt;Too late... too late...&lt;/i&gt;.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Fight me, cowards!.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;EnemyAllyBattle2&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidGoblinStats&gt;&gt; 
&lt;&lt;VoidGoblinEnemyStats&gt;&gt; 
&lt;&lt;set $flee = 1&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
\
You slay the Void Goblins!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpses of your fallen foes. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

&lt;&lt;if $merchantstatus eq 22&gt;&gt;You gather a vial of void resin!
&lt;&lt;set $voidresin +=1&gt;&gt;\
&lt;&lt;if $voidresin gte 3&gt;&gt;You have enough resin, and should give it all to &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="134" name="Ori4" tags="" position="1798,661" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
You wander through the Dark Heart, seeking to find a path to the Dark Portal. By chance, you stumble upon what looks to be a ruined temple.
&lt;img src=&quot;Images/DarkHeart/dark6.jpg&quot; width=700 /&gt;

It seems less affected by the Void&#39;s corruption than the land around it, yet you can&#39;t shake a foreboding feeling in your gut. Something dangerous lurks near.

[[Retreat-&gt;Outside the Cabin]] 
[[Explore the temple-&gt;Ori4][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
Stepping inside the temple, you see that your optimism and hesitation were both misplaced. The temple is barren. Perhaps it was looted centuries ago.

Just as you turn around, there&#39;s a heavy &lt;i&gt;stomp&lt;/i&gt; from trees. Then another. Something approaches. Something massive.

[[Draw your weapon-&gt;Ori4][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
The rotted trees are ripped asunder as the massive form marches towards you. It looks like a giant, forged of twisted shadow and dark malice. With thin, unblinking eyes, it studies you with cold hatred.
&lt;img src=&quot;Images/DarkHeart/greatvoid3.jpg&quot; width=700 /&gt;

&lt;&lt;VoidColossusTalk &quot;&lt;i&gt;$name $title. You who would stand against the Void. Come, let me devour you.&lt;/i&gt;&quot;&gt;&gt;\
Its voice is like a boom of thunder. While your heart races, you do your best to keep your arms steady. This will be a fight for your life. Outmatched as you may be, you cannot give up.

[[Just then, something large charges forth from the trees-&gt;Ori4][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle9_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
It&#39;s &lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Oriazus the Resplendant&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/ori1.jpg&quot; width=700 /&gt;

&lt;&lt;OriTalk &quot;$name! Careful! This one is beyond you!&quot;&gt;&gt;\
&lt;&lt;VoidColossusTalk &quot;&lt;i&gt;Ah, the last golden golem. Good - I will have both your souls.&lt;/i&gt;&quot;&gt;&gt;\
The golem stands beside you, its fists raised against the Void Colossus, apparently ready for combat.
&lt;&lt;HeroTalk &quot;Ori, you&#39;re no warrior. Let me handle this.&quot;&gt;&gt;\
&lt;&lt;OriTalk &quot;No. No more hiding. Now we fight.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidColossusStats&gt;&gt; 
&lt;&lt;OriStats&gt;&gt; 

&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;shrine&quot;&gt;&gt;\
The Void Colossus shudders as its power finally fails. You watch as it fades to dust, all its darkness and power drifting off with the wind.
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

You gain the Golden Greaves!

&lt;&lt;OriTalk &quot;$name $title... we did it...&quot;&gt;&gt;\

[[Go to Ori-&gt;Ori4][$p = 21]]
\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $legsinventory.push($goldengreaves)&gt;&gt;\

\
&lt;&lt;elseif $p eq 21&gt;&gt;\
The golden golem lies upon ground, its rock-like exterior torn in multiple places. From its wounds, liquid gold spills onto the dirt.
&lt;&lt;HeroTalk &quot;Ori! You&#39;re wounded!&quot;&gt;&gt;\
&lt;&lt;OriTalk &quot;Do not fret, little one. I am not afraid to die.&quot;&gt;&gt;\
&lt;&lt;if $witchlives eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;Give me a moment - I&#39;ll fetch Scyllia. She can heal this.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Give me a moment - I&#39;ll fetch Babar. He must have a restorative potion to-.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;OriTalk &quot;No. I am beyond any remedy. Please, little one. Just be still, and listen.&quot;&gt;&gt;\
You do as the golem says, though it pains you to watch it suffer.
&lt;&lt;OriTalk &quot;It is not so bad a thing, to pass on in the company of a friend. Thank you, little one, for speaking with me. And for your morsels. Might I ask... a final favor?&quot;&gt;&gt;\

[[Ask Ori what it wants-&gt;Ori4][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
&lt;&lt;HeroTalk &quot;Name it, Ori, and it is yours.&quot;&gt;&gt;\
&lt;&lt;OriTalk &quot;It would be a shame... to die... hungry...&quot;&gt;&gt;\
Laughing despite yourself, you draw out a gold coin from your purse and toss it into the golem&#39;s mouth.
&lt;&lt;OriTalk &quot;Mmm... delicious...&quot;&gt;&gt;\
The golem blinks once more, then is still. Before your eyes, it seems, &lt;span class=&quot;ori&quot;&gt;&lt;b&gt;Oriazus the Resplendant&lt;/b&gt;&lt;/span&gt; fades from a living thing to a large lump of gold, only vaguely shaped like a man.
&lt;&lt;HeroTalk &quot;Be at peace, my friend.&quot;&gt;&gt;\
And so passed the last of the golden golems from the face of the world.

[[With a heavy heart, you return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $oristatus = 5&gt;&gt;\
&lt;&lt;set $gold -= 1&gt;&gt;
\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="135" name="GateApproach" tags="" position="1802,800" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
You focus your mind upon the idea of the Shadow Gate, willing the world to reshape itself to bring you to it. It is an odd feeling, but you get the sense that &lt;i&gt;something&lt;/i&gt; is happening. In your peripheral vision, the trees seem to shift, the ground reforming itself it your will.
&lt;img src=&quot;Images/DarkHeart/dark3.jpg&quot; width=700 /&gt;

It is as &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; said - the threads of Tylae&#39;s creation are loose, here, from when the Dark Portal first opened.

[[Seek the Shadow Gate-&gt;GateApproach][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
As the day lengthens - hard as it might be to tell, with the sun hidden - you get the sense that you&#39;re making progress. The gate must be close...

And as you reach the peak of a low-rising hill, you see it.
&lt;img src=&quot;Images/DarkHeart/misc3.jpg&quot; width=600 /&gt;

The wall surrounding the Netheryn Capital is a wonder in and of itself - one hundred paces high, and still intact after fourteen hundred years of ruin. The Shadow Gate seems to be the only way into the descecrated city. And it is firmly shut.

Almost as eye-catching as the gate itself is the army that is besieging it.
&lt;&lt;HeroTalk &quot;It can&#39;t be...&quot;&gt;&gt;\

[[Yet it is-&gt;GateApproach][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
The Deathguard are besieging the Netheryn Capital.
&lt;img src=&quot;Images/Character/deathguard1.jpg&quot; width=600 /&gt;

There are about one hundred soldiers present. At their head is none other than &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt;. His armor is still banged-up from the battle atop the Tower of Zyr.

As you spy on the army, you start to feel like you&#39;re being watched.

[[Turn around-&gt;GateApproach][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle8_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
Just as you turn around, you spot a thing of shadow-forged armor approaching you, sword in hand.
&lt;img src=&quot;Images/DarkHeart/void7.jpg&quot; width=450 /&gt;

&lt;&lt;VoidWarriorTalk &quot;&lt;i&gt;$name, it is time to give up. The time of the Void has come.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Not if I can stop it.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidWarriorStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
The void warrior falls to its knees, then crumbles to dust.
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

Wounded as you are from the battle, you&#39;re in no position to confront &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; and the Deathguard.
&lt;&lt;HeroTalk &quot;I will pull back for now, and deal with this tomorrow.&quot;&gt;&gt;\

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt; \
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $finalquest = 4&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="136" name="DomitusBattle" tags="" position="1937,300" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle5_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;You realize there is no way around this. If the Deathguard are to fall in line, &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; must be dealt with.
&lt;&lt;HeroTalk &quot;Very well, Domitus. Just you and me - a fight to the death. But if I am triumphant, the Deathguard will aid me against the Redeemer.&quot;&gt;&gt;\
He tilts his head.
&lt;img src=&quot;Images/Character/deathguard5.jpg&quot; width=550 /&gt;

&lt;&lt;DomitusTalk &quot;Agreed. But if I am the victor, Naya shall be sent to the king.&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;This duel is a distraction - this is what the Redeemer wants us to do!&quot;&gt;&gt;\
&lt;&lt;DomitusTalk &quot;&lt;i&gt;Silence&lt;/i&gt;! Come, $name - let us see who shall lead the forces of mankind against the Void!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;Domitus2Stats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $i eq 2&gt;&gt;\
&lt;&lt;HeroTalk &quot;Domitus, this war is bigger than the bad blood between us. This is bigger, even, than your fight against the elves. The Redeemer is days away from unleashing a cataclysm that will end the world. Please. Stand down.&quot;&gt;&gt;\

&lt;b&gt;Willpower Check&lt;/b&gt;
&lt;&lt;WillpowerCheck 125&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; seems a bit taken by your words. He steps back, uncertain.

The deathguard, too, have taken heed. Some sheathe their weapons.
&lt;&lt;DomitusTalk &quot;Perhaps there is some merit in your words...&quot;&gt;&gt;\

[[Ally with the Deathguard-&gt;DomitusBattle][$p = 1]]

&lt;&lt;elseif $action eq &quot;failure&quot;&gt;&gt;\
\
&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; seems unfazed by your words.
&lt;&lt;DomitusTalk &quot;Enough lies, $name! A duel, I demand, by what remains of your honor!&quot;&gt;&gt;\

[[Duel Domitus-&gt;DomitusBattle][$i = 1]]
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 1&gt;&gt;\
\
&lt;&lt;DomitusTalk &quot;Maybe we work together, for now. But what guarantee do I have that the elf girl won&#39;t stab me in the back?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You have her word.&quot;&gt;&gt;\
&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; looks at &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;DomitusTalk &quot;Do I?&quot;&gt;&gt;\
Her lips harden to a line.
&lt;&lt;NayaTalk &quot;Yes. You do.&quot;&gt;&gt;\

[[Strategize on how to get past the Shadow Gate-&gt;DomitusBattle][$p = 2]]

&lt;&lt;set $domituslives = 1&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 2&gt;&gt;You, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, &lt;&lt;if $domituslives eq 0&gt;&gt;and &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; &lt;&lt;else&gt;&gt;&lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt;, and &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Domitus&lt;/b&gt;&lt;/span&gt;&lt;&lt;/if&gt;&gt; gather in the command tent.
&lt;&lt;HeroTalk &quot;Tell me, then. What progress have you made against the Shadow Gate?&quot;&gt;&gt;\
&lt;&lt;if $domituslives eq 1&gt;&gt;&lt;&lt;DomitusTalk &quot;Little. The Gate spits out Voidspawn, which we&#39;ve been able to contain. But our siege weapons do nothing against it. We&#39;re stuck.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;MessengerTalk &quot;Little. The Gate spits out Voidspawn, which the Deathguard have been able to contain. But the siege weapons do nothing against it.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;NayaTalk &quot;It is protected by ancient elven magic. What say the mages?&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;The Deathguard wizards seem to believe a &#39;beam of pure light&#39; could pierce the magic... but they can&#39;t seem to create such a beam as of yet.&quot;&gt;&gt;\

[[Propose that Scyllia assists-&gt;DomitusBattle][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;HeroTalk &quot;The priestess of Tylae is an ally of ours. If any kind of magic can pierce the Shadow Gate, it would be hers.&quot;&gt;&gt;\
&lt;&lt;if $domituslives eq 1&gt;&gt;&lt;&lt;DomitusTalk &quot;The Scarlet Witch? Who&#39;s to say she&#39;s not working with the Redeemer?&quot;&gt;&gt;\ 
&lt;&lt;else&gt;&gt;&lt;&lt;MessengerTalk &quot;And we can trust her? Perhaps she serves as a spy for the Redeemer.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;HeroTalk &quot;Impossible - I&#39;ve seen him try to kill her. Besides, she has no equal in light magic. She is our best, maybe our only hope.&quot;&gt;&gt;\
You quickly find agreement. The Deathguard will maintain the siege at the Shadow Gate while you fetch &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $finalquest = 6&gt;&gt;\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
\
\
\
\
\
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
\
You defeated $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

You gain $enemygold gold pieces! You gain $enemyexp Experience Points! 
You gain Death&#39;s Visage! The fury of the Deathguard is contained within!

[[Captain Domitus spits out blood-&gt;DomitusBattle][$p = 21]]

&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $headinventory.push($deathsvisage)&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $domituslives = 0&gt;&gt;\

&lt;&lt;elseif $p eq 21&gt;&gt;\
\
&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; falls to the ground, his life draining out of him.
&lt;&lt;HeroTalk &quot;You brought this upon yourself.&quot;&gt;&gt;\
A gurgling laugh echoes from his helmet.
&lt;&lt;DomitusTalk &quot;Better to let the world die, than to ally with an elf... right, men?&quot;&gt;&gt;\
The Deathguard look to each other, but say nothing. No one voices their agreement.
&lt;&lt;DomitusTalk &quot;Naya... I want you to know something... about your precious Hadamshal.&quot;&gt;&gt;\

[[Naya cautiously approaches him-&gt;DomitusBattle][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
His voice comes in a whisper.
&lt;&lt;DomitusTalk &quot;It was me. It was me.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;... what are you talking about?&quot;&gt;&gt;\
&lt;&lt;DomitusTalk &quot;&lt;i&gt;I killed the king&#39;s ambassador, using an elven blade.&lt;/i&gt;&quot;&gt;&gt;\
&lt;img src=&quot;Images/ScarletVale/hadamshal3.jpg&quot; width=550 /&gt;

&lt;&lt;DomitusTalk &quot;&lt;i&gt;I could not stand to let an elf king live under our Kingdom&#39;s protection... so I made it seem like Hadamshal had betrayed us... and everyone believed me...&lt;/i&gt;&quot;&gt;&gt;\
&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; breaks out into vicious laughter. His men back away, alarmed. &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; looks like she&#39;s been struck.

In a flash, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; has a dagger in her hand. The next moment, she plunges it through &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Domitus&#39;s&lt;/b&gt;&lt;/span&gt; eye.

[[Silence follows-&gt;DomitusBattle][$p = 23]]

&lt;&lt;elseif $p eq 23&gt;&gt;\
You face the contingent of Deathguard, well aware that they could charge at you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; at any moment.

They don&#39;t, though.

&lt;&lt;MessengerTalk &quot;Enough theatrics. He made his case, and he died for it. As for that deathbed confession... it will be dealt with, &lt;i&gt;after&lt;/i&gt; the Redeemer is slain.&quot;&gt;&gt;\
A Deathguard soldier takes a few steps forwards, his hands raised.
&lt;&lt;DeathguardTalk &quot;Lady Brunhilde, we will obey the result of the duel. We&#39;d rather not fall under the charge of the ones who killed our captain though. If you&#39;d have us, we will serve under your command.&quot;&gt;&gt;\
At &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&#39;s&lt;/b&gt;&lt;/span&gt; look, you nod your head. You&#39;re in no mood to command soldiers.
&lt;&lt;MessengerTalk &quot;Very well. $name, Naya. Follow me.&quot;&gt;&gt;\

[[Follow Brunhilde-&gt;DomitusBattle][$p = 2]]

&lt;&lt;elseif $p eq 24&gt;&gt;\



































&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="137" name="Gatekeeper" tags="" position="1939,421" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
\
The creature stands its full height, once you get between it and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;GatekeeperTalk &quot;&lt;i&gt;Little mortal, do you wish to die?&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Not particularly.&quot;&gt;&gt; \
&lt;&lt;GatekeeperTalk &quot;&lt;i&gt;Then stand aside.&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;No.&quot;&gt;&gt; \
It doesn&#39;t like your answer.
&lt;&lt;GatekeeperTalk &quot;&lt;i&gt;For fourteen hundred years I have held the Shadow Gate, in service to Queen Domedra and the Void. Who are you to face the Gatekeeper?&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;I am $name $title. Who are you?&quot;&gt;&gt; \
&lt;&lt;GatekeeperTalk &quot;&lt;i&gt;I am the keeper of keys and the watcher on the walls. I am a servant to the inevitable end. Behold, the power of the Void!&lt;/i&gt;&quot;&gt;&gt; \

[[The Gatekeeper raises six arms skyward-&gt;Gatekeeper][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle9_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\

Shadows gather upon its arms. The smoke on its back billows and roars with raw power.
&lt;&lt;WitchTalk &quot;The Gate is broken, $name - all that remains is to slay the Gatekeeper!&quot;&gt;&gt; \
&lt;&lt;if $witchlove gte 22&gt;&gt;&lt;&lt;HeroTalk &quot;With me, my love! We will take him down together!&quot;&gt;&gt; &lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;With me, Scyllia! We will take him down together!&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GatekeeperStats&gt;&gt; 
&lt;&lt;Witch1Stats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;\
\
You slay $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \

You gain the Grip of the Trickster! A legendary item, blessed by Sathael!
You gain the Armor of the Victorious! A legendary item, blessed by Myridia!

[[Scyllia has fallen-&gt;Gatekeeper][$p = 21]]

&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $finalquest = 8&gt;&gt;\
&lt;&lt;set $chestinventory.push($armorofthevictorious)&gt;&gt;\
&lt;&lt;set $handsinventory.push($gripofthetrickster)&gt;&gt;\
\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 21&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;shrine&quot;&gt;&gt;\
She lies upon the barren ground, her eyes glazed over. Above, a hint of sunlight slips through the shrouded sky. 
&lt;img src=&quot;Images/DarkHeart/savewitch6.jpg&quot; width=650 /&gt;

Seeing their commander has fallen, the Voidspawn retreat. They flee beyond the Shadow Gate, which has fallen to ruin. 
&lt;&lt;if $domituslives eq 1&gt;&gt;&lt;&lt;DomitusTalk &quot;Onwards, men! Into the breach!&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;MessengerTalk &quot;Forwards, Deathguard - capture the gate!&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
You drop to your knees before the fallen priestess.
&lt;&lt;if $witchlove gte 22&gt;&gt;&lt;&lt;HeroTalk &quot;Scyllia? No... you can&#39;t be dead. &lt;i&gt;You can&#39;t die! SCYLLIA!!!&lt;/i&gt;&quot;&gt;&gt; &lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Scyllia...&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
Beside you, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; places a hand on your shoulder.
&lt;&lt;NayaTalk &quot;She&#39;s gone...&quot;&gt;&gt; \

[[Beseech Tylae to intervene-&gt;Gatekeeper][$p = 22]]
&lt;&lt;if $witchlove gte 22&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Shut her eyes&lt;/span&gt; &lt;&lt;else&gt;&gt;[[Shut her eyes-&gt;Gatekeeper][$p = 27]]&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 22&gt;&gt;\
You look skyward, towards the distant sun.
&lt;&lt;HeroTalk &quot;Oh, holy Tylae. Blessed mother - heed me. It is not your priestess&#39;s time to pass - not when we&#39;re so close. As your champion in these Woods, I ask you: &lt;i&gt;bring her back&lt;/i&gt;.&quot;&gt;&gt; \
Nothing happens. Until...
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;img src=&quot;Images/DarkHeart/savewitch1.jpg&quot; width=500 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/DarkHeart/savewitch2.jpg&quot; width=500 /&gt;&lt;&lt;/if&gt;&gt;
Your hands begin to glow.

Then, a voice brushes against your ear.
&lt;&lt;TylaeTalk &quot;&lt;i&gt;This one was always meant to meet her end, here. It was her fate.&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;To the depths with fate.&quot;&gt;&gt; \
&lt;&lt;TylaeTalk &quot;&lt;i&gt;There is a cost to creation... one you will wish you never paid. Are you certain of your course?&lt;/i&gt;&quot;&gt;&gt; \

&lt;&lt;if $witchlove gte 22&gt;&gt;[[Bring Scyllia back-&gt;Gatekeeper][$p = 23]]&lt;&lt;elseif $basewillpower gte 6&gt;&gt;[[Bring Scyllia back-&gt;Gatekeeper][$p = 23]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Bring Scyllia back&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $witchlove gte 22&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Let her go&lt;/span&gt;&lt;&lt;else&gt;&gt;[[Let her go-&gt;Gatekeeper][$p = 27]]&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 23&gt;&gt;\
The light in your hands flashes with white brilliance. As it does, you feel a part of yourself - &lt;i&gt;your soul&lt;/i&gt; - tear. A part of it slips through your fingers and slithers past &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; lips.

Then, she gasps. Life returns to her skin.
&lt;&lt;NayaTalk &quot;$name! That&#39;s... that&#39;s incredible.&quot;&gt;&gt; \

You feel your consciousness fading, as your soul writhes in pain.

&lt;i&gt;You lost 5 willpower!&lt;/i&gt;
&lt;&lt;set $basewillpower -= 5&gt;&gt;\

[[Darkness-&gt;Gatekeeper][$p = 24]]

&lt;&lt;set $witchlives = 1&gt;&gt;\
&lt;&lt;set $spoketowitch = 0&gt;&gt;\
\
&lt;&lt;elseif $p eq 24&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;\
When you awaken, it seems that little time has passed. The sun is just beginning to set. You are outside your cabin, leaning against &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; tree.
&lt;img src=&quot;Images/Locations/tree1.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;What happened?&quot;&gt;&gt; \
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; looks up at you, relief clear in her eyes.
&lt;&lt;NayaTalk &quot;You&#39;re awake! I suppose bringing the dead back to life can take its toll on anyone. Even $name $title.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;It worked, then? She lives?&quot;&gt;&gt; \
&lt;&lt;Witch2Talk &quot;I live.&quot;&gt;&gt; \

[[Turn to Scyllia-&gt;Gatekeeper][$p = 25]]

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;elseif $p eq 25&gt;&gt;\
The priestess has &lt;i&gt;changed&lt;/i&gt;. While she&#39;s standing before you, breathing, it is clear your bargain with Tylae was imperfect. There is less color to &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; skin, and her eyes seem cast in shadow. Yet beyond this darkness, a ring of light seems to shine around her - Tylae&#39;s grace, made manifest.
&lt;img src=&quot;Images/Character/witch3.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;You&#39;re...&quot;&gt;&gt; \
&lt;&lt;Witch2Talk &quot;Alive. Mostly. There is no such thing as a perfect ressurection. And what you did - &lt;i&gt;splitting your soul&lt;/i&gt; - that is a dangerous kind of magic. Do not make it a habit.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;You think I should have let you die?&quot;&gt;&gt; \
She nearly smiles.
&lt;&lt;Witch2Talk &quot;Such hubris, to think my life - or my death - was ever in your hands. Don&#39;t misjudge me, $name. I am grateful. It is a blessing, to breathe this world&#39;s air again. But it hurt you. I know it did.&quot;&gt;&gt; \
She&#39;s not wrong. You can feel your soul diminished, your power not quite what it was before.

[[Just then, a visitor arrives-&gt;Gatekeeper][$p = 26]]

&lt;&lt;elseif $p eq 26&gt;&gt;\
It is &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt;. She looks tired, but unwounded.
&lt;img src=&quot;Images/Character/messenger1.jpg&quot; width=450 /&gt;

&lt;&lt;if $witchlives eq 1&gt;&gt;&lt;&lt;MessengerTalk &quot;Priestess Scyllia - I am pleased to see you survived the battle. Naya, same to you. As for you, $name, I&#39;ve come to provide a report.&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt; &lt;&lt;MessengerTalk &quot;Naya, Babar, $name - it pained me to see the priestess fall, today. All the same, I&#39;ve come to provide a report.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
You stand and face her.
&lt;&lt;HeroTalk &quot;Hail, Lady Brunhilde. Go on, then.&quot;&gt;&gt; \
&lt;&lt;MessengerTalk &quot;The Deathguard have secured the Shadow Gate and set up a defensive perimeter at the entrance to the city. We have full access to the Netheryn Capital, but we have not yet located the Redeemer or the Temple of Eternity.&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;I know the way. I will show you, in the morning.&quot;&gt;&gt; \
&lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; bows, then takes her leave.

Feeling more than exhausted from the day&#39;s events, you reason it may be time to get some sleep.

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;elseif $p eq 27&gt;&gt;\
Swallowing your grief, you close &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; eyes and let her go.
&lt;img src=&quot;Images/DarkHeart/savewitch7.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;Farewell, priestess of Tylae.&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;... Scyllia...&quot;&gt;&gt; \
The battle is over. As the Deathguard secure the Shadow Gate, you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; lift &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; body and carry her away.

[[Bury her-&gt;Gatekeeper][$p = 28]]

&lt;&lt;set $witchlives = 0&gt;&gt;\
\
&lt;&lt;elseif $p eq 28&gt;&gt;\
By nightfall, the burial is done. Where once stood her hut, only her burial mound remains. You&#39;ve put her to rest beneath a lonely tree, with the stars watching over from above.
&lt;img src=&quot;Images/DarkHeart/savewitch8.jpg&quot; width=600 /&gt;

&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; wipes the tears from his eyes.
&lt;&lt;MerchantTalk &quot;This place is going to be a whole lot quieter, now. I never thought I&#39;d miss the company of a witch.&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;She is with the mother Goddess, now. There is no reason to grieve. And yet...&quot;&gt;&gt; \
You say nothing, your mind numb, your body still bruised from the desperate battle against The Gatekeeper.

[[Just then, a visitor arrives-&gt;Gatekeeper][$p = 26]]

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
\
&lt;&lt;elseif $p eq 29&gt;&gt;\
\
&lt;&lt;elseif $p eq 30&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;i&gt;
@@.delayed;Meanwhile...@@

@@.delayed;... in the ruins of the Temple of Eternity@@
&lt;/i&gt;
@@.delayed;[[...-&gt;Gatekeeper][$p = 31]] @@

&lt;&lt;elseif $p eq 31&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer2_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;redeemer&quot;&gt;&gt;\
\
Deep in the Temple of Eternity, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/span&gt; sits upon a descecrated throne. Around him, reality has lost all meaning. All is shifting darkness, as the Void reigns over the temple.
&lt;img src=&quot;Images/DarkHeart/misc1.jpg&quot; width=500 /&gt;

&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;Redeemer4Talk &quot;That human interloper, $name $title - he somehow broke through the Shadow Gate. He&#39;s... persistent.&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;Redeemer4Talk &quot;That human hero, $name $title - she broke through the Shadow Gate. She is as powerful as she is graceful. We mustn&#39;t underestimate her.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;
&lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Queen Domedra&lt;/b&gt;&lt;/span&gt; stands behind the throne, caressing &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&#39;s&lt;/b&gt;&lt;/span&gt; hair.
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;DomedraTalk &quot;Do not let your hatred for the human cloud your mind. The Portal is nearly opened. This world is nearly at an end.&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;DomedraTalk &quot;Do not let your attraction for this human girl cloud your mind. The Portal is nearly opened. This world is nearly at an end..&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
&lt;&lt;Redeemer4Talk &quot;My judgement is &lt;i&gt;not&lt;/i&gt; clouded! I am beyond such emotions! But we must stop $name - we cannot let the ritual be interupted.&quot;&gt;&gt;

[[Domedra nods, then gestures into the writhing darkness-&gt;Gatekeeper][$p = 32]]

&lt;&lt;elseif $p eq 32&gt;&gt;\
&lt;&lt;DomedraTalk &quot;When I first opened the Dark Portal, I was aided by three nobles of Netheryn - three servants who sacrificed everything in my name. They shall serve us well.&quot;&gt;&gt; \
Waves of dark power flow out from her hands. 
&lt;&lt;DomedraTalk &quot;Arise, Zenatar - Void General.&quot;&gt;&gt; \
From the darkness, a shadow built of black steel forms. It kneels before &lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Queen Domedra&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/DarkHeart/greatvoid5.jpg&quot; width=500 /&gt;

&lt;&lt;ZenatarTalk &quot;&lt;i&gt;How may I serve you, your grace?&lt;/i&gt;&quot;&gt;&gt; \

[[Domedra summons her second servant-&gt;Gatekeeper][$p = 33]]

&lt;&lt;elseif $p eq 33&gt;&gt;\
She raises her hands higher.
&lt;&lt;DomedraTalk &quot;Arise, Xorn - Void Prophet.&quot;&gt;&gt; \
Next comes a swirling storm of eldritch energy, loosely contained in the form of a giant.
&lt;img src=&quot;Images/DarkHeart/greatvoid7.jpg&quot; width=500 /&gt;

&lt;&lt;XornTalk &quot;&lt;i&gt;What are the Void&#39;s demands, my queen?&lt;/i&gt;&quot;&gt;&gt; \

[[Domedra summons her last servant-&gt;Gatekeeper][$p = 34]]

&lt;&lt;elseif $p eq 34&gt;&gt;\
She turns her hands to fists.
&lt;&lt;DomedraTalk &quot;Arise, Jhuun - Void Blade.&quot;&gt;&gt; \
The last figure is longlimbed warrior, formed of shadow and bone. Each of its many hands carries a weapon twice as long as a man.
&lt;img src=&quot;Images/DarkHeart/greatvoid9.jpg&quot; width=500 /&gt;

&lt;&lt;JhuunTalk &quot;&lt;i&gt;Tell me who must die in your name.&lt;/i&gt;&quot;&gt;&gt; \

[[The Redeemer studies his newfound champions-&gt;Gatekeeper][$p = 35]]

&lt;&lt;elseif $p eq 35&gt;&gt;\
&lt;&lt;Redeemer4Talk &quot;I hold the Void Gem. The Dark Portal is nearly ready to open for a final time. Only one trifling human stands between us and this world&#39;s destruction.&quot;&gt;&gt;
He holds forth the Void Gem. 
&lt;img src=&quot;Images/Outskirts/voidgem1.jpg&quot; width=400 /&gt;

&lt;&lt;Redeemer4Talk &quot;Zenatar - you shall command my armies of Voidspawn. Bury the humans under the shadows. Xorn, you shall turn the very fabric of reality against my enemies - send heaven&#39;s fire down upon them!&quot;&gt;&gt;\
He looks last to &lt;span class=&quot;void&quot;&gt;&lt;b&gt;Jhuun, the Void Blade&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;Redeemer4Talk &quot;You. When the time is right, I have a special task for you...&quot;&gt;&gt;
\
[[...-&gt;Morning]] 
\
&lt;&lt;set $finalquest = 9&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="138" name="Witch6" tags="" position="599,1337" size="100,100">&lt;&lt;if $music neq &quot;witch&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;witch1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;witch&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You approach &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; grave. 
&lt;img src=&quot;Images/DarkHeart/savewitch8.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;Rest well, Scyllia.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] </tw-passagedata><tw-passagedata pid="139" name="CommandCenter" tags="" position="1935,548" size="100,100">&lt;&lt;if $finalquest eq 9&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
You and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; walk through the ruins of the Shadow Gate and into the Netheryn Capital. As you expected, it is a vast, darkened shell of a city. The old bones of once-grand buildings, the slanted, decaying towers, all stretch beyond your sight. 
&lt;img src=&quot;Images/DarkHeart/ruins3.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;So this is the heart of the Deep Woods.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;I can feel the world ripping at its seams. The Temple of Eternity isn&#39;t too far away.&quot;&gt;&gt;\

[[Enter the war camp-&gt;CommandCenter][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
The Deathguard have built up a fortified camp just beyond the ruins of the Shadow Gate. Ideally, it would be a staging ground for assaults deeper in the city, but there aren&#39;t enough soldiers for that. Instead, it looks like the Deathguard are just barely keeping the marauding Voidspawn at bay.
&lt;img src=&quot;Images/DarkHeart/camp1.jpg&quot; width=700 /&gt;

As you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; walk through the camp, the Deathguard give the two of you space, and step aside to let you pass. Occasionally, one will nod and offer greetings.
&lt;&lt;DeathguardTalk &quot;Hail, $name $title. Hail, Naya of Hadamshal.&quot;&gt;&gt;\
While it&#39;s clear they see you - and definitely &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; - as outsiders to their order, you are all now on the same side.

You&#39;re not sure whether it&#39;s evidence that the Deathguard are not so lost to zeal as you thought, or simply proof that the world is ending, and times are grim enough to demand strange allies.

Likely both.

[[Brunhilde beckons you and Naya over-&gt;CommandCenter][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
The King&#39;s messenger nods to you both.
&lt;img src=&quot;Images/Character/messenger1.jpg&quot; width=450 /&gt;

&lt;&lt;MessengerTalk &quot;$name, Naya. I&#39;m glad you arrived so soon. As you can see, we&#39;ve established a foothold in the Netheryn Capital. But now we&#39;re at an impasse.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;An impasse? We need to keep moving, and strike at the Temple of Eternity.&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;Of course... but our losses at the Shadow Gate were severe. For now, we stay put. Come, a war council is about to begin.&quot;&gt;&gt;\

She gestures to the largest tent in the camp.

[[Attend the war council-&gt;CommandCenter][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
You and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; enter the command tent. It holds a large central table, currently flanked by a few Deathguard officers. &lt;&lt;if $domituslives eq 1&gt;&gt;Among them is &lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt;, he doesn&#39;t look particularly pleased to see you.
&lt;&lt;DomitusTalk &quot;$name, your victory against the Gatekeeper was... somewhat impressive. I&#39;d have slain the fiend myself, were I not up to my neck in Voidspawn at the time.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;DeathguardTalk &quot;$name, your victory against the Gatekeeper was most impressive. With a $class like this leading us, we might just succeed at stopping the Redeemer.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
You, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, and &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; gather around the table.
&lt;img src=&quot;Images/DarkHeart/camp2.jpg&quot; width=700 /&gt;

&lt;&lt;MessengerTalk &quot;I hereby call this council to order. We are gathered here today at the King&#39;s command - to put an end to the evil that haunts the Deep Woods. As we all know, if the Redeemer succeeds in reopening the Dark Portal, the whole world is in peril.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Then our path is clear - we attack the Temple of Eternity. Today.&quot;&gt;&gt;\
The Deathguard officers grumble amongst themselves.
&lt;&lt;if $domituslives eq 1&gt;&gt;\
&lt;&lt;DomitusTalk &quot;Don&#39;t be a fool. Attacking the temple is suicide - the Voidspawn are too well fortified, at the moment. We first need to break their defenses.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;DeathguardTalk &quot;If only it were so simple. The Voidspawn are too well fortified, at the moment, to risk such an attack. We first need to break their defenses.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

[[What defenses?-&gt;CommandCenter][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; gestures beyond the tent.
&lt;&lt;MessengerTalk &quot;The mightest of the Voidspawn seem to coming at us from a ruin we call the Black Bastion. Our scouts have spotted an armored giant observing us from within. Until the Bastion is taken, the Temple is unapproachable.&quot;&gt;&gt;\
&lt;img src=&quot;Images/DarkHeart/ruins2.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;Very well - I will deal with the Black Bastion.&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;There is also the Weeping Tower, not far from the Temple of Eternity. Our scouts report that a Voidspawn archmage is positioned at its peak. Whenever the Deathguard are caught in the open, this mage strikes down with black magic.&quot;&gt;&gt;\
&lt;img src=&quot;Images/DarkHeart/ruins8.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;And if the Tower and the Bastion fall?&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;Then... we might be able to risk an attack on the Temple of Eternity.&quot;&gt;&gt;\

[[Naya steps forward-&gt;CommandCenter][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;NayaTalk &quot;There&#39;s one more thing you should all be aware of, before this council is ended. There are three ancient reliquaries within the Netheryn Capital. These places are the home to old, powerful artifacts. Weapons, I believe, that may aid us against the Redeemer.&quot;&gt;&gt;\
&lt;&lt;if $domituslives eq 1&gt;&gt;\
&lt;&lt;DomitusTalk &quot;We don&#39;t have time to dither about treasure hunting.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;DeathguardTalk &quot;Do we have enough time to go chase relics?&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; looks at you.
&lt;&lt;NayaTalk &quot;Ultimately, it&#39;s your decision. Investigating just one of reliquaries may be a massive aid. Exploring all three would likely take too much time.&quot;&gt;&gt;\

[[The council ends-&gt;CommandCenter][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
&lt;&lt;MessengerTalk &quot;I hereby conclude this war council. Our sole path to victory seems harrowing indeed. The Deathguard shall hold this position to the last man. $name, you will defeat the Voidspawn in the Black Bastion and the Weeping Tower. Then we will regroup here to plan the final attack.&quot;&gt;&gt;\
&lt;img src=&quot;Images/DarkHeart/camp2.jpg&quot; width=700 /&gt;

&lt;&lt;DeathguardTalk &quot;Heree, heree! For the Deathguard, and the King!&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;For the world. For everyone.&quot;&gt;&gt;\

[[Exit the command tent-&gt;CommandCenter][$p = 0]]
\
&lt;&lt;set $finalquest = 10&gt;&gt;\
&lt;&lt;set $reliquaryofshadow = 1&gt;&gt;\
&lt;&lt;set $reliquaryoflight = 1&gt;&gt;\
&lt;&lt;set $reliquaryofblood = 1&gt;&gt;\
&lt;&lt;set $blackbastion = 1&gt;&gt;\
&lt;&lt;set $weepingtower = 1&gt;&gt;\
&lt;&lt;set $nayabow = 1&gt;&gt;\
\
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $finalquest gte 10&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $music neq &quot;dark&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You are standing in the Deathguard warcamp. Behind you lies the ruins of the Shadow Gate. Ahead, past the palisade, stakes, and hastily-dug moat, is what remains of the Netheryn Capital. Voidspawn howl from the shadows.
&lt;img src=&quot;Images/DarkHeart/camp1.jpg&quot; width=700 /&gt;

[[Enter the command tent-&gt;Tent1][$p = 0]]
[[Speak to Naya-&gt;CommandCenter][$p = 1]]
[[Speak to Brunhilde-&gt;CommandCenter][$p = 6]]
&lt;&lt;if $domituslives eq 1&gt;&gt;[[Speak to Domitus-&gt;CommandCenter][$p = 11]]
&lt;&lt;else&gt;&gt;[[Speak to the Deathguard soldiers-&gt;CommandCenter][$p = 14]]&lt;&lt;/if&gt;&gt;
[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; stands at the edge of the camp, stringing her bow while staring out into the ruined Capital.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

[[Ask her what it&#39;s like working with the Deathguard-&gt;CommandCenter][$p = 2]]
&lt;&lt;if $reliquaryofshadow eq 1&gt;&gt;[[Ask her about the Reliquary of Shadow-&gt;CommandCenter][$p = 3]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Ask her about the Reliquary of Shadow&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $reliquaryoflight eq 1&gt;&gt;[[Ask her about the Reliquary of Light-&gt;CommandCenter][$p = 4]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Ask her about the Reliquary of Light&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $reliquaryofblood eq 1&gt;&gt;[[Ask her about the Reliquary of Blood-&gt;CommandCenter][$p = 5]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Ask her about the Reliquary of Blood&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;HeroTalk &quot;Have you gotten used to it? Fighting alongside the Deathguard, I mean.&quot;&gt;&gt;\
She smirks.
&lt;&lt;NayaTalk &quot;I&#39;ve already gotten used to working with humans, haven&#39;t I? These men are no different than you and Babar. Well, none are as fat as him. But otherwise, they&#39;re just men.&quot;&gt;&gt;\
Her voice lowers. 
&lt;&lt;NayaTalk &quot;But for them, working with me is nearly as bad as working with the Voidspawn. They don&#39;t seem hostile... but none of them seem eager to talk.&quot;&gt;&gt;\
&lt;&lt;if $domituslives eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;That&#39;s likely Domitus&#39;s doing.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;At least he&#39;s stopped calling me &#39;elf bitch.&#39;&quot;&gt;&gt;\
It&#39;s your turn to smirk.
&lt;&lt;HeroTalk &quot;This is how old hatreds end. One tiny step at a time.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;You did kill their captain in cold blood.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;And how many Hadamshal elves fell to Domitus&#39;s treachery? That one act, at least, I doubt they hold against me.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

[[Ask her something else-&gt;CommandCenter][$p = 1]]
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;HeroTalk &quot;What can I find in the Reliquary of Shadow?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;According to the libraries of Hadamshal, the greatest assassin to ever live was buried in that reliquary, along with her weapons.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Weapons/Silence and Fury.jpg&quot; width=450 /&gt;

&lt;&lt;if $class eq &quot;rogue&quot;&gt;&gt;&lt;&lt;HeroTalk &quot;The greatest assassin to ever live... I should take the time to acquire those weapons.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Fascinating... but I shouldn&#39;t distract myself. I need to focus on stopping the Redeemer.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;
[[Ask her something else-&gt;CommandCenter][$p = 1]]
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;HeroTalk &quot;What can I find in the Reliquary of Light?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;According to the libraries of Hadamshal, the fabled blade of Iulius is buried in that reliquary. The blade is, of course, broken. Yet legends state that a person of great faith can repair the sword through piety alone. Whatever that means.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Weapons/Faith&#39;s Promise.jpg&quot; width=450 /&gt;

&lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;&lt;&lt;HeroTalk &quot;The sword of Iulius... I should take the time to acquire that weapon.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Fascinating... but I shouldn&#39;t distract myself. I need to focus on stopping the Redeemer.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;
[[Ask her something else-&gt;CommandCenter][$p = 1]]
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
&lt;&lt;HeroTalk &quot;What can I find in the Reliquary of Blood?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;According to the libraries of Hadamshal, the Reliquary of Blood is the final resting place of Karhan the Great - a barbarian king who nearly toppled Netheryn two thousand years ago. He was buried with his most prized possession - a massive greatsword too heavy for most people to even lift, let alone use in combat.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Weapons/Karhan&#39;s Rebuke.jpg&quot; width=450 /&gt;

&lt;&lt;if $class eq &quot;soldier&quot;&gt;&gt;&lt;&lt;HeroTalk &quot;The long-lost blade of Karhan... I should take the time to acquire that weapon.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Fascinating... but I shouldn&#39;t distract myself. I need to focus on stopping the Redeemer.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;
[[Ask her something else-&gt;CommandCenter][$p = 1]]
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
Lady &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; stands in the center of the camp, not too far from the command tent. 
&lt;img src=&quot;Images/Character/messenger1.jpg&quot; width=450 /&gt;

[[How fares the king?-&gt;CommandCenter][$p = 7]]
[[Can we expect any reinforcements?-&gt;CommandCenter][$p = 9]]
[[Am I still branded as a traitor?-&gt;CommandCenter][$p = 10]]
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 7&gt;&gt;\
&lt;&lt;HeroTalk &quot;Tell me, Brunhilde. How fares the king?&quot;&gt;&gt;\
&lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; waits until two Deathguard soldiers walk past, then speaks in a hushed tone.
&lt;&lt;MessengerTalk &quot;In truth: he has not been well since you left for the Deep Woods, $daynumber days ago. He barely eats. When he sleeps, he is plagued by nightmares.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Yes, he mentioned such nightmares before. He feels like the darkness in the Deep Woods is somehow a manifestation of his misdeeds.&quot;&gt;&gt;\
Upon hearing those words, she closes her eyes.
&lt;&lt;MessengerTalk &quot;In a strange way, that&#39;s exactly true. All of this stems from the destruction of Hadamshal.&quot;&gt;&gt;\

[[Your eyes widen-&gt;CommandCenter][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
&lt;&lt;HeroTalk &quot;Careful with your words, Brunhilde. The king favored peace with Hadamshal. He did not intend for it to burn.&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;No, but he intended for it to kneel. Elf liberty irked him... and look at where it&#39;s brought us. The Deathguard hunts the elves for their wickedness... but maybe we have it backwards. Perhaps being hunted begets wickedness, instead of the other way around.&quot;&gt;&gt;\
She does make a fair deal of sense. You decide to change the subject.
&lt;&lt;HeroTalk &quot;So the king is not well.&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;Sick, yes. And getting older. And without an heir. In truth, $name... I fear for the future of the Kingdom&quot;&gt;&gt;\
You shrug.
&lt;&lt;HeroTalk &quot;First let&#39;s save the world. Then we can worry about the Kingdom.&quot;&gt;&gt;\

[[Ask her something else-&gt;CommandCenter][$p = 6]]
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 9&gt;&gt;\
&lt;&lt;HeroTalk &quot;Can we expect any reinforcements?&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;I sent messengers requesting aid, but it will take half a season just to muster a company of soldiers. What you see in this camp is what we have. To be honest, we&#39;re &lt;i&gt;lucky&lt;/i&gt; the Deathguard went on this wanton hunt for elves in the Deep Woods. It may end up saving us all.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Still, if we could bring the full might of the Kingdom to bear against the Redeemer...&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;The Deep Woods isn&#39;t favorable terrain for a large army. Too easy to get lost. Impossible to bring a baggage train. And worse: I&#39;ve had reports of increased goblin activity in the Outskirts. And from the Frozen Hills, an undead legion seems to be on the march - perhaps in defense of the Redeemer.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Voidspawn, goblins, undead... we have our work cut out for us...&quot;&gt;&gt;\

[[Ask her something else-&gt;CommandCenter][$p = 6]]
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 10&gt;&gt;\
&lt;&lt;HeroTalk &quot;When we met in the Frozen Hills, you said I would be branded as a traitor. Does that ruling stand, considering all of this?&quot;&gt;&gt;\
She thinks for a while.
&lt;&lt;MessengerTalk &quot;I am no judge... but my guess is: yes, you are still marked a traitor, to be killed on sight. Your only hope is a royal pardon from the king. Those, of course, are rare.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I see. Well, so is saving the world...&quot;&gt;&gt;\

[[Ask her something else-&gt;CommandCenter][$p = 6]]
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 11&gt;&gt;\
&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; stands like a statue, blade in hand, while watching his men practice formations.
&lt;img src=&quot;Images/Character/deathguard5.jpg&quot; width=550 /&gt;

[[How fare the defenses?-&gt;CommandCenter][$p = 12]]
[[Can I count on you, Domitus?-&gt;CommandCenter][$p = 13]]
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
&lt;&lt;HeroTalk &quot;Domitus, how fare the defenses?&quot;&gt;&gt;\
&lt;&lt;DomitusTalk &quot;We lost a fair deal of good men at the Shadow Gate, and many still standing are nursing wounds. Our palisade is patchwork. Our moat is too shallow. Our supplies are dwindling. Morale is obviously low.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I see. So, simply put: the defenses are poor?&quot;&gt;&gt;\
&lt;&lt;DomitusTalk &quot;We will hold. The true grit of the Deathguard is not how we fare when the sun is shining, but how we endure when all hope is lost. To the last man. To the last moment. &lt;i&gt;We will hold&lt;/i&gt;.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;ll leave you to it, then.&quot;&gt;&gt;\
&lt;&lt;DomitusTalk &quot;Be ever vigilant, $name, and beware the trickery of-&quot;&gt;&gt;\
He stops himself, then casts a long look at &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; from across the camp.
&lt;&lt;DomitusTalk &quot;Hmm... just be vigilant.&quot;&gt;&gt;\

[[Ask him something else-&gt;CommandCenter][$p = 11]]
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 13&gt;&gt;\
&lt;&lt;HeroTalk &quot;Domitus, we&#39;ve had our disagreements in the past.&quot;&gt;&gt;\
The Deathguard Captain tilts his head at you.
&lt;&lt;DomitusTalk &quot;You&#39;re a traitor and I obey the king. That is our disagreement.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You oversimplify at your peril. All the same, we now stand as one. Can I count on you, in the battle to come? Can I trust you to have my back?&quot;&gt;&gt;\
&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; stares at you a while longer, then sighs.
&lt;&lt;DomitusTalk &quot;I have not always behaved in a manner befitting a knight. Perhaps your question, though crudely put, is not without merit.&quot;&gt;&gt;\
His grip on his sword tightens.
&lt;&lt;DomitusTalk &quot;So long as your aim is to defeat the Redeemer, you can count on me. I will give my life to save yours, I swear it, if doing so will advance our cause.&quot;&gt;&gt;\

[[Ask him something else-&gt;CommandCenter][$p = 11]]
[[Return-&gt;CommandCenter][$p = 0]]

&lt;&lt;elseif $p eq 14&gt;&gt;\
You approach a soldier of the Deathguard who stands on watch, right at the camp&#39;s palisade
&lt;img src=&quot;Images/Character/deathguard3.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Soldier, report.&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;The Voidspawn attack at random - dawn, dusk, whenever it pleases them. We&#39;re in a strong position, but we can&#39;t replace our fallen, while they can. We will hold as long as we can... but it&#39;s only a matter of time.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Stand firm. I&#39;ll take the fight to the Voidspawn.&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;The Deathguard never falter.&quot;&gt;&gt;\

[[Return-&gt;CommandCenter][$p = 0]]
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
\
\
\</tw-passagedata><tw-passagedata pid="140" name="Tent1" tags="" position="1935,673" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
You stand within the command tent. From here, you can plan your forays into the Netheryn Capital.
&lt;img src=&quot;Images/DarkHeart/camp2.jpg&quot; width=700 /&gt;

[[Assault the Temple of Eternity-&gt;Temple1][$p = 0]]
&lt;&lt;if $blackbastion lt 10&gt;&gt;[[Assault the Black Bastion-&gt;Bastion1][$p = 0]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;&lt;i&gt;The Black Bastion has been cleared!&lt;/i&gt;&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $weepingtower lt 10&gt;&gt;[[Assault the Weeping Tower-&gt;WeepingTower1][$p = 0]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;&lt;i&gt;The Weeping Tower has been cleared!&lt;/i&gt;&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $reliquaryofshadow lt 10&gt;&gt;[[Explore the Reliquary of Shadow-&gt;RShadow1][$p = 0]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;&lt;i&gt;The Reliquary of Shadow has been cleared!&lt;/i&gt;&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $reliquaryoflight lt 10&gt;&gt;[[Explore the Reliquary of Light-&gt;RLight1][$p = 0]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;&lt;i&gt;The Reliquary of Light has been cleared!&lt;/i&gt;&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $reliquaryofblood lt 10&gt;&gt;[[Explore the Reliquary of Blood-&gt;RBlood1][$p = 0]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;&lt;i&gt;The Reliquary of Blood has been cleared!&lt;/i&gt;&lt;/span&gt;&lt;&lt;/if&gt;&gt;

[[Return-&gt;CommandCenter][$p = 0]] 
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="141" name="Bastion1" tags="" position="1937,1427" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $nayabow eq 1&gt;&gt;You and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; are about to head out to the Black Bastion when a Deathguard soldier blocks your path.
&lt;img src=&quot;Images/Character/deathguard3.jpg&quot; width=450 /&gt;

&lt;&lt;DeathguardTalk &quot;$name, Naya - you cannot leave.&quot;&gt;&gt;\
Your hand falls to your $weapon, sitting in its sheathe at your side.
&lt;&lt;HeroTalk &quot;What is the meaning of this?&quot;&gt;&gt;\
The soldier signals for his follows to approach.
&lt;&lt;DeathguardTalk &quot;See for yourself.&quot;&gt;&gt;\

[[The Deathguard are holding some kind of box-&gt;NayaBow][$p = 0]]
\
\
&lt;&lt;else&gt;&gt;&lt;&lt;if $music neq &quot;dark&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; venture to the Black Bastion. Until the general who leads the Bastion is taken down, you will never have an opportunity to assault the Temple of Eternity.
&lt;img src=&quot;Images/DarkHeart/ruins2.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;Are you ready for this?&quot;&gt;&gt;\
She tests the taut string of her mother&#39;s bow.
&lt;&lt;NayaTalk &quot;Of course. Are you?&quot;&gt;&gt;\

[[Assault the Black Bastion-&gt;Bastion1][$p = 1]]
[[Pull back for now-&gt;CommandCenter][$p = 0]]
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 1&gt;&gt;\
You and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; step inside the Black Bastion. For an old ruin, it is kept meticulously clean. It is also perfectly silent. It almost seems abandoned.
&lt;img src=&quot;Images/DarkHeart/ruins13.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;Something&#39;s not right...&quot;&gt;&gt;\

[[Seek out the Voidspawn-&gt;Bastion1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
Walking into another room, you find it similarly empty. Together, you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; scour the Black Bastion, seeking any sort of enemy, yet come out empty handed.

Until you read the Bastion&#39;s crumbling roof.
&lt;img src=&quot;Images/DarkHeart/ruins15.jpg&quot; width=700 /&gt;

Though hard to tell from the outside, the Bastion is built in the shape of an arena. Walking up its roof, you are suddenly filled with the feeling of being watched.

&lt;&lt;ZenatarTalk &quot;So this is the human who would stand against the inevitable.&quot;&gt;&gt;\

[[Face your foe-&gt;Bastion1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;if $music neq &quot;battle&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle8_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
From the far side of the area, a massive figure covered in pitch-black armor looms over you.
&lt;img src=&quot;Images/DarkHeart/greatvoid5.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;Who are you?&quot;&gt;&gt;\
&lt;&lt;ZenatarTalk &quot;I am Zenatar, the Void General. I serve Queen Domedra of Netheryn. I have been ordered to kill you.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Domedra? She&#39;s dead. I saw her crypt.&quot;&gt;&gt;\
The general shakes its head.
&lt;&lt;ZenatarTalk &quot;The Redeemer has restored her to life. At last, the time has come to end this wretched world.&quot;&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; takes two steps forward. 
&lt;&lt;NayaTalk &quot;Why would she want the world to end? My brother has lost his mind, but what excuse does your queen have?&quot;&gt;&gt;\
&lt;&lt;ZenatarTalk &quot;You would have to ask her yourself. I am her commander, not her counsel. Now...&quot;&gt;&gt;\
He gestures to the center of the arena, where by ancient gears a platform is rising.
&lt;&lt;ZenatarTalk &quot;Let the slaughter begin.&quot;&gt;&gt;\

[[Something&#39;s on the platform-&gt;Bastion1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
From the platform comes a quick, blue-eyed beast, cloaked in shadow.
&lt;img src=&quot;Images/DarkHeart/void1.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;Come, Naya - we&#39;ll slay it together!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidSentinelStats&gt;&gt; \
&lt;&lt;Naya2Stats&gt;&gt;\
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
&lt;&lt;set $battletotal = 0&gt;&gt;\
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;if $battletotal eq 0&gt;&gt;
\
You slay the $enemyname!
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $battletotal += 1&gt;&gt;\

Before you have time to catch your breath, two more Voidspawn rise from the platform!
&lt;img src=&quot;Images/DarkHeart/void3.jpg&quot; width=500 /&gt;

&lt;&lt;NayaTalk &quot;Void Goblins! Don&#39;t let them surround us!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;EnemyAllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidGoblinStats&gt;&gt; \
&lt;&lt;VoidGoblinEnemyStats&gt;&gt; \
&lt;&lt;Naya2Stats&gt;&gt;\
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \

&lt;&lt;elseif $battletotal eq 1&gt;&gt;\
\
You slay the Void Goblins!
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $battletotal += 1&gt;&gt;\

&lt;span class=&quot;void&quot;&gt;&lt;b&gt;Zenatar&lt;/b&gt;&lt;/span&gt; nods his head.
&lt;&lt;ZenatarTalk &quot;Good. I would have been disappointed if you fell to such meager opposition. Now, let&#39;s see how you fare against my true army!&quot;&gt;&gt;\
A well-armed Void Warrior marches forth from the platform.
&lt;img src=&quot;Images/DarkHeart/void7.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Damn, is there no end to this?!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidWarriorStats&gt;&gt; \
&lt;&lt;Naya2Stats&gt;&gt;\
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \

&lt;&lt;elseif $battletotal eq 2&gt;&gt;\
At last, the Void Warrior turns to dust.
&lt;&lt;BattleEnd&gt;&gt;\

The moment if dies, the platform returns with more to take its place.
&lt;img src=&quot;Images/DarkHeart/misc6.jpg&quot; width=450 /&gt;

&lt;&lt;ZenatarTalk &quot;Tired yet? Is your will beginning to fade?&quot;&gt;&gt;\
This isn&#39;t working. A new tactic is needed.

[[Insult the general&#39;s honor-&gt;Bastion2][$p = 0]]
[[Keep fighting-&gt;Bastion1][$p = 21]]

&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 21&gt;&gt;\
You grit your teeth and decide to keep fighting.
&lt;&lt;NayaTalk &quot;We can&#39;t keep this up forever.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;We fight to the last!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidWarriorStats&gt;&gt; \
&lt;&lt;Naya2Stats&gt;&gt;\
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="142" name="WeepingTower1" tags="" position="1942,1675" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $nayabow eq 1&gt;&gt;You and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; are about to head out to the Weeping Tower when a Deathguard soldier blocks your path.
&lt;img src=&quot;Images/Character/deathguard3.jpg&quot; width=450 /&gt;

&lt;&lt;DeathguardTalk &quot;$name, Naya - you cannot leave.&quot;&gt;&gt;\
Your hand falls to your $weapon, sitting in its sheathe at your side.
&lt;&lt;HeroTalk &quot;What is the meaning of this?&quot;&gt;&gt;\
The soldier signals for his follows to approach.
&lt;&lt;DeathguardTalk &quot;See for yourself.&quot;&gt;&gt;\

[[The Deathguard are holding some kind of box-&gt;NayaBow][$p = 0]]
\
\
&lt;&lt;else&gt;&gt;&lt;&lt;if $music neq &quot;dark&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; venture to the Weeping Tower. Until the mage atop the Tower is destroyed, you will never have an opportunity to assault the Temple of Eternity.
&lt;img src=&quot;Images/DarkHeart/ruins8.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;Shall we climb?&quot;&gt;&gt;\
She stares up at the tower&#39;s peak.
&lt;&lt;NayaTalk &quot;Lead the way.&quot;&gt;&gt;\

[[Assault the Weeping Tower-&gt;WeepingTower1][$p = 1]]
[[Pull back for now-&gt;CommandCenter][$p = 0]]
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;if $music neq &quot;battle&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle8_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
Just as you advance towards the Tower&#39;s base, a deep, growling voice rumbles down from its peak.
&lt;&lt;XornTalk &quot;&lt;i&gt;None can stand before the Void! Behold, the power of the world&#39;s ending&lt;/i&gt;!&quot;&gt;&gt;\
The sky opens at voice&#39;s command, and from it rains down a torrent of dark lightning.
&lt;img src=&quot;Images/DarkHeart/misc14.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;Run, Naya - &lt;i&gt;into the tower&lt;/i&gt;!&quot;&gt;&gt;\

[[Run!-&gt;WeepingTower1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
\
You sprint away from the barrage of dark lightning!
&lt;img src=&quot;Images/DarkHeart/misc14.jpg&quot; width=500 /&gt;
\
&lt;b&gt;Agility Check&lt;/b&gt;
&lt;&lt;AgilityCheck 100&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;Weaving between the blasts, you avoid the attack and leap into the tower!

[[Catch your breath-&gt;WeepingTower1][$p = 3]]

&lt;&lt;elseif $action eq &quot;failure&quot;&gt;&gt;\
A bolt of lightning just barely grazes your back, searing the skin!

You lose 150 health!
&lt;&lt;set $currenthealth -= 150&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]] &lt;&lt;else&gt;&gt;[[Enter the tower-&gt;WeepingTower1][$p = 3]] &lt;&lt;/if&gt;&gt;
\
\
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 3&gt;&gt;\
You and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; lean against the inner wall of the tower. Outside, the torrent of lightning slowly subsides, leaving the ground a twisted, smoking ruin.
&lt;&lt;HeroTalk &quot;The Deathguard were right - we can&#39;t risk an attack on the the Redeemer until this mage is silenced.&quot;&gt;&gt;\
She nods, drawing an arrow and nocking it to her bowstring.
&lt;&lt;NayaTalk &quot;That attack against us may have left him winded. Let us make haste.&quot;&gt;&gt;\

[[Ascend the tower-&gt;WeepingTower1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
On the second level of the Weeping Tower, a rumbling grows from above. Glancing up, you spoke a wave of massive boulders, dropping right on top of you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;!
&lt;img src=&quot;Images/DarkHeart/misc15.jpg&quot; width=500 /&gt;

There&#39;s no time to move!

[[Stand strong against the stones-&gt;WeepingTower1][$p = 5]]
\
&lt;&lt;elseif $p eq 5&gt;&gt;
You brace yourself against the boulders!
&lt;img src=&quot;Images/DarkHeart/misc15.jpg&quot; width=500 /&gt;
\
&lt;b&gt;Strength Check&lt;/b&gt;
&lt;&lt;StrengthCheck 100&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;Gritting your teeth, you stand strong as the rocks shatter against your armor!

[[Keep moving-&gt;WeepingTower1][$p = 6]]

&lt;&lt;elseif $action eq &quot;failure&quot;&gt;&gt;\
The boulders get the better of you, leaving you bruised and battered!

You lose 150 health!
&lt;&lt;set $currenthealth -= 150&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]] &lt;&lt;else&gt;&gt;[[Keep moving-&gt;WeepingTower1][$p = 6]] &lt;&lt;/if&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 6&gt;&gt;\
You get the sense that you&#39;re near the top of the Weeping Tower. Just a little bit higher up...
&lt;&lt;NayaTalk &quot;Hopefully we&#39;ve passed the last of this mage&#39;s tricks.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Don&#39;t tempt fate...&quot;&gt;&gt;\
Just as you speak, an odd &lt;i&gt;flicking&lt;/i&gt; sound catches your ears.

&lt;i&gt;flick, flick, flick.&lt;/i&gt;

&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; glances down at her feet.
&lt;&lt;NayaTalk &quot;Why is the ground covered in oil?&quot;&gt;&gt;\

&lt;i&gt;[[Flick-&gt;WeepingTower1][$p = 7]]&lt;/i&gt;

&lt;&lt;elseif $p eq 7&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;&lt;i&gt;Run!&lt;/i&gt;&quot;&gt;&gt;\
The oil catches - and in a flash, the entire hall is engulfed in flame!
&lt;img src=&quot;Images/DarkHeart/misc16.jpg&quot; width=500 /&gt;

You have choice but to hide &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; beneath your cloak and dash through the flames!

&lt;b&gt;Willpower Check&lt;/b&gt;
&lt;&lt;WillpowerCheck 100&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;You manage to hold your breath and keep your nerve, and successfully traverse the burning hall

[[Reach the summit-&gt;WeepingTower1][$p = 8]]

&lt;&lt;elseif $action eq &quot;failure&quot;&gt;&gt;\
You begin to gasp and choke on smoke. Though you&#39;re able to get to the hall&#39;s ending, your lungs drained and burns over your arms and shoulders.

You lose 150 health!
&lt;&lt;set $currenthealth -= 150&gt;&gt;\

&lt;&lt;if $currenthealth lte 0&gt;&gt;[[You are slain!-&gt;Game Over]] &lt;&lt;else&gt;&gt;[[Reach the summit-&gt;WeepingTower1][$p = 8]] &lt;&lt;/if&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 8&gt;&gt;\
At last, you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; climb to the top of the Weeping Tower. Here, through the tower&#39;s long-shattered walls, you get a grand, sweeping view of the entire Capital of Netheryn. Nearly to the horizon, the world below is full of ruined buildings and shattered towers. A dark mist hangs over everything.
&lt;img src=&quot;Images/DarkHeart/ruins14.jpg&quot; width=600 /&gt;

&lt;&lt;XornTalk &quot;&lt;i&gt;Welcome to my chamber of divination. Only upon this summit can I perceive the world&#39;s doom most clearly&lt;/i&gt;!&quot;&gt;&gt;\

It seems you&#39;ve found the Tower&#39;s mage.

[[Turn around-&gt;WeepingTower1][$p = 9]]

&lt;&lt;elseif $p eq 9&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle9_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
Before you stands a massive creature of dark, swirling energy. Lightning vaults sporadically from its writhing thundercloud of a face.
&lt;img src=&quot;Images/DarkHeart/greatvoid7.jpg&quot; width=500 /&gt;

&lt;&lt;XornTalk &quot;&lt;i&gt;It is I, Xorn, the Void Prophet. True servant of Queen Domedra, and the end of all things&lt;/i&gt;!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Domedra? Why do you still serve a dead queen?&quot;&gt;&gt;\
&lt;&lt;XornTalk &quot;&lt;i&gt;You are mistaken, human. Domedra lives, and her desire to end this world shall be fulfilled. I have foreseen it&lt;/i&gt;!&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;You&#39;ve lost your mind.&quot;&gt;&gt;\
&lt;&lt;XornTalk &quot;&lt;i&gt;Behold - the power of the Void&lt;/i&gt;!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;XornStats&gt;&gt; \
&lt;&lt;Naya2Stats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
\
You slay $enemyname!
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
\
You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!
\
\
You gain the Greaves of the Lightbringer! A legendary item, blessed by Iulius!
You gain the Hood of the Trickster! A legendary item, blessed by Sathael!

[[Check to see that Naya is okay-&gt;WeepingTower1][$p = 21]]
\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $weepingtower = 10&gt;&gt;\
&lt;&lt;set $legsinventory.push($greavesofthelightbringer)&gt;&gt;\
&lt;&lt;set $headinventory.push($hoodofthetrickster)&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; is battered and a bit burned, but otherwise uninjured. She slowly rises to her feet
&lt;&lt;NayaTalk &quot;No wonder the people of Netheryn feared the end of the world, if that madman was their prophet.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;It seems Queen Domedra was the true source of Netheryn&#39;s fall. If she lives, it is our duty to put her down for good.&quot;&gt;&gt;\

The Weeping Tower has been conquered. The Deathguard can now advance into the city without fear of being attacked from above. &lt;&lt;if $blackbastion eq 10&gt;&gt;With the Weeping Tower and the Black Bastion both dealt with, the path to the Temple of Eternity is now open! The final battle is at hand!&lt;&lt;else&gt;&gt;The Black Bastion must still be dealt with before an assault on the Temple of Eternity can begin.&lt;&lt;/if&gt;&gt;

[[Return to the cabin-&gt;Outside the Cabin]] 
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="143" name="RShadow1" tags="" position="1933,808" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $music neq &quot;dark&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
Based on &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; directions, you approach the Reliquary of Shadow. From the outside, it appears to be a crumbling, overgrown ruin. The last fourteen hundred years haven&#39;t been particularly kind to it.
&lt;img src=&quot;Images/DarkHeart/ruins1.jpg&quot; width=700 /&gt;

[[Enter the reliquary-&gt;RShadow1][$p = 1]]
[[Return to the war camp-&gt;CommandCenter][$p = 0]] 

&lt;&lt;elseif $p eq 1&gt;&gt;You stand within a dark hallway. There is little light, and the shadows seem to crawl and twist at the periphery of your vision
&lt;img src=&quot;Images/DarkHeart/ruins9.jpg&quot; width=600 /&gt;

[[Venture into the darkness-&gt;RShadow1][$p = 2]]
[[Fall back-&gt;RShadow1][$p = 0]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
In no time at all, you find yourself in pitch darkness. Moving feel and sound alone, you keep through the hall. You get the distinct sense that you&#39;re not alone.
&lt;img src=&quot;Images/DarkHeart/ruins10.jpg&quot; width=600 /&gt;

&lt;b&gt;Agility Check&lt;/b&gt;
&lt;&lt;AgilityCheck 100&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;Your breath goes still. Your heart slows its beat. You become darkness itself, moving from room to room, avoiding whatever hunter looks in these shadowed halls.

[[You find the central chamber-&gt;RShadow2][$p = 0]]

&lt;&lt;elseif $action eq &quot;failure&quot;&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle8_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
Your breath goes still. Your heart slows its beat. Just as you feel you&#39;ve evaded your foe, something grabs you from behind!
&lt;img src=&quot;Images/DarkHeart/void1.jpg&quot; width=500 /&gt;

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidSentinelStats&gt;&gt; \
&lt;&lt;set $flee = 1&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
\
\
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;&lt;if $music neq &quot;dark&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
You defeat the Void Sentinel. Looking around, you see you&#39;ve somehow returned to the first room.
&lt;img src=&quot;Images/DarkHeart/ruins9.jpg&quot; width=600 /&gt;
\
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!
\
&lt;&lt;if $merchantstatus eq 22&gt;&gt;You gather a vial of void resin!
&lt;&lt;set $voidresin +=1&gt;&gt;\
&lt;&lt;if $voidresin gte 3&gt;&gt;You have enough resin, and should give it all to &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; &lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\

[[Continue-&gt;RShadow1][$p = 1]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\

&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="144" name="RLight1" tags="" position="1935,1063" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $music neq &quot;dark&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
Based on &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; directions, you approach the Reliquary of Light. From the outside, it appears to be a crumbling, overgrown ruin. The last fourteen hundred years haven&#39;t been particularly kind to it.
&lt;img src=&quot;Images/DarkHeart/ruins4.jpg&quot; width=700 /&gt;

[[Enter the reliquary-&gt;RLight1][$p = 1]]
[[Return to the war camp-&gt;CommandCenter][$p = 0]] 

&lt;&lt;elseif $p eq 1&gt;&gt;You stand within the ruined reliquary. There, before you, a strange light seems to glow. It brightens and brightens until it is all you can see.
&lt;img src=&quot;Images/DarkHeart/misc8.jpg&quot; width=600 /&gt;

[[Approach it-&gt;RLight1][$p = 2]]
[[Fall back-&gt;RLight1][$p = 0]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
As you approach, a booming voice echoes through the ruin.
&lt;&lt;AvatarTalk &quot;Who seeks my broken blade?&quot;&gt;&gt;\
That voice! &lt;&lt;if $class eq &quot;paladin&quot;&gt;&gt;It appears you&#39;re talking to a fragment of the God of the paladins, Iulius!&lt;&lt;else&gt;&gt;It appears to be a fragment of Iulius, God of judgement. You must speak carefully.&lt;&lt;/if&gt;&gt;
&lt;&lt;HeroTalk &quot;I, $name $title, seek your fabled weapon.&quot;&gt;&gt;\
&lt;&lt;AvatarTalk &quot;Are you pure of heart?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I try to be.&quot;&gt;&gt;\
&lt;&lt;AvatarTalk &quot;Yet there is a shadow, in your past.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;There is. But this sword is a part of my redemption.&quot;&gt;&gt;\
&lt;&lt;AvatarTalk &quot;... we shall see.&quot;&gt;&gt;\

[[The light begins to change-&gt;RLight1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle8_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
Where once there was only light, a fragment of Iulius now stands before you, armed for battle!
&lt;img src=&quot;Images/DarkHeart/avatar1.jpg&quot; width=500 /&gt;

&lt;&lt;AvatarTalk &quot;Prove to me that you can rise above your bloodied past!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;AvatarStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
\
\
&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;&lt;if $music neq &quot;shrine&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;shrine_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;shrine&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;AvatarTalk &quot;Very well, you may take up Faith&#39;s Promise. Use it in the name of justice...&quot;&gt;&gt;\
The fragment of Iulius fades away. The light is gone. In its place is nothing but a broken sword - there is little left of it but the hilt.
&lt;img src=&quot;Images/DarkHeart/misc9.jpg&quot; width=400 /&gt;

&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!
\

[[Pick up the hilt-&gt;RLight1][$p = 21]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
The moment you pick up the hilt, you are filled with holy energy. And just as newfound power floods through your soul, it similarly pours into the sword itself, forming a blade of radiant energy.
&lt;img src=&quot;Images/Weapons/Faith&#39;s Promise.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;This should cut cleanly through the Voidspawn...&quot;&gt;&gt;\

You found the legendary weapon, Faith&#39;s Promise!

[[Leave this place-&gt;Outside the Cabin]] 

&lt;&lt;set $weaponinventory.push($faithspromise)&gt;&gt;\
&lt;&lt;set $reliquaryoflight = 10&gt;&gt;\
\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="145" name="RBlood1" tags="" position="1933,1193" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $music neq &quot;dark&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
Based on &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; directions, you approach the Reliquary of Blood. From the outside, it appears to be a crumbling, overgrown ruin. A strange red light that pulses from within.
&lt;img src=&quot;Images/DarkHeart/ruins7.jpg&quot; width=700 /&gt;

[[Enter the reliquary-&gt;RBlood1][$p = 1]]
[[Return to the war camp-&gt;CommandCenter][$p = 0]] 

&lt;&lt;elseif $p eq 1&gt;&gt;The inside of the reliquary is not what you expected. This isn&#39;t just a burial chamber - it&#39;s a sacrificial altar.
&lt;img src=&quot;Images/DarkHeart/ruins12.jpg&quot; width=600 /&gt;

&lt;&lt;if $reliquaryofblood eq 1&gt;&gt;[[Approach the altar-&gt;RBlood1][$p = 2]]&lt;&lt;else&gt;&gt;[[Approach the altar-&gt;RBlood1][$p = 3]]&lt;&lt;/if&gt;&gt;
[[Fall back-&gt;RBlood1][$p = 0]]

&lt;&lt;set $bloodcount = 0&gt;&gt;

&lt;&lt;elseif $p eq 2&gt;&gt;\
As you approach the altar, a voice echoes through the chamber.
&lt;&lt;KarhanTalk &quot;&lt;i&gt;I am Karhan, slayer of kings. Who are you to disturb my death-sleep?&lt;/i&gt;&quot;&gt;&gt;\
You decide that honesty is likely to serve you best, here.
&lt;&lt;HeroTalk &quot;I am $name $title. I seek the treasure hidden in this place.&quot;&gt;&gt;\
The voice answers with mocking laughter.
&lt;&lt;KarhanTalk &quot;&lt;i&gt;All things may be taken by the strong - so long as they are willing to bleed. Prove yourself, $name $title!&lt;/i&gt;&quot;&gt;&gt;\

It seems the altar requires a sacrifice.

[[Place your palm against the altar-&gt;RBlood1][$p = 3]]
[[Fall back-&gt;RBlood1][$p = 0]]

&lt;&lt;set $reliquaryofblood = 2&gt;&gt;\
\
&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;if $bloodcount eq 0&gt;&gt;\
&lt;&lt;KarhanTalk &quot;&lt;i&gt;How much do you dare to bleed? How much will you pay for power!? Show me, mortal!&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;elseif $bloodcount lt 400&gt;&gt;\
&lt;&lt;KarhanTalk &quot;&lt;i&gt;More blood! I demand more!&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;KarhanTalk &quot;&lt;i&gt;Impressive! You have passed my first test.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $bloodcount gte 400&gt;&gt;[[There&#39;s a second test?!-&gt;RBlood1][$p = 5]]
&lt;&lt;else&gt;&gt;&lt;&lt;if $currenthealth gt 100&gt;&gt;[[Bleed-&gt;RBlood1][$p = 4]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Bleed&lt;/span&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
[[Fall back-&gt;RBlood1][$p = 0]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
You shed your own blood onto the altar.
&lt;img src=&quot;Images/DarkHeart/misc10.jpg&quot; width=600 /&gt;

[[Was it enough?-&gt;RBlood1][$p = 3]]

&lt;&lt;set $currenthealth -= 100&gt;&gt;
&lt;&lt;set $bloodcount += 100&gt;&gt;\

&lt;&lt;elseif $p eq 5&gt;&gt;&lt;&lt;if $music neq &quot;battle&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dragon1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;HeroTalk &quot;Wait - there&#39;s a second test!?&quot;&gt;&gt;\

Just then, there&#39;s a gutteral cry from beyond the reliquary. In comes charging a massive, bloodied minotaur, its eyes alight with fury!
&lt;img src=&quot;Images/DarkHeart/minotaur1.jpg&quot; width=500 /&gt;

&lt;&lt;KarhanTalk &quot;&lt;i&gt;Fight to the death! Only the worthy may have my blade!&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;MinotaurTalk &quot;&lt;i&gt;GRAAAAAHHHHH!!!&lt;/i&gt;&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;MinotaurStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
\
\
&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;&lt;if $music neq &quot;dark&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
With one laugh frenzied cry, the minotaur finally goes down. The ground is soaked with blood.
&lt;&lt;KarhanTalk &quot;&lt;i&gt;You! I like you! A true demon on the field of battle, you are!&lt;/i&gt;&quot;&gt;&gt;\
From a hidden cavity beneath the altar, a massive greatsword rises into the air. You set both your hands upon its handle. It seems to &lt;i&gt;burn&lt;/i&gt; with bloodlust.
&lt;img src=&quot;Images/Weapons/Karhan&#39;s Rebuke.jpg&quot; width=450 /&gt;
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You feel stronger from your victory - you gain $enemyexp Experience Points!
\

[[Lift up the sword-&gt;RBlood1][$p = 21]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
It&#39;s a truly massive weapon, but with all your might behind you, you&#39;re able to heft it over your head.

The moment you do, a mistlike figure appears before you. It is none other than the ghost of &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Karhan the Great&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/DarkHeart/minotaur3.jpg&quot; width=450 /&gt;

&lt;&lt;KarhanTalk &quot;&lt;i&gt;Wield my blade with pride. Go now, and face the so-called Redeemer. It shall be a battle for the ages!&lt;/i&gt;&quot;&gt;&gt;\

You found the legendary weapon, Karhan&#39;s Rebuke!

[[Leave this place-&gt;Outside the Cabin]] 

&lt;&lt;set $weaponinventory.push($karhansrebuke)&gt;&gt;\
&lt;&lt;set $reliquaryofblood = 10&gt;&gt;\
\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="146" name="RShadow2" tags="" position="1932,935" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $music neq &quot;dark&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
A faint light leads you to the central chamber of the reliquary. It isn&#39;t some grand throne room or anything like that. It is a thief&#39;s stash.
&lt;img src=&quot;Images/DarkHeart/ruins11.jpg&quot; width=600 /&gt;

[[Search the treasure-&gt;RShadow2][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;if $music neq &quot;battle&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle8_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
Just as you reach towards the treasure, the loud, grinding noise of a sword dragged against stone pricks your ears. Turning, you see this won&#39;t be as easy as you&#39;d hoped.
&lt;img src=&quot;Images/DarkHeart/void5.jpg&quot; width=350 /&gt;

&lt;&lt;VoidSlayerTalk &quot;&lt;i&gt;You should never have come here.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Perish, fiend!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidSlayerStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Search the treasure-&gt;RShadow2][$p = 21]]

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\

&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
You search through the treasure in the center of the Reliquary of Shadow. Most of it seems to be useless, sentimental items. A bronze botton. A painted portrait, long faded away. A man&#39;s name written on a scrap of leather. But among the trash, you spot two magnificent weapons.
&lt;img src=&quot;Images/Weapons/Silence and Fury.jpg&quot; width=450 /&gt;

You found the legendary weapons, Silence and Fury!

You found 1000 gold!

[[Leave this place-&gt;Outside the Cabin]] 

&lt;&lt;set $weaponinventory.push($silenceandfury)&gt;&gt;\
&lt;&lt;set $reliquaryofshadow = 10&gt;&gt;\
&lt;&lt;set $gold += 1000&gt;&gt;\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="147" name="NayaBow" tags="" position="1937,1308" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
On closer inspection, it&#39;s not just a box. It&#39;s some kind of chest.
&lt;img src=&quot;Images/Outskirts/treasure2.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;What is it?&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;We looted it from Hadamshal. It&#39;s not of any use to us, but we carry it around as a reminder of past victories.&quot;&gt;&gt;\
He nods to &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;DeathguardTalk &quot;Take it. Do with it as you will.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;What do you mean?&quot;&gt;&gt;\

[[Naya opens the treasure chest-&gt;NayaBow][$p = 1]]


&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;if $music neq &quot;naya&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

She spends a while just gazing into the chest, frozen to stillness by whatever hides inside.
&lt;&lt;NayaTalk &quot;I can&#39;t believe it... I...&quot;&gt;&gt;\
She pulls out a rather spectacular looking longbow.
&lt;img src=&quot;Images/DarkHeart/misc11.jpg&quot; width=550 /&gt;

&lt;&lt;NayaTalk &quot;This was my mother&#39;s bow.&quot;&gt;&gt;\
She looks back to the Deathguard soldiers, her stare incredulous.
&lt;&lt;NayaTalk &quot;You&#39;re &lt;i&gt;giving&lt;/i&gt; this to me?&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;Actually, it&#39;s not even ours to give. It&#39;s yours, Naya of Hadamshal.&quot;&gt;&gt;\

[[The soldiers cheer as Naya tests the draw of the bow-&gt;NayaBow][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
While &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; practices with her newfound inheritance, you approach one of the Deathguard soldiers.
&lt;&lt;HeroTalk &quot;What are you up to? What kind of a trap have you sprung on her?&quot;&gt;&gt;\
He looks confused.
&lt;&lt;DeathguardTalk &quot;Trap?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;The &lt;i&gt;bow&lt;/i&gt;. A soldier of the Deathguard doesn&#39;t just &lt;i&gt;gift&lt;/i&gt; an elf a weapon.&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;Oh. You&#39;re right. The truth is, she saved my hide at the Shadow Gate. Killed a Voidspawn just before it did me in. Not to mention, lugging that chest around everywhere was a pain.&quot;&gt;&gt;\
He shrugs.
&lt;&lt;DeathguardTalk &quot;She&#39;s alright. For an elf.&quot;&gt;&gt;\
Then he heads off. You sigh at the whole situation, then content yourself to watch &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; arrows repeatedly hit their targets.
&lt;img src=&quot;Images/DarkHeart/misc12.jpg&quot; width=450 /&gt;

[[Return-&gt;CommandCenter][$p = 0]]
\
\
&lt;&lt;set $nayabow = 2&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="148" name="Bastion2" tags="" position="1937,1558" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
You point your weapon at &lt;span class=&quot;void&quot;&gt;&lt;b&gt;Zenatar&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;HeroTalk &quot;No wonder I have never heard of a General Zenatar in any tome of history. You&#39;re a coward, lacking any true skill. Even a child could drown his enemies in fodder.&quot;&gt;&gt;\
The general tilts its head.
&lt;&lt;ZenatarTalk &quot;A general exploits his every advantage. A fool falls for tricks like what you hope to pull on me. I-&quot;&gt;&gt;\
&lt;img src=&quot;Images/DarkHeart/misc13.jpg&quot; width=450 /&gt;
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; arrow strikes him in the chest, bouncing harmlessly off his armor.
&lt;&lt;ZenatarTalk &quot;The nerve! Attacking a general in mid-speech! You pathetic-&quot;&gt;&gt;\
&lt;img src=&quot;Images/DarkHeart/misc13.jpg&quot; width=450 /&gt;
The second arrow strikes him in the helmet.
&lt;&lt;ZenatarTalk &quot;&lt;i&gt;Grah! One more arrow and-&lt;/i&gt;&quot;&gt;&gt;\

[[Naya draws a third arrow-&gt;Bastion2][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle9_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
\
The moment the third arrow strikes his shield, &lt;span class=&quot;void&quot;&gt;&lt;b&gt;Zenatar&lt;/b&gt;&lt;/span&gt; charges at you.
&lt;&lt;ZenatarTalk &quot;ENOUGH! I WILL CUT YOU BOTH DOWN! IN DOMEDRA&#39;S NAME!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;ZenatarStats&gt;&gt; \
&lt;&lt;Naya2Stats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
\
You slay $enemyname! As it dies, the rest of the Voidspawn in the Black Bastion turn to dust!
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
\
You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!
\
\
You gain the Helm of the Lightbringer! A legendary item, blessed by Iulius!
You gain the Boots of the Victorious! A legendary item, blessed by Myridia!

[[Check to see that Naya is okay-&gt;Bastion2][$p = 21]]
\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $blackbastion = 10&gt;&gt;\
&lt;&lt;set $headinventory.push($helmofthelightbringer)&gt;&gt;\
&lt;&lt;set $feetinventory.push($bootsofthevictorious)&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; is bruised up and drained, but otherwise uninjured. You offer her a hand to help her up.
&lt;&lt;HeroTalk &quot;That was clever, Naya.&quot;&gt;&gt;\
She grabs your hand, looking pleased with herself.
&lt;&lt;NayaTalk &quot;I learned from the best.&quot;&gt;&gt;\

The Black Bastion has been conquered. That should provide some much needed relief to the Deathguard camp. &lt;&lt;if $weepingtower eq 10&gt;&gt;With the Weeping Tower and the Black Bastion both dealt with, the path to the Temple of Eternity is now open! The final battle is at hand!&lt;&lt;else&gt;&gt;The Weeping Tower must still be dealt with before an assault on the Temple of Eternity can begin.&lt;&lt;/if&gt;&gt;

[[Return to the cabin-&gt;Outside the Cabin]] 
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="149" name="Assassin" tags="" position="1807,927" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
You set your will upon the Shadow Gate and start your trek towards it.

However, no matter how hard you try, you can&#39;t seem to find it. Instead, with every step you take, you find yourself walking further from the Shadow Gate, and instead towards a vast, barren field, just outside of the Dark Heart of the Deep Woods. Here there are no trees, or any life at all. It is an empty, broken land, the ground cracked and split open from the Void&#39;s corruption.
&lt;img src=&quot;Images/DarkHeart/ruins16.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;Something is wrong...&quot;&gt;&gt;\
It&#39;s as if &lt;i&gt;someone else&#39;s&lt;/i&gt; will is drawing you to this barren field.

[[Search for answers-&gt;Assassin][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
After a few moments walking through the lifeless land, you spot a figure, so far away as to be nearly masked by the horizon. You approach at a quick pace, uncertain whether you will find friend or foe.

As you near, your worry grows. For the figure is &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;. She&#39;s standing with her back to you. She doesn&#39;t seem to be moving, or even breathing.
&lt;img src=&quot;Images/DarkHeart/misc17.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Naya? &lt;i&gt;Naya&lt;/i&gt;!?&quot;&gt;&gt;\
She doesn&#39;t answer.

Just before you reach her, a cold chill sweeps through your soul. Something is right behind you. 

[[And its shadow is incredibly long-&gt;Assassin][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
The monster stalking you is unlike anything you&#39;ve seen before. It stands as tall as a giant, and wields six massive weapons - each longer than you - with perfect ease.
&lt;img src=&quot;Images/DarkHeart/greatvoid9.jpg&quot; width=450 /&gt;

You stand your ground, quickly drawing $weapon and taking a defensive stance.
&lt;&lt;HeroTalk &quot;What have you done to Naya?&quot;&gt;&gt;\
The monster kneels before you. Even like this, its head is above yours.
&lt;&lt;JhuunTalk &quot;&lt;i&gt;I paralyzed her, and told her I would skin her alive. This lie encouraged her to will you to come and save her... and here you are.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;So you used her as bait.&quot;&gt;&gt;\
The monster nods.
&lt;&lt;JhuunTalk &quot;&lt;i&gt;We must speak. There&#39;s something you should know about the Redeemer.&lt;/i&gt;&quot;&gt;&gt;\

[[Listen to the monster-&gt;Assassin][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;redeemer&quot;&gt;&gt;\
\
&lt;&lt;JhuunTalk &quot;&lt;i&gt;You should know, $name, that the Redeemer commanded me to kill a certain Naya of Hadamshal. His own sister.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Yet you haven&#39;t.&quot;&gt;&gt;\
The monster shrugs.
&lt;&lt;JhuunTalk &quot;&lt;i&gt;Not yet. The Redeemer believes that killing her would break your will. Would weaken your resolve. Would it?&lt;/i&gt;&quot;&gt;&gt;\
The thing seems to actually want an answer.

[[Yes-&gt;Assassin][$p = 4, $i = 1]]
&lt;&lt;if $nayalove eq 23&gt;&gt;&lt;span class=&quot;grey&quot;&gt;No&lt;/span&gt;&lt;&lt;else&gt;&gt;[[No-&gt;Assassin][$p = 4, $i = 2]]&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 4&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;\
&lt;&lt;if $nayalove eq 23&gt;&gt;\
You glance back at &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;. Seeing her paralyzed, at the mercy of this monster, burns at your very soul.
&lt;&lt;HeroTalk &quot;I... love her. She means everything to me. Would her death break my will? Perhaps.&quot;&gt;&gt;\
You look back at the monster.
&lt;&lt;HeroTalk &quot;But from its ashes would rise a vengeance like you have never seen. I would make you and the Redeemer beg for the mercy of death long before I would grant it.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;\
\
You glance back at the paralyzed elf girl.
&lt;&lt;HeroTalk &quot;She is... unstained by the world&#39;s cruelties. She has faced them, but remains pure of heart. I do not think I will leave these Woods alive... but I hope she will.&quot;&gt;&gt;\
&lt;&lt;JhuunTalk &quot;&lt;i&gt;It is for her sake you fight the Redeemer?&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I fight to clear my own soul of past mistakes. But... yes. For her, too.&quot;&gt;&gt;\
The monster nods.
&lt;&lt;JhuunTalk &quot;&lt;i&gt;How curious...&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;
\
&lt;&lt;else&gt;&gt;\
&lt;&lt;HeroTalk &quot;Nothing could ever weaken my resolve. No hardship, no trial, no cruelty the Redeemer could impose.&quot;&gt;&gt;\
&lt;&lt;JhuunTalk &quot;&lt;i&gt;Then you do not care for the girl?&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course I care for her. Kill her, and my resolve strengthens like steel in a searing forge. Kill her, and I will see the Redeemer suffers long before I deign to kill him.&quot;&gt;&gt;\
The monster nods.
&lt;&lt;JhuunTalk &quot;&lt;i&gt;How curious...&lt;/i&gt;&quot;&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\

[[Ask the monster what it will do now-&gt;Assassin][$p = 5]]
\
\
&lt;&lt;elseif $p eq 5&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
The monster stands its full height.
&lt;img src=&quot;Images/DarkHeart/greatvoid9.jpg&quot; width=450 /&gt;

&lt;&lt;JhuunTalk &quot;&lt;i&gt;I am Jhuun, the Void Blade. I serve Queen Domedra of Netheryn. I will see her desires made manifest.&lt;/i&gt;&quot;&gt;&gt;\
It pauses, then looks back at &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;JhuunTalk &quot;&lt;i&gt;But I will not kill the girl. She is irrelevent to Domedra&#39;s plans. Only you need to die. Naya will face the Void like the rest of us.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You seem more reasonable than Zenatar and Xorn. Must we fight? Surely you can see that Domedra&#39;s quest is folly.&quot;&gt;&gt;\
The monster blinks at you, one eye at a time.
&lt;&lt;JhuunTalk &quot;&lt;i&gt;So my brothers are dead? The Redeemer is right to fear you. As for your question...&lt;/i&gt;&quot;&gt;&gt;\

[[Jhuun glances behind its back, perhaps towards the Temple of Eternity-&gt;Assassin][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
&lt;&lt;JhuunTalk &quot;&lt;i&gt;Domedra&#39;s quest is not folly.&lt;/i&gt;&quot;&gt;&gt;\
&lt;span class=&quot;void&quot;&gt;&lt;b&gt;Jhuun&lt;/b&gt;&lt;/span&gt; gestures towards the Temple of Eternity.
&lt;&lt;JhuunTalk &quot;&lt;i&gt;Domedra never truly believed she could kill the Void - that was simply a lie she told the common people of Netheryn. She intended for the world to end, when she first opened the Dark Portal fourteen hundred years ago.&lt;/i&gt;&quot;&gt;&gt;\
&lt;img src=&quot;Images/Outskirts/misc3.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;Why?&quot;&gt;&gt;\
&lt;&lt;JhuunTalk &quot;&lt;i&gt;Because the world has ended before. Many times. Domedra was a priestess of Tylae before she was a queen. She learned that each time the world ends, Tylae starts again, weaving a more perfect world. Less bloodshed. Less loss. Less suffering.&lt;/i&gt;&quot;&gt;&gt;\
You flinch at the revelation.
&lt;&lt;JhuunTalk &quot;&lt;i&gt;Don&#39;t you see, $name? We deserve better than this imperfect world. Our souls will be swallowed by the Void and reforged into a newer, better pattern. This is Domedra&#39;s vision.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;No. I don&#39;t believe you. Domedra lies, or is mistaken.&quot;&gt;&gt;\

[[Jhuun points a massive blade towards you-&gt;Assassin][$p = 7]]

&lt;&lt;elseif $p eq 7&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle9_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
&lt;&lt;JhuunTalk &quot;&lt;i&gt;When you die, $name, you may ask Tylae yourself. All that matters now is that I kill you here.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;So be it. Come, Jhuun - let us fight with honor.&quot;&gt;&gt;\
&lt;&lt;JhuunTalk &quot;&lt;i&gt;Agreed. Now, to arms!&lt;/i&gt;&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;JhuunStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
\
You slay $enemyname!
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \
\
You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!
\
\
You gain the Dreadknight Cuirass!
\

[[Help Naya-&gt;Assassin][$p = 21]]
\
&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $finalquest = 12&gt;&gt;\
&lt;&lt;set $chestinventory.push($dreadknightcuirass)&gt;&gt;\
\
\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
The moment &lt;span class=&quot;void&quot;&gt;&lt;b&gt;Jhuun&lt;/b&gt;&lt;/span&gt; died, the magic keeping &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; paralyzed disappeared. She lies upon the barren ground, catching her breath.
&lt;&lt;HeroTalk &quot;Naya, are you alright?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;I heard him.&quot;&gt;&gt;\
At your confused look, she slowly pulls herself to her feet.
&lt;&lt;NayaTalk &quot;I heard what he said about my brother. Nendel sent that monster to kill me.&quot;&gt;&gt;\
She&#39;s fighting to appear hard as steel, but you can see a slight trembling in her lips.

[[Comfort her-&gt;Assassin][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
&lt;&lt;HeroTalk &quot;Your brother is gone, Naya. It is only the Void Gem, using Nendel&#39;s body like a puppet.&quot;&gt;&gt;\
She takes a deep breath, then nods. 
&lt;&lt;NayaTalk &quot;We have to destroy it.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;And we shall. The time has come to attack the Temple of Eternity.&quot;&gt;&gt;\
&lt;&lt;if $nayalove eq 23&gt;&gt;Your lips press against hers, so glad to see her safe.
&lt;video loop muted autoplay src=&quot;Images/Other/kiss4.mp4&quot;&gt;&lt;/video&gt;
&lt;&lt;set $nayalove = 24&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

[[Return to the cabin-&gt;Outside the Cabin]] 
\
&lt;&lt;set $finalquest = 12&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
\
\
\</tw-passagedata><tw-passagedata pid="150" name="WitchIntro" tags="" position="804,2035" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;if $music neq &quot;goblincave&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;goblincave_bgm&quot; volume 0.5 play loop&gt;&gt; &lt;&lt;set $music = &quot;goblincave&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
You are wandering through the outskirts when you a great tree, much larger than its brothers. It stands valiant against an abrupt drop into a shadowed valley below.
&lt;img src=&quot;Images/Outskirts/tree1.jpg&quot; width=450 /&gt;

As you rest under its shade, you notice that something has been scratched into its bark. A message, maybe.

[[Investigate-&gt;WitchIntro][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
The writing appears to be done by a goblin, using a dull blade as a pen. Still, you can just barely read the words.
&lt;&lt;HeroTalk &quot;&lt;i&gt;Beware the Scarlet Witch&lt;/i&gt;... what is a &#39;Scarlet Witch?&#39;&quot;&gt;&gt; \
To that, you have no answer. All you know is that the goblins fear her. Just another evil of the Deep Woods to be found and destroyed.

As you ponder this, you notice you&#39;re being watched - not by a goblin, but by a mouse. It sits under a mushroom, and studies you with a calm, curious stare.
&lt;img src=&quot;Images/Scarletvale/mouse1.jpg&quot; width=450 /&gt;

Though you can&#39;t quite explain it, it seems different from the other animals of the Deep Woods.

[[Nod to the mouse-&gt;WitchIntro][$p = 2, $i = 1]]
[[Throw a rock at the mouse-&gt;WitchIntro][$p = 2, $i = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;You give the mouse a polite nod. It seems to understand you mean it no harm, and returns the greeting. Then it scurries off into the bushes.
&lt;&lt;HeroTalk &quot;It&#39;s good to see not &lt;i&gt;every&lt;/i&gt; beast in the Deep Woods has gone mad with goblin poison...&quot;&gt;&gt; \
\
\
&lt;&lt;elseif $i eq 2&gt;&gt;You pick up a fairly sized rock and whip it at the animal. The mouse, seeing you wind up your arm, darts into the bushes. The rock hits nothing but the mushroom.
&lt;&lt;HeroTalk &quot;Next time, I won&#39;t miss.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
With nothing else of note near the tree, you reason it&#39;s time to return to the cabin.

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="151" name="GhorokIntro" tags="" position="1100,2257" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
You are wandering through the Scarlet Vale when the loud, shrill roar of an angry goblin stops you in your tracks.
&lt;&lt;GhorokTalk &quot;$name! I know you&#39;re here, $name! Face me!&quot;&gt;&gt; \

It seems someone wants your attention.

[[Find the angry goblin-&gt;GhorokIntro][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
Stepping out from the undergrowth into a small clearing, you spot a stout, well-built goblin. He holds a greatsword that even a human would find heavy, yet he doesn&#39;t seem the least bit bothered by it. 
&lt;img src=&quot;Images/Outskirts/ghorok1.jpg&quot; width=550 /&gt;

&lt;&lt;GhorokTalk &quot;You! Human! Have you seen $name $title?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;And if I have?&quot;&gt;&gt; \
&lt;&lt;GhorokTalk &quot;Then I order you to take me to them. We must meet in glorious combat! I will have my vengence!&quot;&gt;&gt; \

[[Vengence?-&gt;GhorokIntro][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
The crazed goblin doesn&#39;t seem he realize that he&#39;s found the object of his search.
&lt;&lt;HeroTalk &quot;What quarrel do you have with $name $title?&quot;&gt;&gt; \
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;GhorokTalk &quot;He slew Gresh, the Goblin King. I never cared for Gresh - but he happened to be my brother. So, he must be avenged.&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;&lt;&lt;GhorokTalk &quot;She slew Gresh, the Goblin King. I never cared for Gresh - but he happened to be my brother. So, he must be avenged.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
You stand tall against &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;HeroTalk &quot;For what it&#39;s worth, I did not want to kill Gresh. He was too far gone - corrupted by the Redeemer&#39;s gem.&quot;&gt;&gt; \

[[Ghorok&#39;s eyes flash, realizing who you are-&gt;GhorokIntro][$p = 3]]
\
&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle5_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\

&lt;&lt;GhorokTalk &quot;$name $title! I expected you to be taller!&quot;&gt;&gt; \
He points his heavy greatsword in your direction.
&lt;&lt;GhorokTalk &quot;Come, show me the strength that bested my brother!&quot;&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;SpecialBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;GhorokStats&gt;&gt; \
&lt;&lt;set $flee = 0&gt;&gt;\
&lt;&lt;set $battlecount = 0&gt;&gt; \
\
&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;vale1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;vale&quot;&gt;&gt;\
&lt;&lt;BattleEnd&gt;&gt;\
You and &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt; circle each other - both bloodied, both heaving for breath.
&lt;img src=&quot;Images/Outskirts/ghorok1.jpg&quot; width=550 /&gt;

Oddly enough, &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt; then stabs his sword into the dirt and raises his hands.
&lt;&lt;GhorokTalk &quot;Enough! I came here for vengence, not to die. Fighting is too fun to ruin it all by dying.&quot;&gt;&gt; \
You nod, drawing back your weapon. 
&lt;&lt;HeroTalk &quot;Fine. We&#39;ll call it a draw.&quot;&gt;&gt; \
&lt;&lt;GhorokTalk &quot;Truth be told, the only bad bit about Gresh getting killed is people keep throwing a crown at me and calling me King. Hard to find a good battle when I&#39;m trying to collect taxes from trolls all day.&quot;&gt;&gt; \

[[Ghorok leans against a tree, thinking-&gt;GhorokIntro][$p = 21]]

&lt;&lt;elseif $p eq 21&gt;&gt;\
&lt;&lt;GhorokTalk &quot;So, Gresh got his mind warped by that damned Redeemer? I told him not to do business with that freak.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Perhaps your vengence is better aimed at the Redeemer.&quot;&gt;&gt; \
&lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt; grunts in agreement.
&lt;&lt;GhorokTalk &quot;A war against the Redeemer... I&#39;d need an army for something like that.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;You&#39;re king, now, aren&#39;t you? You have an army.&quot;&gt;&gt; \
The goblin heaves himself onto his feet and pulls his sword from the ground.
&lt;&lt;GhorokTalk &quot;Hah! Maybe I do. You&#39;re a clever human, $name $title. Try not to get yourself killed.&quot;&gt;&gt; \
And with that, the goblin leaves you. You figure it&#39;s about time to return to the cabin yourself.

&lt;i&gt;You gain 150 experience!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 
\
&lt;&lt;set $exp += 150&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="152" name="Temple1" tags="" position="2060,182" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;if $finalquest lt 12&gt;&gt;The Temple of Eternity sits in the center of the ruined Netheryn Capital. Within, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Queen Domedra&lt;/b&gt;&lt;/span&gt; are rapidly preparing to reopen the Dark Portal, inviting in the Void to consume the world.
&lt;img src=&quot;Images/Outskirts/misc3.jpg&quot; width=650 /&gt;

The Temple of Eternity cannot be attacked with any hope of success until both the Black Bastion and the Weeping Tower have been dealt with.

[[Return-&gt;Tent1]] 

&lt;&lt;else&gt;&gt;The Temple of Eternity sits in the center of the ruined Netheryn Capital. Within, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Queen Domedra&lt;/b&gt;&lt;/span&gt; are rapidly preparing to reopen the Dark Portal, inviting in the Void to consume the world.
&lt;img src=&quot;Images/Outskirts/misc3.jpg&quot; width=650 /&gt;

Once the assault on the Temple of Eternity begins, there can be no turning back.

Make no mistake - &lt;i&gt;the final battle is at hand&lt;/i&gt;.

&lt;&lt;if $nayalove eq 24&gt;&gt;[[Begin the assault-&gt;Naya Lewd][$p = 60]]&lt;&lt;else&gt;&gt;[[Begin the assault-&gt;Temple1][$p = 1]]&lt;&lt;/if&gt;&gt;
[[Reconsider-&gt;Tent1]] 

&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $p eq 1&gt;&gt;\
\
&lt;&lt;if $music neq &quot;dark&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $nayalove eq 30&gt;&gt;You do your best to clean the command tent and wipe away any evidence of your and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; lovemaking, but the smell of sex lingers in the air. Hopefully no one will notice.

Then, at&lt;&lt;else&gt;&gt;At&lt;&lt;/if&gt;&gt; your command, another war council is summoned. Soon, you, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt;, &lt;&lt;if $domituslives eq 1&gt;&gt;&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt;, and the remaining Deathguard leaders&lt;&lt;else&gt;&gt; and the remaining Deathguard leaders&lt;&lt;/if&gt;&gt; gather around the table, all looking equally grim.
&lt;img src=&quot;Images/DarkHeart/camp2.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;It wasn&#39;t easy, but the general holding the Black Bastion has been removed. The Weeping Tower is also silent. I&#39;ve opened a path to the Temple of Eternity.&quot;&gt;&gt;\
&lt;&lt;if $domituslives eq 1&gt;&gt;&lt;&lt;DomitusTalk &quot;While that may be true, our forces have only dwindled since the attack on the Shadow Gate. We&#39;re hardly in a position to attack anything.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;DeathguardTalk &quot;While that may be true, our forces have only dwindled since the attack on the Shadow Gate. We&#39;re hardly in a position to attack anything.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;MessengerTalk &quot;How many Deathguard knights are in healthy enough to assault the Temple?&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;Thirty. Barely. And that will mean leaving the wounded undefended in the camp.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;It&#39;s not enough...&quot;&gt;&gt;\
Quiet follows. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; might be right, but it hardly matters anymore. It&#39;s now or never.
&lt;&lt;HeroTalk &quot;Gather anyone who can stand. We attack today.&quot;&gt;&gt;\

[[March on the Temple of Eternity-&gt;Temple1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
As you walk out of the camp, horns blow from within. What remains of the Deathguard assemble, gathering swords and shields and falling into formation at your back. Thirty half-starved, exhausted men - together with yourself, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, and &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/DarkHeart/war2.jpg&quot; width=600 /&gt;

It will have to do.

Just as your meager army leaves behind the camp&#39;s moat, a dark line seems to bleed out from the horizon. Like a flood of ink, it flows from the dark corners of the ruined Capital.

[[The Void assembles-&gt;Temple1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle8_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
&lt;&lt;MessengerTalk &quot;By the Gods... there are so many of them...&quot;&gt;&gt;\
It seems all the remaining Voidspawn in the Capital have banded together to defend the Temple of Eternity. There has to be more than one thousand of them. They begin to move towards you slowly, patiently. They know they have you completely outnumbered, and that time is on their side.
&lt;img src=&quot;Images/DarkHeart/war1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;Damn. We&#39;ll be overwhelmed.&quot;&gt;&gt;\
&lt;&lt;DeathguardTalk &quot;There&#39;s nothing to be done - we must retreat!&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;If we turn back today, we&#39;ll never have another chance. We fight on!&quot;&gt;&gt;\

[[Charge!-&gt;Temple1][$p = 4]]
[[Pull back to the Shadow Gate!-&gt;Temple1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
Before you can even utter the order, a great horn rings through the city. Only it&#39;s not coming from the Voidspawn, but from behind you.
&lt;&lt;if $domituslives eq 1&gt;&gt;&lt;&lt;DomitusTalk &quot;We&#39;re being attacked from our rear! Ready shields - we make our last stand, now!&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;DeathguardTalk &quot;We&#39;re being attacked from our rear! There&#39;s no escape!&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; leaps upon a ruined pillar, then looks back beyond the emptied warcamp.
&lt;&lt;NayaTalk &quot;An army approaches - but it isn&#39;t Voidspawn. It&#39;s... &lt;i&gt;goblins!&lt;/i&gt;&quot;&gt;&gt;\

[[Goblins?-&gt;Temple1][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
You turn, puzzled, as a horde of some five hundred goblins pours out from the Shadow Gate and into the city. They&#39;ll hit the back of your lines long before the Voidspawn will.
&lt;img src=&quot;Images/DarkHeart/war3.jpg&quot; width=600 /&gt;

&lt;&lt;MessengerTalk &quot;Do the goblins serve the Redeemer?&quot;&gt;&gt;\
You shake your head. 
&lt;&lt;HeroTalk &quot;Not anymore.&quot;&gt;&gt;\
Then, from the center of the goblin army, a lone figure emerges. Green-skinned like his fellows, he stands out on account of his considerable bulk, as well as the heavy greatsword he lugs around with ease.
&lt;img src=&quot;Images/Outskirts/Ghorok1.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;Lower your weapons - these goblins... they&#39;re not our foes!&quot;&gt;&gt;\
The Deathguard look at you with disbelief.

[[Approach Ghorok-&gt;Temple1][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
Once the gobin army is some twenty paces away from your soldiers, it comes to a stop. At its head, &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt; looks rather pleased with himself. 
&lt;&lt;Ghorok2Talk &quot;$name $title! I was worried I&#39;d miss the battle. Looks like I got here right in time.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Ghorok, what is the meaning of this?&quot;&gt;&gt;\
&lt;&lt;Ghorok2Talk &quot;I was thinkin&#39; &#39;bout what you told me in the Scarlet Vale. How da Redeemer was really da reason Gresh&#39;s dead. And what with me bein&#39; king and all, I thought - it&#39;s &#39;bout time I smashed that Redeemer&#39;s head in!&quot;&gt;&gt;\
The goblin army gives a high-pitched, triumphant roar in support of their king.
&lt;&lt;Ghorok2Talk &quot;Seems like you had da same idea, $name $title! What say you an&#39; me join forces?&quot;&gt;&gt;\
He sticks out his hand. You grasp it, and nod your agreement.
&lt;&lt;HeroTalk &quot;Yes - we&#39;ll strike down the Redeemer together.&quot;&gt;&gt;\
&lt;&lt;Ghorok2Talk &quot;Good! First, though, we gotta deal with dem skeletons.&quot;&gt;&gt;\

[[Skeletons?-&gt;Temple1][$p = 7]]

&lt;&lt;elseif $p eq 7&gt;&gt;\
&lt;&lt;HeroTalk &quot;Skeletons? What do you mean?&quot;&gt;&gt;\
&lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt; gestures back to the Shadow Gate. 
&lt;&lt;Ghorok2Talk &quot;We&#39;re being tailed, we are. A big lot of skeletons followed us to the Dark Heart. Figure dey must be workin&#39; for da Redeemer!&quot;&gt;&gt;\
Just as those words leave his mouth, the first of the undead step forth from the Shadow Gate. There must be at least two hundred of them, all stumbling towards your combined human/goblin army.
&lt;img src=&quot;Images/DarkHeart/war4.jpg&quot; width=600 /&gt;

&lt;&lt;NayaTalk &quot;Those skeletons... I recognize their armor. They serve Duke Carnax.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;That&#39;s impossible. Carnax is dead.&quot;&gt;&gt;\

[[Just then, you recognize who&#39;s leading them-&gt;Temple1][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
Floating above his army, looking ready for a masquerade or for war, is &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Count Barsenes&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/FrozenHills/count1.jpg&quot; width=500 /&gt;

After you wave him over, he flies over the goblins and lands between you and &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt;. 
&lt;&lt;CountTalk &quot;&lt;i&gt;$name $title! What art thee doing here&lt;/i&gt;?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I was going to ask you the same question. I thought you were dead.&quot;&gt;&gt;\
&lt;&lt;CountTalk &quot;&lt;i&gt;Tis true: without the Catalyst, the magic sustaining me is failing. Still, I may tarry in this realm a few days more.&lt;/i&gt;&quot;&gt;&gt;\
He points at the army of Voidspawn.
&lt;&lt;CountTalk &quot;&lt;i&gt;Once I learn&#39;d Domedra did escape her prison, I gather&#39;d what remained of Carnax&#39;s loyal soldiers. We were elves of Netheryn, once. We shall stand against the traitor queen until we art dust. We march to war&lt;/i&gt;!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;When last we met, we were enemies - yet now our paths are one. I, too, seek to stop Domedra&#39;s foul ambitions. Will you fight at my side?&quot;&gt;&gt;\
The count drops into a formal bow.
&lt;&lt;CountTalk &quot;&lt;i&gt;For a peasant, thee has&#39;t proven thyself worthy. I shalt heed thy commands, $name $title&lt;/i&gt;!&quot;&gt;&gt;\

[[Prepare your army for battle-&gt;Temple1][$p = 9]]

&lt;&lt;elseif $p eq 9&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;main_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;main&quot;&gt;&gt;\
You pull yourself onto the pillar beside &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;. Your ramshackle army of Deathguard, goblins, and undead elves gather around you, looking resolute, fearful, or (in the case of the undead) completely without emotion.
&lt;&lt;HeroTalk &quot;The Redeemer has made up his mind. He has decided this world is unworthy. Today, he plans to wipe the slate clean - to end this. To end all of us.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;But he&#39;s made a grevious error. He never thought elves, and men, and goblins, would or could set aside their differences to stand up for this world. For &lt;i&gt;our&lt;/i&gt; world. Yet here we are. Let&#39;s go show him how wrong he is.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Men of the Deathguard, are you with me?&quot;&gt;&gt;\
The Deathguard slam their swords against their shields.
&lt;&lt;if $domituslives eq 1&gt;&gt;&lt;&lt;DomitusTalk &quot;Death to the false Redeemer! Glory to the Deathguard!&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;DeathguardTalk &quot;Death to the false Redeemer! Glory to the Deathguard&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;HeroTalk &quot;Goblins of the Deep Wood, are you with me?&quot;&gt;&gt;\
The goblins stomp upon the ground and raise their spears.
&lt;&lt;GoblinTalk &quot;Fight &#39;em shadow-things! For Gresh! For da king!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Elves of Netheryn, are you with me?&quot;&gt;&gt;\
The skeletons all draw their weapons at once.
&lt;&lt;SkeletalSoldierTalk &quot;&lt;i&gt;We shalt triumph ov&#39;r the traitor queen!&lt;/i&gt;&quot;&gt;&gt;\

[[CHAAARGE!!!-&gt;Temple1][$p = 10]]

&lt;&lt;elseif $p eq 10&gt;&gt;\
You leap from the pillar, swinging $weapon over your head, and dash towards the Temple of Eternity. While you don&#39;t look back, you can &lt;i&gt;feel&lt;/i&gt; your newfound army charging forward just behind. The ground quakes under the weight of their feet. Especially from the few trolls &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt; brought with him.
&lt;img src=&quot;Images/DarkHeart/war5.jpg&quot; width=750 /&gt;

The Voidspawn, now seeing the odds have been well and truly evened, stop their advance. The creatures of darkness brace, weapons ready, for when the lines meet.

You sprint, your chest heaving, your blood aflame with fiery conviction. The time has come - for better or worse, this will be the deciding confrontation. 

With a sharp thrust and heavy &lt;i&gt;thump&lt;/i&gt; of sudden impact, your blade strikes true and battle is joined. The Voidspawn you fell is replaced by three more, but before they can reach you they are overwhelmed - pulled down to the ground by frenzied goblins. 

&lt;&lt;HeroTalk &quot;Onward! To the Temple!&quot;&gt;&gt;\

[[The battle begins-&gt;Temple1][$p = 11]]

&lt;&lt;elseif $p eq 11&gt;&gt;\
\
\
Your forces break through the initial line of Voidspawn, and pour into the ancient streets of Netheryn&#39;s dark capital. Here the fighting is thick, and the Voidspawn fight for every step of your desperate advance to the temple. In your periphery, you see Deathguard fall to explosions of foul magic, only for the undead elves under &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Barsenes&#39;&lt;/b&gt;&lt;/span&gt; command charge forwards and exact revenge.

You lose sight of &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Lady Brunhilde&lt;/b&gt;&lt;/span&gt;, and can only hope she fares well in the thick of the melee. At your side, thankfully, is &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;. You keep her clear of charging Voidspawn, and in return she strikes down monster after monster with unfailing accuracy. Her mother&#39;s bow sings with starfire, and enchanted arrows burst in novas of white flame as they strike their foes.

Then, crossing a shattered street, you spot it.

[[The Temple of Eternity-&gt;Temple1][$p = 12]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle9_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
The entrance looms before you - massive, ornate, and seemingly untouched by time. Beyond its grand entry, dark shadows rise like smoke, and spread throughout the city.
&lt;img src=&quot;Images/DarkHeart/misc2.jpg&quot; width=650 /&gt;

&lt;&lt;NayaTalk &quot;There it is! Hurry!&quot;&gt;&gt;\
Yet just as you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; climb the ancient steps, a shadow falls over you. A massive Voidspawn, as tall and broad as a giant.
&lt;img src=&quot;Images/DarkHeart/greatvoid3.jpg&quot; width=500 /&gt;

It stands in your way, its growl like the rumbling of an earthquake.
&lt;&lt;HeroTalk &quot;Naya! Bring it down!&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidColossus2Stats&gt;&gt; 
&lt;&lt;Naya2Stats&gt;&gt; 

&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 

&lt;&lt;elseif $p eq 20&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;main_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;main&quot;&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
\
Just as the Void Colossus falls, another steps forth from the shadows!
&lt;img src=&quot;Images/DarkHeart/greatvoid3.jpg&quot; width=500 /&gt;

&lt;&lt;VoidColossusTalk &quot;&lt;i&gt;GRAAAAHHH!!!&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;We don&#39;t have time for this!&quot;&gt;&gt;\
The next moment, &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; runs forward, together with three Deathguard soldiers. With a leaping strike, she sends the Void Colossus reeling.
&lt;&lt;MessengerTalk &quot;We&#39;ll keep the Voidspawn busy as long as we can! Go, $name - take the fight to the Redeemer!&quot;&gt;&gt;\
There&#39;s no time to argue, or even to offer thanks. You and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; simply dash into the Temple of Eternity.

[[Find the Redeemer-&gt;Temple2][$p = 0]]
\
&lt;&lt;set $finalquest = 13&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
\</tw-passagedata><tw-passagedata pid="153" name="Temple2" tags="" position="2065,303" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer2_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;redeemer&quot;&gt;&gt;\
As you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; run into the Temple of Eternity, everything begins to shift.

The floor stretches out like ocean waves. The walls melt. Above, the high ceiling bleeds pure darkness. Distantly, you can see stars.
&lt;img src=&quot;Images/DarkHeart/war6.jpg&quot; width=750 /&gt;

&lt;&lt;HeroTalk &quot;Naya - what&#39;s happening!?&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;This close to the Dark Portal, reality loses all sense of coherency.&quot;&gt;&gt; \
She takes your hand.
&lt;&lt;if $nayalove eq 30&gt;&gt;&lt;&lt;NayaTalk &quot;Stay close, my love.&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;NayaTalk &quot;In case you slip.&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\

[[In the distance, you spot a throne-&gt;Temple2][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
\
The path turns to a long, twisting set of stairs. At either side is nothing but an eternal drop into darkness. The stairs lead to a black throne. &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/span&gt; sits upon it, the Void Gem in his hand. At his side stands an elven woman in regal dress. &lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Queen Domedra&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/DarkHeart/misc1.jpg&quot; width=550 /&gt;

&lt;&lt;Redeemer4Talk &quot;Of all the sins of this world, the betrayal of my sister stings me most deeply.&quot;&gt;&gt; \
You and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; come to a stop, ten paces from the throne.
&lt;&lt;NayaTalk &quot;It was you who sent an assassin against me, Nendel. All I&#39;ve ever tried to do was save you.&quot;&gt;&gt; \
&lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Queen Domedra&lt;/b&gt;&lt;/span&gt; slowly shakes her head.
&lt;&lt;if $nayalove eq 30&gt;&gt;&lt;&lt;DomedraTalk &quot;You work alongside a &lt;i&gt;human&lt;/i&gt;, and dare to call your brother a traitor? And worse, I can smell the stink of his seed in your womb from here. You interbreeding &lt;i&gt;slut&lt;/i&gt;.&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;DomedraTalk &quot;You work alongside a &lt;i&gt;human&lt;/i&gt;, and dare to call your brother a traitor? You are beyond hope, little girl.&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\
&lt;&lt;if $nayalove eq 30&gt;&gt;&lt;&lt;Redeemer4Talk &quot;A &lt;i&gt;human&lt;/i&gt;, Naya? How revolting. But it is of no consequence, now. The Portal is nearly opened.&quot;&gt;&gt; &lt;&lt;else&gt;&gt;&lt;&lt;Redeemer4Talk &quot;It is of no consequence, now. The Portal is nearly opened.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \

[[Kill him-&gt;Temple2][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;final1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;final&quot;&gt;&gt;\
\
You point $weapon at &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/span&gt;. 
&lt;&lt;HeroTalk &quot;It is you who lies beyond saving, Nendel. This world is better than its worst mistake. It is better than the fall of Hadamshal. But you cannot see that truth. The Gem won&#39;t let you.&quot;&gt;&gt; \
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/span&gt; rises, and draws his twin black blades. Purple fire burns in each of &lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Domedra&#39;s&lt;/b&gt;&lt;/span&gt; palms.
&lt;&lt;HeroTalk &quot;In the name of Tylae and all her creation, I sentence you to death.&quot;&gt;&gt; \
&lt;&lt;if $nayalove eq 30&gt;&gt;&lt;&lt;Redeemer4Talk &quot;Yes, what better way to end this world than by slaying my whore sister and her lover? &lt;i&gt;Come, $name, Naya - behold the power of the eternal dark&lt;/i&gt;!&quot;&gt;&gt; &lt;&lt;else&gt;&gt;&lt;&lt;Redeemer4Talk &quot;Yes, what better way to end this world than by slaying Tylae&#39;s champion? &lt;i&gt;Come, $name, Naya - behold the power of the eternal dark&lt;/i&gt;!&quot;&gt;&gt; &lt;&lt;/if&gt;&gt; \

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;EnemyAllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;Redeemer1Stats&gt;&gt; 
&lt;&lt;Domedra1Stats&gt;&gt; 
&lt;&lt;Naya2Stats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; &lt;&lt;masteraudio stop&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
You and &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;The Redeemer&lt;/b&gt;&lt;/span&gt; lock blades, each pushing with all your remaining might to throw the other over the ledge. Around you, the throne room fractures and shakes under the strain of the battle.
&lt;&lt;HeroTalk &quot;Yield, Nendel! The battle is lost!&quot;&gt;&gt; \
&lt;&lt;Redeemer4Talk &quot;&lt;i&gt;Never&lt;/i&gt;! Curse you, $name! &lt;i&gt;Curse you to oblivion&lt;/i&gt;!&quot;&gt;&gt; \
He draws back, and stabs his swords deep into his blackened throne. There is a terrible rumbling.

Then the floor shatters beneath your feet.

[[Fall-&gt;Temple3][$p = 0]]
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="154" name="Temple3" tags="" position="2066,426" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
Your thoughts shift through a liquid haze.

Consciousness slips. @@.delayed;Frays.@@ @@.delayed;Fades Away.@@

@@.delayed;&lt;&lt;TylaeTalk &quot;Wake up, $name.&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;HeroTalk &quot;...&quot;&gt;&gt; @@ \
@@.delayed; @@ \
@@.delayed;&lt;&lt;TylaeTalk &quot;One final effort... please...&quot;&gt;&gt; @@ \
@@.delayed; She places a potion into your hand. @@ \

@@.delayed; [[Awaken-&gt;Temple3][$p = 1]] 
@@
&lt;&lt;elseif $p eq 1&gt;&gt;\
Your eyes open. You gasp for breath. It is hard to tell where you are. There is no top or bottom, no sense of dimension to the space. There is only the Dark Portal, and a fragment of stone beneath it. Vague pillars float in space. All else is darkness.
&lt;img src=&quot;Images/DarkHeart/war7.jpg&quot; width=700 /&gt;

Beside you, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; stirs. Groaning, you force yourself to your feet. The portal flashes and swirls with wild destructive energy. It must be nearly ready to open.

Standing just before it, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;the Redeemer&lt;/b&gt;&lt;/span&gt; holds up the Void Gem - it seems to be lending its strength to the portal.
&lt;&lt;HeroTalk &quot;&lt;i&gt;Nendel&lt;/i&gt;!&quot;&gt;&gt; \

[[Stop him-&gt;Temple3][$p = 2]]

&lt;&lt;set $iteminventory.push($goddesspotion)&gt;&gt;\
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 2&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;final1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;final&quot;&gt;&gt;\
Just as you near &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;the Redeemer&lt;/b&gt;&lt;/span&gt;, you hit an invisible boundary. Bouncing off it, you then strike it with your weapon - it seems completely invincible.
&lt;&lt;Domedra2Talk &quot;Going somewhere?&quot;&gt;&gt; \
Turning, you see &lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Domedra&lt;/b&gt;&lt;/span&gt; has shed her veil. She now wields a massive, ornate scythe. The magical shield must be powered by her foul magic.
&lt;&lt;Domedra2Talk &quot;I will not let a worm like you prevent the next world. The new world. The best of all worlds.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;You&#39;re a fool, Domedra.&quot;&gt;&gt; \
Her lips twitch at the insult.
&lt;&lt;HeroTalk &quot;There is no better world. Or rather, it&#39;s up to us to build it. Destruction can never bring about creation. Evil cannot be used to make good. &lt;i&gt;This&lt;/i&gt; is the world. This is it. I&#39;m sorry it did not meet your expectations.&quot;&gt;&gt; \

[[She raises her scythe-&gt;Temple3][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;Domedra2Talk &quot;Liar. Scoundrel. &lt;i&gt;Rotten human maggot&lt;/i&gt;. The next world shall get it right. &lt;i&gt;It shall be the elves above all, forever. For eternity&lt;/i&gt;! We will be like Gods-&quot;&gt;&gt; \
An arrow flies past her neck.

&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; draws a second arrow.
&lt;&lt;NayaTalk &quot;Shut up. Shut up and die, you old crone.&quot;&gt;&gt; \
&lt;&lt;if $nayalove eq 30&gt;&gt;&lt;&lt;Domedra2Talk &quot;&lt;i&gt;You disgusting whore, traitor to your own kind&lt;/i&gt;! In my kingdom, we slit the throat of any elf woman who laid with humans or animals! Now, &lt;i&gt;die&lt;/i&gt;!!!&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;AllyBattle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;Domedra2Stats&gt;&gt; 
&lt;&lt;Naya2Stats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; &lt;&lt;masteraudio stop&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
With one last wretched cry, &lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Domedra&lt;/b&gt;&lt;/span&gt; withers and turns into dust. Just as she disappears, she throws her scythe in a last, desperate attack.

It strikes &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;HeroTalk &quot;&lt;i&gt;Naya! No!&lt;/i&gt;&quot;&gt;&gt; \

[[Go to her-&gt;Temple4][$p = 0]]
\
\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="155" name="Temple4" tags="" position="2069,554" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;naya1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;naya&quot;&gt;&gt;\
She lies on her side. Blood pours from her arm.
&lt;&lt;NayaTalk &quot;What are you doing?&quot;&gt;&gt; \
You pull a potion out of your pack. 
&lt;&lt;HeroTalk &quot;Saving your life.&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;Don&#39;t be a fool, $name. My brother... the portal. That&#39;s all that matters. If he succeeds, it doesn&#39;t matter if I&#39;m breathing or not.&quot;&gt;&gt; \
At your concerned look, she pulls out a stun dart from her belt and &lt;i&gt;jams it into her arm&lt;/i&gt;.
&lt;img src=&quot;Images/Outskirts/arrow2.jpg&quot; width=350 /&gt;

&lt;&lt;if $nayalove eq 30&gt;&gt;&lt;&lt;NayaTalk &quot;There. That will slow my blood loss... $name, I love you...&quot;&gt;&gt; &lt;&lt;else&gt;&gt;&lt;&lt;NayaTalk &quot;There. That will... slow my... blood loss...&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \
Her lips go still. She is paralyzed. The blood seeping from the gash on her arm slows to a trickle.
&lt;&lt;if $nayalove eq 30&gt;&gt;&lt;&lt;HeroTalk &quot;Naya... you will survive this. You must. And in time, you will be my wife, I swear it.&quot;&gt;&gt; &lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Naya... I&#39;ll come back for you.&quot;&gt;&gt; &lt;&lt;/if&gt;&gt; \

[[Face the Redeemer-&gt;Temple4][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;redeemer2_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;redeemer2&quot;&gt;&gt;\
A foul wind sweeps out from the Portal - the Void itself, reaching into the world. 
&lt;img src=&quot;Images/DarkHeart/war7.jpg&quot; width=700 /&gt;

&lt;&lt;Redeemer4Talk &quot;&lt;i&gt;Yes! At long last, the time has come!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Nendel! Face me!&quot;&gt;&gt; \
He turns, and stares at you with maddened eyes.
&lt;&lt;Redeemer4Talk &quot;&lt;i&gt;It&#39;s open, $name. Open at last. The Void simply awaits my command. You are too late.&lt;/i&gt;&quot;&gt;&gt; \
He raises the Void Gem over his head.
&lt;&lt;Redeemer4Talk &quot;&lt;i&gt;A single order, and this world is gone. Forever.&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Nendel... there&#39;s something you need to know.&quot;&gt;&gt; \

[[Confess-&gt;Temple4][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;
He stares at you, caught off-guard by your tone.
&lt;&lt;HeroTalk &quot;It was me, Nendel.&quot;&gt;&gt; \
&lt;&lt;Redeemer4Talk &quot;What are you talking about?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;It was me. That dark day in Hadamshal. I was a new recruit, trying to prove myself. The battle was bloody, chaotic, and terrifying. I&#39;d never killed anyone before. But I found myself in the throne room.&quot;&gt;&gt; \
&lt;&lt;Redeemer4Talk &quot;... the throne room?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;He attacked me. I fought back... I didn&#39;t mean to strike his head...&quot;&gt;&gt; \
You take a deep breath.
&lt;&lt;HeroTalk &quot;Nendel... it was me. I killed the king of Hadamshal. I killed your father.&quot;&gt;&gt; \

[[He blinks. Slowly, he lowers the Void Gem-&gt;Temple4][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;Redeemer4Talk &quot;Yes... yes... I remember... a young man&#39;s face. The fear in his eyes as he struck down my father.&quot;&gt;&gt; \
&lt;&lt;elseif ($gender eq &quot;female&quot;) and ($fem eq 5)&gt;&gt;&lt;&lt;Redeemer4Talk &quot;Yes... yes... I remember... a young woman&#39;s face. The fear in her eyes as she struck down my father.&quot;&gt;&gt; \
\
&lt;&lt;elseif ($gender eq &quot;female&quot;) and ($fem eq 1)&gt;&gt;&lt;&lt;Redeemer4Talk &quot;No - it was a man who killed my father! And yet... &lt;i&gt;your eyes&lt;/i&gt;. I could never forget those eyes. I remember the fear in them as you struck down my father.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
&lt;&lt;HeroTalk &quot;If you want your vengeance... then it is yours.&quot;&gt;&gt; \
You drop your weapon.
&lt;&lt;HeroTalk &quot;If you must destroy something, destroy me. Not your sister. Not the soul of every child who&#39;s lost his parents, like you have. Not the world. Just me.&quot;&gt;&gt; \
&lt;&lt;Redeemer4Talk &quot;Vengeance... destruction... it is all I find in my heart. &lt;i&gt;Why&lt;/i&gt;?&quot;&gt;&gt; \
His eyes soften. He looks at the gem in his hands, suddenly disgusted. 
&lt;&lt;Redeemer4Talk &quot;It is this thing. It is more evil than any human...&quot;&gt;&gt; \

[[The gem glows-&gt;Temple4][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
\
&lt;&lt;VoidTalk &quot;&lt;i&gt;Nendel... you fool. You were this close to greatness&lt;/i&gt;!&quot;&gt;&gt; \
The gem starts to burn red hot in &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&#39;s&lt;/b&gt;&lt;/span&gt; hands. He tries to drop it, but it seems fused to his skin. All he can do is scream in anguish.
&lt;&lt;VoidTalk &quot;&lt;i&gt;You&#39;ve brought me close enough. For this final step, I will assume control. You will have the destruction you so desire&lt;/i&gt;!&quot;&gt;&gt; \
&lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; cries out as the gem &lt;i&gt;melts into his hands&lt;/i&gt;. As it does, his skin turns to darkness. Black tendrils writhe up his arms, towards his face.
&lt;img src=&quot;Images/DarkHeart/misc7.jpg&quot; width=600 /&gt;

&lt;&lt;Redeemer4Talk &quot;$name... take care... of Naya-&quot;&gt;&gt; \

[[Darkness engulfs him-&gt;Temple4][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;final1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;final&quot;&gt;&gt;\
You reach down and take hold of $weapon. Before you, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; is no more. In his place is a grotesque avatar of darkness and destruction. Void itself, summoned from the end of time.
&lt;img src=&quot;Images/DarkHeart/voidlord1.jpg&quot; width=550 /&gt;

&lt;&lt;Void2Talk &quot;&lt;i&gt;AT LAST, I HAVE COME TO DEVOUR MY SISTER&#39;S CREATION. SUCH IS THE DESTINY OF ALL WORLDS, TO RETURN TO DUST. TO RETURN TO ME&lt;/i&gt;!&quot;&gt;&gt; \
Steeling yourself, you approach the horrific abomination.
&lt;&lt;Void2Talk &quot;&lt;i&gt;YOU SEEK TO STOP ME, MORTAL? MY SISTER CHOSE HER CHAMPION WELL. BUT KNOW THIS - IN ALL THE MANY CYCLES OF THIS WORLD, FEW HAVE GOTTEN THIS FAR - AND NONE HAVE DEFEATED ME. I AM DESTRUCTION ETERNAL. I AM THE ENVITABLE END! I AM VOID&lt;/i&gt;!&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Enough talk. To arms!&quot;&gt;&gt; \

&lt;i&gt;A rush of power sweeps through you. The Gods lend their support!

Your strength increases by 10!
Your agility increases by 10!
Your willpower increases by 10!&lt;/i&gt;
\
&lt;&lt;set $basestrength += 10&gt;&gt;\
&lt;&lt;set $baseagility += 10&gt;&gt;\
&lt;&lt;set $basewillpower += 10&gt;&gt;\
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
\
\
\
&lt;&lt;elseif $p eq 20&gt;&gt; &lt;&lt;masteraudio stop&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
&lt;&lt;set $currenthealth = 1&gt;&gt;
\
&lt;span class=&quot;void&quot;&gt;&lt;b&gt;Void&lt;/b&gt;&lt;/span&gt; roars in anguish as &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt; regains control of his ruined body. The monstrous form before you takes one step back. 
Then another.
&lt;&lt;Void2Talk &quot;&lt;i&gt;THIS CANNOT BE! NOOOOO&lt;/i&gt;!&quot;&gt;&gt; \

[[It falls into the Dark Portal-&gt;Temple4][$p = 21]]
\
\

&lt;&lt;elseif $p eq 21&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;\

Final chapter @@.delayed;...@@

@@.delayed;...@@

@@.delayed;...@@

@@.delayed;Complete.@@

@@.delayed;[[Continue-&gt;Epilogue1][$p = 0]]
 @@

&lt;&lt;set $check3 = random(1,3)&gt;&gt;\
&lt;&lt;if $check3 eq 1&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Bloodborne&lt;/b&gt; in a new game to start off with the legendary weapon - Karhan&#39;s Rebuke!&lt;/i&gt;@@
&lt;&lt;elseif $check3 eq 2&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Shadowsong&lt;/b&gt; in a new game to start off with the legendary weapons - Silence and Fury!&lt;/i&gt;@@
&lt;&lt;elseif $check3 eq 3&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Lightbringer&lt;/b&gt; in a new game to start off with the legendary weapon - Faith&#39;s Promise!&lt;/i&gt;@@
&lt;&lt;elseif $check3 eq 4&gt;&gt;\
@@.delayed;&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Special Title Unlocked!&lt;/b&gt;&lt;/span&gt;
&lt;i&gt;Title yourself &lt;b&gt;the Dragoon&lt;/b&gt; in a new game to start off with a full set of dragon hunting gear!&lt;/i&gt;@@
&lt;&lt;/if&gt;&gt;\
\
\
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="156" name="Epilogue1" tags="" position="398,1578" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;epilogue1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;epilogue&quot;&gt;&gt;\
With a shuddering blast, the Dark Portal disappears. The Gem, &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;Nendel&lt;/b&gt;&lt;/span&gt;, and &lt;span class=&quot;void&quot;&gt;&lt;b&gt;Void&lt;/b&gt;&lt;/span&gt;... they&#39;re all gone. All that remains in the center of the Temple of Eternity is a single, white tree.
&lt;img src=&quot;Images/DarkHeart/end2.jpg&quot; width=550 /&gt;

You understand. It&#39;s a symbol, handed down from Tylae above.
&lt;&lt;HeroTalk &quot;A new beginning...&quot;&gt;&gt;\

Behind you, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; groans.

[[Go to her-&gt;Epilogue1][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
She is too weak to stand, but her eyes begin to flutter open.
&lt;&lt;NayaTalk &quot;... it&#39;s over, isn&#39;t it?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;How can you tell?&quot;&gt;&gt;\
She points above you.
&lt;&lt;NayaTalk &quot;The sun is shining over Netheryn.&quot;&gt;&gt;\
&lt;img src=&quot;Images/DarkHeart/end3.jpg&quot; width=550 /&gt;

She&#39;s right. For the first time in fourteen hundred years, the sun shines upon the Heart of the Deep Woods.
&lt;&lt;NayaTalk &quot;... my brother?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;He&#39;s... gone. But in the last moment, he fought at my side. Nendel gave his life to close the portal.&quot;&gt;&gt;\
She shuts her eyes. Tears gather upon her eyelids.
&lt;&lt;NayaTalk &quot;I don&#39;t believe you... but I hope you&#39;re right...&quot;&gt;&gt;\

[[Carry her out of the Temple-&gt;Epilogue1][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
@@.delayed;...@@

@@.delayed;...@@

@@.delayed;[[One year later...-&gt;Epilogue1][$p = 3]]
 @@
 
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
&lt;&lt;set $daynumber += 365&gt;&gt;\
\
&lt;&lt;elseif $p eq 3&gt;&gt;\
In the aftermath of the Battle for Eternity, peace fell upon the Deep Woods.
&lt;img src=&quot;Images/Locations/woods1.jpg&quot; width=650 /&gt;

The rumors of a lurking evil eventually ran dry. Sightings of dark riders, of shadow-things scuttling in the night, gradually faded to memory. It was still no land to journey to lightly, but it seemed that whatever evil once grew there had been silenced, or had moved on.

[[As for the goblins...-&gt;Epilogue1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
Under &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&#39;s&lt;/b&gt;&lt;/span&gt; reluctant leadership, the many goblins of the Deep Woods unified, and built a sprawling kingdom among the Woods&#39; outskirts. In honor of &lt;b&gt;$name&lt;/b&gt; and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt; allowed humans and elves to travel freely through his kingdom, and a river of trade began to flow between goblins and the Kingdoms of men.
&lt;img src=&quot;Images/Epilogue/goblins1.jpg&quot; width=650 /&gt;

As for &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt;, he never quite grew into his new role as Goblin king - that was always &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Gresh&#39;s&lt;/b&gt;&lt;/span&gt; speciality. Much of the running of the kingdom he left to his advisors, giving him ample time to wrestle trolls, and attack any bandits stupid enough to raid his lands.
&lt;img src=&quot;Images/Outskirts/ghorok1.jpg&quot; width=550 /&gt;

[[As for the undead...-&gt;Epilogue1][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
With all of the Netheryn Catalysts destroyed, the undead of the Deep Woods knew their days were numbered. As it turns out, this didn&#39;t bother them very much. After fourteen hundred years guarding &lt;span class=&quot;queen&quot;&gt;&lt;b&gt;Domedra&#39;s&lt;/b&gt;&lt;/span&gt; crypt, the undead were looking forward to a restful afterlife.
&lt;img src=&quot;Images/Epilogue/undead1.jpg&quot; width=650 /&gt;

What time they did have left they devoted to rebuilding the Capital of Netheryn. In this work, they were led by &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Count Barsenes&lt;/b&gt;&lt;/span&gt;. The Count was actually one of Netheryn&#39;s chief architects during his life, and so worked tirelessly to bring back some of its former glory before his (second) death.
&lt;img src=&quot;Images/FrozenHills/count1.jpg&quot; width=450 /&gt;

When &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Count Barsenes&lt;/b&gt;&lt;/span&gt; did eventually pass on, it marked the end of undeath in the Deep Woods. He was buried in the restored Winter Palace, alongside his longtime partner, &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Duke Carnax&lt;/b&gt;&lt;/span&gt;.

[[As for Brunhilde...-&gt;Epilogue1][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
Once the Deep Woods were saved, the King&#39;s nightmares disappeared. Yet, at the same time, his health rapidly declined. It was as if, after finding peace, he longer needed to remain in the world. He passed away not thirty days after the Battle for Eternity.

Some amount of chaos followed his death. Thankfully, &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Lady Brunhilde&lt;/b&gt;&lt;/span&gt; was there to serve as a voice of reason while the other nobles squabbled for power and threatened civil war.
&lt;img src=&quot;Images/Character/messenger1.jpg&quot; width=450 /&gt;

&lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; was able to avoid civil war, and eventually an heir - a distant nephew of the king, only three years old - was found. The child-king, being so young, relied on his regent &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; to run the kingdom.
&lt;img src=&quot;Images/Epilogue/kingdom1.jpg&quot; width=650 /&gt;

As regent, &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; relaxed many of the anti-elf policies that plagued the last king&#39;s reign. She also granted independence to some of the outlying lands that the last king had conquered. These moves freed up the kingdom&#39;s army to focus on the orcish threat to the south, and reduced the tax burden on the peasantry.

&lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; was lauded as a true paragon of the nobility, and respected by humans and elves alike.

[[As for the Deathguard...-&gt;Epilogue1][$p = 7]]

&lt;&lt;elseif $p eq 7&gt;&gt;\
With their numbers greatly reduced after the Battle for Eternity, and with the anti-elf policies formally ended by &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Regent Brunhilde&lt;/b&gt;&lt;/span&gt;, many expected the Deathguard to end as a knightly order.

&lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; thought otherwise. At her advice, the order reformed into the &lt;b&gt;Voidguard&lt;/b&gt; - a knightly order devoted to rooting out any cults seeking to reopen the Dark Portal. 
&lt;img src=&quot;Images/Epilogue/deathguard1.jpg&quot; width=650 /&gt;

The Voidguard became a ruthless and effective order of knights, merciless in their constant vigilance against threats of the Void.

A year after their creation, they allowed into the order their first elven knight.

[[As for Captain Domitus...-&gt;Epilogue1][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
&lt;&lt;if $domituslives eq 1&gt;&gt;\
&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; supported the creation of the Voidguard and served as its first captain. Once the order was running smoothly, though, he resigned. After renouncing his vows and handing his helmet to the king, he left the Kingdom&#39;s Capital and was not seen again by his fellow knights.

In the months that followed, rumors arose of a lone hedge knight, aged and scarred, wandering the countryside. He seemed adept at appearing whenever bandits were attacking elves or stealing from elven merchants, and delivering swift justice. 
&lt;img src=&quot;Images/Epilogue/domitus1.jpg&quot; width=650 /&gt;

He never offered his name, nor dared to stay for long in one place. The elves who he saved called him their hero, but noted that he looked like a haunted man. Like he was trying to atone for some old, wretched sin. 

But the path to atonement is a long one, indeed.
\
&lt;&lt;else&gt;&gt;\
&lt;span class=&quot;deathguard&quot;&gt;&lt;b&gt;Captain Domitus&lt;/b&gt;&lt;/span&gt; died at the Shadow Gate, and was buried with honors in the Kingdom&#39;s Capital a month after the battle for Eternity.

Once word spread that he was the cause of the fall of Hadamshal, his corpse was dug up and delivered to Hadamshal refugees as a peace offering. 

They burned his corpse and spat upon the ashes.
\
\
&lt;&lt;/if&gt;&gt;\

[[As for Scyllia...-&gt;Epilogue1][$p = 9]]

&lt;&lt;elseif $p eq 9&gt;&gt;\
&lt;&lt;if $witchlives eq 1&gt;&gt;\
With the Deep Woods cleansed of &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;the Redeemer&#39;s&lt;/b&gt;&lt;/span&gt; dark ambitions, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; devoted herself to restoring much of the damaged woodland. Realizing that hiding herself away had actually made the &lt;span class=&quot;redeemer&quot;&gt;&lt;b&gt;the Redeemer&#39;s&lt;/b&gt;&lt;/span&gt; task easier, she abandoned the false front of the Scarlet Witch, and openly embraced her role as the priestess of Tylae.
&lt;img src=&quot;Images/Character/witch3.jpg&quot; width=450 /&gt;

She also realized that having a single priestess of Tylae to protect all of the Deep Woods was an impossible task. With &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; help, she spread word of the need for new priestesses to devote themselves to the Mother Goddess. Soon, a stream of young women joined &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, and the priesthood of Tylae grew to become an established group in the Deep Woods. 
&lt;img src=&quot;Images/Epilogue/witches1.jpg&quot; width=600 /&gt;

Humans and elves began to make pilgrimages to the Deep Woods, seeking the priestesses&#39; aid and healing magic.

&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; sometimes missed the solitude of her old life, but only rarely. Like the Goddess she so revered, she had become a mother to the Deep Woods, and to all her young disciples.
\
&lt;&lt;else&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; perished at the Shadow Gate. With her death, the long line of priestesses in service to Tylae ended. 
&lt;img src=&quot;Images/DarkHeart/savewitch8.jpg&quot; width=650 /&gt;

Much knowledge and old magic was lost with her passing. There is some hope another will come to take up her mantle, but none have yet succeeded.
\
&lt;&lt;/if&gt;&gt;\

[[As for Babar...-&gt;Epilogue1][$p = 10]]

&lt;&lt;elseif $p eq 10&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&lt;/b&gt;&lt;/span&gt; left the Deep Woods a much wealthier merchant than he entered them as. Not that he found much gold there - in fact, it wasn&#39;t a very profitable venture - but he found far greater treasures:

Atonement, forgiveness, and peace.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

With his brother put to rest and the Deep Woods saved, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; resumed his trade as a merchant with a renewed sense of happiness and hope. This jolity seemed to work as a kind of good luck charm. Wherever the merchant travelled, he could not help but run across good deals and rare (and profitable) artifacts. His wealth grew tenfold in the next year.

But &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; had come to learn that there was quite a bit more to life than riches. He developed a terrible habit of donating his wealth to the poor. As such, he would never build a grand merchantile empire.

Still, he slept easily each night. Peace of mind, as it turns out, is worth its weight in gold.

[[As for Naya...-&gt;Epilogue1][$p = 11]]
\
\
&lt;&lt;elseif $p eq 11&gt;&gt;\

&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Princess Naya of Hadamshal&lt;/b&gt;&lt;/span&gt; emerged from the Deep Woods with a renewed sense of purpose. No longer willing to run from her destiny and birthright, she immediately took to work in seeing her dream realized.

With the support of &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Regent Brunhilde&lt;/b&gt;&lt;/span&gt;, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; gathered many of the survivors of Hadamshal, and offered them a new home far away from human slums - in the old Netheryn Capital.
&lt;img src=&quot;Images/Epilogue/elves1.jpg&quot; width=700 /&gt;

In the year that followed, elves arrived in droves - not just from Hadamshal, but from many of the other elven cities destroyed during the reign of the last king. They worked day and night to restore the old Capital of Netheryn in heart of the Deep Woods.

Exactly one year after the Battle for Eternity, she was crowned &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Queen Naya of Netheryn&lt;/b&gt;&lt;/span&gt;. Dignitaries from the surrounding realms - including &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt;, &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt;&lt;&lt;if $witchlives eq 1&gt;&gt;, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;&lt;&lt;else&gt;&gt; and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;&lt;&lt;/if&gt;&gt; - attended, and prayed for her long and peaceful reign.
&lt;img src=&quot;Images/Epilogue/naya1.jpg&quot; width=500 /&gt;

A small shrine was built in the city to remember those who fell in Hadamshal. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Queen Naya&lt;/b&gt;&lt;/span&gt; was often seen visiting it, and resting her fingers against a single name.

&lt;i&gt;Prince Nendel of Hadamshal - who taught us it is never too late to be redeemed.&lt;/i&gt;

[[And as for you...-&gt;Epilogue1][$p = 12]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
&lt;b&gt;$name $title&lt;/b&gt; remained in the Deep Woods for another few days after the Battle for Eternity, nursing &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;his&lt;&lt;else&gt;&gt;her&lt;&lt;/if&gt;&gt; wounds and telling - and retelling - the story of what happened within the Temple of Eternity to &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt;, &lt;span class=&quot;gresh&quot;&gt;&lt;b&gt;Ghorok&lt;/b&gt;&lt;/span&gt;, &lt;span class=&quot;dead&quot;&gt;&lt;b&gt;Barsenes&lt;/b&gt;&lt;/span&gt;, and the Deathguard. Many found it hard to believe that the God of Destruction was just moments from devouring the world, but none had any reason to doubt &lt;b&gt;$name&#39;s&lt;/b&gt; words.
&lt;img src=&quot;Images/DarkHeart/end2.jpg&quot; width=550 /&gt;

$name left the Deep Woods at the same time as &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;, seeing no reason to stay any longer. After heartfelt farewells to &lt;&lt;if $witchlives eq 1&gt;&gt;&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;&lt;&lt;else&gt;&gt;&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;&lt;&lt;/if&gt;&gt;, &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;he&lt;&lt;else&gt;&gt;she&lt;&lt;/if&gt;&gt; departed, hitching a ride on &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; wagon.
&lt;img src=&quot;Images/Outskirts/outskirts7.jpg&quot; width=650 /&gt;

They traveled as a pair for a few more days, until they reached the border of the Kingdom. Technically, &lt;b&gt;$name&lt;/b&gt; was still a traitor to the throne - it would take some time for &lt;span class=&quot;king&quot;&gt;&lt;b&gt;Brunhilde&lt;/b&gt;&lt;/span&gt; to fix that.

So &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; and &lt;b&gt;$name&lt;/b&gt; held a great feast out in the wilds. They ate roasted boar, drank wine, and laughed at each other while sharing tales of their forays in the Deep Woods.

[[And when morning came, they parted ways.-&gt;Epilogue1][$p = 13]]

&lt;&lt;elseif $p eq 13&gt;&gt;\
And after that, who can say?

&lt;b&gt;$name $title&lt;/b&gt; simply disappeared from history. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; of course hoped that &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;he&lt;&lt;else&gt;&gt;she&lt;&lt;/if&gt;&gt; would attend her coronation, but &lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;his&lt;&lt;else&gt;&gt;her&lt;&lt;/if&gt;&gt; seat remained empty.

The day after she is crowned, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; catches up with &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;, just as he  prepares to leave Netheryn.
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;Naya2Talk &quot;You know, after everything, I thought $name would be here. This day is more his doing than it is mine.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;Naya2Talk &quot;You know, after everything, I thought $name would be here. This day is more her doing than it is mine.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
The merchant laughs, then gives the elven queen an almost fatherly look.
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;MerchantTalk &quot;Don&#39;t be so pained over it, Naya. He would have been here if it was possible. He&#39;s just got his hands full, yes?&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;MerchantTalk &quot;Don&#39;t be so pained over it, Naya. She would have been here if it was possible. She&#39;s just got her hands full, yes?&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;Naya2Talk &quot;So you know where he is, then?&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;Naya2Talk &quot;So you know where she is, then?&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; shrugs, then gestures over to the horizon.
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;MerchantTalk &quot;No... but the day before $name and I parted ways, he told me a most curious tale. It was about a young man who had been cursed to wear a chain of iron around his soul - a punishment for an old misdeed. This chain weighed on him for twelve long years - until at last, in the Heart of the Deep Woods, it was broken. It took the help of friends, of course - particularly a brave merchant by the name of Babar - but at last, the chain was gone. Only then could the man begin his life anew.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;MerchantTalk &quot;No, Naya, I don&#39;t. But the day before $name and I parted ways, she told me a most curious tale. It was about a young woman who had been cursed to wear a chain of iron around her soul - a punishment for an old misdeed. This chain weighed on her for twelve long years - until at last, in the Heart of the Deep Woods, it was broken. It took the help of friends, of course - particularly a brave merchant by the name of Babar - but at last, the chain was gone. Only then could the woman begin her life anew.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; places a hand against her heart, catching his meaning.
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;&lt;&lt;MerchantTalk &quot;Wherever $name is, I imagine he&#39;s happy. Wherever he is...I think he&#39;s finally free.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;MerchantTalk &quot;Wherever $name is, I imagine she&#39;s happy. Wherever she is...I think she&#39;s finally free.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if ($lewdmode eq 1) and ($merchantlove gte 31)&gt;&gt;[[The end-&gt;Epilogue2][$p = 0]]&lt;&lt;elseif ($lewdmode eq 1) and ($nayalove gte 30)&gt;&gt;[[The end-&gt;Epilogue2][$p = 8]]&lt;&lt;elseif ($lewdmode eq 1) and ($witchlove gte 22)&gt;&gt;[[The end-&gt;Epilogue2][$p = 17]]&lt;&lt;else&gt;&gt;[[The end-&gt;Close][$p = 0]]&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="157" name="Close" tags="" position="398,1827" size="100,100">Hi there - it&#39;s Lobsterman9999
&lt;img src=&quot;Images/Other/lobster.jpg&quot; width=600 /&gt;

Thank you so much for playing &lt;b&gt;&lt;i&gt;Battle Quest&lt;/i&gt;&lt;/b&gt;. 

I hope you enjoyed playing it as much as I enjoyed creating it.

Bug fixes and balancing are ongoing.



</tw-passagedata><tw-passagedata pid="158" name="Lewd Mode" tags="" position="595,1600" size="100,100">&lt;b&gt;Lewd Mode&lt;/b&gt; is an optional setting that unlocks the following features in the game:
&lt;ul&gt;\
&lt;li&gt;Optional romances + scenes for male and female characters&lt;/li&gt;
&lt;li&gt;Different, more revealing versions of the female avatar&lt;/li&gt;
&lt;li&gt;A mirror within the cabin to check out your body&lt;/li&gt;
&lt;li&gt;The ability to transform parts of your body at certain points in the game&lt;/li&gt;
&lt;/ul&gt;\
&lt;img src=&quot;Images/Other/heart1.jpg&quot; width=500 /&gt;

Without &lt;b&gt;Lewd Mode&lt;/b&gt;, the game includes no erotic or romantic content.

[[Continue with Lewd Mode-&gt;Class Select][$lewdmode = 1]] 
[[Continue without Lewd Mode-&gt;Class Select][$lewdmode = 0]] 
\
\
&lt;&lt;set $lewdmode = 0&gt;&gt;\
\
\
&lt;&lt;if $gender eq &quot;female&quot;&gt;&gt;\
\
&lt;&lt;set $chestlewd = 5&gt;&gt;\
&lt;&lt;set $hips = 5&gt;&gt;\
&lt;&lt;set $ass = 5&gt;&gt;
&lt;&lt;set $pussy = 1&gt;&gt;\
&lt;&lt;set $fem = 5&gt;&gt;\
&lt;&lt;set $penis = 0&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;\
\
&lt;&lt;set $chestlewd = 1&gt;&gt;\
&lt;&lt;set $hips = 1&gt;&gt;\
&lt;&lt;set $ass = 1&gt;&gt;\
&lt;&lt;set $penis = 1&gt;&gt;\
&lt;&lt;set $fem = 1&gt;&gt;\
&lt;&lt;set $pussy = 0&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
\
\
&lt;&lt;set $startingname = $name&gt;&gt;\
&lt;&lt;set $startingtitle = $title&gt;&gt;\

\
\</tw-passagedata><tw-passagedata pid="159" name="Mirror" tags="" position="596,1711" size="100,100">You remove your clothes and gaze into the mirror.

[[Return-&gt;Cabin]] 

&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;
&lt;b&gt;Chest&lt;/b&gt;
&lt;&lt;if $chestlewd eq 1&gt;&gt;\
You have a broad, muscular chest. It is a testament to your masculinity and overwhelming strength.
&lt;img src=&quot;Images/Other/chest1.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $chestlewd eq 2&gt;&gt;\
Your chest is narrow, hairless, and plain. None would ever describe it as &#39;manly - thought some might call it cute.
&lt;img src=&quot;Images/Other/chest2.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $chestlewd eq 3&gt;&gt;\
Your chest ripples with hard, corded muscles. You are built like a God of warfare, and your bulging muscles make it clear you are a champion and leader of men.
&lt;img src=&quot;Images/Other/chest3.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $chestlewd eq 4&gt;&gt;\
Your nipples have grown, and feel sensitive. Fat has gatheed beneath them, forming small breasts. You have the chest of a cute teenage girl!
&lt;img src=&quot;Images/Other/chest4.jpg&quot; width=300 /&gt;
&lt;&lt;/if&gt;&gt;\

&lt;b&gt;Hips&lt;/b&gt;
&lt;&lt;if $hips eq 1&gt;&gt;\
You have a narrow waist and muscular hips.
&lt;img src=&quot;Images/Other/hips1.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $hips eq 2&gt;&gt;\
Your hips have gone soft, and widened out. You now walk with a subtle sway, like a woman.
&lt;img src=&quot;Images/Other/hips2.jpg&quot; width=300 /&gt;
&lt;&lt;/if&gt;&gt;\

&lt;b&gt;Ass&lt;/b&gt;
&lt;&lt;if $ass eq 1&gt;&gt; \
You have a tight, well-muscled ass. When you flex, the cheeks go concave.
&lt;img src=&quot;Images/Other/ass1.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $ass eq 2&gt;&gt;\
Your ass seems to have grown, recently. It is now fat and shaped like two bubbles. 
&lt;img src=&quot;Images/Other/ass2.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $ass eq 3&gt;&gt;\
Your ass is round and bouncy like a woman&#39;s. Your asshole feels sensitive and needy. Touching it feels nice.
&lt;img src=&quot;Images/Other/ass3.jpg&quot; width=300 /&gt;
&lt;&lt;/if&gt;&gt;\

&lt;b&gt;Cock&lt;/b&gt;
&lt;&lt;if $penis eq 1&gt;&gt;\
You have a nice, somewhat average penis. It gets the job done, and none of your lovers have ever complained.
&lt;img src=&quot;Images/Other/penis1.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $penis eq 2&gt;&gt;\
Your penis has lost its hair and shrunk to little more than an inch in size. It is incredibly sensitive, but can no longer become erect.
&lt;img src=&quot;Images/Other/penis2.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $penis eq 3&gt;&gt;\
Your penis has become thick and long. Your balls, too, are now larger and heavier than before. Any man would be proud to wield such a rod between his legs.
&lt;img src=&quot;Images/Other/penis3.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $penis eq 4&gt;&gt;\
Your penis is now among the largest seen among men. Your erections are hard as diamonds. When you walk, your bulge catches the eyes of any woman nearby. You are built like a God of sex.
&lt;img src=&quot;Images/Other/penis4.jpg&quot; width=300 /&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;elseif $gender eq &quot;female&quot;&gt;&gt;
&lt;b&gt;Chest&lt;/b&gt;
&lt;&lt;if $chestlewd eq 5&gt;&gt; \
You have a pair of average, bouncy breasts. They are perky and sensitive to the touch, but they don&#39;t get in the way during combat. You&#39;ve always been proud of your impressive-yet-practical bust.
&lt;img src=&quot;Images/Other/chest5.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $chestlewd eq 6&gt;&gt; \
Your breasts are large, too big to hold in the palm of your hand. Your bras struggle to keep them under control, and you can feel their weight when you stand. Your nipples, too, are bigger and more sensitive than before. You find yourself rubbing them at night, which quickly makes you wet.
&lt;img src=&quot;Images/Other/chest6.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $chestlewd eq 7&gt;&gt; \
Your breasts are massive, and significantly sow your down in combat. They would look much more at home being sucked at by babies than on the best of a hero like you. Your bras are useless, meaning they press directly against your armor. The feeling of metal against your puffy, sensitive nipples means your always a bit turned on in combat.
&lt;img src=&quot;Images/Other/chest7.jpg&quot; width=300 /&gt;
&lt;&lt;/if&gt;&gt;\

&lt;b&gt;Hips&lt;/b&gt;
&lt;&lt;if $hips eq 3&gt;&gt;
You have wide, feminine hips. They&#39;re proportionate to your figure and give you a bit of a sexy sway to your walk. Sitting between them is your thick, girly cock.
&lt;img src=&quot;Images/Other/hips3.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $hips eq 5&gt;&gt;\ 
You have somewhat wide, very feminine hips. They&#39;re proportionate to your figure and give you a bit of a sexy sway to your walk. You like them, but wouldn&#39;t want them any bigger.
&lt;img src=&quot;Images/Other/hips5.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $hips eq 6&gt;&gt;\
You have wide, childbearing hips. Around them, soft fat has built up, especially on your tummy. Anyone who looked at you would think your job involved making lots of babies, not saving the world. Looking in the mirror, you feel like hips like these &lt;i&gt;should&lt;/i&gt; be put to use by being a mother to many children. The thought of getting pregnant has become a huge turn-on.
&lt;img src=&quot;Images/Other/hips6.jpg&quot; width=300 /&gt;
&lt;&lt;/if&gt;&gt;\

&lt;b&gt;Ass&lt;/b&gt;
&lt;&lt;if $ass eq 5&gt;&gt; \
You have a cute, firm ass. You love its shape and how it looks in your fitted pants.
&lt;img src=&quot;Images/Other/ass5.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $ass eq 6&gt;&gt; \
You ass is bigger and bouncier than before. Its tightness has given way to a pleasant softness, and it jiggles when you slap it.
&lt;img src=&quot;Images/Other/ass6.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $ass eq 7&gt;&gt; \
You have a fat ass that bounces with every step. Pants can barely contain it, and it affects your center of balance. The trouble is, you &lt;i&gt;love&lt;/i&gt; how big and sexy it is. At several points each day, you get lost in imagining what it would be like for a man to spread your cheeks and push his cock inside your asshole.
&lt;img src=&quot;Images/Other/ass7.jpg&quot; width=300 /&gt;
&lt;&lt;/if&gt;&gt;\

&lt;b&gt;Pussy&lt;/b&gt;
&lt;&lt;if $pussy eq 1&gt;&gt;\ 
You have a pretty little pussy. Its lips stay ever so slighty parted, and if you ignore it for too long it gets wet with desire. You&#39;ve always enjoyed pleasuring yourself with it, and your few sexual partners in the past have commented on how warm and tight you are inside.
&lt;img src=&quot;Images/Other/pussy1.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $pussy eq 2&gt;&gt;\ 
Your pussy has become pinker and plumper, as of late. Your clit, too, seems to get hard and excited at a moment&#39;s notice. It always feels wet and ready to fuck. Your mind drifts to sexual fantasies far more often than before. You have the pussy of a so-called &#39;easy woman,&#39; now.
&lt;img src=&quot;Images/Other/pussy2.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $pussy eq 3&gt;&gt;\ 
Your pussy is permanently wet - in fact, it constantly drips warm lube down your thighs, practically begging to get filled with cock. Rubbing it feels amazing, and it tends to squirt out its juices when you cum. You have a slutty, desperate pussy - from now on, you&#39;ll be ready and willing to fuck anything that moves.
&lt;img src=&quot;Images/Other/pussy3.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $pussy eq 4&gt;&gt;\ 
You&#39;ve been blessed with the best of both worlds - a hard cock and a wet pussy, all in one. Stuffing your pussy with your own cock is a whole new kind of pleasure, and cumming inside of yourself makes you feel like a naughty slut. You love nothing more than perking yourself off while fingering your dripping wet pussy.
&lt;img src=&quot;Images/Other/pussy4.jpg&quot; width=300 /&gt;
&lt;&lt;elseif $pussy eq 5&gt;&gt;\ 
There&#39;s only one word to properly describe your pussy - &lt;i&gt;fat&lt;/i&gt;. Your outer lips are plump, your inner lips nearly as thick, and pushing a finger into your wet depths reveals how warm and juicy you&#39;ve become. Your clit is fat enough to push far past its hood, and always seems to throb, eager for your attention. When you get turned on, it gets erect like a tiny little cock!
&lt;img src=&quot;Images/Other/pussy5.jpg&quot; width=300 /&gt;
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $pleasured neq 0&gt;&gt;&lt;i&gt;You already pleasured yourself today. Your lust has been sated for now.&lt;/i&gt;&lt;&lt;else&gt;&gt;&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;[[Relieve your stress-&gt;Stress Relief][$p = 0]]&lt;&lt;elseif $gender eq &quot;female&quot;&gt;&gt;[[Relieve your stress-&gt;Stress Relief F][$p = 0]]&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
[[Return-&gt;Cabin]] </tw-passagedata><tw-passagedata pid="160" name="Stress Relief" tags="" position="595,1826" size="100,100">&lt;&lt;if $penis eq 1&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
You shut your eyes and work up a nice fantasy to get your arousal building.
&lt;&lt;set $random = random(1, 3)&gt;&gt;\
&lt;&lt;if $random eq 1&gt;&gt;\
You see a beautiful woman, descended from the stars aove. The way she looks at you makes it clear that there&#39;s only one thing on her mind.
&lt;img src=&quot;Images/Other/vision1.jpg&quot; width=450 /&gt;
&lt;&lt;elseif $random eq 2&gt;&gt;\
You see of the famed gladiator women of the Southern Realms. adorned in nothing but a loincloth, she bares her breasts to her opponents - and the audience - as she fights for fame and glory.
&lt;img src=&quot;Images/Other/vision2.jpg&quot; width=450 /&gt;
&lt;&lt;elseif $random eq 3&gt;&gt;\
You see one of the royal protectors of the king. A beautiful woman in the real world - now, in your fantasy, she is issing some key components of her armor. The contrast of her soft skin and supple breasts against the hard folds of steel sends your heart racing.
&lt;img src=&quot;Images/Other/vision3.jpg&quot; width=450 /&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $nayalove eq 15&gt;&gt;[[Masturbate-&gt;Naya Lewd][$p = 14]]&lt;&lt;else&gt;&gt;[[Masturbate-&gt;Stress Relief][$p = 1]]&lt;&lt;/if&gt;&gt;
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
\
You stroke your stiff erection, lost in lust.
&lt;video loop muted autoplay src=&quot;Images/Other/solo1.mp4&quot;&gt;&lt;/video&gt;

Before too long, you climax, spurting your seed onto the floor. Feeling relaxed and no longer clouded by your arousal, you clean, get dressed, and return to your quest.

[[Return-&gt;Cabin]] 
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $penis eq 2&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
You shut your eyes and work up a nice fantasy to get your arousal building.
&lt;&lt;set $random = random(1, 3)&gt;&gt;\
&lt;&lt;if $random eq 1&gt;&gt;\
A lonely woman invites your back to your home. Eager, you follow, and watch with pleasure as she strips, revealing her bountiful breasts and... a rather impressive cock between her legs. Stiff with need, she pulls your down. Your mouth waters...
&lt;img src=&quot;Images/Other/vision6.jpg&quot; width=450 /&gt;
&lt;&lt;elseif $random eq 2&gt;&gt;\
A horny woman strips to nothing, then pushes a set of strange beads against her asshole. She moans as they slide in and out, then draws back her legs - revealing a turgid cock. The more you watch the arousing scene, the more the woman seems to look exactly like you...
&lt;img src=&quot;Images/Other/vision7.jpg&quot; width=550 /&gt;
&lt;&lt;elseif $random eq 3&gt;&gt;\
Two beautiful maidens bring you back to their home. When they strip, you see they have been blessed to carry the sex of both men and women. Lust overwhelms you, as they pull you onto the bed. Too late do you realize they intend for you to play the girl... not that you mind...
&lt;img src=&quot;Images/Other/vision8.jpg&quot; width=550 /&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $nayalove eq 15&gt;&gt;[[Masturbate-&gt;Naya Lewd][$p = 14]]&lt;&lt;else&gt;&gt;[[Masturbate-&gt;Stress Relief][$p = 1]]&lt;&lt;/if&gt;&gt;
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
You wiggle your bouncy ass in the air. With your cock unable to get hard, a new kind of pleasure is needed.
&lt;video loop muted autoplay src=&quot;Images/Other/solo2.mp4&quot;&gt;&lt;/video&gt;

Placing a soft rubber instrument between your ass cheeks, you squat down, gasping as your tight hole is penetrated. You ride the toy, moaning to the new sensations, until your limp cock spurts cum down your girly thighs.
&lt;video loop muted autoplay src=&quot;Images/Other/solo3.mp4&quot;&gt;&lt;/video&gt;

Feeling relaxed and no longer clouded by your arousal, you clean, get dressed, and return to your quest.

[[Return-&gt;Cabin]] 
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $penis gte 3&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;set $random = random(1, 3)&gt;&gt;\
&lt;&lt;if $random eq 1&gt;&gt;\
You pound a beautiful woman with you massive cock, splitting her in half and drawing out moans of pleasure with every thrust. Her breasts heave as she gasps in bliss, cumming on your cock.
&lt;img src=&quot;Images/Other/vision4.jpg&quot; width=550 /&gt;
&lt;&lt;elseif $random eq 2&gt;&gt;\
Your latest conquest spreads her cheeks, showing what your thick cock has done to her asshole. It&#39;s a cum-soaking, gaping mess. Still horny, she begs you to fuck her dripping wet pussy. Of course, you comply.
&lt;img src=&quot;Images/Other/vision5.jpg&quot; width=550 /&gt;
&lt;&lt;elseif $random eq 3&gt;&gt;\
A mysterious women sits on top of you riding your cock. Your substantial girth stretches her pussy, and draws out lewd moans from her luscious red lips.
&lt;video loop muted autoplay src=&quot;Images/Other/vision1.mp4&quot;&gt;&lt;/video&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $nayalove eq 15&gt;&gt;[[Masturbate-&gt;Naya Lewd][$p = 14]]&lt;&lt;else&gt;&gt;[[Masturbate-&gt;Stress Relief][$p = 1]]&lt;&lt;/if&gt;&gt;
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
You stroke your massive erection, lost in lust.
&lt;video loop muted autoplay src=&quot;Images/Other/solo4.mp4&quot;&gt;&lt;/video&gt;

Before too long, you climax, spurting a copious amount of semen onto the floor. Feeling relaxed and no longer clouded by your arousal, you clean, get dressed, and return to your quest.

[[Return-&gt;Cabin]] 
\
&lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;set $pleasured = 1&gt;&gt;\
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="161" name="Stress Relief F" tags="" position="595,1939" size="100,100">&lt;&lt;if ($pussy lte 3) or ($pussy eq 5)&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
You shut your eyes and work up a nice fantasy to get your arousal building.

&lt;&lt;set $random = random(1, 7)&gt;&gt;\
&lt;&lt;if ($merchantlove eq 11) or ($merchantlove eq 16)&gt;&gt;\
You&#39;re kneeling before &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; glory hole, nervous about what you&#39;re going to do. After knocking three times, his cock slides through. It&#39;s long and thick and &lt;i&gt;perfect&lt;/i&gt;.
&lt;img src=&quot;Images/Other/gloryhole2.jpg&quot; width=550 /&gt;

&lt;&lt;if $merchantlove eq 11&gt;&gt;&lt;&lt;HeroTalk &quot;Ugh, why is this such a turn-on?&quot;&gt;&gt;&lt;&lt;elseif $merchantlove eq 16&gt;&gt;&lt;&lt;HeroTalk &quot;Fuck yes, Babar... give me that cock...&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $random eq 1&gt;&gt;\
You see yourself as a courtesean of the Great Occident, hired by wealthy desert merchants to give them pleasure from your body. You lower yourself onto your client&#39;s massive cock, your lips spreading, your body quivering from his impressive girth.
&lt;img src=&quot;Images/Other/vision9.jpg&quot; width=550 /&gt;
&lt;&lt;elseif $random eq 2&gt;&gt;\
&lt;&lt;if $fem eq 5&gt;&gt;You recall a war from your past. After a harrowing fight, you and a comrade in arms celebrated your survival by stripping down in his tent and pressing your bodies together. His rough grip, his desperate thrusts - they had you cumming in moments.&lt;&lt;else&gt;&gt;You recall a war from your past. After a harrowing fight, you and a comrade in arms celebrated your survival by stripping down in her tent and pressing your bodies together. This time, though, you imagine &lt;i&gt;you&lt;/i&gt; as the woman, getting fucked up your needy cunt by a daring soldier. His rough grip, his desperate thrusts - he&#39;ll have you cumming in moments.&lt;&lt;/if&gt;&gt;
&lt;img src=&quot;Images/Other/vision10.jpg&quot; width=500 /&gt;
&lt;&lt;elseif $random eq 3&gt;&gt;\
You&#39;ve fallen into a murky pit, deep underground. There, a creature of darkness - of slime and tendrils and fathomless form - takes you into its unyielding grip. Stripped and spread open, you take its rigid member deep inside. It breeds you for nights on end. Your protests turn to lewd moans, as your womb fills with eggs...
&lt;img src=&quot;Images/Other/vision11.jpg&quot; width=500 /&gt;
&lt;&lt;elseif $random eq 4&gt;&gt;\
You&#39;ve lose a duel to an impressive swordsman, and the cost is a steep one indeed. Your breasts bared to the public square, your ass for all to see, you widen your mouth and take in his stiff cock. Before the townsfolk, you suck the victor&#39;s cock, your pussy getting wet from how arousing the humiliation feels.
&lt;img src=&quot;Images/Other/vision12.jpg&quot; width=500 /&gt;
&lt;&lt;elseif $random eq 5&gt;&gt;\
Captured in battle, your foes strip you and bind you with rope and chain. Instead of selling you for ransom, they decide to keep you as a camp slut. The only time you&#39;ll ever be unbound is when your mouth or cunt need a cock inside them. You can&#39;t wait...
&lt;img src=&quot;Images/Other/vision13.jpg&quot; width=500 /&gt;
&lt;&lt;elseif $random eq 6&gt;&gt;\
&lt;&lt;if $fem eq 5&gt;&gt;You never let a man stick his cock up there - but in your imagination, you make un exception. Your pussy drips with fiery need as your ass is stretched apart. You moan lustily, your breasts bouncing as he fucks you ragged. You can feel your orgasm rising...&lt;&lt;else&gt;&gt;You wonder it would feel like to feel a cock up your ass. How your pussy would drip with fiery need as your ass is stretched apart. You imagine that you&#39;d moan like a whore as your asshole is ravaged. You can feel your orgasm rising...&lt;&lt;/if&gt;&gt;
&lt;img src=&quot;Images/Other/vision14.jpg&quot; width=500 /&gt;
&lt;&lt;elseif $random eq 7&gt;&gt;\
An honorable wrestling match goes wrong, and your opponent tears off your clothes. Before you can protest, he has your pinned - and worse, his cock is pushing against your asshole. You try to fight him off but you can&#39;t. Seeing he&#39;s got you beat, he starts to mercilessly fuck you, making your pussy gush from how good it feels.
&lt;img src=&quot;Images/Other/vision15.jpg&quot; width=500 /&gt;
&lt;&lt;/if&gt;&gt;\

[[Masturbate-&gt;Stress Relief F][$p = 1]]
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
\
You rub your pussy, moaning in bliss.
&lt;&lt;if $pussy eq 1&gt;&gt;&lt;video loop muted autoplay src=&quot;Images/Other/solo5.mp4&quot;&gt;&lt;/video&gt;\
&lt;&lt;elseif $pussy eq 2&gt;&gt;&lt;video loop muted autoplay src=&quot;Images/Other/solo6.mp4&quot;&gt;&lt;/video&gt;\
&lt;&lt;elseif ($pussy eq 3) or ($pussy eq 5)&gt;&gt;&lt;video loop muted autoplay src=&quot;Images/Other/solo7.mp4&quot;&gt;&lt;/video&gt;\
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $pussy eq 1&gt;&gt;Your pussy gets wet, and you push one finger inside while another flicks your clit. Your tight little hole warms up to the touch, and that warm feeling growing with very flick. Soon you peak, and cry out as you cum.&lt;&lt;elseif $pussy eq 2&gt;&gt;Your pussy hungers for touch. As you push a finger deep inside, drops of your juices leak past your hand. Each time you touch your engorged clit, you cant help but moan like a slut. Soon your thighs are slick with wetness from your cunt. Crying out, you orgasm hard, a gush of fluid pouring out of you as you collapse in an exhausted heap.&lt;&lt;elseif ($pussy eq 3) or ($pussy eq 5)&gt;&gt;You jam two fingers into you gaping, soaking pussy. They easily slide in. Your thumb flicks your big, swollen clit, making you moan with pleasure loud enough for the whole camp to hear. Your juices spurt of you as your finger fuck yourself to climax, until you finally cum. Rubbing your clit, you squirt out of your pussy and soak the floor. The feeling is enough to make you nearly faint from pleasure. &lt;&lt;/if&gt;&gt;

Feeling relaxed and no longer clouded by your arousal, you clean up, get dressed, and return to your quest.

&lt;&lt;if $merchantlove eq 11&gt;&gt;[[Think about what just happened-&gt;Merchant Lewd][$p = 5]]&lt;&lt;elseif $merchantlove eq 16&gt;&gt;[[Think about what to do now-&gt;Merchant Lewd][$p = 26]]&lt;&lt;else&gt;&gt;[[Return-&gt;Cabin]]&lt;&lt;/if&gt;&gt;
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $pussy gte 4&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
You shut your eyes and work up a nice fantasy to get your arousal building.
&lt;&lt;set $random = random(1, 3)&gt;&gt;\
&lt;&lt;if $random eq 1&gt;&gt;\
Like a fool, you summon three succubi to do your bidding. They quickly overwhelm you, and tear off your clothes. The only way you&#39;ll escape with your soul intact is please them. Luckily, pleasing big-dicked demons is your speciality....
&lt;img src=&quot;Images/Other/vision16.jpg&quot; width=550 /&gt;
&lt;&lt;elseif $random eq 2&gt;&gt;\
The woman claims she&#39;s always wanted to try it with a girl &#39;like you.&#39; Naturally, you bring her home, and push her eager lips against your cock. She gags on your impressive size, while you face-fuck her until you cum.
&lt;img src=&quot;Images/Other/vision17.jpg&quot; width=550 /&gt;
&lt;&lt;elseif $random eq 3&gt;&gt;\
You imagine peering above a woman blessed like you, her thick cock stiff and pulsing with lust. As you tease her, she loses control, spurts her seed onto her face, and breasts, and tummy.
&lt;video loop muted autoplay src=&quot;Images/Other/vision2.mp4&quot;&gt;&lt;/video&gt;
&lt;&lt;/if&gt;&gt;\

[[Masturbate-&gt;Stress Relief F][$p = 1]]
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;set $random = random(1, 2)&gt;&gt;\
&lt;&lt;if $random eq 1&gt;&gt;\
You wrap your cock around your breasts and then lap at the head with your tongue. It feels so naughty to give yourself a titjob and a blowjob at the same time.
&lt;video loop muted autoplay src=&quot;Images/Other/solo8.mp4&quot;&gt;&lt;/video&gt;\

You can&#39;t last like this for long. You quickly climax, shooting cum into oyur face wihle you rpussy squirts its juices onto the floor.
&lt;video loop muted autoplay src=&quot;Images/Other/solo9.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;elseif $random eq 2&gt;&gt;\
You stroke yourself to completion, your semen shooting into the air just as your pussy spasms and squirts from the intensity of your orgasm.
&lt;video loop muted autoplay src=&quot;Images/Other/solo10.mp4&quot;&gt;&lt;/video&gt;\
&lt;&lt;/if&gt;&gt;\

Feeling relaxed and no longer clouded by your arousal, you clean, get dressed, and return to your quest.

[[Return-&gt;Cabin]] 
\
&lt;&lt;/if&gt;&gt;\
\
\
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $pleasured = 1&gt;&gt;\
&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
\
\</tw-passagedata><tw-passagedata pid="162" name="Full Notes" tags="" position="202,1595" size="100,100">- Naya rose, see her masturbate
- Get Naya&#39;s buttplug from the Scarlet Vale
- Give her the buttplug, on the condition you get to watch her use it
- Talk about sex, sexual frustration, sex between humans and elves
- Agree to some stress relief anal sex (the night before she leaves to Carnax)

</tw-passagedata><tw-passagedata pid="163" name="LewdShrine1" tags="" position="602,2055" size="100,100">&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
Walking through the outskirts, you come upon a curious-looking shrine. It appears absolutely ancient, yet clean of dirt and vine. Either the goblins visit it and keep it cared for, or some old magic is at work within it.
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

Upon closer inspection, you come to recognize the statue. How could you not, considering its curves, and breasts, and wings? This statue is a shrine to none other than &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith, Goddess of Desire.&lt;/b&gt;&lt;/span&gt;. 

A wanton Goddess, known to gift her devoted with their deepest, darkest desires - or destroy them on a whim. She is not a being to be trifled with.
&lt;&lt;HeroTalk &quot;I could provide an offering to assure her of no ill intent. Or I could send her a message, to prove that I am above her petty magics.&quot;&gt;&gt;\

&lt;&lt;if $gold gte 50&gt;&gt;[[Provide Lilith an offering of 50 gold pieces-&gt;LewdShrine1][$p = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Provide Lilith an offering of 50 gold pieces&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Spit on her shrine-&gt;LewdShrine1][$p = 5]]
[[Back away slowly-&gt;LewdShrine1][$p = 9]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
One does not tread lightly when it comes to the Gods. A small offering should suffice to let &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; leave you in peace.

You count out the gold pieces, set them between the statue&#39;s thick, stone thighs, then walk away...

... only to step up to the same statue. 
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;That can&#39;t be right.&quot;&gt;&gt;\
You have a keen sense of direction - you wouldn&#39;t get turned around so easily. Either there are &lt;i&gt;two&lt;/i&gt; shrines to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;, or some kind of magic is afoot.

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine1][$p = 2]]

&lt;&lt;set $gold -= 50&gt;&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
The laughter is melodious, sweet, and sinister at that same time. You stand your ground, your hand instinctively reaching for your $weapon.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... there&#39;s no need for violence.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;Shit.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Such a kind gift, my sweet. How am I to turn return the favor?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;That was no gift, only an offering to leave me be. I want no gift from the likes of you,&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Oh, but I think you do. Such a fine specimen of a man. So strong. So broad. But then...&quot;&gt;&gt;\
A warmth tingles on the head of your cock.
&lt;&lt;LilithTalk &quot;... where it matters most, so painfully average. &lt;i&gt;That just won&#39;t do!&lt;/i&gt;&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
\
As you cum, your cock starts to feel intensely hot. Peeling down your pants before you&#39;re burned, you see that it has &lt;i&gt;changed&lt;/i&gt; - it is impressively large, even flaccid. It&#39;s length and girth have both increased, and it feels you with a burning, reckless pride.
&lt;img src=&quot;Images/Other/penis3.jpg&quot; width=450 /&gt;

&lt;&lt;LilithTalk &quot;Oh, how lovely! And you like it already, I can tell.&quot;&gt;&gt;\
You grit your teeth.
&lt;&lt;HeroTalk &quot;I did not ask for this.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;You didn&#39;t have to. Farewell, my sweet. I hope we&#39;ll meet again.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you fix your pants and start walking back to your cabin. Moving around with this big tool between your legs is going to take some getting used to...

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $penis = 3&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
\
You need not sully yourself by bowing and scraping before such an ignoble Goddess as &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;. Instead, you spit your saliva onto the statue, and curse it to fall to ruin. Your spittle lands on the statue&#39;s breasts. It shouldn&#39;t, but the act is a bit of a turn-on.

With your deed done, you walk away...

... only to step up to the same statue. 
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;That can&#39;t be right.&quot;&gt;&gt;\
You have a keen sense of direction - you wouldn&#39;t get turned around so easily. Either there are &lt;i&gt;two&lt;/i&gt; shrines to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;, or some kind of magic is afoot.

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine1][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
\
The laughter is melodious, sweet, and sinister at that same time. You stand your ground, your hand instinctively reaching for your $weapon.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... that&#39;s not going to work.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;Shit.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Yes, &#39;shit&#39; is right. Spitting on me? Normally, I like when my partner plays dirty... but not today. Do you think you&#39;re &lt;i&gt;above&lt;/i&gt; me, sweetheart?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I care for not desire, or any of your deviant gifts.&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Oh, &#39;deviant,&#39; am I? I think it&#39;s time you learned a lesson in humility&quot;&gt;&gt;\
A warmth tingles on your chest.
&lt;&lt;LilithTalk &quot;... you think yourself a big, strong man? &lt;i&gt;Think again&lt;/i&gt;.&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine1][$p = 7]]

&lt;&lt;elseif $p eq 7&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine1][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
\
As you cum, your body starts to feel intensely hot. Cursing, you tear off your clothes just as the muscles along your chest and back begin to shrink, withering down and becoming soft and fragile.
&lt;img src=&quot;Images/Other/hips2.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;What have you done to me?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Brought you down to size, for one. Oh, do not pout, my sweet. There are is a different, finer kind of pleasure to be found in being oh so dainty and sweet.&quot;&gt;&gt;\
She laughs.
&lt;&lt;LilithTalk &quot;But perhaps I&#39;ll save that for another time. Farewell, sweetheart. I&#39;m sure we&#39;ll meet again.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you put on your clothes and start walking back to your cabin. You feel small and weak, with your muscles so shrunken down. Until you can find &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; agian and reverse the curse, it seems you&#39;re stuck like this.

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;You lost 1 strength!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $chestlewd = 2&gt;&gt;\
&lt;&lt;set $hips = 2&gt;&gt;\
&lt;&lt;set $ass = 2&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $basestrength -= 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\

&lt;&lt;elseif $p eq 9&gt;&gt;\
\
Instead of acting rashly, you decide to simply walk away. No good can come from getting involved with a Goddess like &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;.

Soon enough, the statue is out of sight. It might be your imagination, but you seem to hear a woman&#39;s distant sigh.

It must have been the wind.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\

&lt;&lt;/if&gt;&gt;\
\
\
\
\
\
\
\
&lt;&lt;elseif $gender eq &quot;female&quot;&gt;&gt;
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
Walking through the outskirts, you come upon a curious-looking shrine. It appears absolutely ancient, yet clean of dirt and vine. Either the goblins visit it and keep it cared for, or some old magic is at work within it.
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

Upon closer inspection, you come to recognize the statue. How could you not, considering its curves, and breasts, and wings? This statue is a shrine to none other than &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith, Goddess of Desire.&lt;/b&gt;&lt;/span&gt;. 

A wanton Goddess, known to gift her devoted with their deepest, darkest desires - or destroy them on a whim. She is not a being to be trifled with.
&lt;&lt;HeroTalk &quot;I could provide an offering to assure her of no ill intent. She may be a capricious Goddess, but she is still divine, and worthy of my respect.&quot;&gt;&gt;\

&lt;&lt;if $gold gte 50&gt;&gt;[[Provide Lilith an offering of 50 gold pieces-&gt;LewdShrine1][$p = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Provide Lilith an offering of 50 gold pieces&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Defile Lilith&#39;s shrine-&gt;LewdShrine1][$p = 6]]
[[Back away slowly-&gt;LewdShrine1][$p = 5]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
One does not tread lightly when it comes to the Gods. A small offering should suffice to let &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; leave you in peace.

You count out the gold pieces, set them between the statue&#39;s thick, stone thighs, then walk away...

... only to step up to the same statue. 
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;That can&#39;t be right.&quot;&gt;&gt;\
You have a keen sense of direction - you wouldn&#39;t get turned around so easily. Either there are &lt;i&gt;two&lt;/i&gt; shrines to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;, or some kind of magic is afoot.

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine1][$p = 2]]

&lt;&lt;set $gold -= 50&gt;&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
The laughter is melodious, sweet, and sinister at the same time. You stand your ground, your hand instinctively reaching for your $weapon.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... there&#39;s no need for violence.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;Shit.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Such a kind gift, my sweet. How am I to turn return the favor?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;That was no gift, only an offering to leave me be. I want no gift from the likes of you,&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Oh, but I think you do. Beneath those clothes, there&#39;s actually a woman hiding. So much beauty, waiting to be revealed. So much pleasure, waiting to be found...&quot;&gt;&gt;\
A warmth tingles on your clit.
&lt;&lt;LilithTalk &quot;... after such a kind gift, it&#39;s time I returned the favor. You&#39;re going to love the new you...&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine1][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine1][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
\
As you cum, your pussy starts to feel intensely hot. Peeling down your pants before you&#39;re burned, you see that it has &lt;i&gt;changed&lt;/i&gt; - it looks plumper than before, the lips swollen with need. Wetness pours down your thighs, and your clit pulses, now large enough to poke ever so lightly past its hood
&lt;img src=&quot;Images/Other/pussy2.jpg&quot; width=300 /&gt;

And then your breasts begin to burn just as hot. Gasping, you clutch them as they grow, swelling up to the size of coconuts, your nipples puffing up and expanding, too.
&lt;img src=&quot;Images/Other/chest6.jpg&quot; width=300 /&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Oh fuck.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;How lovely! And you like my gifts already, I can tell.&quot;&gt;&gt;\
You grit your teeth.
&lt;&lt;HeroTalk &quot;I did not ask for this.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;You didn&#39;t have to. Farewell, my sweet. I hope we&#39;ll meet again.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you put on your clothes and start walking back to your cabin. Your breasts feel ponderously heavy, your pussy won&#39;t stop leaking its juices into your underwear. This is going to take some getting used to...

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $pussy = 2&gt;&gt;\
&lt;&lt;set $chestlewd = 6&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
Instead of acting rashly, you decide to simply walk away. No good can come from getting involved with a Goddess like &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;.

Soon enough, the statue is out of sight. It might be your imagination, but you seem to hear a woman&#39;s distant sigh.

It must have been the wind.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 6&gt;&gt;\
\
You need not sully yourself by bowing and scraping before such an ignoble Goddess as &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;. Instead, you decide to defile this vile Goddess by paying her in her own coin.

After stripping down, you squat and relieve your bladder onto her thick stone thighs.
&lt;video loop muted autoplay src=&quot;Images/Other/solo15.mp4&quot;&gt;&lt;/video&gt;\

&lt;&lt;HeroTalk &quot;That will serve her right.&quot;&gt;&gt;\
Once you&#39;re nice and empty, you pull up your panties. Though you hate to admit it, the act was a bit of a turn-on.

With your deed done, you walk away...

... only to step up to the same statue. 
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;That can&#39;t be right.&quot;&gt;&gt;\
You have a keen sense of direction - you wouldn&#39;t get turned around so easily. Either there are &lt;i&gt;two&lt;/i&gt; shrines to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;, or some kind of magic is afoot.

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine1][$p = 7]]

&lt;&lt;elseif $p eq 7&gt;&gt;\
\
The laughter is melodious, sweet, and sinister at that same time. You stand your ground, your hand instinctively reaching for your $weapon.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... that&#39;s not going to work.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;Shit.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Yes, &#39;shit&#39; is right. Peeing on me? Normally, I like when my partner plays dirty... but not today. Do you think you&#39;re &lt;i&gt;above&lt;/i&gt; me, sweetheart?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I care for not desire, or any of your deviant gifts.&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Oh, &#39;deviant,&#39; am I? Well, that makes two of us&quot;&gt;&gt;\
A warmth tingles between your legs.
&lt;&lt;LilithTalk &quot;... you think yourself a dainty, chaste woman? &lt;i&gt;Think again&lt;/i&gt;.&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine1][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine1][$p = 9]]

&lt;&lt;elseif $p eq 9&gt;&gt;\
\
As you cum, your body starts to feel intensely hot. Cursing, you tear pull down your panties just in time to see your pussy puff up with heat. Your clitoris, usually tiny enough to be hidden by its hood, swells up, getting so thick that it seems to stick out past even your outer lips.
&lt;img src=&quot;Images/Other/pussy5.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;What have you done to me?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Oh, this is just the beginning, sweetheart. Just wait until you see what&#39;s next.&quot;&gt;&gt;\
She laughs.
&lt;&lt;LilithTalk &quot;But we&#39;ll save that for another time. Farewell. I&#39;m sure we&#39;ll meet again.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you put on your clothes and start walking back to your cabin. You pussy feels &lt;i&gt;big&lt;/i&gt; between your legs. It even throbs. Your swollen clit rubs against your panties, making you feel all tingly inside. Until you can find &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; again and reverse the curse, it seems you&#39;re stuck like this.

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;You gained 1 strength!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $pussy = 5&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $basestrength += 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\

\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
\
\
\
\
\
\
\
\
</tw-passagedata><tw-passagedata pid="164" name="LewdShrine2" tags="" position="600,2161" size="100,100">&lt;&lt;if $gender eq &quot;male&quot;&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
Walking through the Scarlet Vale, you come upon a familiar shrine. It appears absolutely ancient, yet clean of dirt and vine. The dark magic of &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith, Goddess of Desire&lt;/b&gt;&lt;/span&gt; burns within.
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;if $chestlewd eq 2&gt;&gt;The last time you were here, you spat on her stone tits, and your body suffered for it. Insulting her again might inspire her rage, or it might finally demonstrate that you are not her pawn.

&lt;&lt;if $gold gte 100&gt;&gt;[[Provide Lilith an offering of 100 gold pieces and beg for her forgiveness-&gt;LewdShrine2][$p = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Provide Lilith an offering of 100 gold pieces and beg for her forgiveness&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Spit on her shrine again, and prepare to suffer another naughty curse-&gt;LewdShrine2][$p = 5]]
\
&lt;&lt;elseif $penis eq 3&gt;&gt;The last time you were here, you provided her an offering, and you were blessed with a bigger dick. It has been nice to have, and perhaps a second gift from &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; is in order. Then again, she is a capricious Goddess... it might be best to walk away.

&lt;&lt;if $gold gte 50&gt;&gt;[[Provide Lilith a second offering of 50 gold pieces-&gt;LewdShrine2][$p = 10]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Provide Lilith a second offering of 50 gold pieces&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Leave the shrine alone-&gt;LewdShrine2][$p = 15]]
\
&lt;&lt;elseif $penis eq 1&gt;&gt;The last time you were here, you avoided her magic entirely. That seemed like an effective strategy - and it might be best to do so again.

&lt;&lt;if $gold gte 50&gt;&gt;[[Provide Lilith an offering of 50 gold pieces-&gt;LewdShrine2][$p = 20]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Provide Lilith an offering of 50 gold pieces&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Spit on her shrine-&gt;LewdShrine2][$p = 25]]
[[Leave the shrine alone-&gt;LewdShrine2][$p = 30]]


&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
One does not tread lightly when it comes to the Gods. Your last encounter with &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; taught you that.  An offering should to her should hopefully be enough to restore your strength.

You count out the gold pieces, set them between the statue&#39;s thick, stone thighs, and pray.
&lt;&lt;HeroTalk &quot;Oh, Lilith, devious and powerful. I come to you a humbled man. Please, return me my strength!&quot;&gt;&gt;\

[[You hear a woman&#39;s laughter-&gt;LewdShrine2][$p = 2]]

&lt;&lt;set $gold -= 100&gt;&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
The laughter is melodious, sweet, and sinister at that same time. You stand your ground, ready for anything
&lt;&lt;LilithTalk &quot;Oh, sweetheart... back with your tail between your legs? How charmig.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;Yes, I come to you contrite. Please, restore me, oh Lilith.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Such a kind gift. Very well, you will have your body restored... but that is not all.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;That is all I ask.&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;&lt;i&gt;Too bad!&lt;/i&gt; If you&#39;re to be a man, you shall be a stallion among men. I can&#39;t wait to hear your lovers moan as you break them in two...&quot;&gt;&gt;\
A warmth tingles on the head of your cock.
&lt;&lt;LilithTalk &quot;... in bed, I mean. Not on the battlefield...&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine2][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine2][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
\
As you cum, your body starts to burn. Stripping off your clothes, you see your muscles grow back to their old size - and then they keep growing! You roar with newfound power as you become a hulking, rippled beast of a man!
&lt;img src=&quot;Images/Other/chest3.jpg&quot; width=550 /&gt;

Then cock starts to feel intensely hot. Looking between your legs, you watch as it grows, and grows, and &lt;i&gt;grows&lt;/i&gt;, until it is impressively large, even flaccid. It&#39;s length and girth have both increased, and it feels you with a burning, reckless pride.
&lt;img src=&quot;Images/Other/penis3.jpg&quot; width=450 /&gt;

&lt;&lt;LilithTalk &quot;Oh, how lovely! And you like it already, I can tell.&quot;&gt;&gt;\
You grit your teeth.
&lt;&lt;HeroTalk &quot;I did not for such a cock.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;You didn&#39;t have to. You have been restored and enhanced, my sweet. Go, and drive women wild with your flesh. &lt;i&gt;I&#39;ll be watching&lt;/i&gt;.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you fix your pants and start walking back to your cabin. Moving around with this big tool between your legs is going to take some getting used to...

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;You gained 2 strength!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $penis = 3&gt;&gt;\
&lt;&lt;set $chestlewd = 3&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $basestrength += 2&gt;&gt;\
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
\
You refuse to play &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; games, and refuse to beg for her forgiveness. Her pathetic curse has hardly been an issue for you - in fact, you&#39;ve grown to enjoy your lithe body. There is something almost comforting in being so smooth and sweet...

Determined to get the better of the wanton Goddess, you spit your saliva onto the statue, and curse it to fall to ruin. Your spittle lands on the statue&#39;s breasts. 

With your deed done, you walk away...

... only to step up to the same statue. 
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;Oh. This again.&quot;&gt;&gt;\
&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; magic is at play.

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine2][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
\
The laughter is melodious, sweet, and sinister at that same time. You stand your ground, ready for her divine punishment.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... you little slut.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;I defy you, Lilith.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Oh, you &lt;i&gt;defy&lt;/i&gt; me? I think not. I can see right through you, sweetheart. The only reason you spat on my statue is because you &lt;i&gt;like&lt;/i&gt; your new body. You have tasted the sweetness of this soft, dainty form and you want more.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Liar!&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Remember, my sweet: you brought this upon yourself.&quot;&gt;&gt;\
A warmth tingles in your cock.
&lt;&lt;LilithTalk &quot;You won&#39;t be needing &lt;i&gt;that&lt;/i&gt; anymore...&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine2][$p = 7]]

&lt;&lt;elseif $p eq 7&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine2][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
\
As you cum, your cock starts to feel intensely hot. Cursing, you tear off your clothes just as your cock shrinks, all the flesh of it shriveling down to your abdomen. In a moment, nearly nothing remains, just a small head a bit of the shaft. The hair, too, is all gone. It looks pathetic and almost feminine!
&lt;img src=&quot;Images/Other/penis2.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;What have you done to me?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Given you what you always secretly wanted, I suspect. That little cocklet will get hard no longer - but don&#39;t fret, you&#39;ll find pleasure elsewhere..&quot;&gt;&gt;\
She laughs, and before your eyes a strange bluish rubber instrument appears on the ground.
&lt;img src=&quot;Images/Other/dildo1.jpg&quot; width=450 /&gt;

&lt;&lt;LilithTalk &quot;I suspect we&#39;ll meet once more, my sweet. Then, your fate will be sealed.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you put on your clothes and start walking back to your cabin. Your cock is so tiny, so miniscule, it fully slips inside your body when you walk. There&#39;s essentially nothing hanging between your legs - it makes you feel like a woman!

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;You lost 1 strength!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $penis = 2&gt;&gt;\
&lt;&lt;set $ass = 3&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $basestrength -= 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\

&lt;&lt;elseif $p eq 10&gt;&gt;\
One does not tread lightly when it comes to the Gods. One more offering  to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; is probably in your best interests. Besides, you&#39;re curious as to how she might make you even more powerful and virile...

You count out the gold pieces, set them between the statue&#39;s thick, stone thighs, and pray. 
&lt;&lt;HeroTalk &quot;Oh devious Lilith - I come to you seeking a second boon. Answer, I beg you!&quot;&gt;&gt;\

[[You hear a woman&#39;s laughter-&gt;LewdShrine2][$p = 11]]

&lt;&lt;set $gold -= 50&gt;&gt;\
\
&lt;&lt;elseif $p eq 11&gt;&gt;\
The laughter is melodious, sweet, and sinister at the same time. You stand your ground, ready for her
&lt;&lt;LilithTalk &quot;Oh, sweetheart... I&#39;m impressed. One has to be bold, or foolish, or desperate to pay me &lt;i&gt;twice&lt;/i&gt;.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;I want more. And I think you want to give me more.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Excess is a habit of mine... you&#39;re so clever, my sweet. I might have to reward you.&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Very well - let us make a true champion out of you! I love a fine physique...&quot;&gt;&gt;\
A warmth tingles on your best

[[A flash of light-&gt;LewdShrine2][$p = 12]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine2][$p = 13]]

&lt;&lt;elseif $p eq 13&gt;&gt;\
\
As you cum, your body starts to burn. Stripping off your clothes, you see your muscles swell. You roar with newfound power as you become a hulking, rippled beast of a man!
&lt;img src=&quot;Images/Other/chest3.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;Yes! I feel it, deep inside me - lust and power!&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Mmm... talk dirty to me, my sweet.&quot;&gt;&gt;\
Awash with desire, you cup the stone breast of the statue.
&lt;&lt;HeroTalk &quot;I can do more than &lt;i&gt;talk&lt;/i&gt; dirty.&quot;&gt;&gt;\
She giggles.
&lt;&lt;LilithTalk &quot;Men who fuck me tend to die, sweetheart - and you have work to do...&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you put on your clothes and start walking back to your cabin. You feel incredibly strong. The Deep Woods cannot stop a man blessed by &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;!

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;You gained 2 strength!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $chestlewd = 3&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $basestrength += 2&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 15&gt;&gt;\
\
Instead of getting further involved with &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;, you decide to simply walk away. You&#39;ve received plenty from her already. No need to push your luck.

Soon enough, the statue is out of sight. It might be your imagination, but you seem to hear a woman&#39;s distant sigh.

It must have been the wind.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\

&lt;&lt;elseif $p eq 20&gt;&gt;\
One does not tread lightly when it comes to the Gods. A small offering should suffice to let &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; leave you in peace.

You count out the gold pieces, set them between the statue&#39;s thick, stone thighs, then walk away...

... only to step up to the same statue. 
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;That can&#39;t be right.&quot;&gt;&gt;\
You have a keen sense of direction - you wouldn&#39;t get turned around so easily. Either there are &lt;i&gt;two&lt;/i&gt; shrines to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;, or some kind of magic is afoot.

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine2][$p = 21]]

&lt;&lt;set $gold -= 50&gt;&gt;\

&lt;&lt;elseif $p eq 21&gt;&gt;\
The laughter is melodious, sweet, and sinister at that same time. You stand your ground, your hand instinctively reaching for your $weapon.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... there&#39;s no need for violence.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;Shit.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Such a kind gift, my sweet. How am I to turn return the favor?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;That was no gift, only an offering to leave me be. I want no gift from the likes of you,&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Oh, but I think you do. Such a fine specimen of a man. So strong. So broad. But then...&quot;&gt;&gt;\
A warmth tingles on the head of your cock.
&lt;&lt;LilithTalk &quot;... where it matters most, so painfully average. &lt;i&gt;That just won&#39;t do!&lt;/i&gt;&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine2][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine2][$p = 23]]

&lt;&lt;elseif $p eq 23&gt;&gt;\
\
As you cum, your body starts to burn. Stripping off your clothes, you see your muscles grow back to their old size - and then they keep growing! You roar with newfound power as you become a hulking, rippled beast of a man!
&lt;img src=&quot;Images/Other/chest3.jpg&quot; width=550 /&gt;

At the same time your cock starts to feel intensely hot. Watching it, you see that it has &lt;i&gt;changed&lt;/i&gt; - it is impressively large, even flaccid. It&#39;s length and girth have both increased, and it feels you with a burning, reckless pride.
&lt;img src=&quot;Images/Other/penis3.jpg&quot; width=450 /&gt;

&lt;&lt;LilithTalk &quot;Oh, how lovely! And you like your gifts already, I can tell.&quot;&gt;&gt;\
You grit your teeth.
&lt;&lt;HeroTalk &quot;I did not ask for this.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;You didn&#39;t have to. Farewell, my sweet. I hope we&#39;ll meet again.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you fix your pants and start walking back to your cabin. Moving around with this big tool between your legs is going to take some getting used to...

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;You gained 2 strength!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $penis = 3&gt;&gt;\
&lt;&lt;set $chestlewd = 3&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $basestrength += 2&gt;&gt;\

&lt;&lt;elseif $p eq 25&gt;&gt;\
You need not sully yourself by bowing and scraping before such an ignoble Goddess as &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;. Instead, you spit your saliva onto the statue, and curse it to fall to ruin. Your spittle lands on the statue&#39;s breasts. It shouldn&#39;t, but the act is a bit of a turn-on.

With your deed done, you walk away...

... only to step up to the same statue. 
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;That can&#39;t be right.&quot;&gt;&gt;\
You have a keen sense of direction - you wouldn&#39;t get turned around so easily. Either there are &lt;i&gt;two&lt;/i&gt; shrines to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;, or some kind of magic is afoot.

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine2][$p = 26]]

&lt;&lt;elseif $p eq 26&gt;&gt;\
\
The laughter is melodious, sweet, and sinister at that same time. You stand your ground, your hand instinctively reaching for your $weapon.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... that&#39;s not going to work.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;Shit.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Yes, &#39;shit&#39; is right. Spitting on me? Normally, I like when my partner plays dirty... but not today. Do you think you&#39;re &lt;i&gt;above&lt;/i&gt; me, sweetheart?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I care for not desire, or any of your deviant gifts.&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Oh, &#39;deviant,&#39; am I? I think it&#39;s time you learned a lesson in humility&quot;&gt;&gt;\
A warmth tingles on your chest.
&lt;&lt;LilithTalk &quot;... you think yourself a big, strong man? &lt;i&gt;Think again&lt;/i&gt;.&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine2][$p = 27]]

&lt;&lt;elseif $p eq 27&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine2][$p = 28]]

&lt;&lt;elseif $p eq 28&gt;&gt;\
\
As you cum, your body starts to feel intensely hot. Cursing, you tear off your clothes just as the muscles along your chest and back begin to shrink, withering down and becoming soft and fragile.
&lt;img src=&quot;Images/Other/hips2.jpg&quot; width=450 /&gt;

Just afterwards, your cock starts to feel intensely hot. Cursing, you watch as your cock shrinks, all the flesh of it shriveling down to your abdomen. In a moment, nearly nothing remains, just a small head a bit of the shaft. The hair, too, is all gone. It looks pathetic and almost feminine!
&lt;img src=&quot;Images/Other/penis2.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;What have you done to me?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Given you what you always secretly wanted, I suspect. That little cocklet will get hard no longer - but don&#39;t fret, you&#39;ll find pleasure elsewhere..&quot;&gt;&gt;\
She laughs, and before your eyes a strange bluish rubber instrument appears on the ground.
&lt;img src=&quot;Images/Other/dildo1.jpg&quot; width=450 /&gt;

&lt;&lt;LilithTalk &quot;I suspect we&#39;ll meet once more, my sweet. Then, your fate will be sealed.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you put on your clothes and start walking back to your cabin. Your chest and muscles feel shrunken and weak. Your cock is so tiny, so miniscule, it fully slips inside your body when you walk. There&#39;s essentially nothing hanging between your legs - it makes you feel like a woman!

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;You lost 1 strength!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $penis = 2&gt;&gt;\
&lt;&lt;set $ass = 3&gt;&gt;\
&lt;&lt;set $hips = 2&gt;&gt;\
&lt;&lt;set $chestlewd = 2&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $basestrength -= 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 30&gt;&gt;\
Leaving &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; alone worked last time - surely it will work again. Besides, no good can come from getting involved with a Goddess like her.

Soon enough, the statue is out of sight. It might be your imagination, but you seem to hear a woman&#39;s distant sigh.

It must have been the wind.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
\
\
\
\
\
\
&lt;&lt;elseif $gender eq &quot;female&quot;&gt;&gt;
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
Walking through the Scarlet Vale, you come upon a familiar shrine. It appears absolutely ancient, yet clean of dirt and vine. The dark magic of &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith, Goddess of Desire.&lt;/b&gt;&lt;/span&gt; sustains the statue.
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;if $pussy eq 1&gt;&gt;The last time you found such a statue, you simply left it alone. You have half a mind to do the same again. Then again, you are at least curious what could be gained from invoking the Goddess of desire...

&lt;&lt;if $gold gte 50&gt;&gt;[[Provide Lilith an offering of 50 gold pieces-&gt;LewdShrine2][$p = 1]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Provide Lilith an offering of 50 gold pieces&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Back away slowly-&gt;LewdShrine2][$p = 5]]
\
&lt;&lt;elseif $pussy eq 2&gt;&gt;The last time you provided an offering to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; you rewarded you with bigger, bouncier tits and a wet, needy pussy. A day doesn&#39;t go by where you don&#39;t think about sex, nowadays. 

Clearly, you shouldn&#39;t give her a second offering.

You feel yourself blush.
&lt;&lt;HeroTalk &quot;Then again, I&#39;ve certainly enjoyed her gifts... I suppose I have a bit of a naughty side, after all...&quot;&gt;&gt;\

&lt;&lt;if $gold gte 50&gt;&gt;[[Provide Lilith a second offering of 50 gold pieces-&gt;LewdShrine2][$p = 10]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Provide Lilith an offering of 50 gold pieces&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Back away slowly-&gt;LewdShrine2][$p = 15]]
\
&lt;&lt;elseif $pussy eq 5&gt;&gt;The last time you defiled &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; shrine, she cursed you with a meaty pussy and a big clit. It might be time to beg for amends or be restored to normal...

... or, you could push the Goddess even further. She did seem to have a special plan for you...

&lt;&lt;if $gold gte 50&gt;&gt;[[Provide Lilith with an offering of 50 gold pieces-&gt;LewdShrine2][$p = 16]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Provide Lilith with an offering of 50 gold pieces&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Defile her shrine again-&gt;LewdShrine2][$p = 20]]
\
&lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
\
One does not tread lightly when it comes to the Gods. A small offering should suffice to relieve yourself of your curiosity and show respect to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;.

You count out the gold pieces, set them between the statue&#39;s thick, stone thighs, then walk away...

... only to step up to the same statue. 
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;That can&#39;t be right.&quot;&gt;&gt;\
You have a keen sense of direction - you wouldn&#39;t get turned around so easily. Either there are &lt;i&gt;two&lt;/i&gt; shrines to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;, or some kind of magic is afoot.

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine2][$p = 2]]

&lt;&lt;set $gold -= 50&gt;&gt;\
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
The laughter is melodious, sweet, and sinister at the same time. You stand your ground, your hand instinctively reaching for your $weapon.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... there&#39;s no need for violence.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;Shit.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Such a kind gift, my sweet. How am I to turn return the favor?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;It was nothing. I ask for nothing from you.&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Oh, but I think you do. Beneath those clothes, there&#39;s actually a woman hiding. So much beauty, waiting to be revealed. So much pleasure, waiting to be found...&quot;&gt;&gt;\
A warmth tingles on your clit.
&lt;&lt;LilithTalk &quot;... after such a kind gift, it&#39;s time I returned the favor. You&#39;re going to love the new you...&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine2][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine2][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
\
As you cum, your pussy starts to feel intensely hot. Peeling down your pants before you&#39;re burned, you see that it has &lt;i&gt;changed&lt;/i&gt; - it looks plumper than before, the lips swollen with need. Wetness pours down your thighs, and your clit pulses, now large enough to poke ever so slightly past its hood
&lt;img src=&quot;Images/Other/pussy2.jpg&quot; width=450 /&gt;

And then your breasts begin to burn just as hot. Gasping, you clutch them as they grow, swelling up to the size of coconuts, your nipples puffing up and expanding, too.
&lt;img src=&quot;Images/Other/chest6.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Oh fuck.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;How lovely! And you like my gifts already, I can tell.&quot;&gt;&gt;\
You grit your teeth.
&lt;&lt;HeroTalk &quot;I did not ask for this.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;You didn&#39;t have to. Farewell, my sweet. I hope we&#39;ll meet again.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you put on your clothes and start walking back to your cabin. Your breasts feel ponderously heavy, your pussy won&#39;t stop leaking its juices into your underwear. This is going to take some getting used to...

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $pussy = 2&gt;&gt;\
&lt;&lt;set $chestlewd = 6&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
Nothing good can come of interacting with such a lewd Goddess. You again decide to walk away.

Soon enough, the statue is out of sight. It might be your imagination, but you seem to hear a woman&#39;s distant sigh.

It must have been the wind.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\

&lt;&lt;elseif $p eq 10&gt;&gt;\
You simply can&#39;t help yourself. One offering to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; provided you with nothing but a curvier, sexier body and more frequent, more powerful orgasms. Surely a second offering could only be even more lovely?

You count out the gold pieces, your fingers shaking as you do, and then set them between the statue&#39;s thick, stone thighs.

&lt;&lt;HeroTalk &quot;Oh Lilith - heed my prayer. I have tasted your pleasures and find myself wanting more. Grant me bliss, and a body to match.&quot;&gt;&gt;\

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine2][$p = 11]]

&lt;&lt;set $gold -= 50&gt;&gt;\
\
&lt;&lt;elseif $p eq 11&gt;&gt;\
The laughter is melodious, sweet, and sinister at the same time. You fall to your knees, ready for her.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... I just &lt;i&gt;knew&lt;/i&gt; you would enjoy my gifts. And I must say, you look &lt;i&gt;delicious&lt;/i&gt;...&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your pussy starts to leak.
&lt;&lt;HeroTalk &quot;&lt;i&gt;Oooohhh...&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;And now you come for a second gift? So very naughty...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Just a bit more pleasure is all I ask...&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Pleasure comes with consequence, dear. A woman who sleeps around will eventually find her belly swollen, her breasts full of milk. Every mother was once a sweet little slut.&quot;&gt;&gt;\
You ass starts to get warm.
&lt;&lt;LilithTalk &quot;I know just the gift for a slut like you...&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine2][$p = 12]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine2][$p = 13]]

&lt;&lt;elseif $p eq 13&gt;&gt;\
\
As you cum, your ass starts to burn. Clutching it, you feel your cheeks swell in size, getting softer and rounder and fuller. Your ass cheeks swallow your underwear, turning them into a lewd thong.
&lt;img src=&quot;Images/Other/ass6.jpg&quot; width=450 /&gt;

And then your hips begin to burn just as hot. Gasping, you watch as fat seems to gather upon them, and on your tummy, too. Your lithe, athletic figure transforms before your eyes into the body of a sexy, curvy whore&#39;s!
&lt;img src=&quot;Images/Other/hips6.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Oh... oh no...&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Oh yes, sweetheart. Youre going to love the new you.&quot;&gt;&gt;\
You grit your teeth.
&lt;&lt;HeroTalk &quot;How am I supposed to fight like this?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;On your back, I suppose.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you put on your clothes and start walking back to your cabin. Your enlarged hips give you a slowly, sexy sway to your step, and your pants can barely contain your big, round ass.

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;Your agility has fallen by 1!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $hips = 6&gt;&gt;\
&lt;&lt;set $ass = 6&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $baseagility -= 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 15&gt;&gt;\
&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; has already enhanced your body and increased your libido. Any further gifts would likely put your quest in danger. You&#39;re here to be a hero, not a whore. Gritting your teeth, you turn around and leave.

Soon enough, the statue is out of sight. It might be your imagination, but you seem to hear a woman&#39;s distant sigh.

It must have been the wind.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 16&gt;&gt;\
\
You need to show your guilt and humility to the Goddess - only then will she fix you. A small offering should suffice make amends with &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;.

You count out the gold pieces, set them between the statue&#39;s thick, stone thighs, then walk away...

... only to step up to the same statue. 
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;That can&#39;t be right.&quot;&gt;&gt;\
You have a keen sense of direction - you wouldn&#39;t get turned around so easily. Either there are &lt;i&gt;two&lt;/i&gt; shrines to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;, or some kind of magic is afoot.

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine2][$p = 17]]

&lt;&lt;set $gold -= 50&gt;&gt;\
\
&lt;&lt;elseif $p eq 17&gt;&gt;\
The laughter is melodious, sweet, and sinister at the same time. You stand your ground, your hand instinctively reaching for your $weapon.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... there&#39;s no need for violence.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;Lilith....&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Your back, my sweet? And this time so deliciously polite.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I wish to be returned to normal.&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Normal? I&#39;ve never heard of such a thing. But if you &lt;i&gt;insist&lt;/i&gt; I will change what I had planned for you. A more typical feminine beauty, then? Very well... everyone loves a slut...&quot;&gt;&gt;\
A warmth tingles on your clit.
&lt;&lt;HeroTalk &quot;A &lt;i&gt;slut&lt;/i&gt;? what are you doing to me?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Relax, sweetheart! After such a kind gift, I&#39;m only returning the favor. You&#39;re going to love the new you...&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine2][$p = 18]]

&lt;&lt;elseif $p eq 18&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine2][$p = 19]]

&lt;&lt;elseif $p eq 19&gt;&gt;\
\
As you cum, your pussy starts to feel intensely hot. Peeling down your pants before you&#39;re burned, you see that it has &lt;i&gt;changed&lt;/i&gt; - it&#39;s not quite so meaty as before, but still plump and with a swollen clitoris.
&lt;img src=&quot;Images/Other/pussy2.jpg&quot; width=450 /&gt;

And then your breasts begin to burn just as hot. Gasping, you clutch them as they grow, swelling up to the size of coconuts, your nipples puffing up and expanding, too.
&lt;img src=&quot;Images/Other/chest6.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Oh fuck.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;How lovely! And you like my gifts already, I can tell.&quot;&gt;&gt;\
You grit your teeth.
&lt;&lt;HeroTalk &quot;I did not ask for this.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;You didn&#39;t have to. Farewell, my sweet. I hope we&#39;ll meet again.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you put on your clothes and start walking back to your cabin. Your breasts feel ponderously heavy, your pussy won&#39;t stop leaking its juices into your underwear. This is going to take some getting used to...

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $pussy = 2&gt;&gt;\
&lt;&lt;set $chestlewd = 6&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\

&lt;&lt;elseif $p eq 20&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;I won&#39;t be toyed with by some foolish Goddess. She thinks she can bully me? I stand defiant!&quot;&gt;&gt;\

After stripping down, you squat and relieve your bladder onto her thick stone thighs.
&lt;video loop muted autoplay src=&quot;Images/Other/solo15.mp4&quot;&gt;&lt;/video&gt;\

&lt;&lt;HeroTalk &quot;That will serve her right.&quot;&gt;&gt;\
Once you&#39;re nice and empty, you pull up your panties. Though you hate to admit it, the act was a bit of a turn-on.

With your deed done, you walk away...

... only to step up to the same statue. 
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;Ah... here we go again.&quot;&gt;&gt;\
You have a keen sense of direction - you wouldn&#39;t get turned around so easily. Either there are &lt;i&gt;two&lt;/i&gt; shrines to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;, or some kind of magic is afoot.

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine2][$p = 21]]

&lt;&lt;elseif $p eq 21&gt;&gt;\
\
The laughter is melodious, sweet, and sinister at that same time. You stand your ground, your hand instinctively reaching for your $weapon.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... didn&#39;t you learn last time? That won&#39;t help you.&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your feet freeze in place.
&lt;&lt;HeroTalk &quot;Shit.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Pissing on me &lt;i&gt;twice&lt;/i&gt;? I&#39;ve half a mind to turn you to ash right here. But then my dear sister will complain about me dooming the world. Well, I can get you back in other ways&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You wouldn&#39;t dare.&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Oh? I wouldn&#39;t? Welcome to your new life, sweetheart. I think it will &lt;i&gt;suit you&lt;/i&gt;.&quot;&gt;&gt;\
A warmth tingles between your legs.
&lt;&lt;LilithTalk &quot;... say farewell to womanhood.&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine2][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine2][$p = 23]]

&lt;&lt;elseif $p eq 23&gt;&gt;\
\
As you cum, your body starts to feel intensely hot. Screaming, you fall to your hands and knees and crawl away. The burning sensation grows, all of it flooding into your clit. Its like it&#39;s going to explode!
&lt;&lt;HeroTalk &quot;&lt;i&gt;Fuuuuuuck!&lt;/i&gt;&quot;&gt;&gt;\

Then it bursts.
&lt;video loop muted autoplay src=&quot;Images/Other/futa1.mp4&quot;&gt;&lt;/video&gt;\

You gasp in wonder as what can only be described as a &lt;i&gt;cock&lt;/i&gt; slides out, thick and long, from your clitoral hood. It pulses and twitches fully erect, even bigger than what most men have between their legs.
&lt;&lt;HeroTalk &quot;&lt;i&gt;This... this can&#39;t be happening.&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Impressed? You should be, my sweet. You are now &lt;i&gt;twice-blessed&lt;/i&gt;, my finest gift. I know, it will take some getting used to, but I&#39;m sure you&#39;ll come to love it...&quot;&gt;&gt;\
She fades into a cloud of red smoke. All you can do is stare at your new, wondrous anatomy. You&#39;re still a woman... in fact, you&#39;re &lt;i&gt;more&lt;/i&gt; than woman. You don&#39;t what word describes you anymore. Whatever happens in the Deep Woods, you will never be the same.

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;Your strength, agility, and willpower have increased by 1!&lt;/i&gt;

[[After getting dressed, you head back to your cabin-&gt;Outside the Cabin]] 
\
&lt;&lt;set $pussy = 4&gt;&gt;\
&lt;&lt;set $hips = 3&gt;&gt;\
&lt;&lt;set $ass = 6&gt;&gt;
&lt;&lt;set $lewdshrine += 1 &gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $basestrength += 1&gt;&gt;\
&lt;&lt;set $baseagility += 1&gt;&gt;\
&lt;&lt;set $basewillpower += 1&gt;&gt;\
&lt;&lt;set $pleasured = 1&gt;&gt;\
&lt;&lt;set $merchantlove = 5&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
\
\
\
\
\
\
\
\
\</tw-passagedata><tw-passagedata pid="165" name="Chest Blessing" tags="" position="595,2392" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
As you drift through a strange dream, a soft, melodious laughter catches your ears.

It sounds familiar.

[[Seek it out-&gt;Chest Blessing][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
Swimming through a dark haze, you see a small, shimmering flame in the distance. As you near it, it takes the form of a woman.
&lt;img src=&quot;Images/Other/lilith1.jpg&quot; width=500 /&gt;

Not just any woman. It&#39;s &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith, Goddess of Desire&lt;/b&gt;&lt;/span&gt;.

&lt;&lt;LilithTalk &quot;Hello, my sweet.&quot;&gt;&gt;\

[[Swim closer-&gt;Chest Blessing][$p = 2, $i = 1]]
[[Swim away-&gt;Chest Blessing][$p = 2, $i = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;You swim closer, curious as to what a Goddess is doing in your dream.
&lt;&lt;LilithTalk &quot;Yes, come close, sweetheart...&quot;&gt;&gt;\
&lt;&lt;elseif $i eq 2&gt;&gt;Try as you might, you can&#39;t swim away. A powerful current pulls you towards her.
&lt;&lt;LilithTalk &quot;Really, sweetheart? Did you think that would work?&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;HeroTalk &quot;What are you doing here?&quot;&gt;&gt;\
Her eyes fall to your shrunken manhood, your soft, lithe chest, your round, feminine ass, and your wide hips.
&lt;&lt;LilithTalk &quot;Admiring my work, mostly. But then I noticed something was missing...&quot;&gt;&gt;\

[[Missing?-&gt;Chest Blessing][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;HeroTalk &quot;What do you mean?&quot;&gt;&gt;\
In answer, she spreads her legs. Her pussy shimmering with her arousal.
&lt;img src=&quot;Images/Other/lilith4.jpg&quot; width=500 /&gt;

&lt;&lt;LilithTalk &quot;Come taste, and find out...&quot;&gt;&gt;\
You don&#39;t have much of a choice. Drawn in by the scent and sight of her divine beauty, your mouth latches onto her cunt. Sucking deep, you taste her.

[[You cum immediately-&gt;Chest Blessing][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
Your asshole spasms as you orgasm, while you tiny limp cock spurts out semen. Just as you cum, your chest begins to burn. Moaning, you feel your nipples harden as they grow, as small breasts form beneath them.
&lt;img src=&quot;Images/Other/chest4.jpg&quot; width=300 /&gt;

&lt;&lt;HeroTalk &quot;What have you done?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Oh, don&#39;t pretend to be upset, my sweet. From the moment you spat on my statue&#39;s breasts, I saw your jealously. You always wanted a body like this.&quot;&gt;&gt;\
You&#39;re not entirely sure whether she&#39;s wrong. Your mind too clouded by lust to make sense of anything.

[[Wake up-&gt;Chest Blessing][$p = 5]]

&lt;&lt;set $chestlewd = 4&gt;&gt;\
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
You wake up with the dawn.
&lt;img src=&quot;Images/Locations/morning1.jpg&quot; width=600 /&gt;

The moment you rise, you realize that the dream with &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; was more than a dream. The small breasts adorning your chest are proof of that. 
&lt;img src=&quot;Images/Other/chest4.jpg&quot; width=300 /&gt;

Gazing into your mirror, you run your hands down your soft, supple flesh, pausing to play with your nipples. A feminine gasp escapes your lips.
&lt;&lt;HeroTalk &quot;I am hardly a man, anymore. Even my voice betrays me. It may be time to change my name, soon...&quot;&gt;&gt;\
Oddly enough, the notion is &lt;i&gt;exciting&lt;/i&gt;.

[[Onwards!-&gt;Cabin]]

&lt;&lt;set $currenthealth = $maxhealth&gt;&gt;\
&lt;&lt;if $class neq &quot;soldier&quot;&gt;&gt;&lt;&lt;set $currentmana = $maxmana&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $startingmaxmana = $maxmana&gt;&gt;\
&lt;&lt;set $daynumber += 1&gt;&gt;\
&lt;&lt;set $time = &quot;Morning&quot;&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="166" name="LewdShrine3" tags="" position="594,2281" size="100,100">&lt;&lt;if $fem eq 1&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
Walking through the Frozen Hills, you come upon a familiar shrine. It appears absolutely ancient, yet clean of dirt and vine. The dark magic of &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith, Goddess of Desire&lt;/b&gt;&lt;/span&gt; burns within.
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;if $penis eq 2&gt;&gt;Your shriveled penis starts to leak precum the moment you spot the statue. &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; has changed you so much, but you sense a bit more change is required. You&#39;re almost there - you&#39;ve almost found the bliss she&#39;s designed for you. You need only ask for it.

[[Beg Lilith for one last gift-&gt;LewdShrine3][$p = 1]]
&lt;span class=&quot;grey&quot;&gt;Restrain yourself&lt;/span&gt;

&lt;&lt;elseif $penis eq 3&gt;&gt;Your hefty cock becomes erect the moment you spot the statue. &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; has blessed you with strength and virility. But you want more. You want &lt;i&gt;her&lt;/i&gt;

[[Demand she give herself to you-&gt;LewdShrine3][$p = 10]]
&lt;span class=&quot;grey&quot;&gt;Restrain yourself&lt;/span&gt;

&lt;&lt;elseif $penis eq 1&gt;&gt;You have successfully resisted her charms so far. You wouldn&#39;t dare fall into her trap now.

[[Back away-&gt;LewdShrine3][$p = 20]]

&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
\
You strip off your clothes and fall to your knees. Your small, sensitive breasts bounce from the movement.
&lt;&lt;HeroTalk &quot;Oh, Lilith, devious and powerful. Give me pleasure, give me salvation! I am a toy for you to mold as you see fit!&quot;&gt;&gt;\

[[You hear a woman&#39;s laughter-&gt;LewdShrine3][$p = 2]]
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
The laughter is melodious, sweet, and sinister at that same time. As the laughter grows, the statue begins to shake, then crack, and finally it shatters. From beneath it rises the Goddess of Desire herself - or at least a fragment of her in the mortal world.
&lt;img src=&quot;Images/Other/lilith1.jpg&quot; width=450 /&gt;

&lt;&lt;LilithTalk &quot;Oh sweetheart, look how far you&#39;ve come. Such a pretty, girlish figure. You&#39;re almost there.&quot;&gt;&gt;\

[[She removes her scandalous clothing-&gt;LewdShrine3][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
You gasp as you see what unfurls from between &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; legs. You&#39;ve never seen a cock so large. It would look at home on a stallion, and yet it seems to fit her. Just the sight of it is sending flashes of arousal through your veins.
&lt;img src=&quot;Images/Other/lilith5.jpg&quot; width=500 /&gt;

&lt;&lt;LilithTalk &quot;Go on, my sweet. A final gift I have for you, but first you must prove your devotion.&quot;&gt;&gt;\
You are far beyond any shame or chance of hesitation. Crawling on all fours, you approach &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; equine-like cock. It stiffens as your wrap your hands around it.

[[Serve the Goddess-&gt;LewdShrine3][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
You stretch your jaw and wrap your lips around its bulbous head. It is so hot as to nearly burn your tongue. The precum tastes like fresh honey. Moaning, you blow the Goddess.

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; Pushes deeper into your mouth, her girthy cock filling up your throat and making it had to breathe. That sweet, fiery honey seems to dissolve on your tongue and flow through your body. It gathers in your breasts, burning them, swelling them to twice their size.
&lt;img src=&quot;Images/Other/lilith6.jpg&quot; width=500 /&gt;

Then it carries on to your cock. You scream, your cries muffled by the dick in your mouth, as your scrotum melts into your body, and a flesh splits open. Your cock shrinks into the new folds, as your body reforms itself, turning your manhood into something else.

[[Lilith pulls out her cock-&gt;LewdShrine3][$p = 5]]

&lt;&lt;set $gender = &quot;female&quot;&gt;&gt;\
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
You slowly rise to your knees, feeling dizzy and disoriented. It&#39;s hard to tell, but you feel &lt;i&gt;shorter&lt;/i&gt;.
&lt;&lt;HeroTalk &quot;What have you done?&quot;&gt;&gt;\
Your eyes widen hearing your voice - so delicate, so feminine.
&lt;&lt;LilithTalk &quot;Oh, sweetheart - I only finished what I started. A bit of humility was all I wanted for you - and trading your manly brashness for a woman&#39;s grace seemed fitting. You&#39;ll love your new body - be sure to spread your legs for all the boys...&quot;&gt;&gt;\
As she speaks, your send a probing finger between your legs. The Goddess doesn&#39;t lie: you&#39;re a woman now - fully and completely.
&lt;img src=&quot;Images/Other/pussy1.jpg&quot; width=300 /&gt;

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; smiles bewitchingly at you.
&lt;&lt;LilithTalk &quot;We are even, my sweet. You may go in peace - you have a quest, and I have other playthings to enjoy. Or...&quot;&gt;&gt;\
Her look sends a twinge of worry down your spine.
&lt;&lt;HeroTalk &quot;Or?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;I could take your sweet maidenhood here and now... but such a thing would change you forever. You would not be a normal woman, anymore.&quot;&gt;&gt;\
As she speaks, she tugs on her cock.

[[Leave with your new, womanly body-&gt;LewdShrine3][$p = 6]]
[[Spread your legs and let Lilith transform you further-&gt;LewdShrine3][$p = 7]]

&lt;&lt;set $penis = 0&gt;&gt;\
&lt;&lt;set $pussy = 1&gt;&gt;\
&lt;&lt;set $chestlewd = 5&gt;&gt;\
&lt;&lt;set $ass = 5&gt;&gt;\
&lt;&lt;set $hips = 5&gt;&gt;\
\
&lt;&lt;elseif $p eq 6&gt;&gt;\
You bow with reverence, but do not accept. &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; seems to understand.
&lt;&lt;LilithTalk &quot;A fine choice, sweetheart. Go - heal this world. And maybe show that merchant friend of yours a good time.&quot;&gt;&gt;\
She fades into a cloud of red smoke.

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;Your agility and willpower have increased by 1!&lt;/i&gt;

[[After getting dressed, you head back to your cabin-&gt;LewdCabin][$p = 0]]

&lt;&lt;set $lewdshrine += 1 &gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $baseagility += 1&gt;&gt;\
&lt;&lt;set $basewillpower += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 7&gt;&gt;\
You know you shouldn&#39;t, but a part of you is intensely curious about how &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; would change your beautiful female body. Could you become &lt;i&gt;even more beautiful&lt;/i&gt;?

Besides, your new pussy is dripping with arousal. It wants to be filled.

Instead of saying anything, you lower yourself onto your back, spread your legs, and shut your eyes. It feels incredibly submissive and vulnerable, but for some reason that just makes your pussy even more soaked.
&lt;&lt;LilithTalk &quot;Oh, my sweet... if you insist...&quot;&gt;&gt;\
The next moment, your eyes shoot open as the Goddess thrusts &lt;i&gt;every inch&lt;/i&gt; of her swollen manhood into your eager pussy.
&lt;video loop muted autoplay src=&quot;Images/Other/femsex1.mp4&quot;&gt;&lt;/video&gt;\

[[Get fucked by a Goddess-&gt;LewdShrine3][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
The pain turns to pleasure as &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; soaks your insides with her magic precum. You hear a woman crying out in ecstasy - and realize that the woman is &lt;i&gt;you&lt;/i&gt;. Pleasure crashes through you like the waves of a storming sea, until all that bliss billed to a boiling point.

Moaning, you cum onto &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; cock.
&lt;video loop muted autoplay src=&quot;Images/Other/femsex2.mp4&quot;&gt;&lt;/video&gt;\

&lt;&lt;LilithTalk &quot;Such a good girl! Now, you&#39;re ready for your final blessing!&quot;&gt;&gt;\

[[She cums inside of you-&gt;LewdShrine3][$p = 9]]

&lt;&lt;elseif $p eq 9&gt;&gt;\
The semen burns like liquid fire pulsing through your guts. Screaming, you climb off of the Goddess and crawl away. The burning sensation grows, all of it flood into your clit. Its like it&#39;s going to explode!
&lt;&lt;HeroTalk &quot;&lt;i&gt;Fuuuuuuck!&lt;/i&gt;&quot;&gt;&gt;\

Then it bursts.
&lt;video loop muted autoplay src=&quot;Images/Other/futa1.mp4&quot;&gt;&lt;/video&gt;\

You gasp in wonder as your cock returns, sliding out from your clitoral hood. It pulses and twitches fully erect and even bigger than it used to be, before you first crossed paths with the Goddess of Desire.
&lt;&lt;LilithTalk &quot;Impressed? You should be, my sweet. You are now &lt;i&gt;twice-blessed&lt;/i&gt;, my finest gift awarded to my favorite mortals. Enjoy...&quot;&gt;&gt;\

She fades into a cloud of red smoke. All you can do is stare at your new, wondrous anatomy. You&#39;re not a man anymore, but you&#39;re more than a woman. Whatever happens in the Deep Woods, you will never be the same.

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;Your strength, agility, and willpower have increased by 1!&lt;/i&gt;

[[After getting dressed, you head back to your cabin-&gt;LewdCabin][$p = 0]]
\
&lt;&lt;set $pussy = 4&gt;&gt;\
&lt;&lt;set $hips = 3&gt;&gt;\
&lt;&lt;set $lewdshrine += 1 &gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $basestrength += 1&gt;&gt;\
&lt;&lt;set $baseagility += 1&gt;&gt;\
&lt;&lt;set $basewillpower += 1&gt;&gt;\
\
\
\
\
\
&lt;&lt;elseif $p eq 10&gt;&gt;\
You strip off your clothes and stand before the statue, proud of your musclebound physique and hefty cock.
&lt;&lt;HeroTalk &quot;Oh, Lilith, devious and powerful. You have filled me with desire that must be sated. Spread your legs before me, and let me drive you wild.&quot;&gt;&gt;\

[[You hear a woman&#39;s laughter-&gt;LewdShrine3][$p = 11]]
\
&lt;&lt;elseif $p eq 11&gt;&gt;\
The laughter is melodious, sweet, and sinister at that same time. As the laughter grows, the statue begins to shake, then crack, and finally it shatters. From beneath it rises the Goddess of Desire herself - or at least a fragment of her in the mortal world.
&lt;img src=&quot;Images/Other/lilith1.jpg&quot; width=450 /&gt;

&lt;&lt;LilithTalk &quot;Oh sweetheart, You really think you can lie with me? Most men who try turn to ash.&quot;&gt;&gt;\
The threat only makes you hard. Seeing the effect she&#39;s had on you, &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; licks her lips.
&lt;&lt;LilithTalk &quot;Very well... let&#39;s see how heroic you really are.&quot;&gt;&gt;\

[[She removes her scandalous clothing-&gt;LewdShrine3][$p = 12]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
As you might have guessed, the Goddess of Desire is tantalizingly beautiful. Her breasts are as round and pale as the full moon, heavy and heaving and topped with a puffy, swollen nipple. Her tight waist swells to her full, feminine hips and soft thighs, betwen which sits her womanhood, ever so sightly parted and glistening with wetness.
&lt;img src=&quot;Images/Other/lilith7.jpg&quot; width=500 /&gt;

&lt;&lt;LilithTalk &quot;Tell me I&#39;m pretty...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You&#39;re-&quot;&gt;&gt;\

[[Before you can even say the word, she leaps on top of you-&gt;LewdShrine3][$p = 13]]

&lt;&lt;elseif $p eq 13&gt;&gt;\
\
She hits you hard enough to knock the wind out of your lungs. You collapse on the cold ground, her body pressed up close, her legs wrapped around your hips. 
&lt;img src=&quot;Images/Other/lilith8.jpg&quot; width=500 /&gt;

She&#39;s incredibly hot - almost another to burn the skin whenever she touches you. You gasp as her pussy drips her arousal onto your cock - each drop as hot as liquid wax.
&lt;&lt;LilithTalk &quot;Mmmm... won&#39;t this be fun?&quot;&gt;&gt;\
You&#39;re not going to let her boss you around. You grasp the Goddess&#39;s perfect hips and jam your cock inside of her.

[[The two of you cry out together-&gt;LewdShrine3][$p = 14]]

&lt;&lt;elseif $p eq 14&gt;&gt;\
\
And then you&#39;re fucking her. Your grunts are a mix of pain and pleasure - pain, because she&#39;s burning hot inside, and pleasure, because the depths of her pussy are infinitely ridged and textured. As you plunge deep inside of her, you feel what must be eight different tongue lick and drool on your cock. One particularly long one licks to push inside your urethra.
&lt;img src=&quot;Images/Other/lilith9.jpg&quot; width=500 /&gt;

&lt;&lt;LilithTalk &quot;&lt;i&gt;Oh, Oh, Oh! Fuck me, sweetheart! Give me everything!&lt;/i&gt;&quot;&gt;&gt;\
Her massive breasts bounce up and down with your every thrut. Her saliva drips onto your abs, sizzling as it lands. You start to shake from the overwhelming sensations.

She wasn&#39;t lying - you might actually die from this.

&lt;b&gt;Willpower Check&lt;/b&gt;
&lt;&lt;WillpowerCheck 55&gt;&gt;

&lt;&lt;if $action eq &quot;success&quot;&gt;&gt;Gritting your teeth, you manage to keep your soul intact.

[[Cum inside of her-&gt;LewdShrine3][$p = 15]]

&lt;&lt;elseif $action eq &quot;failure&quot;&gt;&gt;\
\
You cry out as you cum, just as your soul shatters into a thousand pieces.

[[It was a good way to die-&gt;Game Over]] 
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 15&gt;&gt;\
You cum deep inside of &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;, groaning as your orgasm overwhelms. You just barely manage to keep your mind intact as tidal waves of pleasure crash through you. 

After taking a deep breath, you pull out of her.
&lt;img src=&quot;Images/Other/lilith10.jpg&quot; width=500 /&gt;

&lt;&lt;LilithTalk &quot;Now I really am impressed, sweetheart. Few mortals cum inside me and live.&quot;&gt;&gt;\
She rubs when gaping pussy, as your semen gushes out of it.
&lt;&lt;LilithTalk &quot;Maybe I&#39;ll keep her. A little demi-goddess, as horny as her father.&quot;&gt;&gt;\
You can do little but catch your breath. That wasn&#39;t just sex - it was a battle for your soul. 

[[She touches your lips-&gt;LewdShrine3][$p = 16]]

&lt;&lt;elseif $p eq 16&gt;&gt;\
\
&lt;&lt;LilithTalk &quot;A final gift, from me to you.&quot;&gt;&gt;\
She rubs her saliva onto your lips. It burns, and that fiery sensation travels down your spine and gathers on your flaccid cock. You gasp as it hardens, then grows even larger than before!
&lt;img src=&quot;Images/Other/penis4.jpg&quot; width=300 /&gt;

&lt;&lt;LilithTalk &quot;Do you like it? It will get hard on command, and it will always be ready to fuck. A man who can withstand me should have a worthy tool.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Yes... this will serve me well.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Now, enough distractions. You have a quest, sweetheart. I&#39;ll leave you to it... though I admit, I&#39;ll miss our chats...&quot;&gt;&gt;\
She fades into a cloud of red smoke. All you can do is stare at your new, massive dick. You must have the biggest cock of any mortal human in the world.

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;Your strength has increased by 2!&lt;/i&gt;
&lt;i&gt;Your willpower has increased by 1!&lt;/i&gt;

[[After getting dressed, you head back to your cabin-&gt;Outside the Cabin]] 
\
&lt;&lt;set $penis = 4&gt;&gt;\
&lt;&lt;set $lewdshrine += 1 &gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $basestrength += 2&gt;&gt;\
&lt;&lt;set $basewillpower += 1&gt;&gt;\

&lt;&lt;elseif $p eq 20&gt;&gt;\
Leaving &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; alone worked before - surely it will work again. Besides, no good can come from getting involved with a Goddess like her.

Soon enough, the statue is out of sight. It might be your imagination, but you seem to hear a woman&#39;s distant sigh.

It must have been the wind.

You get the sense you won&#39;t be bothered by &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; statue again.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $fem eq 5&gt;&gt;\
&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
Walking through the Frozen Hills, you come upon a familiar shrine. It appears absolutely ancient, yet clean of dirt and vine. The dark magic of &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith, Goddess of Desire&lt;/b&gt;&lt;/span&gt; burns within.
&lt;img src=&quot;Images/Other/statue1.jpg&quot; width=600 /&gt;

&lt;&lt;if $hips gte 6&gt;&gt;Your pussy starts to gush with lust the moment you see the statue. &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; has changed you so much, but you sense you could become even more beautiful, even more of a perfect woman. You&#39;re almost there - you&#39;ve almost found the bliss she&#39;s designed for you. You need only ask for it.

[[Beg Lilith for one last gift-&gt;LewdShrine3][$p = 1]]
&lt;span class=&quot;grey&quot;&gt;Restrain yourself&lt;/span&gt;

&lt;&lt;elseif $pussy eq 4&gt;&gt;Your heart races the moment you spot the statue. &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; blessed you with a cock, the last time you spoke. Perhaps she could return you to normal... but would you even want that?

[[Speak to Lilith-&gt;LewdShrine3][$p = 40]]

&lt;&lt;elseif $pussy gte 2&gt;&gt;Your heart races the moment you spot the statue. &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; has blessed you with an increased libido, larger breasts, and a wetter pussy. Do you dare ask for more?

&lt;&lt;if $gold gte 50&gt;&gt;[[Offer her 50 gold pieces-&gt;LewdShrine3][$p = 15]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;Offer her 50 gold pieces&lt;/span&gt;&lt;&lt;/if&gt;&gt;
[[Back away-&gt;LewdShrine3][$p = 20]]

&lt;&lt;elseif $pussy eq 1&gt;&gt;You have successfully resisted her charms so far. You wouldn&#39;t dare fall into her trap now.

[[Back away-&gt;LewdShrine3][$p = 25]]

&lt;&lt;/if&gt;&gt;\

&lt;&lt;elseif $p eq 1&gt;&gt;\
You strip off your clothes and fall to your knees. Your large, perky breasts heave with the movement.
&lt;&lt;HeroTalk &quot;Oh, Lilith, devious and powerful. Give me pleasure, give me salvation! I am a toy for you to mold as you see fit!&quot;&gt;&gt;\

[[You hear a woman&#39;s laughter-&gt;LewdShrine3][$p = 2]]
\
&lt;&lt;elseif $p eq 2&gt;&gt;\
The laughter is melodious, sweet, and sinister at that same time. As the laughter grows, the statue begins to shake, then crack, and finally it shatters. From beneath it rises the Goddess of Desire herself - or at least a fragment of her in the mortal world.
&lt;img src=&quot;Images/Other/lilith1.jpg&quot; width=450 /&gt;

&lt;&lt;LilithTalk &quot;Oh sweetheart, look how far you&#39;ve come. Those breasts, those hips! Yet still you want more, to be nothing but an object of desire... and I&#39;m of a mind to give it to you...&quot;&gt;&gt;\

[[She removes her scandalous clothing-&gt;LewdShrine3][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
You gasp as you see what unfurls from between &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; legs. You&#39;ve never seen a cock so large. It would look at home on a stallion, and yet it seems to fit her. Just the sight of it is sending flashes of arousal through your veins.
&lt;img src=&quot;Images/Other/lilith5.jpg&quot; width=500 /&gt;

&lt;&lt;LilithTalk &quot;Go on, my sweet. A final gift I have for you, but first you must prove your devotion.&quot;&gt;&gt;\
You are far beyond any shame or chance of hesitation. Crawling on all fours, you approach &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; equine-like cock. It stiffens as your wrap your hands around it.

[[Serve the Goddess-&gt;LewdShrine3][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
You stretch your jaw and wrap your lips around its bulbous head. It is so hot as to nearly burn your tongue. The precum tastes like fresh honey. Moaning, you blow the Goddess.

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; Pushes deeper into your mouth, her girthy cock filling up your throat and making it had to breathe. That sweet, fiery honey seems to dissolve on your tongue and flow through your body. It gathers in your breasts, burning them, swelling them to twice their size.
&lt;img src=&quot;Images/Other/lilith6.jpg&quot; width=500 /&gt;

Then it flows into your pussy. You scream, your cries muffled by the dick in your mouth, as you cum &lt;i&gt;hard&lt;/i&gt;. You fel your pussy transform, its lips enlarging, the clit poking way past its hood. You&#39;re going to have a soaking wet, slutty pussy for the rest of your life!

[[Lilith pulls out her cock-&gt;LewdShrine3][$p = 5]]
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
You slowly rise to your knees, feeling dizzy and disoriented. Your breasts are massive and whorish. Your pussy feels gaped and eager for dick. 
&lt;&lt;HeroTalk &quot;What have you done?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Oh, sweetheart - I only finished what I started. Now everyone will always want to fuck you. You&#39;ll love your new body - be sure to spread your legs for all the boys...&quot;&gt;&gt;\
As she speaks, your send a probing finger between your legs. You gasp at how good your pussy feels. You nearly cum just by flicking your clit.
&lt;img src=&quot;Images/Other/pussy3.jpg&quot; width=300 /&gt;

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; smiles bewitchingly at you.
&lt;&lt;LilithTalk &quot;I am done, my sweet. You may go in peace - you have a quest, and I have other playthings to enjoy. Or...&quot;&gt;&gt;\
Her look sends a twinge of worry down your spine.
&lt;&lt;HeroTalk &quot;Or?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;I could fuck you here and now. Doing so will bind you to me forever - you won&#39;t even remember that you have a quest in the Deep Woods. You won&#39;t even remember your name. But I promise you, you&#39;ll feel &lt;i&gt;very&lt;/i&gt; good.&quot;&gt;&gt;\
As she speaks, she tugs on her cock.

[[Leave with your new, perfected body-&gt;LewdShrine3][$p = 6]]
[[Abandon your quest, spread your legs and let Lilith take you-&gt;LewdShrine3][$p = 7]]

&lt;&lt;set $pussy = 3&gt;&gt;\
&lt;&lt;set $chestlewd = 7&gt;&gt;\
&lt;&lt;set $ass = 7&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 6&gt;&gt;\
You bow with reverence, but do not accept. &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; seems to understand.
&lt;&lt;LilithTalk &quot;A fine choice, sweetheart. Go - save this world. I&#39;ll be watching you closely...&quot;&gt;&gt;\
She fades into a cloud of red smoke.

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;Your willpower has increased by 2!&lt;/i&gt;
&lt;i&gt;Your agility has decreased by 1!&lt;/i&gt;

[[After getting dressed, you head back to your cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $lewdshrine += 1 &gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $baseagility -= 1&gt;&gt;\
&lt;&lt;set $basewillpower += 2&gt;&gt;\
\
&lt;&lt;elseif $p eq 7&gt;&gt;\
You know you shouldn&#39;t, but denying &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; is simply impossible for you. All the pleasure you could ever want in the world is within reach. To the depths with the Deep Woods! You want more!

Besides, your pussy is dripping with arousal. It needs to be filled.

Instead of saying anything, you lower yourself onto your back, spread your legs, and shut your eyes. It feels incredibly submissive and vulnerable, but for some reason that just makes your pussy even more soaked.
&lt;&lt;LilithTalk &quot;Oh, my sweet... if you insist...&quot;&gt;&gt;\
The next moment, your eyes shoot open as the Goddess thrusts &lt;i&gt;every inch&lt;/i&gt; of her swollen cock into your eager pussy.
&lt;video loop muted autoplay src=&quot;Images/Other/femsex1.mp4&quot;&gt;&lt;/video&gt;\

[[Get fucked by a Goddess-&gt;LewdShrine3][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
The pain turns to pleasure as &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; soaks your insides with her magic precum. Pleasure crashes through you like the waves of a storming sea, until all that bliss reaches a boiling point.

Moaning, you cum onto &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; cock.
&lt;video loop muted autoplay src=&quot;Images/Other/femsex2.mp4&quot;&gt;&lt;/video&gt;\

&lt;&lt;LilithTalk &quot;Such a good girl! Now, you&#39;re ready for your final blessing!&quot;&gt;&gt;\

[[She cums inside of you-&gt;LewdShrine3][$p = 9]]

&lt;&lt;elseif $p eq 9&gt;&gt;\

@@.delayed;One year later...@@

@@.delayed; [[...-&gt;LewdShrine3][$p = 10]]
@@

&lt;&lt;set $daynumber += 365&gt;&gt;\
\
&lt;&lt;elseif $p eq 10&gt;&gt;\
&lt;&lt;LilithTalk &quot;Sweetheart? Where is my little slut?&quot;&gt;&gt;\
&lt;&lt;ZaphiaTalk &quot;Here I am, dearest.&quot;&gt;&gt;\
You you spread your legs and show your &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; your soaking wet pussy, just like she taught you. Becoming an immortal servant to the Goddess of Desire took some getting used to, but you&#39;ve never been happier with your role in the world. 
&lt;img src=&quot;Images/Other/demon1.jpg&quot; width=500 /&gt;

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; stares to you, her eyes burning with infinite lust.
&lt;&lt;LilithTalk &quot;You wouldn&#39;t believe it, $name, but the world ended today. It&#39;s gone.&quot;&gt;&gt;\
You drool, thinking about cock.
&lt;&lt;LilithTalk &quot;Tylae is already making a new one, of course. I wonder how long this one will last...&quot;&gt;&gt;\
She notices you&#39;re not paying attention.

[[Get punished-&gt;LewdShrine3][$p = 11]]

&lt;&lt;set $name = &quot;Zaphia&quot;&gt;&gt;\
&lt;&lt;set $title = &quot;the Hell Slut&quot;&gt;&gt;\
&lt;&lt;set $chest = &quot;Massive breasts&quot;&gt;&gt;\
&lt;&lt;set $head = &quot;Wicked horns&quot;&gt;&gt;\
&lt;&lt;set $hands = &quot;Naughty nails&quot;&gt;&gt;\
&lt;&lt;set $legs = &quot;Thick thighs&quot;&gt;&gt;\
&lt;&lt;set $feet = &quot;Sharp claws&quot;&gt;&gt;\
&lt;&lt;set $weapon = &quot;Whip of Dark Desire&quot;&gt;&gt;\
&lt;&lt;set $gold = 10000&gt;&gt;\
&lt;&lt;set $exp = 10000&gt;&gt;\

&lt;&lt;elseif $p eq 11&gt;&gt;\
The best part of &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; punishments are that they always involve getting completely filled up by her soulless man-husks. They&#39;re the sweetest punishments in the universe!
&lt;img src=&quot;Images/Other/demon2.jpg&quot; width=500 /&gt;

&lt;&lt;ZaphiaTalk &quot;&lt;i&gt;Mmmm.... fuck me harder! Make me cum!&lt;/i&gt;&quot;&gt;&gt;\
Days fly by as the orgy suspended in the darkness of space carries on. Your entire mind is reduced to those inredible feelings as your holes are filled with cock.
&lt;&lt;set $daynumber += 5&gt;&gt;\

[[Eventually, the punishment ends-&gt;LewdShrine3][$p = 12]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
Later, &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; lies on top of you, staring deeply into your eyes.
&lt;&lt;LilithTalk &quot;Sweetheart, wouldn&#39;t it be fun to make a demi-goddess? A little succubus, as eager for cock as her mother.&quot;&gt;&gt;\
Just the thought of it makes your pussy gush with desire.
&lt;&lt;ZaphiaTalk &quot;Yes, mistress. Please breed me!&quot;&gt;&gt;\
Her massive dick hardens against your stomach.
&lt;&lt;LilithTalk &quot;If you say so...&quot;&gt;&gt;\

&lt;img src=&quot;Images/Other/demon3.jpg&quot; width=500 /&gt;

[[Get pregnant with Lilith&#39;s spawn-&gt;Close]] 

&lt;&lt;elseif $p eq 15&gt;&gt;\
\
You simply can&#39;t help yourself. One offering to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; provided you with nothing but a curvier, sexier body and more frequent, more powerful orgasms. Surely a second offering could only be even more lovely?

You count out the gold pieces, your fingers shaking as you do, and then set them between the statue&#39;s thick, stone thighs.

&lt;&lt;HeroTalk &quot;Oh Lilith - heed my prayer. I have tasted your pleasures and find myself wanting more. Grant me bliss, and a body to match.&quot;&gt;&gt;\

[[Then you hear a woman&#39;s laughter-&gt;LewdShrine3][$p = 16]]

&lt;&lt;set $gold -= 50&gt;&gt;\
\
&lt;&lt;elseif $p eq 16&gt;&gt;\
The laughter is melodious, sweet, and sinister at the same time. You fall to your knees, ready for her.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... I just &lt;i&gt;knew&lt;/i&gt; you would enjoy my gifts. And I must say, you look &lt;i&gt;delicious&lt;/i&gt;...&quot;&gt;&gt;\

The voice sings out from the statue. It sweeps around your ears, and slips into your heart. Your pussy starts to leak.
&lt;&lt;HeroTalk &quot;&lt;i&gt;Oooohhh...&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;And now you come for a second gift? So very naughty...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Just a bit more pleasure is all I ask...&quot;&gt;&gt;\
She laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;Pleasure comes with consequence, dear. A woman who sleeps around will eventually find her belly swollen, her breasts full of milk. Every mother was once a sweet little slut.&quot;&gt;&gt;\
You ass starts to get warm.
&lt;&lt;LilithTalk &quot;I know just the gift for a slut like you...&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine3][$p = 17]]

&lt;&lt;elseif $p eq 17&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine3][$p = 18]]

&lt;&lt;elseif $p eq 18&gt;&gt;\
\
As you cum, your ass starts to burn. Clutching it, you feel your cheeks swell in size, getting softer and rounder and fuller. Your ass cheeks swallow your underwear, turning them into a lewd thong.
&lt;img src=&quot;Images/Other/ass6.jpg&quot; width=450 /&gt;

And then your hips begin to burn just as hot. Gasping, you watch as fat seems to gather upon them, and on your tummy, too. Your lithe, athletic figure transforms before your eyes into the body of a sexy, curvy whore&#39;s!
&lt;img src=&quot;Images/Other/hips6.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Oh... oh no...&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Oh yes, sweetheart. Youre going to love the new you.&quot;&gt;&gt;\
You grit your teeth.
&lt;&lt;HeroTalk &quot;How am I supposed to fight like this?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;On your back, I suppose.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you put on your clothes and start walking back to your cabin. Your enlarged hips give you a slowly, sexy sway to your step, and your pants can barely contain your big, round ass.

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;Your agility has fallen by 1!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $hips = 6&gt;&gt;\
&lt;&lt;set $ass = 6&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $baseagility -= 1&gt;&gt;\

&lt;&lt;elseif $p eq 20&gt;&gt;\
&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; has already enhanced your body and increased your libido. Any further gifts would likely put your quest in danger. You&#39;re here to be a hero, not a whore. Gritting your teeth, you turn around and leave.

Soon enough, the statue is out of sight. It might be your imagination, but you seem to hear a woman&#39;s distant sigh.

It must have been the wind. 

You sense you won&#39;t see &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; or her statue again.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\

&lt;&lt;elseif $p eq 25&gt;&gt;\
Leaving &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; alone worked before - surely it will work again. Besides, no good can come from getting involved with a Goddess like her.

Soon enough, the statue is out of sight. It might be your imagination, but you seem to hear a woman&#39;s distant sigh.

It must have been the wind.

You get the sense you won&#39;t be bothered by &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; statue again.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 40&gt;&gt;\
\
You undress, and then fall to your knees. You and &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; need to have a talk. And it probably wouldn&#39;t be a wise idea to piss on her shrine a third time. 
&lt;&lt;HeroTalk &quot;Oh Lilith - heed my prayer. I wish for your presence once more.&quot;&gt;&gt;\

[[You hear a woman&#39;s laughter-&gt;LewdShrine3][$p = 41]]

\
&lt;&lt;elseif $p eq 41&gt;&gt;\
The laughter is melodious, sweet, and sinister at the same time.
&lt;&lt;LilithTalk &quot;Oh, sweetheart... I just &lt;i&gt;knew&lt;/i&gt; you would enjoy being twice-blessed. Look at you, so hard and pretty.&quot;&gt;&gt;\

Unfortunately, she&#39;s right - you&#39;re completely erect. Your eager cock betrays you at the worst of all times.
&lt;&lt;HeroTalk &quot;That&#39;s what I wanted to speak with you about. I never asked to be... &lt;i&gt;blessed&lt;/i&gt; like this. If I wanted to return to normal-&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;&lt;i&gt;Normal&lt;/i&gt;? How boring. I do have the means to do that, but it comes with a risk.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Risk?&quot;&gt;&gt;\
Sweet laughter arises from the statue. 
&lt;&lt;LilithTalk &quot;Oh, nothing a &lt;i&gt;chaste&lt;/i&gt; girl like you would have to worry about. Let&#39;s begin...&quot;&gt;&gt;\

[[A flash of light-&gt;LewdShrine3][$p = 42]]

&lt;&lt;elseif $p eq 42&gt;&gt;\
Your eyes flash, and when your vision returns, all is hazy and indistinct. All you can see is a woman&#39;s - perhaps &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; - vagina above you, a single drop of its juices falling free.
&lt;img src=&quot;Images/Other/lilith3.jpg&quot; width=450 /&gt;

Your tongue acts of its own accord, sticking out and tasting the fluid.

[[Gasping, you cum-&gt;LewdShrine3][$p = 43]]

&lt;&lt;elseif $p eq 43&gt;&gt;\
\
As you cum, your breasts starts to burn. Clutching them, you feel them swelll in size. As they expand, your nipples grow too, your areolas widening and your nipples extending into the air.
&lt;img src=&quot;Images/Other/chest7.jpg&quot; width=450 /&gt;

Your cock, meanwhile, is fine. Dripping out cum from your orgasm, but otherwise completely untouched by &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; magic.
&lt;&lt;HeroTalk &quot;This is &lt;i&gt;not&lt;/i&gt; what I had in mind.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;Oh yes, sweetheart. That was the risk I mentioned. If you&#39;ve already jerked off your little girl-cock to orgasm, then it&#39;s here forever. The spell backfired, and gave you a whorish set of tits instead - how &lt;i&gt;awful&lt;/i&gt;!&quot;&gt;&gt;\
You nearly shout at the goddess, before realizing the futility of the action. She played you, and deep down, you &lt;i&gt;like&lt;/i&gt; your new, sizable breasts. 
&lt;&lt;HeroTalk &quot;But... how am I supposed to fight like this?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;On your back, I suppose.&quot;&gt;&gt;\

&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; laughter slowly fades. 

Afterwards, you put on your clothes and start walking back to your cabin. Your enlarged breasts are nearly popping out of your armor. This will take some getting used to. 

&lt;i&gt;You gained 100 exp!&lt;/i&gt;
&lt;i&gt;Your body has changed!&lt;/i&gt;
&lt;i&gt;Your agility has fallen by 1!&lt;/i&gt;
&lt;i&gt;Your willpower has increased by 1!&lt;/i&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $chestlewd = 7&gt;&gt;\
&lt;&lt;set $lewdshrine += 1&gt;&gt;\
&lt;&lt;set $exp += 100&gt;&gt;\
&lt;&lt;set $baseagility -= 1&gt;&gt;\
&lt;&lt;set $basewillpower += 1&gt;&gt;\
\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
\
\</tw-passagedata><tw-passagedata pid="167" name="LewdCabin" tags="" position="593,2510" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
You walk back to the cabin, still getting used to your new body. Your breasts, large and firm, fit snug against your $chest. Between your legs, &lt;&lt;if $pussy lte 3&gt;&gt;Your new pussy feels warm and moist. Its juices are soaking your underwear.&lt;&lt;else&gt;&gt;Your cock rests against our new pussy. The feeling of them pressing against each other is turning you on.&lt;&lt;/if&gt;&gt;

When you get back to your cabin, you spot &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; in conversation with &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;. They stop what they are saying when they see you.
&lt;&lt;MerchantTalk &quot;By sand and sun - who is this beauty?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;You know her, Babar. Look at the eyes - it&#39;s $name.&quot;&gt;&gt;\
The merchant blushes, astounded.
From her tree, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; walks over to see what the fuss is about.
&lt;&lt;NayaTalk &quot;What seems to be the problem?&quot;&gt;&gt;\
She notices you, her eyes locking onto on your chest, then your face.
&lt;&lt;NayaTalk &quot;What in the name of the Gods...?&quot;&gt;&gt;\

[[An explanation is in order-&gt;LewdCabin][$p = 1]]

&lt;&lt;set $gender = &quot;female&quot;&gt;&gt;\
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
You look to your three companions in turn.
&lt;img src=&quot;Images/Character/team1.jpg&quot; width=700 /&gt;

&lt;&lt;HeroTalk &quot;I&#39;ve been struck by a bit of old magic, hiding in the Deep Woods.&quot;&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; nods and glances at the woods with new fear, clearly weary of being struck by such magic himself.
&lt;&lt;WitchTalk &quot;I will check my scrolls for a spell to return you to your former shape - but this enchantment looks beyond me.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Don&#39;t bother it&#39;s... um.... not worth the risk. Man or woman, it doesn&#39;t matter. Stopping the Redeemer is more important than this.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Very well - but what am I to call you? $name feels a bit out of place for a lady like you.&quot;&gt;&gt;\

[[A new name-&gt;LewdCabin][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; makes a fair point. You can hardly be called $name $title, any more. Perhaps a new name is in order...

Considering your new body, you try to come up with a new name.
&lt;&lt;HeroDisplay&gt;&gt;

&lt;&lt;textbox &quot;$name&quot; &quot;Anora&quot;&gt;&gt; &lt;&lt;textbox &quot;$title&quot; &quot;the Lovely&quot;&gt;&gt;\

&lt;&lt;if $pussy eq 4&gt;&gt;[[Continue-&gt;LewdCabin][$p = 3]]&lt;&lt;else&gt;&gt;[[Continue-&gt;LewdCabin][$p = 5]]&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 3&gt;&gt;\
\
Once the four of you agree on your new name, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; go to fetch some water, leaving you alone with &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

The witch stares at you for a long while. Slowly, her eyes drop to your waist.
&lt;&lt;WitchTalk &quot;Such a strange kind of magic. What sort of creature cursed you so?&quot;&gt;&gt;\
You have no intention of admitting that you fell for the charms of the Goddess of Desire.
&lt;&lt;HeroTalk &quot;It&#39;s hard to say - it happened so quickly.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;I see... well, if you want to chat, come to my hut. I&#39;m always willing to listen, &lt;i&gt;sweetheart&lt;/i&gt;.&quot;&gt;&gt;\
Then she walks away.

[[Sweetheart?-&gt;LewdCabin][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
\
You watch her go, caught off-guard.
&lt;&lt;HeroTalk &quot;She called me &#39;sweetheart...&#39; perhaps Scyllia knows more about Lilith than she&#39;s letting on.&quot;&gt;&gt;\
It may be worth speaking to the priestess about your contact with the Goddess.

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $witchlove = 11&gt;&gt;\
&lt;&lt;set $nayalove = 5&gt;&gt;\
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
\
Once the four of you agree on your new name, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; go to fetch some water, leaving you alone with &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

The merchant stares at you for a long while. Clearly, he likes what he sees. You&#39;re not at all used to the male gaze so strongly beamed against your body. It makes you feel... &lt;i&gt;naked&lt;/i&gt;.
&lt;&lt;MerchantTalk &quot;By the white of the moon, $name, who would have thought you could become such a beautiful woman? This is most curious, no?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Don&#39;t get distracted, Babar. It&#39;s still me - and we still have a quest to deal with.&quot;&gt;&gt;\
He laughs. His deep, rumbling laugh makes your stomach twinge, and your heart beat fast. 

That&#39;s never happened before. 
&lt;&lt;MerchantTalk &quot;Of course, $name, of course.&quot;&gt;&gt;\
He walks close - and now that you&#39;ve shrunk, he&#39;s actually taller than you - and takes your hand. When he plants a chaste kiss on it, you feel warm between your legs.

[[Then he leaves you.-&gt;LewdCabin][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
You watch him go, uncertain about how you feel.
&lt;&lt;HeroTalk &quot;So it seems this woman&#39;s body changed more than just my flesh. My desires feel all twisted, too. Naya looks suddenly plain, while Babar...&quot;&gt;&gt;\
Somewhat old, rather fat, hairy as a beast... &lt;i&gt;no one should find him attractive&lt;/i&gt;! And yet his bluster and kindness are making your heart race.

Gross.

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $nayalove = 5&gt;&gt;\

&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="168" name="GoblinProstitute" tags="" position="934,1587" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You are wandering through the Outskirts when you come across a goblin. It looks rather different than the goblins you&#39;re used to - then you realize: it&#39;s a female goblin.
&lt;img src=&quot;Images/Other/goblin2.jpg&quot; width=450 /&gt;

It&#39;s a rather beautiful female goblin, too. Unlike her small, wiry kin, she is all curves and supple skin. Even better - she&#39;s completely naked.
&lt;&lt;GoblinWhoreTalk &quot;Hey cutie! Lookin&#39; for a good time?&quot;&gt;&gt; \
You stand your ground.
&lt;&lt;HeroTalk &quot;I&#39;m seeking the source of the Deep Woods&#39; evil.&quot;&gt;&gt; \
She giggles.
&lt;&lt;GoblinWhoreTalk &quot;Evil? I&#39;m talkin&#39; about getting your cock sucked. I don&#39;t know nothing about any &lt;i&gt;evil&lt;/i&gt;.&quot;&gt;&gt; \
The goblin whore probably isn&#39;t lying - interogating her seems like it would be unproductive.

And she is rather pretty. Her offer is almost tempting.

[[Inquire-&gt;GoblinProstitute][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
Your hand falls to your coin purse.
&lt;&lt;HeroTalk &quot;How much?&quot;&gt;&gt; \
Her eyes light up when she hears the gold jingling in your purse.
&lt;&lt;GoblinWhoreTalk &quot;I charge thirty pieces to my cousins - but I &lt;i&gt;loooove&lt;/i&gt; the taste of man-cum. For you, pretty boy, I&#39;ll charge twenty-five.&quot;&gt;&gt; \

&lt;&lt;if $gold gte 25&gt;&gt;[[Relieve your stress-&gt;GoblinProstitute][$p = 3]]&lt;&lt;else&gt;&gt;Relieve your stress&lt;&lt;/if&gt;&gt;
[[Resist temptation-&gt;GoblinProstitute][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
You decline the goblin&#39;s offer.
&lt;&lt;HeroTalk &quot;I&#39;m here on a quest from my king. I have no time for whores.&quot;&gt;&gt; \
She sighs.
&lt;img src=&quot;Images/Other/goblin2.jpg&quot; width=450 /&gt;

&lt;&lt;GoblinWhoreTalk &quot;What if I only charged twenty?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;No.&quot;&gt;&gt; \
&lt;&lt;GoblinWhoreTalk &quot;Free? I just want that cock.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Enough!&quot;&gt;&gt; \

Deflated, the whore leaves you. You decide it&#39;s about time you returned to your cabin.

&lt;i&gt;Your resistance was noted by the Gods! You gained 1 willpower!&lt;/i&gt;

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;set $goblinwhore = 0&gt;&gt;\
&lt;&lt;set $basewillpower += 1&gt;&gt;\

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 3&gt;&gt;\
Your cock is already stiffening. You take out the gold and toss it at her feet. She doesn&#39;t even count it - just just pulls down your pants and buries her face in your cock.
&lt;img src=&quot;Images/Other/goblin1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;By the Gods!&lt;/i&gt;&quot;&gt;&gt; \
The goblin is an absolute professional. All you can do is grunt and groan as she expertly teases your cockhead with your tongue, all the while she gently squeezes your balls. Her huge breasts bounce and heave as she deepthroats the full length of your cock.

[[You don&#39;t last long-&gt;GoblinProstitute][$p = 4]]

&lt;&lt;set $gold -= 25&gt;&gt;\

&lt;&lt;elseif $p eq 4&gt;&gt;\
You warn her when you&#39;re about to cum. She doubles the pace of her blowjob, forcing the orgasm out of you.
&lt;img src=&quot;Images/Other/goblin4.jpg&quot; width=550 /&gt;

Your cum covers her face, only for her to greedily slurp it all up with her astonishingly long tongue.
&lt;&lt;GoblinWhoreTalk &quot;Thanks, pretty boy. Maybe I&#39;ll see you again?&quot;&gt;&gt; \
She picks up the coins, blows a cum bubble from her lips and then leaves you.
&lt;&lt;HeroTalk &quot;Fuck...&quot;&gt;&gt; \

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;set $goblinwhore = 1&gt;&gt;\
\
\
&lt;&lt;/if&gt;&gt;\
\
\
\
\
\</tw-passagedata><tw-passagedata pid="169" name="Merchant Lewd" tags="" position="930,1694" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
As you wander past &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; shop, you notice a rather peculiar whole on its side. Circular, waist-high, about the size of your fist...
&lt;img src=&quot;Images/Other/gloryhole1.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;How strange...&quot;&gt;&gt; \
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; peers over his counter, and sees you staring at his carriage.
&lt;&lt;MerchantTalk &quot;$name, you can&#39;t buy goods from that side - come, come, I have special deals for you today!&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Babar - what is this?&quot;&gt;&gt; \

[[The merchant comes to join you outside his shop-&gt;Merchant Lewd][$p = 1]]
\
&lt;&lt;elseif $p eq 1&gt;&gt;\
When the merchant sees the hole, he breaking out into a laughter so intense he needs to clutch side belly for support.
&lt;&lt;MerchantTalk &quot;Curious, are you, $name? This hole is of no interest to a virtuous hero like yourself.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;I&#39;ll be the judge of that. Tell me, Babar, what am I even looking at?&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;It&#39;s a glory hole.&quot;&gt;&gt; \
You stare a him with a blank expression.
&lt;&lt;MerchantTalk &quot;These outskirts are thick with goblin-women. Always slinking about, looking for a quick lay in the grass. This keeps them satisfied.&quot;&gt;&gt; \
The man is talking in riddles. Goblin maids looks like a lay in the grass?
&lt;&lt;HeroTalk &quot;Are you &lt;i&gt;sleeping&lt;/i&gt; with goblins?&quot;&gt;&gt; \

[[He breaks out into a new fit of laughter-&gt;Merchant Lewd][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
&lt;&lt;MerchantTalk &quot;Goblin women are whorish by nature. It is in their culture to earn gold with their bodies. I give them a bit of work, a bit of gold, and send them on their way. If not for me, this camp would be swarming with goblins.&quot;&gt;&gt; \
&lt;img src=&quot;Images/Other/goblin2.jpg&quot; width=450 /&gt;

Your almost impressed by the merchant&#39;s ability to turn his lustful misadventures into acts of selflessness.
&lt;&lt;HeroTalk &quot;So they stick their hand in there, and you&#39;re naked on the other side?&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Dear $name, this isn&#39;t proper talk for a lady of your grace and stature.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;I kill things for a living. Blood is my profession - a bit of skin won&#39;t hurt my disposition.&quot;&gt;&gt; \
Besides, the naughtiness of the business is rather intriguing.

[[Babar explains-&gt;Merchant Lewd][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
&lt;&lt;MerchantTalk &quot;At night, an interested goblin woman will knock thrice upon my carriage, just beside the hole. I undress, push my manhood through the hole, and she works her magic with that long goblin tongue. Then I pay her and the deed is done. Satisfied?&quot;&gt;&gt; \
He doesn&#39;t seem the least bit ashamed of the confession.
&lt;&lt;HeroTalk &quot;Some judge those men who have to pay for pleasure.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Not in my homeland - there is no dishonor in buying bliss - or in earning a bit of gold by selling one&#39;s beauty.&quot;&gt;&gt; \
As he says these last words, his eyes drift down to your hips, and then your breasts. You want to slap him - if only your heart wasn&#39;t racing at his wandering gaze!
&lt;&lt;HeroTalk &quot;Your homeland is a strange place.&quot;&gt;&gt; \
He&#39;s still staring.

[[Walk away-&gt;Merchant Lewd][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
You stomp off, not particularly fond of the idea that &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; is likely staring at your ass until you return to the safety of your cabin. &lt;&lt;if $fem eq 1&gt;&gt;Doesn&#39;t he care that you weren&#39;t even a woman a few days ago? It doesn&#39;t seem to bother him one bit.&lt;&lt;/if&gt;&gt;
&lt;&lt;HeroTalk &quot;Stupid old merchant. Him and his goblin whores...&quot;&gt;&gt; \
Though you must admit, your feelings are confused. On the one hand, you don&#39;t like the way he looked at you - like a &lt;i&gt;woman&lt;/i&gt; instead of the person who saved his life. The hero that you are. On the other hand, you&#39;re almost... &lt;i&gt;jealous&lt;/i&gt; of those goblin women. Them and their long tongues...
&lt;img src=&quot;Images/Other/goblin1.jpg&quot; width=450 /&gt;

You blush, realizing what you&#39;re imagining. &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; hairy dick is &lt;i&gt;not&lt;/i&gt; a mental image you need right now. &lt;&lt;if $fem eq 1&gt;&gt;When you were a man, a thought like this would never fill your heart. But now... your body just &lt;i&gt;reacts&lt;/i&gt;. A heat grows between your legs. You can&#39;t help it - your sexual desires have completely flipped since being transformed!&lt;&lt;/if&gt;&gt;
&lt;&lt;HeroTalk &quot;That glory hole... I ought to board it up. Maybe...&quot;&gt;&gt; \
Even if you leave it unboarded, &lt;i&gt;you&lt;/i&gt; certainly wouldn&#39;t use it...

[[Right?-&gt;Cabin]] 
\
&lt;&lt;set $merchantlove = 11&gt;&gt;\

&lt;&lt;elseif $p eq 5&gt;&gt;\
You stare at your fingers, still wet with your arousal. 
&lt;&lt;HeroTalk &quot;Kneeling down like some goblin whore... getting paid for my mouth. It&#39;s so... &lt;i&gt;demeaning&lt;/i&gt;.&quot;&gt;&gt; \
But there&#39;s something kind of exciting about how demeaning it is. Without really meaning to, your hand drops between your legs. Your panties are still soaked.
&lt;video loop muted autoplay src=&quot;Images/Other/solo11.mp4&quot;&gt;&lt;/video&gt;\

You stop yourself before you cum &lt;i&gt;again&lt;/i&gt; to the thought of getting paid by a greasy merchant for sucking his dick.

&lt;&lt;HeroTalk &quot;These fantasies are getting in the way of my quest. Maybe I should just take a look at the gloryhole - just a look! - so my imaginings will end once and for all.&quot;&gt;&gt; \
That seems innocent enough. A look - nothing more. And only at night!

[[Return-&gt;Cabin]] 

&lt;&lt;set $merchantlove = 12&gt;&gt;\
\
&lt;&lt;elseif $p eq 6&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
It&#39;s late. The camp is silent, but for the howling of distant wolves. As you take slow steps towards &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; carriage, you hear no sound from within. He&#39;s probably aleady asleep.
&lt;img src=&quot;Images/Locations/night1.jpg&quot; width=650 /&gt;

Then again, you can&#39;t hear any snoring. Likely he&#39;s getting ready for bed.
&lt;&lt;HeroTalk &quot;This is so stupid - I&#39;m a hero, not some trollop from a bard&#39;s dirty tale.&quot;&gt;&gt; \

[[Leave-&gt;Outside the Cabin]] 
[[Just a quick look-&gt;Merchant Lewd][$p = 7]] 

&lt;&lt;elseif $p eq 7&gt;&gt;\
\
You&#39;ve gotten this far - may as well see what all the fuss is about. At least this way, you&#39;ll probably stop having lewd dreams about the rotund merchant. The fact that his gaze can get you just a bit wet is still a source of mild embarassment. 
&lt;&lt;HeroTalk &quot;Stupid fat merchant...&quot;&gt;&gt; \

You lower yourself to your haunches and stare at the mysterious hole.
&lt;img src=&quot;Images/Other/gloryhole1.jpg&quot; width=550 /&gt;

Your breathing quickens. Right now it looks innocent enough. But three knocks, and his &lt;i&gt;thing&lt;/i&gt; comes out, ready to play.

You wouldn&#39;t actually knock, of course. You&#39;re just hear to look.

[[Leave-&gt;Outside the Cabin]] 
[[One knock wouldn&#39;t hurt-&gt;Merchant Lewd][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
You rap your knuckles against the wood, then stare at your own hand, a bit ashamed of what it just did. 
&lt;&lt;HeroTalk &quot;That was foolish...&quot;&gt;&gt; \
From within, the carriage groans. Someone walking. One step, two steps, three.

&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; is standing on the other side of the carriage. He probably thinks some hesitant goblin slut is trying to remember how many times to knock!

You bite your lip, rather astounded at the whole situation. Luckily, he can&#39;t see you - you can leave this very moment. You probably &lt;i&gt;should&lt;/i&gt;.
&lt;&lt;if $fem eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;Turning into a woman is one thing. Getting used to my body is only natural. But I&#39;m not &lt;i&gt;actually&lt;/i&gt; going to do this... &lt;i&gt;am I&lt;/i&gt;?&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\

[[Leave-&gt;Outside the Cabin]] 
[[Knock again-&gt;Merchant Lewd][$p = 9]]

&lt;&lt;elseif $p eq 9&gt;&gt;\
\
Your knuckles hit the wood again.

Then, silence.

From within the carriage, you hear &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; chuckle.
&lt;&lt;MerchantTalk &quot;Are you teasing me, little goblin?&quot;&gt;&gt; \
From some reason, his voice has your heart racing. Then you hear him unbuckle his pants and let them fall to the floor.
&lt;&lt;HeroTalk &quot;What am I doing here...&quot;&gt;&gt; \

Your mouth fills with saliva, thinking about what one more knock would do. A thousand justifications fill your mind - adventuring is lonely work! &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; will never know it was &lt;i&gt;you&lt;/i&gt; who sucked his cock! You&#39;re just curious!

But deep down, you know you&#39;re horny and just want a thick cock in your mouth. You couldn&#39;t stop this even if you wanted to. 

And you don&#39;t.

[[Knock once more-&gt;Merchant Lewd][$p = 10]]

&lt;&lt;elseif $p eq 10&gt;&gt;\
\
The moment you knuckles hit the wood, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; slides his manhood through the gloryhole.

You gasp, your hands covering your lips the next moment for fear you&#39;ve revealed yoursef. The merchant&#39;s cock is huge! Easily the largest you&#39;ve ever seen, and you&#39;ve been with a few men during your past adventures.
&lt;img src=&quot;Images/Other/babar1.jpg&quot; width=450 /&gt;

You stare for a few more moments. Despite yourself, your feel your pussy get warm. Your nipples stiffen from your excitement.
&lt;&lt;MerchantTalk &quot;Nothing to be afraid of, little goblin. But I don&#39;t pay for looks, no?&quot;&gt;&gt; \

Your jaw opens. There&#39;s only one thing you can do. You lean closer, and closer, until...

[[Your tongue touches it-&gt;Merchant Lewd][$p = 11]]

&lt;&lt;elseif $p eq 11&gt;&gt;\
\
The moment you make contact, all semblence of restraint just evaporates. The salty taste, the heady scent, the way the cock stiffens and swells between your lips - it&#39;s &lt;i&gt;perfect&lt;/i&gt;.

Too horny to be embarassed, you start sucking on &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar Ogho&#39;s&lt;/b&gt;&lt;/span&gt; dick.
&lt;video loop muted autoplay src=&quot;Images/Other/gloryhole1.mp4&quot;&gt;&lt;/video&gt;

Your knees dig into the dirt as you gag on his cock. Muffled sighs escape your throat, quiet moans of pleasure at the naughtiness of the act. Of course, getting your throat stretched by a merchant&#39;s unwashed dick is making you feel all tingly between your legs.

Your fingers find their way into your cunt.
&lt;video loop muted autoplay src=&quot;Images/Other/solo7.mp4&quot;&gt;&lt;/video&gt;

You&#39;re going to cum.

[[And so is he-&gt;Merchant Lewd][$p = 12]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; grunt as he cums. Still, you&#39;re not quite ready for it - the sudden splurge of hot, salty fluid flooding your mouth. As your cheeks fill with his orgasm, you shiver as your own climax hits. By reflex, your throat swallows. 

As waves of pleasure radiate from between your legs, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; cum slides down into your stomach. There&#39;s so much, you feel like you&#39;ve just had a meal.

A &lt;i&gt;delicious&lt;/i&gt; meal.
&lt;video loop muted autoplay src=&quot;Images/Other/gloryhole2.mp4&quot;&gt;&lt;/video&gt;

The moment after &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; pulls his flaccid cock out of the glory hole, he tosses 25 gold pieces through the hole and onto the ground.

Your payment. You have half a mind to leave it there - it&#39;s terribly undignified to collect pay for such a thing - but then he&#39;d know it wasn&#39;t a goblin who sucked him off.

Your legs caked with mud, your thighs slick with your juices, you kneel down and collect the coins, one by one. It takes a long time to find them all in the darkness.
&lt;&lt;HeroTalk &quot;I can&#39;t believe that happened... I&#39;d best go to sleep, and pretend it was all a bad dream...&quot;&gt;&gt; \

[[Leave-&gt;Cabin]] 

&lt;&lt;set $merchantlove = 13&gt;&gt;\
&lt;&lt;set $gold += 24&gt;&gt;\
&lt;&lt;set $gloryholed = 1&gt;&gt;\

&lt;&lt;elseif $p eq 13&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
As you kneel down before the gloryhole again, you try to understand &lt;i&gt;why&lt;/i&gt; you&#39;re doing this. You already discovered what it was - no need for a second exploration. &lt;&lt;if $fem eq 1&gt;&gt;Before you transformed, you never had any desire for men. But now...&lt;&lt;/if&gt;&gt;

But that&#39;s the trouble - you discovered what it was and how &lt;i&gt;fun&lt;/i&gt; it was. Yes, you&#39;re a glorious $class on an important quest. But &lt;i&gt;sometimes&lt;/i&gt; it&#39;s nice to just be a woman. &lt;&lt;if $fem eq 1&gt;&gt;It&#39;s a new experience, but you have to admit... you &lt;i&gt;like it&lt;/i&gt;.&lt;&lt;/if&gt;&gt;

And it&#39;s not like &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; or anyone else will ever know that it&#39;s you.
&lt;img src=&quot;Images/Other/gloryhole1.jpg&quot; width=550 /&gt;

There it is, just &lt;i&gt;waiting&lt;/i&gt; for you.

[[This is foolish. Leave-&gt;Outside the Cabin]] 
[[Knock three times-&gt;Merchant Lewd][$p = 14]]

&lt;&lt;elseif $p eq 14&gt;&gt;\
Your heart picks up its pace as you knock. Once. Twice. &lt;i&gt;Three times&lt;/i&gt;.
&lt;&lt;HeroTalk &quot;Come here, big guy...&quot;&gt;&gt; \

&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; doesn&#39;t make you wait long.
&lt;img src=&quot;Images/Other/babar1.jpg&quot; width=450 /&gt;

You stare at the marvellous cock for a moment. It really is an impressive tool - thick as a spear shaft and long as your forearm. Just the sight of it makes you want to spread your legs.

[[Open wide-&gt;Merchant Lewd][$p = 15]]

&lt;&lt;elseif $p eq 15&gt;&gt;\
He&#39;s too big for you to take the whole length down your throat, but you play with the few inches you can handle, bobbing up and down and gagging when it goes too far.
&lt;video loop muted autoplay src=&quot;Images/Other/gloryhole1.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;MerchantTalk &quot;I remember that tongue. I was hoping you&#39;d come back.&quot;&gt;&gt; \
The words make you blush. Obviously &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; thinks your a new goblin whore. And not just a new one - one of his &lt;i&gt;favorites&lt;/i&gt;. 

For some reason, that thought makes you wet enough to soak your panties. Moaning, you reach down and start playing with yourself.
&lt;video loop muted autoplay src=&quot;Images/Other/solo7.mp4&quot;&gt;&lt;/video&gt;

[[Keep going-&gt;Merchant Lewd][$p = 16]]

&lt;&lt;elseif $p eq 16&gt;&gt;\
\
You suck his cock for a little while longer. Hearing his telltale grunts, you know he&#39;s about to explode. Anticipating this, you jam yourself against the carriage wall, pushing as much of his cock inside of you as possible. His girthy member slides down your esophagus, making you gag.

But that contracting, gagging motion pushes him past his limit. &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; curses as he cums directly into your stomach. You stay there, frozen, unbreathing, as his cock pulsates inside you, implanting rope after rope of semen deep inside. At last, he slides out.
&lt;video loop muted autoplay src=&quot;Images/Other/gloryhole2.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;So good...&quot;&gt;&gt; \
Like last time, he tosses gold at your feet. In fact, there&#39;s more here than before.
&lt;&lt;MerchantTalk &quot;A gift for such a fine talent. Don&#39;t tell your sisters.&quot;&gt;&gt; \

You collect the gold, your lips and chin still covered in cum. Once you have all of it, you leave.
&lt;&lt;HeroTalk &quot;I think I&#39;ve developed a bad, bad habit...&quot;&gt;&gt; \

[[Leave-&gt;Cabin]] 

&lt;&lt;set $merchantlove = 14&gt;&gt;\
&lt;&lt;set $gold += 29&gt;&gt;\
&lt;&lt;set $gloryholed = 1&gt;&gt;\

&lt;&lt;elseif $p eq 17&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You drop to your knees, eager for &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; delicious cock. After knocking three times, it appears.
&lt;video loop muted autoplay src=&quot;Images/Other/gloryhole1.mp4&quot;&gt;&lt;/video&gt;

You gasp and gag on its substantial length, all the while fingering yourself from the sheer naughtiness of the act. You lies pressing your knees into the dirt, your jaw aching as your mouth gets used like you&#39;re a common whore.

And even better than gold, you&#39;re always awarded with a salty dessert.
&lt;video loop muted autoplay src=&quot;Images/Other/gloryhole2.mp4&quot;&gt;&lt;/video&gt;

[[Leave-&gt;Cabin]] 

&lt;&lt;set $gold += 29&gt;&gt;\
&lt;&lt;set $gloryholed = 1&gt;&gt;\

&lt;&lt;elseif $p eq 18&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
When you open the door, you&#39;re somewhat surprised to find &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; standing at the entrance to your cabin.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Babar - what are you doing up so early?&quot;&gt;&gt; \
He bows graciously, then raises a small box before you.
&lt;&lt;MerchantTalk &quot;A specially ordered gift as just arrived. For you, $name.&quot;&gt;&gt; \
You nearly blush. You&#39;ve already received plenty of gifts from the merchant, though he doesn&#39;t actually know it.
&lt;&lt;HeroTalk &quot;It was you who saved me in the Goblin Cave. No gift is necessary.&quot;&gt;&gt; \
He&#39;s still bowing.
&lt;&lt;MerchantTalk &quot;I insist.&quot;&gt;&gt; \

[[Open the box-&gt;Merchant Lewd][$p = 19]]

&lt;&lt;elseif $p eq 19&gt;&gt;\
\
The box is light as a feather. Instead, you find only a few small pieces of silk. They seem to be... garments?

You hold them out before you to get a better look.
&lt;img src=&quot;Images/Other/babar2.jpg&quot; width=450 /&gt;

As you stare at the lingerie, a righteous fury begins to burn inside your gut.
&lt;&lt;HeroTalk &quot;What is the meaning of this?&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Just a small gesture of thanks, for my favorite little goblin.&quot;&gt;&gt; \

Little goblin.

&lt;i&gt;LITTLE GOBLIN!&lt;/i&gt;

[[Fuck!-&gt;Merchant Lewd][$p = 20]]

&lt;&lt;elseif $p eq 20&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;I... but... you...&quot;&gt;&gt; \
Your feel red as a split tomato. Try as you might, you can&#39;t form a single sentence - nor can you drop the garter belt in your hands.

&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; just smiles emphatically, like what he&#39;s just revealed is hardly worth noting at all.
&lt;&lt;MerchantTalk &quot;My dear $name, a man my age knows the difference btween a human tongue and a goblin&#39;s. And even more revealing, you missed a few pieces of gold. A goblin sees well in the dark, and never leaves anything behind.&quot;&gt;&gt; \
Your legs feel weak. You lean against the wall before you completely lose balance.
&lt;&lt;HeroTalk &quot;You must think me a trollop.&quot;&gt;&gt; \

[[The merchant laughs-&gt;Merchant Lewd][$p = 21]]

&lt;&lt;elseif $p eq 21&gt;&gt;\
\
&lt;&lt;MerchantTalk &quot;A trollop? By sun and sands, no! The women of my homeland are loved and cherished - and turning pleasure into profit is not considered a slight upon their honor.&quot;&gt;&gt; \
He takes your hand and gently kisses your fingers.
&lt;&lt;MerchantTalk &quot;I hold you in the highest esteem, $name. That has not changed, I swear.&quot;&gt;&gt; \
&lt;&lt;if $fem eq 1&gt;&gt;\
&lt;&lt;HeroTalk &quot;Surely it must put you off, that when we met I wasn&#39;t a woman.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Were you? It&#39;s hard to remember, with a woman of such beauty now standing before me.&quot;&gt;&gt; \
&lt;&lt;/if&gt;&gt;\
&lt;&lt;HeroTalk &quot;All the same, we must pretend this never happened. It must end immediately.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;End? But $name, I came here to ask for your lips again. I have the gold ready.&quot;&gt;&gt; \
You blink at him, mortified. 

[[Let him down gently-&gt;Merchant Lewd][$p = 22, $i = 1]]
[[Unleash your unending fury upon him-&gt;Merchant Lewd][$p = 22, $i = 2]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
\
&lt;&lt;if $i eq 1&gt;&gt;You sigh, stopping yourself from getting angry at the man. You did lead him on... kind of. It&#39;s no wonder he thinks he can just stroll in here and buy a blowjob.
&lt;&lt;HeroTalk &quot;Babar - I value your friendship, and your merchantile expertise. Together, we will defeat the evil that haunts these Woods. But what I did those nights... that was a mistake.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;A mistake? It did not feel like one.&quot;&gt;&gt; \
Your mind briefly works up an image of his hefty cock.
&lt;img src=&quot;Images/Other/babar1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;And yet, it was. I can&#39;t mix up my quest with... &lt;i&gt;physical concerns&lt;/i&gt;. I&#39;m sorry, Babar.&quot;&gt;&gt; \
He sighs, but seems to understand.
&lt;&lt;MerchantTalk &quot;Very well, $name - I will respect your wishes, I promise. But I insist you keep the gift. I had it specially sized for your figure.&quot;&gt;&gt; \
\
&lt;&lt;elseif $i eq 2&gt;&gt;\
Your breathing rises, your chest practically heaving with rage.
&lt;&lt;HeroTalk &quot;YOU HAVE THE GOLD ALREADY? WHAT, AM I A WHORE AT YOUR FEET, READY TO SUCK YOU OFF ON A MOMENT&#39;S NOTICE?!&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;I - but. By the black moon, what I meant was-&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;I am not anyone&#39;s &lt;i&gt;slut&lt;/i&gt;, Babar Ogho - least of all yours! Never make me such a revolting offer again, or I&#39;ll cut your cock at the root.&quot;&gt;&gt; \
He pales, then sighs.
&lt;&lt;MerchantTalk &quot;Very well, $name - I will respect your wishes, I promise. But I insist you keep the gift. I had it specially sized for your figure.&quot;&gt;&gt; \
\
&lt;&lt;/if&gt;&gt;\
\
[[Babar leaves-&gt;Merchant Lewd][$p = 23]]

&lt;&lt;elseif $p eq 23&gt;&gt;\
\
Once he&#39;s gone, you glance back at his gift.
&lt;img src=&quot;Images/Other/babar2.jpg&quot; width=450 /&gt;

It does look perfectly sized. Not that you&#39;d ever try it on...
&lt;&lt;HeroTalk &quot;No more glory holes, no more lingerie. Enough distractions.&quot;&gt;&gt; \

And yet, a small part of you will miss how much fun you&#39;ve been having...
&lt;&lt;if $fem eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;Now that my body is so soft and feminine, it does feel right to cover it in soft silk. Damn, my very skin is distracting me.&quot;&gt;&gt; &lt;&lt;/if&gt;&gt;\

[[Return-&gt;Cabin]] 

&lt;&lt;set $merchantlove = 15&gt;&gt;\
&lt;&lt;set $legsinventory.push($naughtygarter)&gt;&gt;\

&lt;&lt;elseif $p eq 24&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You glance at the glory hole. Or rather, where it used to be.
&lt;img src=&quot;Images/Other/gloryhole3.jpg&quot; width=550 /&gt;

It seems &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; took your admonishment to heart. He&#39;s gone ahead and replaced the hole with fresh lumber. Him and his goblin whores will no longer be enjoying any nightly entertainment.

And nor will you.

[[Your heart sinks-&gt;Merchant Lewd][$p = 25]]

&lt;&lt;elseif $p eq 25&gt;&gt;\
\
It shouldn&#39;t bother you - in fact, you should be pleased - but the disappearance of the glory hole just leaves you feeling... &lt;i&gt;unsatisfied&lt;/i&gt;.
&lt;&lt;HeroTalk &quot;I must admit, it&#39;s been a welcome distraction from the horrors of the Deep Woods. And now it&#39;s gone.&quot;&gt;&gt; \
Now you&#39;re all wet, and with no relief in sight.
&lt;video loop muted autoplay src=&quot;Images/Other/solo12.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;Maybe I should head to the cabin and take care of this myself...&quot;&gt;&gt; \
&lt;&lt;if $fem eq 1&gt;&gt;As strange as it seems, your sexual libido has only &lt;i&gt;grown&lt;/i&gt; since becoming a woman. Your pussy is far needier than your cock ever was.&lt;&lt;/if&gt;&gt;

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $merchantlove = 16&gt;&gt;\
\
&lt;&lt;elseif $p eq 26&gt;&gt;\
\
You lean against the wall of your cabin, staring at yourself through the mirror.
&lt;img src=&quot;Images/Other/babar3.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;This is getting ridiculous. I can&#39;t just scamper off to my cabin whenever that stupid man and his stupid cock come creeping into my head.&quot;&gt;&gt; \
Huffing, you rise and starting putting on your clothes.
&lt;&lt;if $fem eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;I&#39;m not just a hero - I&#39;m a woman, now, too. If I want to treat a man, privately, in exchange for a bit of gold, then that&#39;s exactly what I&#39;ll do.&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;I&#39;m a grown woman - and a hero, at that. If I want to treat a man, privately, in exchange for a bit of gold, then that&#39;s exactly what I&#39;ll do.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \

&lt;i&gt;Treat a man privately&lt;/i&gt; - a fair euphemism for gagging on his dick.

[[Return-&gt;Cabin]] 

&lt;&lt;set $merchantlove = 17&gt;&gt;\
\
&lt;&lt;elseif $p eq 27&gt;&gt;\
\
You walk up to &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; carriage, feeling rather nervous about the entire situation. It&#39;s not just about negotiating terms for a blowjob - you also need to go back on what you said to him that morning when he gave you the gift.

&lt;&lt;if $legs neq &quot;Naughty Stockings and Garter&quot;&gt;&gt;The gift!
&lt;img src=&quot;Images/Other/babar2.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Babar will probably take my apology seriously if I&#39;m wearing those stockings when I speak to him. I&#39;m not exactly pleased about the idea of wearing them outside...&quot;&gt;&gt; \

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;else&gt;&gt;\
You&#39;re all dressed up in that very gift, now. The light wind of the day tickles the bare skin of your thighs. Your ass cheeks are fully on display. It&#39;s simultaneously embarassing and invigorating. 
&lt;img src=&quot;Images/Armor/Naughty Stockings and Garter.jpg&quot; width=350 /&gt;

Best of all, just the act of walking outside like this has your pussy nice and wet.

[[Speak to Babar-&gt;Merchant Lewd][$p = 28]]
\
&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 28&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
The merchant takes one look at you before his jaw drops open.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;By sun and sand - $name! You look like a Goddess come to bless the mortal world. Tylae herself, perhaps.&quot;&gt;&gt; \
You feel your cheeks brighten.
&lt;&lt;HeroTalk &quot;I don&#39;t think Tylae would ever wear something like this. Lilith, on the other hand...&quot;&gt;&gt; \
His eyes soak in the sight of you, pausing on your soft, thick thighs, and then your black panties. You hate to admit it, but you like the way he&#39;s looking at you. 
&lt;&lt;MerchantTalk &quot;Could you... spin for me?&quot;&gt;&gt; \

[[Indulge him-&gt;Merchant Lewd][$p = 29]]

&lt;&lt;elseif $p eq 29&gt;&gt;\
\
After rolling your eyes, you turn around and give him a good look at your backside.
&lt;img src=&quot;Images/Other/babar4.jpg&quot; width=550 /&gt;

&lt;&lt;MerchantTalk &quot;The more I see, the more I realize you really are an exceptional woman, $name. You humble me.&quot;&gt;&gt; \
You try not to let his compliments affect you, but they do. Your heart is practically singing.
&lt;&lt;MerchantTalk &quot;Does this mean you... reconsidered?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;... I have conditions.&quot;&gt;&gt; \

[[He listens attentively-&gt;Merchant Lewd][$p = 30]]

&lt;&lt;elseif $p eq 30&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;We do it in the cabin. At night. Quietly.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Of course.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;It is &lt;i&gt;not&lt;/i&gt; an invitation for sex, or for you to spend the night. You will get what you pay for, nothing more.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Naturally.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;This is not romance. I am not your lover.&quot;&gt;&gt; \
At that, he stares at you for a long moment. Your heart trembles. Despite your attempts to keep his gaze, you blush and look at your feet.
&lt;&lt;MerchantTalk &quot;And what of the price, $name? Does 300 gold sound right?&quot;&gt;&gt; \
It sounds like plenty.

[[300 will do.-&gt;Merchant Lewd][$p = 31, $i = 1]]
[[I want 400.-&gt;Merchant Lewd][$p = 31, $i = 2]]
[[I demand 500!-&gt;Merchant Lewd][$p = 31, $i = 3]]

&lt;&lt;elseif $p eq 31&gt;&gt;\
&lt;&lt;if $i eq 1&gt;&gt;\
That&#39;s quite a bit more gold than he was paying the goblins. He must really hold you - and your tongue - in high esteem.

Beaming, you nod.
&lt;&lt;HeroTalk &quot;That will do. Thank you, Babar.&quot;&gt;&gt; \
\
&lt;&lt;set $gold += 300&gt;&gt;\
&lt;&lt;elseif $i eq 2&gt;&gt;\
That&#39;s quite a bit more gold than he was paying the goblins. He must really hold you - and your tongue - in high esteem.

Still, it couldn&#39;t hurt to push him.
&lt;&lt;HeroTalk &quot;400 sounds better, to me.&quot;&gt;&gt; \
He shrugs.
&lt;&lt;MerchantTalk &quot;Consider it done.&quot;&gt;&gt; \
\
\
&lt;&lt;set $gold += 400&gt;&gt;\
&lt;&lt;elseif $i eq 3&gt;&gt;\
That&#39;s quite a bit more gold than he was paying the goblins. He must really hold you - and your tongue - in high esteem.

But you&#39;re not an alleyway whore. Well, you &lt;i&gt;are&lt;/i&gt; a whore, now. Technically. But a special one.
&lt;&lt;HeroTalk &quot;500 gold, or this isn&#39;t happening.&quot;&gt;&gt; \
He shrugs.
&lt;&lt;MerchantTalk &quot;I would have paid one thousand.&quot;&gt;&gt; \
\
&lt;&lt;set $gold += 500&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\
He slides the gold across the table. You take it, feeling a bit stunned. You just sold your body for gold. &lt;i&gt;And it felt nice&lt;/i&gt;.

[[Now what?-&gt;Merchant Lewd][$p = 32]]

&lt;&lt;elseif $p eq 32&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;I suppose I&#39;ll see you tonight.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Or tomorrow night, if you would prefer. Call on me when it pleases you, $name. For a woman of your talent, a man must be patient, yes?&quot;&gt;&gt; \
His way with words is making you wet. If only he wasn&#39;t so charming! &lt;&lt;if $fem eq 1&gt;&gt;A &lt;i&gt;woman&lt;/i&gt; of talent. The more you&#39;re referred to as a woman, the more it feels like you&#39;ve always been one.&lt;&lt;/if&gt;&gt;

[[Leave him before you do something stupid-&gt;Outside the Cabin]] 

&lt;&lt;set $merchantlove = 18&gt;&gt;\
\
&lt;&lt;elseif $p eq 33&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
A moment after you call his name, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; is at your door.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;$name, you look exceptionally sweet, tonight. Can I come in?&quot;&gt;&gt; \
Your heart is racing. It&#39;s hard to believe you&#39;re doing this - and yet, here he is.
&lt;&lt;if $fem eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;Are you sure you&#39;re not bothered about me? About what I once was?&quot;&gt;&gt;
&lt;&lt;MerchantTalk &quot;Not at all, $name. Leave the past in the past - and embrace everything you are today.&quot;&gt;&gt; \
&lt;&lt;else&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course, come inside.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \

[[Bring him to your bed-&gt;Merchant Lewd][$p = 34]]

&lt;&lt;elseif $p eq 34&gt;&gt;\
\
Once you get him to your bed, you feel too frozen with nerves to act. You, a hero in service to the King, blowing a middle-aged merchant from the Great Occident for a few hundred gold pieces! Second thoughts flood your mind.

Perhaps seeing your hesitation, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; steps close.
&lt;&lt;MerchantTalk &quot;It is a custom in my homeland that the chest is bare, during service.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;The chest is &lt;i&gt;what&lt;/i&gt;?&quot;&gt;&gt; \
Instead of answering, he peels off your top.
&lt;video loop muted autoplay src=&quot;Images/Other/fondle1.mp4&quot;&gt;&lt;/video&gt;

Your breasts burst free. Hot from your nerves and being bundled up in your armor, they tingle from the cool air of the bedroom. Your nipples immediately stiffen from the chill.

&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; stares at your breasts, clearly pleased. He&#39;s nor &lt;i&gt;leering&lt;/i&gt; at them, just admiring them. You shouldn&#39;t feel proud at being gawked at, and yet...

... you &lt;i&gt;like&lt;/i&gt; the way he looks at you. &lt;&lt;if $fem eq 1&gt;&gt;You&#39;ve never been adored by a man before. It makes you feel &lt;i&gt;sexy&lt;/i&gt;.&lt;&lt;else&gt;&gt;When were you last so &lt;i&gt;adored&lt;/i&gt; by a man?&lt;&lt;/if&gt;&gt;
&lt;&lt;MerchantTalk &quot;May I?&quot;&gt;&gt; \

[[He reaches out-&gt;Merchant Lewd][$p = 35]]

&lt;&lt;elseif $p eq 35&gt;&gt;\
\
You gasp as his hands take hold your breasts, then gently squeeze them. His touch feels nice. You especially like how his fingers press against your stiff nipples.
&lt;video loop muted autoplay src=&quot;Images/Other/fondle2.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;MerchantTalk &quot;Does that feel good?&quot;&gt;&gt; \
He knows that it does. The man is clearly an expert at pleasing women. All you do is nod to his words, feeling much like melted butter to his plying touch.

Then one hand leaves your chest, and pushes gently on the top of your head.

[[Fall to your knees-&gt;Merchant Lewd][$p = 36]]

&lt;&lt;elseif $p eq 36&gt;&gt;\
\
His cock is hard and poking through his robes. You grasp it with one hand, then set your lips upon it. Your body is essentially acting on its own accord - acting on instinct, on desire. All you want in this moment is to please this glorious dick. It doesn&#39;t even matter that you were paid to do it.
&lt;video loop muted autoplay src=&quot;Images/Other/blowjob1.mp4&quot;&gt;&lt;/video&gt;

The cabin is filled with the sounds of your slurping and sucking. &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; strokes your hair, occasionally moving aside an errant strand that has gotten caught on your lips. 

He&#39;s no brash, aggressive customer. He&#39;s exceedingly gentle.

[[Please him-&gt;Merchant Lewd][$p = 37]]

&lt;&lt;elseif $p eq 37&gt;&gt;\
\
He sits on your bed, and you crawl after him. Carefully, tenderly, you kiss every part of his swollen shaft, then let your tongue slide along the glans. He grunts with fine approval.
&lt;video loop muted autoplay src=&quot;Images/Other/blowjob2.mp4&quot;&gt;&lt;/video&gt;

As you blow him, one of your hands rests on his thigh. Even with the fabric of his robe there between your skin and his, you can feel the hard cords of his muscles. The man isn&#39;t really &lt;i&gt;fat&lt;/i&gt; like his bulky frame might suggest - he&#39;s just stout and incredibly well-built. Solid, like an ox.

&lt;&lt;if $fem eq 1&gt;&gt;As a man, you loved strong women - and as it turns out, as a woman, you &lt;i&gt;love&lt;/i&gt; big, beefy men.&lt;&lt;else&gt;&gt;You love a strong man.&lt;&lt;/if&gt;&gt; Your body responds to the feel of him, your pussy dripping with excitement.

[[Don&#39;t stop-&gt;Merchant Lewd][$p = 38]]

&lt;&lt;elseif $p eq 38&gt;&gt;\
You try to take in as much of him as possible. There&#39;s just too much dick for you to ever reach the base. Still, you know he likes it when you gag.
&lt;video loop muted autoplay src=&quot;Images/Other/blowjob3.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;MerchantTalk &quot;Mmm... very good, $name. Just like that...&quot;&gt;&gt; \
His words of encouragement make your whole body tremble. You love when his voice gets like that, so low and husky, and with that lovely, lilting accent.
&lt;&lt;MerchantTalk &quot;Be ready... I&#39;m nearly there...!&quot;&gt;&gt; \

[[Make him cum-&gt;Merchant Lewd][$p = 39]]

&lt;&lt;elseif $p eq 39&gt;&gt;\
\
You start sucking hard on the head of his cock, your tongue ever so gently pushing into his urethra. He grunts, and the next moment your mouth is filled with his hot, bitter orgasm. You swallow two mouthfuls of semen, then pull back, cum dripping down your chin.
&lt;video loop muted autoplay src=&quot;Images/Other/blowjob4.mp4&quot;&gt;&lt;/video&gt;

You help him finish his climax by stroking his cock, forcing the last drops of semen out onto your sheets. Your whole cabin stinks of his sweat, his exotic perfume, and his cum. The scents all mingle together into something masculine and enticing. Almost intoxicating.
&lt;&lt;HeroTalk &quot;Was it worth it?&quot;&gt;&gt; \
He grins.
&lt;&lt;MerchantTalk &quot;Every bit of gold, of course.&quot;&gt;&gt; \

[[Clean up-&gt;Merchant Lewd][$p = 40]]

&lt;&lt;elseif $p eq 40&gt;&gt;\
\
Afterwards, you walk him back to the threshold of your cabin. Outside, the night is dark, though a full moon glows in the distant sky.
&lt;img src=&quot;Images/Locations/night5.jpg&quot; width=700 /&gt;

&lt;&lt;MerchantTalk &quot;This was a perfect evening, $name. You have my thanks.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Of course. Just remember - this stays between us.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Yes, between us.&quot;&gt;&gt; \
He looks at you calmly. Your heart doubles its beat.

[[He leans in-&gt;Merchant Lewd][$p = 41]]

&lt;&lt;elseif $p eq 41&gt;&gt;\
And then-
&lt;video loop muted autoplay src=&quot;Images/Other/kiss1.mp4&quot;&gt;&lt;/video&gt;

For a moment, you&#39;re too stunned by the act to react. &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; lips are pressed to yours, his stubble scratching your chin. His tongue is past your teeth, his hands clutching your bottom, your hips, your breasts-
&lt;&lt;HeroTalk &quot;STOP!&quot;&gt;&gt; \
You push him back.
&lt;&lt;HeroTalk &quot;You are a merchant - I am a hero. This is &lt;i&gt;not&lt;/i&gt; happening.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;But $name, you can&#39;t deny that-&quot;&gt;&gt; \
He sees the anger in your stare, and lets his words die out.
&lt;&lt;MerchantTalk &quot;... I see. Forgive me, $name. This never happened.&quot;&gt;&gt; \

You watch him leave, feeling twisted and strange. He was completely out of line, and yet your heart aches to see him go.
&lt;&lt;HeroTalk &quot;This. Never. Happened.&quot;&gt;&gt; \

[[Return-&gt;Cabin]] 

&lt;&lt;set $merchantlove = 19&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 42&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You open the door, confused as to why &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; is standing outside your cabin.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;$name - I did not have the chance to say it yet, so allow me to speak: I am so glad to see you survived the Tower of Zyr! To know a beauty like yours has perished from the world would tear my heart in-&quot;&gt;&gt; \
You grab him by the arm before he says any more.
&lt;&lt;HeroTalk &quot;Hush, Babar! What if Naya or Scyllia heard you? Come inside, if you must babble.&quot;&gt;&gt; \

[[Drag him in and shut the door-&gt;Merchant Lewd][$p = 43]]

&lt;&lt;elseif $p eq 43&gt;&gt;\
\
The moment he&#39;s inside, you feel a rush of nerves flood your heart, and a faint bit of heat rising in your cheeks. The last time you were in your cabin alone with &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;...

You shake your head, dismissing the thought. That was a mistake, and not one you plan on repeating. 
&lt;&lt;MerchantTalk &quot;As I was saying, the thought of you in danger is like salt in my eyes. You musn&#39;t endanger yourself again!&quot;&gt;&gt; \
Your eyebrows jump up in surprise. 
&lt;&lt;HeroTalk &quot;&lt;i&gt;You&#39;re&lt;/i&gt; going to tell &lt;i&gt;me&lt;/i&gt; what I can and cannot do? &lt;i&gt;I&#39;m&lt;/i&gt; the hero. You&#39;re my potion seller.&quot;&gt;&gt; \
He concedes this point with a humble bow.
&lt;&lt;MerchantTalk &quot;All the same, we are bound, now, you and I. My heart aches at the thought of you coming to harm.&quot;&gt;&gt; \

[[He pulls something from his pocket-&gt;Merchant Lewd][$p = 44]]

&lt;&lt;elseif $p eq 44&gt;&gt;\
\
It&#39;s some kind of necklace. Though the light is dim in your cabin, the gold upon the object seems to glow with a faint, sparkling light.
&lt;img src=&quot;Images/Other/babar5.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;It&#39;s beautiful.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;It&#39;s a gift.&quot;&gt;&gt; \
You remember what happened when you wore the last gift he gave you. The indecent offer. The taste of his manhood in your mouth. His sudden, passionate kiss.
&lt;&lt;HeroTalk &quot;I can&#39;t accept this. It&#39;s not appropriate.&quot;&gt;&gt; \
He chuckles.
&lt;&lt;MerchantTalk &quot;You think I&#39;m trying to court you, $name? Nonesense - this necklace carries a powerful encantation. It will protect you against the horrors of Deep Woods, and empower you to fight on.&quot;&gt;&gt; \

[[Examine the necklace-&gt;Merchant Lewd][$p = 45]]

&lt;&lt;elseif $p eq 45&gt;&gt;\
\
Touching it sends a warm spark through your arm. It certainly contains some kind of magic energy. It could serve as useful tool in your quest.

Then again, it may be best to refuse it. &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; generosity has a way of sneaking its way into your heart. You can hardly trust yourself around him, anymore. This necklace may be more than you can bear.

[[Refuse the necklace-&gt;Merchant Lewd][$p = 46]]
[[Accept the necklace-&gt;Merchant Lewd][$p = 47]]

&lt;&lt;elseif $p eq 46&gt;&gt;\
\
You stare at the glowing gold for another moment, then hand it back to &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;HeroTalk &quot;I&#39;m sorry, Babar. This needs to stop.&quot;&gt;&gt; \
He sighs, looking like he expected you to say exactly that.
&lt;&lt;MerchantTalk &quot;Of course... you&#39;re probably right. Be well, $name.&quot;&gt;&gt; \
He trudges off back to his shop, looking a bit downtrodden. It hurts to deny him, but you know this was the right decision.

[[Return-&gt;Cabin]] 
\
&lt;&lt;set $merchantlove = 5&gt;&gt;\

&lt;&lt;elseif $p eq 47&gt;&gt;\
\
You stare at the glowing gold for another moment, all the while a warmth grows in your heart - and down between your legs. Gifts from &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; are simply &lt;i&gt;too sweet&lt;/i&gt; to refuse.
&lt;&lt;HeroTalk &quot;Thank you Babar - I will treasure it.&quot;&gt;&gt; \
He smiles, and his gaze makes it seem like he&#39;s beholding something divine. 
&lt;&lt;MerchantTalk &quot;It will help me rest, to know you have it. Be sure to sleep with it on, if you can. Doing so should empower it even further.&quot;&gt;&gt; \

[[Return-&gt;Cabin]] 

&lt;&lt;set $merchantlove = 20&gt;&gt;\
&lt;&lt;set $headinventory.push($lovelychoker)&gt;&gt;\

&lt;&lt;elseif $p eq 48&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
As you stomp towards &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;, he can tell something&#39;s amiss.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;Ah, $name! So good to see you. Was a potion not your liking?&quot;&gt;&gt; \
You draw your $weapon.

&lt;&lt;HeroTalk &quot;If you want to live, undo the curse you&#39;ve put on me. &lt;i&gt;Now&lt;/i&gt;.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;C-c-curse!? What curse!?&quot;&gt;&gt; \
Of course he&#39;d play dumb. You look around to make sure &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; can&#39;t hear you.
&lt;&lt;HeroTalk &quot;Come, we&#39;ll talk in the cabin.&quot;&gt;&gt; \

[[He complies-&gt;Merchant Lewd][$p = 49]]

&lt;&lt;elseif $p eq 49&gt;&gt;\
\
The moment, you shut the door in your cabin, you point your $weapon at him.
&lt;&lt;HeroTalk &quot;The choker, Babar. You know it&#39;s cursed.&quot;&gt;&gt; \
He bristles at the thought.
&lt;&lt;MerchantTalk &quot;I would die before a sold such a thing - or gave it as a gift! Tell me, $name - what is the nature of this curse?&quot;&gt;&gt; \
You blink, a bit taken aback by the question.
&lt;&lt;HeroTalk &quot;The... nature of it?&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Yes, I must know its nature. Has your strength run dry? Is your mana fading away in battle? Perhaps your skin is turning to stone?&quot;&gt;&gt; \
You feel yourself start to blush.
&lt;&lt;HeroTalk &quot;Not exactly.&quot;&gt;&gt; \

[[Explain. Delicately-&gt;Merchant Lewd][$p = 50]]

&lt;&lt;elseif $p eq 50&gt;&gt;\
&lt;&lt;HeroTalk &quot;The choker &lt;i&gt;does&lt;/i&gt; help in battle. But when I sleep, it... well, I&#39;ve been having dreams.&quot;&gt;&gt; \
He nods, not at all surprised.
&lt;&lt;MerchantTalk &quot;Yes, that makes sense. Night is when the choker activates.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Activates?&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Of course. You see, $name, I instilled the choker with how much I care for you. If it feels that same caring in your heart, it uses that energy to strengthen its magic. The choker wasn&#39;t affecting you... your dreams were affecting the choker!&quot;&gt;&gt; \
You touch it. So deliciously warm.
&lt;img src=&quot;Images/Other/babar5.jpg&quot; width=550 /&gt;

It seems you were a bit headstrong in accusing &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; of harming you with dark magic. The choker was simply feeding off your lust...

[[You blush at the thought-&gt;Merchant Lewd][$p = 51]]

&lt;&lt;elseif $p eq 51&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; seems to be thinking exactly the same as you.
&lt;&lt;MerchantTalk &quot;To have such a reaction to the choker... consider me flattered, dear $name! Never would I expect a man like me would catch the eye of such a divine beauty!&quot;&gt;&gt; \
He &lt;i&gt;says&lt;/i&gt; that, but you know he&#39;s actually quite clever. He sees how you look at him. How your breathing quickens when he&#39;s near. Just &lt;i&gt;being&lt;/i&gt; here, alone with him, is enough to make you wet.
&lt;&lt;HeroTalk &quot;... Fuck. I give up.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Give up on what?&quot;&gt;&gt; \
You drop to your knees. 
&lt;&lt;HeroTalk &quot;Pretending I don&#39;t need this.&quot;&gt;&gt; \

[[Grab his cock-&gt;Merchant Lewd][$p = 52]]

&lt;&lt;elseif $p eq 52&gt;&gt;\
\
You pull aside his robes, and his hard cock springs out to meet you.
&lt;&lt;MerchantTalk &quot;$name! Are you sure?&quot;&gt;&gt; \
Your answer is to wrap your lips around his swollen cockhead.
&lt;video loop muted autoplay src=&quot;Images/Other/blowjob1.mp4&quot;&gt;&lt;/video&gt;

You don&#39;t think. You don&#39;t worry. You just let your body do what it needs to do. What it &lt;i&gt;wants&lt;/i&gt; to do. You could very well die tomorrow - resisting your desire for &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; is a waste of time. &lt;&lt;if $fem eq 1&gt;&gt;Any thoughts of the man you once were feel distant and faint. You&#39;re a woman now. You have a woman&#39;s desires. You want to be feel him inside of you. You &lt;i&gt;need&lt;/i&gt; it.&lt;&lt;/if&gt;&gt;

Sometimes, a woman just needs to get fucked - hero, maid, or queen, it doesn&#39;t matter.

[[Climb on top of him-&gt;Merchant Lewd][$p = 53]]

&lt;&lt;elseif $p eq 53&gt;&gt;\
Your pussy is on fire. You need him inside of you. &lt;i&gt;Right now!&lt;/i&gt;

There&#39;s hardly time to undress. You just barely slide your soaking wet panties aside and then stuff him inside of you.
&lt;&lt;HeroTalk &quot;&lt;i&gt;OOOoooooohhh!!!&lt;/i&gt;&quot;&gt;&gt; \
After so many days of denial and desire, that moment of connection may as well be an orgasm in and of itself. &lt;&lt;if $fem eq 1&gt;&gt;You&#39;ve never had a cock inside of you before. It feels far better than you could have expected. Delicious warmth fills your body. That gaping emptiness between your legs is finally filled - you feel complete.&lt;&lt;else&gt;&gt;You&#39;ve had your share of lovers over the years, but none have felt quite like this.&lt;&lt;/if&gt;&gt; &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; simply &lt;i&gt;fits&lt;/i&gt;. His girthy cock takes up every little bit of space inside of you, ever so pleasantly stretching your hidden depths. As you bottom out on top of him, you gasp at the feeling of his dick pushing on your clit &lt;i&gt;from inside of you&lt;/i&gt;.
&lt;&lt;MerchantTalk &quot;$name... by the sun and sands. You are &lt;i&gt;magnificent&lt;/i&gt;.&quot;&gt;&gt; \
You start slow, riding him, feeling the full length of him you rise and then fall against him. Your pussy is so wet, just the sounds of you fucking him are loud enough to be heard outside the cabin. His pubic hair glistens with your warm juices.
&lt;&lt;if $fem eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;You did it, Babar. You&#39;ve taken my maidenhood... you&#39;re making a slut out of me...&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \
&lt;video loop muted autoplay src=&quot;Images/Other/sex2.mp4&quot;&gt;&lt;/video&gt;

[[Speed up-&gt;Merchant Lewd][$p = 54]]

&lt;&lt;elseif $p eq 54&gt;&gt;\
\
You keep going, your clothes off, you mind awash with perfect pleasure. The world, the Deep Woods, the Redeemer - none of them exist right now, as far as you&#39;re concerned. There&#39;s just &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;, as his hands against your hips, the feeling of him inside of you, the way he looks at your heaving breasts...
&lt;video loop muted autoplay src=&quot;Images/Other/sex3.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Babar, I&#39;m cumming!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Yes, a bit more... &lt;i&gt;a bit more...&lt;/i&gt;!!!&quot;&gt;&gt; \

[[Release-&gt;Merchant Lewd][$p = 55]]

&lt;&lt;elseif $p eq 55&gt;&gt;\
\
The two of you cum together, your pussy spasming with pleasure just as he fills you with his seed. You moan in bliss, grinding against his hips he pumps semen deep inside.

Then, on shaking legs, you rise. Only then you realize &lt;i&gt;just how much&lt;/i&gt; cum he spurted into your womb.
&lt;video loop muted autoplay src=&quot;Images/Other/creampie1.mp4&quot;&gt;&lt;/video&gt;

Reason slowly returns to you as your lust fades away.
&lt;&lt;HeroTalk &quot;Babar... I could get pregnant.&quot;&gt;&gt; \
He stares at you, his eyes full of love and admiration.
&lt;&lt;MerchantTalk &quot;Would that be so terrible?&quot;&gt;&gt; \
&lt;&lt;if $fem eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;Yes, it most certainly would. I may be a woman, now, but I&#39;m still a hero. This-&quot;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;Yes, it most certainly would. I&#39;m devoted to serving the king - not raising children. This-&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \
He finishes for you.
&lt;&lt;MerchantTalk &quot;-Was a mistake, yes? It&#39;s funny, $name... it doesn&#39;t &lt;i&gt;feel&lt;/i&gt; like a mistake.&quot;&gt;&gt; \
And the worst part is, he&#39;s not wrong. You feel guilty, but only because it was &lt;i&gt;so perfect&lt;/i&gt;, and you&#39;re not supposed to feel good right now. You&#39;re supposed to be redeeming yourself in the Deep Woods.

And you &lt;i&gt;definitely&lt;/i&gt; aren&#39;t supposed to fall in love, or become a mother.

[[Kick him out. Reluctantly-&gt;Merchant Lewd][$p = 56]]

&lt;&lt;elseif $p eq 56&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;m sorry, Babar. This has to stop.&quot;&gt;&gt; \
He dresses, not arguing with you. You almost wish he would. You almost wish he would slap you across the face and tell you to love him.

But he&#39;s too sweet for that.
&lt;&lt;MerchantTalk &quot;As you wish, $name. I am here to serve you in whatever capacity you need. At the shop, or in bed.&quot;&gt;&gt; \
Just as you mean to reply, one last glob of his semen drips out of your gaping pussy, landing between your feet. Terrible timing.
&lt;&lt;HeroTalk &quot;Please, Babar. Just go.&quot;&gt;&gt; \

He leaves you. You&#39;re left to clean up and think about what just happened.

[[Return-&gt;Cabin]] 

&lt;&lt;set $merchantlove = 26&gt;&gt;\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;
\
&lt;&lt;elseif $p eq 58&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
As you look into his eyes, everything suddenly becomes rather simple. Standing before you is a man who would journey to the depths of the underworld for you - or even to the Winter Palace. And all that&#39;s standing between the two of you being together is your own fear of letting him in.

And when death is on the line, that hardly seems like a good reason.

You lean in without saying a word.
&lt;video loop muted autoplay src=&quot;Images/Other/kiss2.mp4&quot;&gt;&lt;/video&gt;

The kiss is long and sweet. His tongue feels nice, curling against your own. You love how he smells up close - like citrus and exotic perfume.

[[Enjoy it-&gt;Merchant Lewd][$p = 59]]

&lt;&lt;elseif $p eq 59&gt;&gt;\
\
After a long moment entwined together, you pull back from him. You stare at the husky, grizzled merchant from a faraway land. Despite yourself, you can&#39;t help but swoon at the sight. You didn&#39;t mean for this to happen, but somehow he won you over. &lt;&lt;if $fem eq 1&gt;&gt;As a man, you never could grow fond of any particular woman. But now, your feels fully invested in him. Forever.&lt;&lt;/if&gt;&gt;
&lt;&lt;HeroTalk &quot;I love you, Babar Ogho.&quot;&gt;&gt; \
&lt;&lt;if $fem eq 1&gt;&gt;&lt;&lt;MerchantTalk &quot;And I&#39;ve loved you since the day $startingname vaished and $name took his place. Now, let&#39;s go kill a necromancer.&quot;&gt;&gt; &lt;&lt;else&gt;&gt;&lt;&lt;MerchantTalk &quot;And I&#39;ve loved you since the day I laid eyes on you, dear $name. Now, let&#39;s go kill a necromancer.&quot;&gt;&gt;&lt;&lt;/if&gt;&gt; \

[[Onwards!-&gt;Palace2][$p = 3]]

&lt;&lt;set $merchantlove = 27&gt;&gt;\
\
&lt;&lt;elseif $p eq 60&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
As you approach &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;, he sees you and drops into a formal bow.
&lt;img src=&quot;Images/Character/merchant3.jpg&quot; width=450 /&gt;

&lt;&lt;MerchantTalk &quot;Dear $name - how might I be of assistance?&quot;&gt;&gt; \
You give him a small curtsy in return.
&lt;&lt;HeroTalk &quot;I was hoping to speak with you about what happened beneath the Winter Palace... in private.&quot;&gt;&gt; \

[[Without another word, he follows you into your cabin-&gt;Merchant Lewd][$p = 61]]

&lt;&lt;elseif $p eq 61&gt;&gt;\
\
The moment you shut the door, you and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; share a long kiss.
&lt;video loop muted autoplay src=&quot;Images/Other/kiss4.mp4&quot;&gt;&lt;/video&gt;

Each time your lips touch his, you fall in love with him a little more. There&#39;s something about the way he pulls you close, his hands holding your hips so possessively, that makes you want to be his forever.

Pulling back, you catch a breath and wipe your lips. Already, that tell-tale warmth is gathering deep between your legs.
&lt;&lt;HeroTalk &quot;With Nendel&#39;s betrayal and the fire, we never did get a chance to talk.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Of course, my dear. What is it wish to speak of?&quot;&gt;&gt; \
You blink at him.
&lt;&lt;HeroTalk &quot;Well, I did tell you I loved you.&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;And I love you too. Now we are bound forever.&quot;&gt;&gt; \

[[Wait. What?-&gt;Merchant Lewd][$p = 62]]

&lt;&lt;elseif $p eq 62&gt;&gt;\
\
You take a step backward.
&lt;&lt;HeroTalk &quot;I don&#39;t know how it works in the Great Occident, but a single confession of love - especially when it seemed like we might die that very day - doesn&#39;t exactly constitute a marriage vow.&quot;&gt;&gt; \
He grins ear to ear and laughs at your discomfort.
&lt;&lt;MerchantTalk &quot;I only joke, sweet $name! Well, mostly. If you would spend a day with me, I&#39;d take it. A year? I&#39;d take. Even a lifetime, I would be honored. But no vow is needed. We&#39;ll stay together as long as the fates allow.&quot;&gt;&gt; \
That seems more than fair. You quite like the flexibility of it - maybe marriage is a different kind of thing altogether, in his homeland.

[[Continue-&gt;Merchant Lewd][$p = 63]]

&lt;&lt;elseif $p eq 63&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;Then there&#39;s Scyllia and Naya. I don&#39;t want them to think my heart is devoted to anything other than defeating the Redeemer.&quot;&gt;&gt; \
&lt;img src=&quot;Images/Character/team2.jpg&quot; width=650 /&gt;

&lt;&lt;MerchantTalk &quot;So we are to keep our love a secret? Very well, $name. We shall play as friends outside. Just call on me whenever you wish to be alone with me, and I will answer, yes?&quot;&gt;&gt; \
You smile, then step close.
&lt;&lt;HeroTalk &quot;What about right now?&quot;&gt;&gt; \

[[He sweeps you off your feet-&gt;Merchant Lewd][$p = 64]]

&lt;&lt;elseif $p eq 64&gt;&gt;\
\
Before you can even catch your breath, he has you pinned to your bed, your legs in the air as he buries his cock in your needy cunt. He could tell there was no need for foreplay of any kind - you&#39;re already wet enough to take him completely.
&lt;video loop muted autoplay src=&quot;Images/Other/sex4.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Oh Babar! Oh, fuck!&lt;/i&gt;&quot;&gt;&gt; \
Every thrust is a little taste of heaven. &lt;&lt;if $fem eq 1&gt;&gt;His cock makes you feel compelete.&lt;&lt;else&gt;&gt;His cock touches parts of deep inside that no other man has found before.&lt;&lt;/if&gt;&gt; And he&#39;s a masterful, experienced lover - he knows just the right angle to drive you absolutely mad.

&lt;&lt;if $fem eq 1&gt;&gt;When you turned into a woman, you wondered how to turn back. Now, you wouldn&#39;t dare. You want to be &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; lover forever!&lt;&lt;else&gt;&gt;You&#39;ll never sleep with a young man again. In fact, you might not sleep with &lt;i&gt;anyone else&lt;/i&gt; ever again!&lt;&lt;/if&gt;&gt;
&lt;&lt;HeroTalk &quot;&lt;i&gt;Harder! Harder!&lt;/i&gt;&quot;&gt;&gt; \

[[Get fucked-&gt;Merchant Lewd][$p = 65]]

&lt;&lt;elseif $p eq 65&gt;&gt;\
\
It isn&#39;t long before you cum. &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; is just too relentless in his pace, his cock is just too good for you to last very long at all. Moaning, you let yourself fall into complete bliss as waves of pleasure flash out from the center of your being. 
&lt;video loop muted autoplay src=&quot;Images/Other/femsex3.mp4&quot;&gt;&lt;/video&gt;

Distantly, you feel liquid gush out from your pussy and soak your sheets. Only &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; can make you squirt like a needy whore!
&lt;&lt;MerchantTalk &quot;&lt;i&gt;$name, I&#39;m nearly done!&lt;/i&gt;&quot;&gt;&gt; \
You eyes flash open.
&lt;&lt;HeroTalk &quot;&lt;i&gt;Pull out!&lt;/i&gt;&quot;&gt;&gt; \
He looks at you, pins you to the bed with his weight, and speeds up.
&lt;&lt;MerchantTalk &quot;&lt;i&gt;Such a thing is an insult in my land. I will finish where my seed belongs!&lt;/i&gt;&quot;&gt;&gt; \

At those words, you cum again.

[[So does he-&gt;Merchant Lewd][$p = 66]]

&lt;&lt;elseif $p eq 66&gt;&gt;\
\
You gasp as, for the second time, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; seed fills your womb. He lifts you up, pumping more and more of it inside of you. 
&lt;video loop muted autoplay src=&quot;Images/Other/creampie2.mp4&quot;&gt;&lt;/video&gt;

Despite the risks, you &lt;i&gt;love&lt;/i&gt; the way it feels. An intense sense of inner calm takes you as his semen flows into your womb. Almost like this was meant to be. Like this is the most important thing you could ever do.

Afterwards, you lie down together, both completely naked. Semen and trapped air spill and spurt out of your gaping cunt, making all kinds of unladylike noises.
&lt;&lt;HeroTalk &quot;... I think I just got pregnant.&quot;&gt;&gt; \
He smiles, and kisses your cheek.
&lt;&lt;MerchantTalk &quot;It is not a curse, to have a child. Embrace this part of you, dear $name.&quot;&gt;&gt; \
And though you should object, you just &lt;i&gt;can&#39;t&lt;/i&gt;. Mothering &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; children just feels like the right thing to do. Besides, with how insistent your lover is on finishing inside of you, you&#39;re going to end up pregnant sooner or later.

Once you clean up and get dressed, you feel it&#39;s time to carry on with your quest

[[Onwards!-&gt;Cabin]] 

&lt;&lt;set $merchantlove = 30&gt;&gt;\
&lt;&lt;set $pleasured = 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 70&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You climb out of bed slowly, feeling a bit more tired than usual. Your breasts feel just a bit tender, and your stomach aches.
&lt;&lt;HeroTalk &quot;Did I eat something rotten, yesterday?&quot;&gt;&gt; \
But even as you ask yourself that question, you realize that it&#39;s something else.
&lt;&lt;HeroTalk &quot;... &lt;i&gt;Oh&lt;/i&gt;. I&#39;m pregnant.&quot;&gt;&gt; \
&lt;&lt;if $fem eq 1&gt;&gt;Not too long ago, it wouldn&#39;t even be possible for you to carry a child. But here you, experiencing the grandest miracle of your new body. The thought is rather comforting. More than anything, this development makes it clear that you are a woman forever, fully, and completely.&lt;&lt;/if&gt;&gt;

The pregnancy is still very new - not even thirty days in the making, you&#39;d guess. And yet you&#39;re &lt;i&gt;certain&lt;/i&gt; that you&#39;re carrying &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; child. Likely from the first time the two of you made love.

For now, it&#39;s impossible to tell that you&#39;re with child, but that won&#39;t last forever. As the days run on, your breasts will get heavy with milk, your nipples will grow and darken, and your belly will swell with new life.
&lt;img src=&quot;Images/Other/babar8.jpg&quot; width=500 /&gt;

[[Make a decision-&gt;Merchant Lewd][$p = 71]]

&lt;&lt;elseif $p eq 71&gt;&gt;\
There are, of course, certain herbs a woman can use to end a pregnancy before it gets too far along.

And yet... you can&#39;t even fathom such an option. You love &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;. You&#39;re a woman of thirty years. If you can save the world from the Redeemer, why not have a child?

Of course, you won&#39;t tell anyone about it - not even &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;. He&#39;d just get so worried that he&#39;d try and stop you from going to battle.

You rest a hand against your flat belly, knowing it won&#39;t be flat for much longer.
&lt;&lt;HeroTalk &quot;Just one more thing worth fighting for.&quot;&gt;&gt; \

[[Onwards!-&gt;Cabin]] 

&lt;&lt;set $merchantlove = 31&gt;&gt;\

&lt;&lt;elseif $p eq 72&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
At your request, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; enters your cabin and shuts the door. Just as the door closes, his demeanor shifts from jolly merchant to ardent, devoted lover.
&lt;&lt;MerchantTalk &quot;My dear. My sweet. Show me you want me.&quot;&gt;&gt; \

You comply with a smile, peeling off your clothes and showing him how wet he makes you.
&lt;video loop muted autoplay src=&quot;Images/Other/strip1.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;I &lt;i&gt;need&lt;/i&gt; you...&quot;&gt;&gt; \

[[He takes off his robe-&gt;Merchant Lewd][$p = 73]]

&lt;&lt;elseif $p eq 73&gt;&gt;\
\
He takes you from behind, slamming his hefty bulk into your hips and making your breasts heave. Having sex like this, like an animal, makes you feel so deliciously naughty.
&lt;video loop muted autoplay src=&quot;Images/Other/sex5.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Yes! - Yes! - Yes! - Yes! Oooohhh!!!&lt;/i&gt;&quot;&gt;&gt; \
He knows just how to make you cum. As you reach your climax, he slips one hand between your legs gently tugs at your clit. That, plus the way his cock is plowing your depths, is more than enough to have you squirt onto your sheets.
&lt;&lt;MerchantTalk &quot;My turn.&quot;&gt;&gt; \

[[He turns you over-&gt;Merchant Lewd][$p = 74]]

&lt;&lt;elseif $p eq 74&gt;&gt;\
\
You know this is his favorite position - being on top of you, getting the perfect view of the woman he charmed, courted, and conquered.
&lt;video loop muted autoplay src=&quot;Images/Other/sex7.mp4&quot;&gt;&lt;/video&gt;

With every thrust, he grunts with pleasure, enjoying the sight and feel of you. Those low, rumbling noises of hard masculinity just make you even more wet. You draw back your legs with your arms, giving him full access to your cunt.
&lt;&lt;MerchantTalk &quot;&lt;i&gt;I&#39;m almost there - here comes your baby!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;&lt;i&gt;Yes! Give it to me!&lt;/i&gt;&quot;&gt;&gt; \

[[He climaxes-&gt;Merchant Lewd][$p = 75]]

&lt;&lt;elseif $p eq 75&gt;&gt;\
\
As always, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; makes sure to pump each and every drop of his seed deep inside your pussy. Blowjobs are one thing, but when the men of Occident have sex, they don&#39;t waste anything.

You gasp, feeling his warm, sticky fluid fill you up.
&lt;video loop muted autoplay src=&quot;Images/Other/creampie3.mp4&quot;&gt;&lt;/video&gt;

Even after the last bit of semen is pumped inside of you, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; stays where he is. It feels incredibly intimate, his thick cock slowly softening inside of you while his seed works its way into your womb.
&lt;&lt;HeroTalk &quot;I love you.&quot;&gt;&gt; \
He kisses you on your lips.
&lt;&lt;MerchantTalk &quot;I love you too. You will make such a fine mother, my dear. I&#39;m sure of it.&quot;&gt;&gt; \
&lt;&lt;if $merchantlove gte 31&gt;&gt;Little does he know, you&#39;re already carrying his baby. You&#39;ll have a child of your own suckling at your breast before the year is out.&lt;&lt;else&gt;&gt;You love how insistent he is. You sincerely hope his seed takes, and your body swells with new life soon.&lt;&lt;/if&gt;&gt;

Afterwards, the two of you dress and return to the matter at hand. The Redeemer must be stopped.

[[Return-&gt;Cabin]] 

&lt;&lt;set $pleasured = 1&gt;&gt;

&lt;&lt;elseif $p eq 76&gt;&gt;\
\










&lt;&lt;/if&gt;&gt;\
\
\</tw-passagedata><tw-passagedata pid="170" name="Merchant Dream" tags="" position="930,1810" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
You find yourself in a strange dream.

&lt;&lt;if $merchantlove eq 20&gt;&gt;\
In it, you are lying on clean, warm sheets. Above you, your lover&#39;s cock glistens - large and pendulous and perfect for filling up your needy pussy.
&lt;img src=&quot;Images/Other/babar1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Wait... isn&#39;t that Babar&#39;s cock?&lt;/i&gt;&quot;&gt;&gt; \
While that may be true, it doesn&#39;t stop your from opening wide...
\
&lt;&lt;elseif $merchantlove eq 21&gt;&gt;\
In it, your lover&#39;s cock is stretching at your jaw, as your play with it inside your mouth. His taste, his scent, the way he makes you feel like the most beautiful woman in the world... all of it is absolutely intoxicating. Enthralling, even.
&lt;video loop muted autoplay src=&quot;Images/Other/blowjob3.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;I&#39;ve done this before... another dream about Babar?&lt;/i&gt;&quot;&gt;&gt; \
\
&lt;&lt;elseif $merchantlove eq 22&gt;&gt;\
You lie there, completely spent after a rough night of sex with your lover.
&lt;img src=&quot;Images/Other/babar7.jpg&quot; width=550 /&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Babar, if we&#39;re not careful, I&#39;ll be pregnant long before we deal with the Deep Woods...&lt;/i&gt;&quot;&gt;&gt; \
\
\
&lt;&lt;elseif $merchantlove eq 23&gt;&gt;\
Your legs are spread wide open. Your lover slams his hips against yours, his turgid cock filling you completely over and over again. You cry out his name to the rhythm of his thrusts.
&lt;video loop muted autoplay src=&quot;Images/Other/femsex2.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Oh, Babar! Oh! Oh! Babar, don&#39;t stop! Fuck me harder&lt;/i&gt;&quot;&gt;&gt; \

&lt;&lt;elseif $merchantlove eq 24&gt;&gt;\
Your lover presses his hard cock against your pussy lips, driving you mad as his glans rubs your clit.
&lt;video loop muted autoplay src=&quot;Images/Other/sex1.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;MerchantTalk &quot;&lt;i&gt;You want me?&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;&lt;i&gt;Yes...&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;&lt;i&gt;Then tell me what I want to hear...&lt;/i&gt;&quot;&gt;&gt; \
You know what he wants.
&lt;&lt;HeroTalk &quot;&lt;i&gt;I love you, Babar. Please fuck me. Make me yours...&lt;/i&gt;&quot;&gt;&gt; \
\
&lt;&lt;/if&gt;&gt;\

[[Wake up-&gt;Merchant Dream][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
&lt;&lt;if $merchantlove lt 24&gt;&gt;You wake up in a sweat. Between your legs, your pussy feels hot and wet and &lt;i&gt;empty&lt;/i&gt;, almost aching to be filled. 
&lt;img src=&quot;Images/Other/babar6.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Just a dream... nothing more than that...&quot;&gt;&gt; \

&lt;i&gt;The choker against your neck burns with a warm, lovely heat. Its power grows as your lust for &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; rises. But before you realize what&#39;s happening, drowsiness strikes.&lt;/i&gt;

&lt;&lt;set $lovelychoker.strength += 1&gt;&gt;\
&lt;&lt;set $lovelychoker.agility += 1&gt;&gt;\
&lt;&lt;set $lovelychoker.willpower += 1&gt;&gt;\
&lt;&lt;set $lovelychoker.armor += 1&gt;&gt;\
&lt;&lt;set $headstrength = $lovelychoker.strength&gt;&gt;\
&lt;&lt;set $headagility = $lovelychoker.agility&gt;&gt;\
&lt;&lt;set $headwillpower = $lovelychoker.willpower&gt;&gt;\
&lt;&lt;set $headarmor = $lovelychoker.armor&gt;&gt;\
&lt;&lt;set $merchantlove += 1&gt;&gt;\

[[You fall asleep-&gt;Morning]] 
\
&lt;&lt;for _a to 0; _a lt $headinventory.length; _a++&gt;&gt;\
&lt;&lt;if $headinventory[_a].name eq &quot;Lovely Choker&quot;&gt;&gt;\
&lt;&lt;set $headinventory[_a].strength += 1&gt;&gt;\
&lt;&lt;set $headinventory[_a].agility += 1&gt;&gt;\
&lt;&lt;set $headinventory[_a].willpower += 1&gt;&gt;\
&lt;&lt;set $headinventory[_a].armor += 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/for&gt;&gt;\
\
&lt;&lt;else&gt;&gt;\
You wake up in a sweat. Between your legs, your pussy feels hot and wet and &lt;i&gt;empty&lt;/i&gt;, almost aching to be filled. 
&lt;img src=&quot;Images/Other/babar6.jpg&quot; width=450 /&gt;

You fight off the wave of drowsiness that strikes. Instead, you grasp the choker that steams against your neck, almost to the point of branding you.
&lt;&lt;HeroTalk &quot;This choker is cursed! No wonder I keep dreaming of that merchant and his fat cock! I&#39;ll make him regret this.&quot;&gt;&gt; \
&lt;&lt;set $lovelychoker.strength += 1&gt;&gt;\
&lt;&lt;set $lovelychoker.agility += 1&gt;&gt;\
&lt;&lt;set $lovelychoker.willpower += 1&gt;&gt;\
&lt;&lt;set $lovelychoker.armor += 1&gt;&gt;\
&lt;&lt;set $headstrength = $lovelychoker.strength&gt;&gt;\
&lt;&lt;set $headagility = $lovelychoker.agility&gt;&gt;\
&lt;&lt;set $headwillpower = $lovelychoker.willpower&gt;&gt;\
&lt;&lt;set $headarmor = $lovelychoker.armor&gt;&gt;\
&lt;&lt;set $merchantlove += 1&gt;&gt;\

[[You fall asleep, eager to deal with the lying merchant in the morning-&gt;Morning]] 
\
&lt;&lt;for _a to 0; _a lt $headinventory.length; _a++&gt;&gt;\
&lt;&lt;if $headinventory[_a].name eq &quot;Lovely Choker&quot;&gt;&gt;\
&lt;&lt;set $headinventory[_a].strength += 1&gt;&gt;\
&lt;&lt;set $headinventory[_a].agility += 1&gt;&gt;\
&lt;&lt;set $headinventory[_a].willpower += 1&gt;&gt;\
&lt;&lt;set $headinventory[_a].armor += 1&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/for&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="171" name="Epilogue2" tags="" position="401,1708" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
@@.delayed;The End@@

@@.delayed;...@@

@@.delayed;[[Or is it?-&gt;Epilogue2][$p = 1]]
 @@

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
While &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; was happy to reassure &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Queen Naya&lt;/b&gt;&lt;/span&gt; that $name was doing quite well, he did not reveal the whole truth.

That, of course, was at his wife&#39;s request. When he went to the coronation, she insisted that he remain perfectly vague on her whereabouts. She had no interest in being found and bothered by friends or foes.

So, having seen the grand coronation of the new Queen of Netheryn, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; returned to his home in the Great Occident.
&lt;img src=&quot;Images/Other/zending1.jpg&quot; width=500 /&gt;

[[He was eager to return-&gt;Epilogue2][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
\
&lt;&lt;set $title = &quot;Ogho&quot;&gt;&gt;\
&lt;&lt;set $weapon = &quot;none&quot;&gt;&gt;\
&lt;&lt;set $daynumber += 93&gt;&gt;\
&lt;&lt;set $gold += 5000&gt;&gt;\
&lt;&lt;set $head = &quot;Flowing hair&quot;&gt;&gt;\
&lt;&lt;set $chest = &quot;Milky breasts, pregnant belly&quot;&gt;&gt;\
&lt;&lt;set $hands = &quot;Jeweled hands&quot;&gt;&gt;\
&lt;&lt;set $legs = &quot;Thick thighs&quot;&gt;&gt;\
&lt;&lt;set $feet = &quot;Swollen feet&quot;&gt;&gt;\
&lt;&lt;set $epilogue = 1&gt;&gt;\
\
When he arrived at his modest seaside estate, the sun was glittering upon the quiet waters, and it almost seemed like no one was home. 

Knowing better, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; hobbled his camel, wiped the travel dust from his robes, and walked to the shore.

There, he was greeted by his wife.
&lt;&lt;HeroTalk &quot;&lt;i&gt;There you are!&lt;/i&gt; You were supposed to be home three days ago!&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;I was waylaid by a sandstorm. Now, my dear, you can&#39;t be wandering around naked outside.&quot;&gt;&gt; \
You frown at him, your heavy, tender breasts swaying as you lean in.
&lt;img src=&quot;Images/Other/zending2.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;I was just swimming. And besides, the servants have seen me give birth - they know what my body looks like.&quot;&gt;&gt; \
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; concedes the point with a bow.
&lt;&lt;MerchantTalk &quot;You seem to be leaking.&quot;&gt;&gt; \
You cup your swollen breasts, squeezing ever so gently. More milk streams out.
&lt;&lt;HeroTalk &quot;I&#39;m &lt;i&gt;always&lt;/i&gt; leaking. I&#39;ve become $name the Leaking, Goddess of fresh milk.&quot;&gt;&gt; \

[[The two of you stare at each other for a moment more, then break out into laughter-&gt;Epilogue2][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
You lead &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; back inside the estate, then walk together to the master bedroom. A servant girl sees the master is home, drops into a curtsy, then runs away to draw a bath. As for your nakedness, she doesn&#39;t even blink. You&#39;re so big with your second pregnancy - &lt;i&gt;twins, you think, judging by the four feet kicking your bladder&lt;/i&gt; - that only a few of your dresses even fit.

You got big with your first pregnancy. &#39;Little Zabil is a warrior!&#39; &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; liked to say, while he massaged your belly. But now with your second... it&#39;s incredible to think you were ever the muscled, lithe hero who defeated Void in the Deep Woods. Now you&#39;re a wide-hipped, heavy-bosomed, slow-moving, fat-bellyed, soft-thighed, &lt;i&gt;milk-dripping&lt;/i&gt; wife and mother.
&lt;img src=&quot;Images/Other/zending3.jpg&quot; width=500 /&gt;

Even once the twins are born, your body will never be the same as it once was. You&#39;ve forever traded fitness and muscle for wide hips and soft skin and a flabby belly. Not to mention your breasts are each larger than your head, now.

And even if you could regain some of your old athleticism, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; would soon have you pregnant once again. He&#39;s hoping to have at least ten children. At this rate, you expect you could have as many as twelve.

This is your life, now.

[[And you couldn&#39;t be happier-&gt;Epilogue2][$p = 4]]

&lt;&lt;elseif $p eq 4&gt;&gt;\
\
You shut the bedroom door.
&lt;&lt;MerchantTalk &quot;Where is Zabil?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Napping. Not to worry, he&#39;ll be up soon to say hello. Tell me, how was the coronation?&quot;&gt;&gt; \
The two of you sit on the large bed, covered in fine silken sheets. At the bedstand, a carafe of ice water (a true luxury, in the Occident) awaits.
&lt;&lt;MerchantTalk &quot;Glorious. Queenship suits Naya. A feeling of hope - true hope for men and elves - filled the whole of the Deep Woods. I wish you were there.&quot;&gt;&gt; \
You pull off one of his dusty boots, and set to massage the sores from his feet.
&lt;&lt;HeroTalk &quot;Don&#39;t be a fool, Babar. My place is here, with our family.&quot;&gt;&gt; \
He smiles, leans close, and runs one hand against your belly. You love when the father of your children touches you like this, so warmly, so delicately.
&lt;&lt;HeroTalk &quot;Your daughters are happy to see you, too.&quot;&gt;&gt; \
He rests his fingers on your nipples, then gently tugs at them. You gasp and warm milk dribbles out onto your belly.
&lt;&lt;MerchantTalk &quot;And my wife? Is she happy to see me?&quot;&gt;&gt; \

[[Make love-&gt;Epilogue2][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
\
When you&#39;re &lt;i&gt;this&lt;/i&gt; pregnant, only so many positions still even &lt;i&gt;work&lt;/i&gt; when it comes to sex. Of course, that never stopped you and &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;. During your first pregnancy, you discovered that seeing you all puffed up and heavy only turned your husband on.

Meaning sex became a daily, sometimes twice daily occurance.
&lt;video loop muted autoplay src=&quot;Images/Other/zending1.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Oh, Babar! Oh, Babar! I missed you!!!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Shh, you&#39;ll wake Zabil!&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;&lt;i&gt;I don&#39;t care, I need this!&lt;/i&gt;&quot;&gt;&gt; \

[[Keep going-&gt;Epilogue2][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
\
You love the way your body, so filled with milk and life, heaves and sways with your husband&#39;s forceful thrusts. Though you&#39;re not nearly as tight as you were before giving birth to your first son, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&#39;s&lt;/b&gt;&lt;/span&gt; cock still feels fantastic as it fills up every inch of your hidden depths.
&lt;video loop muted autoplay src=&quot;Images/Other/zending2.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Can you make me pregnant again?&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;I can try!&quot;&gt;&gt; \

[[You climax together-&gt;Epilogue2][$p = 7]]

&lt;&lt;elseif $p eq 7&gt;&gt;\
\
Afterwards, you lie there on the bed, feeling filled up and very much in love. 
&lt;img src=&quot;Images/Other/zending4.jpg&quot; width=500 /&gt;

From across the estate, you can hear baby Zabil crying. With you all naked and messy with sex, &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; of course will go to the child - but first he just stands there, staring at you.

&lt;&lt;HeroTalk &quot;Don&#39;t look at me. I&#39;m almost as heavy as you are.&quot;&gt;&gt; \
He chuckles.
&lt;&lt;MerchantTalk &quot;My love, I just realized something.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;That your wife is a fat cow?&quot;&gt;&gt; \
&lt;&lt;MerchantTalk &quot;Not at all.&quot;&gt;&gt; \
You tilt your head. 
&lt;&lt;HeroTalk &quot;What is it then? What did you realize?&quot;&gt;&gt; \
He lets his eyes slowly shift from your womanhood, to your breasts, to your face.
&lt;&lt;MerchantTalk &quot;That I&#39;m the richest man alive.&quot;&gt;&gt; \

[[The End-&gt;Close]] 

&lt;&lt;elseif $p eq 8&gt;&gt;\
\
@@.delayed;The End@@

@@.delayed;...@@

@@.delayed;[[Or is it?-&gt;Epilogue2][$p = 9]]
 @@

&lt;&lt;elseif $p eq 9&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
While &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; enjoyed her little chat with &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; before he once more left Netheryn, she was not being entirely honest with the merchant. 

That was, of course, at your request. Too many pieces are still in motion - the wrong word, spoken by a loud-mouthed merchant, might cast everything into chaos.

With her coronation complete, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Queen Naya of Netheryn&lt;/b&gt;&lt;/span&gt; retires to her chambers in a restored palace deep within the capital. Her royal guards know well to leave her alone, and not to gossip about the mysterious suitor who awaits her in her room.
&lt;img src=&quot;Images/Other/zending5.jpg&quot; width=650 /&gt;

[[She enters her private room-&gt;Epilogue2][$p = 10]]

&lt;&lt;elseif $p eq 10&gt;&gt;\
\
&lt;&lt;set $name = &quot;Duke &quot; + $name&gt;&gt;\
&lt;&lt;set $title = &quot;of Darkhollow&quot;&gt;&gt;\
&lt;&lt;set $weapon = &quot;none&quot;&gt;&gt;\
&lt;&lt;set $gold += 50000&gt;&gt;\
&lt;&lt;set $head = &quot;Noble crown&quot;&gt;&gt;\
&lt;&lt;set $chest = &quot;Resplendant coat&quot;&gt;&gt;\
&lt;&lt;set $hands = &quot;Ring of high office&quot;&gt;&gt;\
&lt;&lt;set $legs = &quot;White silk pantaloons&quot;&gt;&gt;\
&lt;&lt;set $feet = &quot;Finely tailored boots&quot;&gt;&gt;\
&lt;&lt;set $epilogue = 1&gt;&gt;\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;
\
You stand by one of the chamber&#39;s massive arched windows, waiting for your queen. From here, you have a grand view of the renewed capital of Netheryn. It is especially beautiful at twilight, as the last vestiges of light shimmer in the skies above.
&lt;img src=&quot;Images/Other/zending6.jpg&quot; width=650 /&gt;

You don&#39;t hear her footsteps - elves are incredibly quiet when they want to be - but you do feel her arm as it wraps around your waist.
&lt;&lt;Naya2Talk &quot;My love - I trust today went well?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Perfectly. Regent Brunhilde met with me in secret during the ceremony. She confirmed that my treason has been pardoned, and the child king will name me Duke of Darkhollow in the coming days.&quot;&gt;&gt;\
You turn around and gaze at &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, struck by how splendidly beautiful she is.
&lt;img src=&quot;Images/Other/zending7.jpg&quot; width=500 /&gt;

&lt;&lt;Naya2Talk &quot;The Duke of Darkhollow... so you will be a noble at last.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Not quite a prince, but close.&quot;&gt;&gt;\
She raises herself onto the balls of her feet and plants her lips against yours.

[[Kiss her back-&gt;Epilogue2][$p = 11]]

&lt;&lt;elseif $p eq 11&gt;&gt;\
\
Eventually, she pulls back and leads you by the hand to her massive bed, draped in silks and the finest furs known to elves and men. There, she slips out of her royal raiment, and lounges naked on her bedding. Though you&#39;ve seen it almost every day during the past year, you still can&#39;t help but admire her figure.
&lt;img src=&quot;Images/Other/zending8.jpg&quot; width=500 /&gt;

&lt;&lt;Naya2Talk &quot;In ten days, then, we&#39;ll announce our betrothal. In thirty, we&#39;ll have the wedding.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Why so quickly? A royal wedding takes a year to prepare.&quot;&gt;&gt;\
She looks at you, she cheeks suddenly going scarlet.
&lt;&lt;Naya2Talk &quot;We&#39;re... we&#39;re going to want to have it soon.&quot;&gt;&gt;\

[[Her hand falls to her belly-&gt;Epilogue2][$p = 12]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
\
You lose your breath - and your ability to speak - for a few moments.
&lt;&lt;HeroTalk &quot;A child? &lt;i&gt;Truly&lt;/i&gt;?&quot;&gt;&gt;\
&lt;&lt;Naya2Talk &quot;Half-elfs are hard to make - I thought it would take us years of trying, but...&quot;&gt;&gt;\
She smiles at you. 
&lt;&lt;Naya2Talk &quot;It&#39;s still early, but I&#39;m sure. Our son. The heir to Netheryn and Darkhollow. A shared future for men and elves.&quot;&gt;&gt;\
Your head is suddenly filled with a vision of &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, heavily pregnant with your child. Her breasts heavy with milk, her belly swollen with life growing within.
&lt;img src=&quot;Images/Other/zending9.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;Naya&#39;driel...&quot;&gt;&gt;\
&lt;&lt;Naya2Talk &quot;Come here...&quot;&gt;&gt;\

[[Bed the queen-&gt;Epilogue2][$p = 13]]

&lt;&lt;elseif $p eq 13&gt;&gt;\
\
In the year since you defeated &lt;span class=&quot;void&quot;&gt;&lt;b&gt;Void&lt;/b&gt;&lt;/span&gt; and closed the Dark Portal, you&#39;ve mostly stayed within Netheryn, supporting &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; from the shadows. Sex became a daily occurance - which meant that you and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; quickly learned something.

While &#39;normal sex&#39; is a fun distraction, her favorite way to make love is, and will always be, anal.
&lt;video loop muted autoplay src=&quot;Images/Other/anal7.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;Naya2Talk &quot;&lt;i&gt;Oh, yes! Ooooh!!! Fill me up! I need your cock in my slutty ass!&lt;/i&gt;&quot;&gt;&gt;\
Just as much as she needs you, you need her. Nothing feels quite as perfect as your dick getting squeezed by &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; puffy, well-used asshole as she milks another one of your orgasms deep into her guts. 

[[Go harder-&gt;Epilogue2][$p = 14]]

&lt;&lt;elseif $p eq 14&gt;&gt;\
\
You really start slamming your cock into &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; ass. She moans in ecstasy, not particularly concerned that her guards can hear her. They&#39;re always just beyond the door, but they know to keep the queen&#39;s private business &lt;i&gt;private&lt;/i&gt;.
&lt;video loop muted autoplay src=&quot;Images/Other/anal12.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;So, I&#39;ll be king in thirty days.&quot;&gt;&gt;\
&lt;&lt;Naya2Talk &quot;King-consort - &lt;i&gt;oh fuck that&#39;s good&lt;/i&gt; - not king. The crown is mine alone - &lt;i&gt;oooooooh!!!&lt;/i&gt; - but you will speak with my authority and be - &lt;i&gt;fuuuuck!&lt;/i&gt; - the second most powerful person in Netheryn.&quot;&gt;&gt;\
You slap her ass cheeks. Hard. Once, twice, three times.
&lt;&lt;HeroTalk &quot;So I&#39;m king, but you&#39;re in charge?&quot;&gt;&gt;\
She pulls her fingers out of her cunt and spreads her ass cheeks as she cums. You watch with delight as she squirts to the rhythm of your thrusts.
&lt;&lt;Naya2Talk &quot;Yes... except in bed. Then you&#39;re in charge, and I&#39;m just your buttslut.&quot;&gt;&gt;\
&lt;i&gt;Buttslut&lt;/i&gt; is entirely right. The entire bed chamber reeks of sex and ass. The maids are used to it by now, and always have a fresh set of sheets ready for the next night. Like the guards, they never speak of the queen&#39;s nightly encounters.

[[Cum-&gt;Epilogue2][$p = 15]]

&lt;&lt;elseif $p eq 15&gt;&gt;\
\
You wrap your hands around &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; neck as you cum, softly choking her as you pump semen inside her ass until your balls run dry. She bounces on your cock, practically milking your orgasm with her puffy asshole.

At last, you let go of her neck and pull your cock out. Her ass is left a gaping, ruined mess - just the way she likes it.
&lt;img src=&quot;Images/Other/zending10.jpg&quot; width=600 /&gt;

You admire the sight - even though you see it essentially every night. There is something remarkably beautiful about the wise, noble, heroic &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya, Queen of Netheryn&lt;/b&gt;&lt;/span&gt; &lt;i&gt;showing off her ruined asshole&lt;/i&gt; and pushing out globs of semen onto her priceless silk sheets, which she will then sleep in. It&#39;s a fully different side of &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; that only you ever get to see.

[[Cuddle your lover-&gt;Epilogue2][$p = 16]]

&lt;&lt;elseif $p eq 16&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;So, what makes you so sure it will be a son, and not a daughter?&quot;&gt;&gt;\
She kisses you as you lie down beside her.
&lt;&lt;Naya2Talk &quot;Just a mother&#39;s instinct. Don&#39;t worry, we&#39;ll have daughters, too.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Oh really? How big of a family do you want?&quot;&gt;&gt;\
She tilts her head, thinking.
&lt;&lt;Naya2Talk &quot;Well, elves are in dire need of repopulation - as queen, I need to set an example for my people. I&#39;m twenty years old, so I have about thirty good fertile years left...&quot;&gt;&gt;\
She starts counting on her fingers.
&lt;&lt;Naya2Talk &quot;... twenty-five. Twenty-five children would be great.&quot;&gt;&gt;\
Twenty-five children.

You try to imagine &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; slim, lithe body transformed by &lt;i&gt;twenty-five&lt;/i&gt; pregnancies.
&lt;img src=&quot;Images/Other/zending11.jpg&quot; width=500 /&gt;

&lt;&lt;Naya2Talk &quot;Are you... getting hard again? From the thought of me pregnant?&quot;&gt;&gt;\
In answer, you stuff three fingers up her gaping asshole.
&lt;&lt;Naya2Talk &quot;&lt;i&gt;Oh, fuck...&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I love you too, Naya. I love you, too.&quot;&gt;&gt;\

[[The end-&gt;Close]] 

&lt;&lt;elseif $p eq 17&gt;&gt;\
@@.delayed;The End@@

@@.delayed;...@@

@@.delayed;[[Or is it?-&gt;Epilogue2][$p = 20]]
 @@

&lt;&lt;elseif $p eq 20&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\

While &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; enjoyed her little chat with &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt;, a cloaked figure left Netheryn by horseback, and slipped into the quiet valleys of the Deep Woods.

This figure was only barely noticed by the guards at the city gates. They saw a robe as black as a moonless night, and a flash of eyes that seemed not fully of this world. They knew the sight, of course.
&lt;img src=&quot;Images/Other/zending12.jpg&quot; width=500 /&gt;

It was &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, the Scarlet Witch and the High Priestess of Tylae. The guards held their breath as they passed, lest she put a curse of them. While &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; was held in high regard by the new queen, many elves of Netheryn did not trust her.

And with good reason. Dark rumors swirled around the coven of priestesses she had been building, over the past year. Rumors of rituals primal and foul...

[[Scyllia soon returned to her temple-&gt;Epilogue2][$p = 21]]

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
\
As she drops from her horse and enters the temple grounds, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; is met by two disciples. As is common among the coven, the young priestesses keep their robes open, proudly displaying their nubile figures to the skies above.
&lt;img src=&quot;Images/Other/zending13.jpg&quot; width=500 /&gt;

&lt;&lt;Disciple1Talk &quot;Mother Superior! How fares the Elf Queen?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;She minds her world, and casts a blind eye at mine. That is all I ask of her, and she provides it. Tell me, girl, has the ritual begun?&quot;&gt;&gt;\
&lt;&lt;Disciple1Talk &quot;It will begin at any moment. And your wife is looking for you.&quot;&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; smiles sweetly.
&lt;&lt;WitchTalk &quot;Then I shall find her. Walk in the light of Tylae, and be warmed by Lilith&#39;s fire.&quot;&gt;&gt;\

[[Scyllia enters the temple-&gt;Epilogue2][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
\
\
&lt;&lt;set $name = $name + &quot;,&quot;&gt;&gt;\
&lt;&lt;set $title = &quot;Lilith&#39;s Chosen&quot;&gt;&gt;\
&lt;&lt;set $weapon = &quot;Lilith&#39;s Kiss&quot;&gt;&gt;\
&lt;&lt;set $gold += 5000&gt;&gt;\
&lt;&lt;set $head = &quot;Dark Tiara&quot;&gt;&gt;\
&lt;&lt;set $chest = &quot;Robes of the Chosen&quot;&gt;&gt;\
&lt;&lt;set $hands = &quot;Ring of Carnal Fire&quot;&gt;&gt;\
&lt;&lt;set $legs = &quot;Bare legs&quot;&gt;&gt;\
&lt;&lt;set $feet = &quot;Bare feet&quot;&gt;&gt;\
&lt;&lt;set $epilogue = 1&gt;&gt;\
\
\
She meets you in the inner sanctum. You smile upon seeing your beloved, and offer her your cheek to kiss. She may be the high priestess, but you are Lilith&#39;s chosen. Within the temple grounds you are equals.

&lt;&lt;HeroTalk &quot;You&#39;re right in time, my love. Our disciples are already welcoming the new girls to their life in the priesthood.&quot;&gt;&gt;\
Gesturing the central chamber, its ceiling open to the stars, you point to one of the new joiners being defiled by an eager priestess. Her virginal cunt is stuffed with the priestess&#39;s cock as she is forever bound in service of Lilith.
&lt;video loop muted autoplay src=&quot;Images/Other/futa11.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;WitchTalk &quot;So much shouting.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;They always fight back... at first.&quot;&gt;&gt;\

[[You notice a new girl crawling away from the welcoming orgy-&gt;Epilogue2][$p = 23]]
\
\
\
\
\
\
&lt;&lt;elseif $p eq 23&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;Where do you think you&#39;re going?&quot;&gt;&gt;\
The girl - hardly eighteen years old - looks back on you with terror.
&lt;&lt;Disciple2Talk &quot;Please let me go! This isn&#39;t what I wanted!&quot;&gt;&gt;\
You snicker, pulling aside your robes and letting your thick cock breath. It hardens with anticipation.
&lt;img src=&quot;Images/Other/zending16.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;You deny Lilith&#39;s blessing? You do not want a perfect body?&quot;&gt;&gt;\
&lt;&lt;Disciple2Talk &quot;&lt;i&gt;Please... please...&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Hush, neophyte. It&#39;s time you embraced true perfection.&quot;&gt;&gt;\

[[Defile her-&gt;Epilogue2][$p = 24]]

&lt;&lt;elseif $p eq 24&gt;&gt;\
\
Ignoring her protests, you tear off the priestess&#39;s clothes and and drag her towards you. Her tight cunt can barely hold you girthy member, but you force yourself in all the same. She screams with a mix of pain and pleasure.
&lt;video loop muted autoplay src=&quot;Images/Other/futa12.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;Disciple2Talk &quot;&lt;i&gt;I don&#39;t want to be...ooooohhh! Stop making me feel good!&lt;/i&gt;&quot;&gt;&gt;\
Your only response is to slap her ass and fuck her even harder.

[[Lilith&#39;s Kiss glows-&gt;Epilogue2][$p = 25]]

&lt;&lt;elseif $p eq 25&gt;&gt;\
\
Lilith&#39;s Kiss glows in your hand, feeding off the carnal energy flowing from the ritual. Soon it will be charged enough to bestow a new priestess with a twice-blessed body. Another convert to the secret cult of Lilith, added to the coven.

To your right, you see that &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; has joined in on the fun. She&#39;s breeding a new priestess, this one clearly eager for Lilith&#39;s blessing. While some protest at first, a few nights with her new sisters turns her into a willing and devoted slut.
&lt;video loop muted autoplay src=&quot;Images/Other/futa15.mp4&quot;&gt;&lt;/video&gt;

[[Raise Lilith&#39;s Kiss above your head-&gt;Epilogue2][$p = 26]]

&lt;&lt;elseif $p eq 26&gt;&gt;\
\
Lilith&#39;s Kiss burns with red fire. Your disciples on the sidelines take this as a signal to join in, leaping up the new priestesses and filling all of their holes with cock. Other disciples strip and start to fuck each other, their lewd moans intermingling into a grand cacophony of lust.
&lt;video loop muted autoplay src=&quot;Images/Other/zending3.mp4&quot;&gt;&lt;/video&gt;

It isn&#39;t long before the first of many climaxes strike. A priestess screams as her pussy shivers with ecstasy. A disciple pumps a load deep into her sister&#39;s cunt. The inner sancum stinks of cum. The marble floors are soon slick with semen.
&lt;video loop muted autoplay src=&quot;Images/Other/zending4.mp4&quot;&gt;&lt;/video&gt;

[[Bliss-&gt;Epilogue2][$p = 27]]

&lt;&lt;elseif $p eq 27&gt;&gt;\
\
Late that night, you lie in bed with &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;. You cannot sleep, too enraptured by thoughts of the dark ritual you performed on that new priestess. Soon, she&#39;ll have a cock of her own - a small one, you bet. The submissive sluts are always blessed with the tiniest members, for whatever reason.

Then a flash a red light blinds your vision. When sight returns, it appears you have a guest in your bedroom.
&lt;img src=&quot;Images/Other/lilith1.jpg&quot; width=450 /&gt;

It&#39;s &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; herself.
&lt;&lt;HeroTalk &quot;To what do I owe the pleasure of your company, Mistress?&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;I&#39;m here for what&#39;s mine, sweetheart. The staff.&quot;&gt;&gt;\
You climb out of bed.
&lt;&lt;HeroTalk &quot;You want it back? After all we&#39;ve done in your name? All we&#39;ve created?&quot;&gt;&gt;\
The Goddess laughs, sickly-sweet.
&lt;&lt;LilithTalk &quot;&lt;i&gt;Ooooh, so arrogant!&lt;/i&gt; I&#39;m not a conquering Goddess, dear. I don&#39;t care for plans or cults. I never asked for you to mix my blessings with Tylae&#39;s priesthood.&quot;&gt;&gt;\
&lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; smirks.
&lt;&lt;LilithTalk &quot;But maybe we can make a trade...&quot;&gt;&gt;\

[[A trade?-&gt;Epilogue2][$p = 28]]

&lt;&lt;elseif $p eq 28&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;What is it? I will give you anything, so long as I can keep the staff.&quot;&gt;&gt;\
&lt;&lt;LilithTalk &quot;I&#39;m in need of a new pet. Something pretty and sweet to lick my asshole for the next thousand years or so.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You can have any of my disciples.&quot;&gt;&gt;\
She snorts.
&lt;&lt;LilithTalk &quot;How boring. No, I want someone special. You know her well, I believe...&quot;&gt;&gt;\
Your heart falters. Realizing what she means.
&lt;&lt;LilithTalk &quot;Yes, sweetheart. I want you to give Queen Naya&#39;driel my blessing, and surrender her to me for eternity.&quot;&gt;&gt;\
She starts to fade away.
&lt;&lt;LilithTalk &quot;You have one hundred days.&quot;&gt;&gt;\

[[She disappears-&gt;Epilogue2][$p = 29]]

&lt;&lt;elseif $p eq 29&gt;&gt;\
\
For a long while, you stare out into the quiet night of the Deep Woods, searching for an answer.
&lt;img src=&quot;Images/Locations/night5.jpg&quot; width=650 /&gt;

You can&#39;t betray &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;. After all you&#39;ve been through, you wouldn&#39;t dare. Not to mention how important she is for peace between the elves of Netheryn and the human Kingdom. 

And yet, you can&#39;t help but imagine how &lt;i&gt;beautiful&lt;/i&gt; she&#39;d look with a cock between her legs.

You grip Lilith&#39;s Kiss, your mind suddenly made up.
&lt;&lt;HeroTalk &quot;Naya... you&#39;re going to love the new you.&quot;&gt;&gt;\

[[The end-&gt;Close]] 
\
\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="172" name="Witch Lewd" tags="" position="922,2173" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You approach the witch, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;. You must admit, her distant demeanor, her serene stare, the contrast of her pale skin and pitch black hair - she&#39;s a strikingly beautiful woman. 
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Lady Scyllia, might we take a walk?&quot;&gt;&gt;\
The way she looks at you, you get the sense she&#39;s already perceived your intent.
&lt;&lt;WitchTalk &quot;A walk? How charming. Is there a meadow with soft grass nearby?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I-&quot;&gt;&gt;\
You nearly blush, then give her a smoldering look.
&lt;&lt;HeroTalk &quot;No meadows, but there is beauty to be found even in a place as bleak as this.&quot;&gt;&gt;\

[[Her lips shift to a wry grin-&gt;Witch Lewd][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
&lt;&lt;WitchTalk &quot;Very well, I will humor you, $name.&quot;&gt;&gt;\
The two of you head off into the quiet trees beyond the cabin. She even takes your elbow in her hand.
&lt;&lt;HeroTalk &quot;Am I so transparent?&quot;&gt;&gt;\
She raises an eyebrow. 
&lt;&lt;WitchTalk &quot;Of course not. But you&#39;re not the first rugged man of arms and means to wander into the Woods. I&#39;ve done this before. It doesn&#39;t end well.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Why not?&quot;&gt;&gt;\
She leans in. 
&lt;img src=&quot;Images/DarkHeart/savewitch3.jpg&quot; width=650 /&gt;

&lt;&lt;WitchTalk &quot;I am far too much to handle.&quot;&gt;&gt;\

[[Now you&#39;re even more intrigued-&gt;Witch Lewd][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;I&#39;ve handled strong women before. Warriors, knights who could snap me in two.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Those girls are nothing like me.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Prove it.&quot;&gt;&gt;\
She opens her mouth, as if to protest, then stops herself. A hint of mischief bleeds into her distant stare. Then she draws back to her cloak, takes hold of a fine fabric and her dress, and pulls.
&lt;video loop muted autoplay src=&quot;Images/Other/strip2.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;By the Mother Goddess...&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;I&#39;m just getting started, brave hero. Don&#39;t you lose your nerve...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Never.&quot;&gt;&gt;\

[[She takes off her dress-&gt;Witch Lewd][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
\
As the dress falls to the ground, leaving just &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; cloak, you nearly choke on your tongue.

She was right, after all: those other girls are nothing like her.
&lt;img src=&quot;Images/Other/futa2.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;What dark sorcery is this?&quot;&gt;&gt;\
She stands before you, unashamed.
&lt;&lt;WitchTalk &quot;A blessing of a Goddess, one you would be lucky to ever possess.&quot;&gt;&gt;\
Her genitals are a puzzle to behold. In body and spirit, she is a woman, yet rising forth from her clitoris is a thick, rigid cock. 
&lt;&lt;WitchTalk &quot;Still eager for that lay in the meadow, $name?&quot;&gt;&gt;\

[[Not anymore-&gt;Witch Lewd][$p = 4]]
[[We can make it work-&gt;Witch Lewd][$p = 5]]

&lt;&lt;set $witchawareness = 1&gt;&gt;

&lt;&lt;elseif $p eq 4&gt;&gt;\
\
You take a single step backwards.
&lt;&lt;HeroTalk &quot;Perhaps not.&quot;&gt;&gt;\
She laughs - sweet and calm - then slowly dresses herself.
&lt;&lt;WitchTalk &quot;I thought not. Forgive me, $name, I did not mean to scare you off - you just made it so tempting. I trust that I can still serve as your priestess?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course. Let&#39;s just agree to never speak of this again.&quot;&gt;&gt;\
At her nod, you march back to your cabin.

[[Leave-&gt;Outside the Cabin]] 
\
&lt;&lt;set $witchlove = 5&gt;&gt;\

&lt;&lt;elseif $p eq 5&gt;&gt;\
\
You stand your ground.
&lt;&lt;HeroTalk &quot;This would be new for me... but we can make it work. You&#39;re a beautiful woman, Scyllia.&quot;&gt;&gt;\
She seems genuinely surprised - and pleased - with your response.
&lt;&lt;WitchTalk &quot;You continue to impress me, $name. But the truth is, I don&#39;t sleep with men.&quot;&gt;&gt;\
You&#39;ve heard of women who prefer their own sex.
&lt;&lt;HeroTalk &quot;So you only sleep with women?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Close. I only sleep with women blessed like me.&quot;&gt;&gt;\
You didn&#39;t even know there were more women like her. The world is truly a vast and strange land - and the Deep Woods strangest of all. Once &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; is dressed again, she takes your elbow.
&lt;&lt;WitchTalk &quot;Forgive me, $name, for the sudden reveal - you just made it so tempting to tease you. I trust that I can still serve as your priestess?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course. You could have just &lt;i&gt;said no&lt;/i&gt;, but I appreciate the theatrics.&quot;&gt;&gt;\
Together, the two of you return to the cabin.

[[Return-&gt;Outside the Cabin]] 
\
&lt;&lt;set $witchlove = 5&gt;&gt;\

&lt;&lt;elseif $p eq 6&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You line in bed for a long while, tossing and turning but unable to rest. You can feel &lt;i&gt;it&lt;/i&gt; pressing against your thighs. 

A &lt;i&gt;penis&lt;/i&gt;. &lt;i&gt;Your&lt;/i&gt; penis, in fact. A cock of your own.
&lt;&lt;HeroTalk &quot;Lilith... what have you done to me?&quot;&gt;&gt;\
Groaning, you draw back your sheet.

[[Investigate your body-&gt;Witch Lewd][$p = 7]]

&lt;&lt;elseif $p eq 7&gt;&gt;\
\
Just the very act of looking at it is enough to make it hard again. You wince at the feeling - not that it hurts, as it doesn&#39;t. It just &lt;i&gt;aches&lt;/i&gt;, like it needs to be touched. Like it needs to go somewhere warm and wet and tight...
&lt;img src=&quot;Images/Other/futa1.jpg&quot; width=550 /&gt;

You are &lt;i&gt;twice-blessed&lt;/i&gt;, as &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; said. You have retained not just your womanly figure, but your vagina, too. You doubt don&#39;t you could still get pregnant. But then, where most would have a clitoris, you have what seems to be a long and fully functional cock. 
&lt;&lt;HeroTalk &quot;Could I penetrate a woman, now? Could I her pregnant?&quot;&gt;&gt;\
And although you&#39;ve never lusted after a woman before, the thought suddenly sends a shiver down your spine. Sleeping with a woman sounds &lt;i&gt;incredibly&lt;/i&gt; arousing.

[[Sheepishly, you reach towards your cock-&gt;Witch Lewd][$p = 8]]

&lt;&lt;elseif $p eq 8&gt;&gt;\
You gasp as your fingers make contact with your cock. It feels hard, swollen with blood, but not so distractingly sensitive as your clit once was. It&#39;s a less intense pleasure, but there&#39;s &lt;i&gt;more&lt;/i&gt; to play with. Slowly, uncertainly, you stroke your cock from your clitoral hood up to the glans.
&lt;&lt;HeroTalk &quot;&lt;i&gt;Why does this feel so good?&lt;/i&gt;&quot;&gt;&gt;\
You stroke and stroke, losing yourself in the new sensation, the quick rhythm of the act. You to start to moan in time with your strokes as your arousal drips out of your neglected pussy. Until-
&lt;img src=&quot;Images/Other/futa3.jpg&quot; width=500 /&gt;

[[Recover-&gt;Witch Lewd][$p = 9]]

&lt;&lt;elseif $p eq 9&gt;&gt;\
\
Afterward you simply sit there in your bed, staring at the mess you made.
&lt;&lt;HeroTalk &quot;Where did all of this even come from?&quot;&gt;&gt;\
A tentative lick at the sticky fluid coating your hands confirms that it is indeed semen. &lt;i&gt;Your semen&lt;/i&gt;.

At least the ache is gone. In fact, your penis recedes as it goes flaccid, until half its length as slipped back inside your clitoral hood. Not only that - a serene sleepiness has taken hold of you. Yawning, you lay back in bed. 

[[In another moment, you&#39;re asleep-&gt;Morning]] 

&lt;&lt;set $witchlove = 11&gt;&gt;\
\
&lt;&lt;elseif $p eq 10&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You look around for &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, but you cannot find her in her hut. She must be elsewhere, perhaps on an errand. 
&lt;img src=&quot;Images/Locations/hut1.jpg&quot; width=650 /&gt;

Just when you mean to leave, you hear a distant singing, coming from the trees.

[[Investigate-&gt;Witch Lewd][$p = 11]]

&lt;&lt;elseif $p eq 11&gt;&gt;\
\
You follow the sound of the singing. It is a woman&#39;s voice, fine and sweet, with a faint, playful raspiness to it. Soon enough, you reconize the sound.
&lt;&lt;HeroTalk &quot;That&#39;s Scyllia singing. And such a lovely voice...&quot;&gt;&gt;\
Passing through the trees, you come upon a small spring. 
&lt;img src=&quot;Images/Locations/woods3.jpg&quot; width=650 /&gt;

And there, bathing in the spring as she sings a strange, sad song, is &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;.

You go terribly still, upon seeing her. Immediately, you realize you&#39;ve trespassed on a part of the witch that she had no intention of showing you. 

&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; has her back to you, and sings a song of loneliness and wonder. You listen, touched by the lyrics and the pain in her beautiful voice, as she sings to the sky. 

[[She climbs out of the water-&gt;Witch Lewd][$p = 12]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
\
You watch, mesmerized, as she slowly climbs out of the water. Her sleek black hair. Her breasts, so large and full, dripping with water from the spring. The soft curves of her figure...
&lt;img src=&quot;Images/Other/futa4.jpg&quot; width=500 /&gt;

You wince as your cock gets hard, pushing out from beneath its hood.

[[She picks up her robe-&gt;Witch Lewd][$p = 13]]

&lt;&lt;elseif $p eq 13&gt;&gt;\
\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; grabs her robe and pulls its over her slender shoulders as she steps out of the water. But just before it wraps around her waist, you see it.
&lt;img src=&quot;Images/Other/futa2.jpg&quot; width=450 /&gt;

She&#39;s just like you. &lt;i&gt;Twice-blessed&lt;/i&gt;.
&lt;&lt;HeroTalk &quot;By the Gods...&quot;&gt;&gt;\
Before she spots you, you retreat from the pond. You&#39;re not sure what to do with this information... or with how intensely aroused the sight of another woman &lt;i&gt;like you&lt;/i&gt; make you feel.

[[Leave and repress the memory-&gt;Outside the Cabin]] 

&lt;&lt;set $witchawareness = 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 14&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You find yourself in a strange dream. A beautiful woman is lying on her stomach, spreading her legs before you. A fire, unquenchable, demanding fire, rages in your heart. Hungry, desperate, your climb on top of her and - 
&lt;img src=&quot;Images/Other/futa5.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Oooohhhh yes!!!&lt;/i&gt;&quot;&gt;&gt;\

[[Fill her up-&gt;Witch Lewd][$p = 15]]

&lt;&lt;elseif $p eq 15&gt;&gt;\
\
You awake in flush. Looking around, you see the dream was, of course, nothing but a dream. And yet, it seemed to have very &lt;i&gt;real&lt;/i&gt; consequences. Your body is soaked with semen. It seems you orgasmed all over yourself while you slept!
&lt;img src=&quot;Images/Other/futa6.jpg&quot; width=600 /&gt;

It&#39;s everywhere. It wet, hot, sticky, and it stinks.
&lt;&lt;HeroTalk &quot;That&#39;s it - I can&#39;t take this anymore!&quot;&gt;&gt;\
You need to talk to someone about your &lt;i&gt;unique&lt;/i&gt; anatomy. Someone who has experienced dealing with a body like this. 

You need to speak to &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;.

[[Try to get some sleep-&gt;Morning]] 
\
&lt;&lt;set $witchlove = 12&gt;&gt;\
\
&lt;&lt;elseif $p eq 16&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You approach &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, not entirely sure how to begin this conversation.
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;Yes, $name? You wish to speak? Or perhaps you are seeking a new encantation?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;No, nothing of the sort. I was hoping you and I might go somewhere private and speak. I...&quot;&gt;&gt;\
You glance around, worried that &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; or &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; might be nearby. &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; seems to sense your worry, and gestures for you to follow.
&lt;&lt;WitchTalk &quot;Come, I know a quiet place.&quot;&gt;&gt;\

[[Follow Scyllia-&gt;Witch Lewd][$p = 17]]

&lt;&lt;elseif $p eq 17&gt;&gt;\
\
You follow &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; into the woods beyond your cabin. It is a short walk, coming to an end by a quiet, undisturbed spring of fresh water.
&lt;img src=&quot;Images/Locations/woods3.jpg&quot; width=650 /&gt;

&lt;&lt;WitchTalk &quot;So, you want to speak to me about your genitals.&quot;&gt;&gt;\
You feel your cheeks go red.
&lt;&lt;WitchTalk &quot;Don&#39;t be so embarassed, $name. I see the way you walk, trying to keep your penis hidden with every step. I understand the concern - it can feel... &lt;i&gt;unwomanly&lt;/i&gt;?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;It&#39;s not that. It&#39;s just...&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Everything?&quot;&gt;&gt;\

[[Slowly, you nod-&gt;Witch Lewd][$p = 18]]

&lt;&lt;elseif $p eq 18&gt;&gt;\
\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; thinks for a while, her gaze never leaving you, before she slowly undoes her robe.
&lt;img src=&quot;Images/Other/futa2.jpg&quot; width=450 /&gt;

There it is, as hard as the last time you saw it. Her penis, sticking out from where her clitoris should be. You can&#39;t help but admit that it is a rather mesmerizing sight. Even if it seems unnatural at first glance, the longer you stare, the more it just feels like it &lt;i&gt;fits&lt;/i&gt; her. 
&lt;&lt;WitchTalk &quot;I was blessed by Lilith, just like you were.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Truly?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Of course. I remember the day clearly. I was a young priestess, then. Eager to tame the Deep Woods and sanctify them in Tylae&#39;s name. Naturally, I tried to defeat Lilith, and force her out of the Woods. It didn&#39;t work.&quot;&gt;&gt;\
One of her hand goes to her hard cock. She slowly strokes the head. In response, her pussy starts to glisten.

[[Try not to get distracted-&gt;Witch Lewd][$p = 19]]

&lt;&lt;elseif $p eq 19&gt;&gt;\
\
&lt;&lt;WitchTalk &quot;Lilith does not like it when you try to push her around. Like most Gods, she demands respect. So she decided to teach me a lesson.&quot;&gt;&gt;\
&lt;video loop muted autoplay src=&quot;Images/Other/futa3.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;WitchTalk &quot;I was terrified by what she did to me. For a long while, I prayed to her for forgiveness. I prayed for her to change me back. She wouldn&#39;t.&quot;&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; smiles, then shakes her head.
&lt;&lt;WitchTalk &quot;I tried praying to Tylae, too. I begged her to fix me... but wouldn&#39;t. Want to know why?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Why?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Because there&#39;s nothing to fix. This body is perfect, just the way it is.&quot;&gt;&gt;\

[[Ask her how she deals with the lewd dreams-&gt;Witch Lewd][$p = 20]]

&lt;&lt;elseif $p eq 20&gt;&gt;\
\
For a while, you let &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; words sink in. This body doesn&#39;t need to be fixed..
&lt;&lt;HeroTalk &quot;I can see your point, Scyllia. I&#39;m not ashamed - at least, I&#39;m trying not to be ashamed. But my sexual urges feel out of control. How can I sort myself out?&quot;&gt;&gt;\
She gestures for you to come close.
&lt;&lt;WitchTalk &quot;I can show you...&quot;&gt;&gt;\

[[She grabs your hair-&gt;Witch Lewd][$p = 21]]

&lt;&lt;elseif $p eq 21&gt;&gt;\
\
With sudden, surprising strength, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; pushes you down to your knees. You cry out as she pulls your hair, but the next moment you voice is gagged by her cock. She forces it inside your mouth, then starts ramming it down your throat.
&lt;video loop muted autoplay src=&quot;Images/Other/futa4.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;WitchTalk &quot;&lt;i&gt;That&#39;s good, $name! Take me! Take all of me in your mouth!&lt;/i&gt;&quot;&gt;&gt;\
It&#39;s not like you have any choice. Your being throat-fucked by your priestess! You can&#39;t even bring yourself to protest - it&#39;s too arousing for you to stop, now. You feel your hands stroking your own cock as you take &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; down to the hilt.
&lt;&lt;WitchTalk &quot;&lt;i&gt;You see, $name, the urges never go away. Twice-blessed means twice the sexual desire. The best thing for girls like us to do is find a willing partner...&lt;/i&gt;&quot;&gt;&gt;\

[[She cums-&gt;Witch Lewd][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
\
Her semen is warm and sticky and surprisingly sweet. It floods down your throat and drips down your chin. Only once the last pulse of her orgasm subsides does &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; let go of your hair. 

You can&#39;t but lick up her cum. It tastes perfect. It almost feels like you were &lt;i&gt;meant&lt;/i&gt; to eat it all up, as strange as that seems.
&lt;video loop muted autoplay src=&quot;Images/Other/blowjob5.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;WitchTalk &quot;Take some time to let that lesson sink in. Come find me when you&#39;re ready for another.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $witchlove = 13&gt;&gt;\
\
&lt;&lt;elseif $p eq 26&gt;&gt;\
\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You find yourself in a strange dream. It is centered in a vast, warm room, filled with steam and moans of pleasure. All around you, women just like you - twice-blessed - are enjoying each others&#39; bodies. Joined together in pairings, and threes and fours, intertwined in all kinds of positions, they are driving each other to climax, after climax, after climax.
&lt;img src=&quot;Images/Other/futa8.jpg&quot; width=500 /&gt;

[[Join in-&gt;Witch Lewd][$p = 27]]

&lt;&lt;elseif $p eq 27&gt;&gt;\
\
Just as you reach them, the dream ends. Crying out, you wake in time to feel your orgasm burst from the head of your cock. Semen sprays out onto your abs and breasts.
&lt;img src=&quot;Images/Other/futa7.jpg&quot; width=500 /&gt;

You rub your soaking wet pussy, taking deep breaths as your climax fades. Your cabin stinks of sweat and semen. 
&lt;&lt;HeroTalk &quot;I&#39;m not ashamed of my body, but these urges aren&#39;t going away. In fact, they&#39;re increasing.  I need to speak to Scyllia again.&quot;&gt;&gt;\

[[Try to get some sleep-&gt;Morning]] 

&lt;&lt;set $witchlove = 14&gt;&gt;\

&lt;&lt;elseif $p eq 28&gt;&gt;\
\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You approach &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;, eager to learn more about your new body and how to control it. 
&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;$name - I was hoping you&#39;d find me.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I was hoping we might-&quot;&gt;&gt;\
She raises a finger to her lips.
&lt;&lt;WitchTalk &quot;Not here. Come, to the spring.&quot;&gt;&gt;\

[[Follow Scyllia-&gt;Witch Lewd][$p = 29]]

&lt;&lt;elseif $p eq 29&gt;&gt;\
\
You follow &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; into the woods beyond your cabin. It is a short walk, coming to an end by the same quiet spring as last time.
&lt;img src=&quot;Images/Locations/woods3.jpg&quot; width=650 /&gt;

&lt;&lt;WitchTalk &quot;Tell me, $name. What have you dreamed of, lately?&quot;&gt;&gt;\
You blush.
&lt;&lt;HeroTalk &quot;You always have a way of reading my mind. My dreams have been as hopelessly erotic as usual, but &lt;i&gt;different&lt;/i&gt;, too. I rarely see men, or &lt;i&gt;typical&lt;/i&gt; women, any more. Instead, everyone&#39;s...&quot;&gt;&gt;\
She smiles, and touches your cheek. A flash of lust fires through you.
&lt;&lt;WitchTalk &quot;Like us?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Yes. Twice-blessed.&quot;&gt;&gt;\

[[Scyllia explains-&gt;Witch Lewd][$p = 30]]

&lt;&lt;elseif $p eq 30&gt;&gt;\
\
&lt;&lt;WitchTalk &quot;Lilith&#39;s blessing reforms the spirit as much as it enhances the body. Men lose their glamour. Women, too, seem to appear faded, almost boring. Over time, this feeling only grows, and grows, and grows...&quot;&gt;&gt;\
She meets your eye. 
&lt;&lt;WitchTalk &quot;Within the year, you will find men &lt;i&gt;and&lt;/i&gt; most women plain, almost ugly to look at. All of them. Only one kind of being will set fire to your heart.&quot;&gt;&gt;\
For a moment, you can see her in all her fiendish glory. &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;. Her perfect red skin. Her supple breasts. Her massive cock...
&lt;img src=&quot;Images/Other/futa9.jpg&quot; width=450 /&gt;

&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; sees the realization in your eyes.
&lt;&lt;WitchTalk &quot;That&#39;s right. Us twice-blessed girls are only attracted to women that bear resemblance to Lilith&#39;s true form. We are only attracted to ourselves.&quot;&gt;&gt;\

[[Come to terms with this insight-&gt;Witch Lewd][$p = 31]]

&lt;&lt;elseif $p eq 31&gt;&gt;\
\
Your legs feel weak. You&#39;re stuck with all the sexual lust in the world, but cursed to feel nothing for the most handsome men or enchanting women.

Then you glance at &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;. 
&lt;&lt;HeroTalk &quot;How many are like us? Twice-blessed?&quot;&gt;&gt;\
She sighs. 
&lt;&lt;WitchTalk &quot;As far as I can tell, we&#39;re the only two living on the Continent. Lilith is sparing with this particular blessing.&quot;&gt;&gt;\
Your heart starts to race as the priestess steps close to you.
&lt;&lt;HeroTalk &quot;You must be so lonely...&quot;&gt;&gt;\
She whispers in your ear.
&lt;img src=&quot;Images/DarkHeart/savewitch3.jpg&quot; width=650 /&gt;

&lt;&lt;WitchTalk &quot;Not anymore.&quot;&gt;&gt;\

[[She kisses you-&gt;Witch Lewd][$p = 32]]

&lt;&lt;elseif $p eq 32&gt;&gt;\
\
Her lips are full and soft, wet and warm. Her tongue laps eager and needy against your own. &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; has clearly been wanting this kiss for a long while.
&lt;video loop muted autoplay src=&quot;Images/Other/kiss5.mp4&quot;&gt;&lt;/video&gt;

Your body instantly responds, your cock hardening and brushing against her own sizable member. As you feel your girl-cock press against hers, you realize with perfect clarity that &lt;i&gt;this&lt;/i&gt; is what you need in a partner - a soft, feminine body, paired with a wet pussy and a juicy cock. Nothing less will ever serve you. Men and typical women no longer excite you. They never will again.
&lt;&lt;WitchTalk &quot;&lt;i&gt;$name... I&#39;ve been so lonely for so long... please...&lt;/i&gt;&quot;&gt;&gt;\

[[Bend over-&gt;Witch Lewd][$p = 33]]

&lt;&lt;elseif $p eq 33&gt;&gt;\
\
The moment of entry is like nothing you&#39;ve ever experienced before. &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; pushes past the warm, inviting lips of your pussy, burying her cock deep inside you. Your own cock stiffens at the feeling, getting stimulated from within. It thumps against your belly with each of &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; thrust, feeling like it might explode with pleasure at any moment. 
&lt;video loop muted autoplay src=&quot;Images/Other/futa7.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;Oh, Scyllia! Ohhh... you feel incredible!&lt;/i&gt;&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;&lt;i&gt;Yes, $name - yes! Take me - take me - take me!!!&lt;/i&gt;&quot;&gt;&gt;\

[[You can&#39;t last much longer-&gt;Witch Lewd][$p = 34]]

&lt;&lt;elseif $p eq 34&gt;&gt;\
\
You cry out &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; name so loud that &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; might be able to hear the two of you from the cabin. As you orgasm approaches, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; seems to sense it and pulls at your hair, drawing you against her.
&lt;video loop muted autoplay src=&quot;Images/Other/futa5.mp4&quot;&gt;&lt;/video&gt;

Her thrusts inside your needy pussy suddenly become too much. That slow build up of burning hot pleasure comes to head a &lt;i&gt;bursts&lt;/i&gt; firing across every limb and shooting out of your cock. Semen sprays upwards, striking you on the breasts and chin and lips. 

&lt;&lt;WitchTalk &quot;You did so well, $name. I&#39;m so glad I found you.&quot;&gt;&gt;\
As she says those words, she shivers. The next moment, you feel her cock start pumping cum deep inside your cunt. 
&lt;&lt;HeroTalk &quot;&lt;i&gt;Scyllia - you&#39;ll make me pregnant!&lt;/i&gt;&quot;&gt;&gt;\

[[She lets go of you, shaking her head-&gt;Witch Lewd][$p = 35]]

&lt;&lt;elseif $p eq 35&gt;&gt;\
\
As you and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; bathe in the spring waters, she explains. 
&lt;&lt;WitchTalk &quot;I&#39;ve been twice-blesed for nearly ten years. When I was first afflicted, I made use of whores in the towns close to the Deep Woods to relieve myself. I didn&#39;t find them pretty, but I needed their holes.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Other/futa11.jpg&quot; width=650 /&gt;

She sighs.
&lt;&lt;WitchTalk &quot;I never could make one pregnant. And the few men I&#39;ve convinced to sleep with me haven&#39;t been able to plant their seed either. We&#39;re infertile.&quot;&gt;&gt;\
You sigh - just another trick of &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;HeroTalk &quot;So we&#39;ll always be the only two like us?&quot;&gt;&gt;\

[[She seems about to answer, then shakes her head-&gt;Witch Lewd][$p = 36]]

&lt;&lt;elseif $p eq 36&gt;&gt;\
\
&lt;&lt;WitchTalk &quot;Not necessarily. There might be a way, but...&quot;&gt;&gt;\
She stops herself.
&lt;&lt;WitchTalk &quot;I hate even to speak of it, but you deserve to know. Come find me tomorrow and I&#39;ll explain.&quot;&gt;&gt;\

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;set $witchlove = 15&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
\
&lt;&lt;elseif $p eq 37&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
Just as before, you and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; walk together to the spring. Two beautiful women, each harboring a thick, meaty secret between her legs.
&lt;img src=&quot;Images/Locations/woods3.jpg&quot; width=650 /&gt;

&lt;&lt;WitchTalk &quot;How are you feeling, $name? After...&quot;&gt;&gt;\
You understand her meaning.
&lt;&lt;if $fem eq 1&gt;&gt;&lt;&lt;HeroTalk &quot;This body is still new to me... but I enjoy it. Womanhood becomes me. It felt good, taking you inside. It felt right.&quot;&gt;&gt;\
&lt;&lt;else&gt;&gt;&lt;&lt;HeroTalk &quot;While my... equipment has changed, sex is still sex. I enjoyed our coupling, Scyllia. You made me feel good.&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
She smiles.
&lt;&lt;WitchTalk &quot;So, you wish to know how to make more women twice-blessed? I&#39;ll admit, I&#39;ve spent a long while seeking such an answer. And I&#39;ve found it.&quot;&gt;&gt;\

[[She explains-&gt;Witch Lewd][$p = 38]]

&lt;&lt;elseif $p eq 38&gt;&gt;\
\
&lt;&lt;WitchTalk &quot;I had once hoped to seek Lilith&#39;s aid... but she&#39;s not interested in making more women like us. She&#39;s a capricious, unpredictable Goddess. You can&#39;t rely on her for anything.&quot;&gt;&gt;\

That lines up with your experiences with &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Other/lilith1.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;I came upon a curious reference, in an elven ruin. An artifact imbued with a fragment of Lilith&#39;s soul...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;What kind of artifact?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;A staff of dark and beguiling power. Elven scholars called it &#39;Lilith&#39;s Kiss.&#39;&quot;&gt;&gt;\
&lt;img src=&quot;Images/Other/lilith11.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;Then we&#39;ll find it.&quot;&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; hesitates.

[[Ask her what&#39;s wrong-&gt;Witch Lewd][$p = 39]]

&lt;&lt;elseif $p eq 39&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;Is something amiss?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;It is not a simple spell to cast, even with the staff. It depends a more direct approach. &lt;i&gt;A dark approach&lt;/i&gt;.&quot;&gt;&gt;\
Considering the staff includes a fragment of &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; soul, you&#39;re not surprised.
&lt;&lt;HeroTalk &quot;We have to sleep with a convert to make her like us?&quot;&gt;&gt;\
&lt;img src=&quot;Images/Other/futa12.jpg&quot; width=500 /&gt;

&lt;&lt;WitchTalk &quot;Exactly. And Lilith&#39;s influence can be overwhelming, even just a fragment of it. I fear we might lose control. I fear we might hurt someone. I fear-&quot;&gt;&gt;\

[[Take her hand-&gt;Witch Lewd][$p = 40]]

&lt;&lt;elseif $p eq 40&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;If anyone can do this, it&#39;s the priestess of Tylae. The Scarlet Witch of the Deep Woods.&quot;&gt;&gt;\
&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; leans close to you.
&lt;&lt;WitchTalk &quot;You trust me?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Forever.&quot;&gt;&gt;\

Her lips meet yours.
&lt;video loop muted autoplay src=&quot;Images/Other/kiss5.mp4&quot;&gt;&lt;/video&gt;

Then her arms are pulling off your clothes, as you grope and squeeze her breasts. Every day, the sight and thought of any other human makes you nothing but squeamish. Only someone twice-blessed like &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; can catch your attention. Only her body can fill you with desire.

You feel her cock, hard and thick, pushing against your own.

[[Give in to your desire-&gt;Witch Lewd][$p = 41]]

&lt;&lt;elseif $p eq 41&gt;&gt;\
\
If &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; can see you, she must be smiling.
&lt;video loop muted autoplay src=&quot;Images/Other/futa10.mp4&quot;&gt;&lt;/video&gt;

You bounce on top of your lover. Her cock pushes deep inside of you, forcing out lewd moans that match the beat of your heart. Your own cock slaps against her breasts and you hold her. You&#39;re like clay in her grasp, ready to be molded however she wills.
&lt;&lt;HeroTalk &quot;&lt;i&gt;Oh, Scyllia! Oh, yes!! Yes - yes - yes - yes!!!&lt;/i&gt;&quot;&gt;&gt;\
Just as you cum, a few more words slip past your lips.
&lt;&lt;HeroTalk &quot;&lt;i&gt;OOOOooooohhh! I love you...&lt;/i&gt;&quot;&gt;&gt;\
Those three words push &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; over the limit. She pumps her hot load deep inside your cunt.

[[Recover-&gt;Witch Lewd][$p = 42]]

&lt;&lt;elseif $p eq 42&gt;&gt;\
\
Afterwards, the two of you relax within the secluded spring, spent.
&lt;&lt;WitchTalk &quot;So, you wish to find Lilith&#39;s Kiss?&quot;&gt;&gt;\
At your nod, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; gestures to the distant horizon.
&lt;&lt;WitchTalk &quot;It is hidden, but it shouldn&#39;t be too much of a detour for you. It&#39;s last known location is the Winter Palace.&quot;&gt;&gt;\
The very Palace you&#39;re already searching for. How perfectly convenient.
&lt;&lt;HeroTalk &quot;Duke Carnax has it?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Indeed - though I don&#39;t believe he&#39;s ever made use of it. Search every bit of the Palace once you gain access. You&#39;ll find the staff, I&#39;m sure.&quot;&gt;&gt;\
With your task clear, you dress and depart. Just as you do, though, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; takes your hand.
&lt;&lt;WitchTalk &quot;For what it&#39;s worth... I love you, too.&quot;&gt;&gt;\

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;set $witchlove = 18&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 43&gt;&gt;\
\
As you wander through the study, you notice a vaguely staff-shaped object, covered in a decaying tapestry. Pulling it aside, you spot a curious relic.
&lt;img src=&quot;Images/Other/lilith11.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;Fascinating...&quot;&gt;&gt;\
&lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; grabs your shoulder before you can pick it up.
&lt;&lt;MerchantTalk &quot;Careful, $name. I know the look of a cursed artifact when I see one. Only a fool would play with such dark magic...&quot;&gt;&gt;\
From the distance, you hear a woman&#39;s cloying laughter.
&lt;&lt;MerchantTalk &quot;See? A malicious spirit resides in that staff.&quot;&gt;&gt;\
More like a fragment of the Goddess of Lust.

[[Take the staff-&gt;Witch Lewd][$p = 45]]
[[Renounce the staff-&gt;Witch Lewd][$p = 44]]

&lt;&lt;elseif $p eq 44&gt;&gt;\
\
You pull back your hand. &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; is right - making use of Lilith&#39;s Kiss would surely corrupt you and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;. It was a mistake to even look for the cursed artifact.

While this might mean you are trapped as one of only two twice-blessed women, it&#39;s still the right decision.
&lt;&lt;HeroTalk &quot;Thank you, Babar. I don&#39;t know what got into me.&quot;&gt;&gt;\

[[Return-&gt;Study][$p = 0, $i = 0]] 
\
&lt;&lt;set $witchlove = 19&gt;&gt;\
\
&lt;&lt;elseif $p eq 45&gt;&gt;\
\
You ignore the merchant. You need this. &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; needs this. There is no curse you wouldn&#39;t endure to make more perfect women. Women like you.

The moment you pick up the staff, you hear a familiar voice, whispering in your ear.
&lt;&lt;LilithTalk &quot;Hello, sweetheart... you and I are going to have such much fun...&quot;&gt;&gt;\

&lt;i&gt;You gained Lilith&#39;s Kiss&lt;/i&gt;!

[[Return-&gt;Study][$p = 0, $i = 0]] 
\
&lt;&lt;set $witchlove = 21&gt;&gt;\
&lt;&lt;set $weaponinventory.push($lilithskiss)&gt;&gt;\
\
&lt;&lt;elseif $p eq 46&gt;&gt;\
\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
Just as before, you and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; walk together to the spring. Two beautiful women, each harboring a thick, meaty secret between her legs.
&lt;img src=&quot;Images/Locations/woods3.jpg&quot; width=650 /&gt;

&lt;&lt;WitchTalk &quot;You don&#39;t have it, do you?&quot;&gt;&gt;\
She&#39;s as perceptive as always.
&lt;&lt;HeroTalk &quot;Scyllia, if you had been there, you would have done the same. That staff is cursed. Lilith would have made us her pawns.&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;Her pawns? And are we not already pawns of Tylae? Who are you, $name, to deny the Goddess of lust? Do you truly think so highly of yourself.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Scyllia...&quot;&gt;&gt;\

[[The priestess seems ready to lash out at you, then turns away-&gt;Witch Lewd][$p = 47]]

&lt;&lt;elseif $p eq 47&gt;&gt;\
\
&lt;&lt;if $music neq &quot;witch&quot;&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;witch1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;witch&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
She spends a long while staring into the woods, then looks back at you. When she does, her face is composed, if a bit somber.
&lt;&lt;if $finalquest lt 8&gt;&gt;&lt;img src=&quot;Images/Character/witch1.jpg&quot; width=450 /&gt;&lt;&lt;else&gt;&gt;&lt;img src=&quot;Images/Character/witch3.jpg&quot; width=450 /&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;WitchTalk &quot;Forgive me, $name. I have let my desire get the better of me. The world is at stake - I can not let so childish a thing as loneliness cloud my judgement. We have far larger concerns.&quot;&gt;&gt;\
The finality of her tone strikes you as harsh.
&lt;&lt;HeroTalk &quot;What about you and me?&quot;&gt;&gt;\
&lt;&lt;WitchTalk &quot;I am your priestess. You are Tylae&#39;s champion. That is all. That is enough.&quot;&gt;&gt;\
Your heart drops. 
&lt;&lt;HeroTalk &quot;But I love-&quot;&gt;&gt;\

[[Your lips go still-&gt;Witch Lewd][$p = 48]]

&lt;&lt;elseif $p eq 48&gt;&gt;\
\
For a few moments, you try in vain to speak. Then you realize that &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; has bewitched your lips!
&lt;&lt;WitchTalk &quot;You don&#39;t love me. So don&#39;t you dare let yourself be distracted by me. The world is at stake, $name.&quot;&gt;&gt;\
And just like that, she walks away. 

Your heart feels like it&#39;s been torn in two. Abandoned just for doing what you thought was right? A few tears fall from your cheeks, unbidden.
&lt;video loop muted autoplay src=&quot;Images/Other/cry1.mp4&quot;&gt;&lt;/video&gt;

But you must move on. To some extent, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; was right - the world is at stake. You can&#39;t let a broken heart weigh you down.

[[Leave the spring, never to return-&gt;Outside the Cabin]] 

&lt;&lt;set $witchlove = 20&gt;&gt;\
\
&lt;&lt;elseif $p eq 49&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
Just as before, you and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; walk together to the spring. Two beautiful women, each harboring a thick, meaty secret between her legs.
&lt;img src=&quot;Images/Locations/woods3.jpg&quot; width=650 /&gt;

&lt;&lt;WitchTalk &quot;Show it to me.&quot;&gt;&gt;\
You pull the staff from your robes. It seems to glow with blood-red energy.
&lt;img src=&quot;Images/Other/lilith11.jpg&quot; width=450 /&gt;

&lt;&lt;WitchTalk &quot;Incredible... we actually have it. Now, let&#39;s see if it works.&quot;&gt;&gt;\

[[She points it at your crotch-&gt;Witch Lewd][$p = 50]]

&lt;&lt;elseif $p eq 50&gt;&gt;\
\
You cry out with pleasure as a bewitching warmth blooms deep inside your cunt. It flows outward, working its way up your cock and hardening it in an instant. Your engorged member pops out of your panties, already dripping precum.
&lt;video loop muted autoplay src=&quot;Images/Other/futa8.mp4&quot;&gt;&lt;/video&gt;

&lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; eyes light up. 
&lt;&lt;WitchTalk &quot;So much power... I feel...&quot;&gt;&gt;\
You a warm, sickly-sweet whisper. You&#39;re sure she hears it, too.
&lt;&lt;LilithTalk &quot;&lt;i&gt;You feel like having sex until the sun goes down...&lt;/i&gt;&quot;&gt;&gt;\
The staff is right: that&#39;s &lt;i&gt;exactly&lt;/i&gt; what you feel like doing. Without another word, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; undoes her robe and climbs on top of you.

[[Penetrate her-&gt;Witch Lewd][$p = 51]]

&lt;&lt;elseif $p eq 51&gt;&gt;\
\
As the day passes and evening wanes, you and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; remain as one. Your cock seems completely insatiable. Orgasm after orgasm, sticky load of semen after sticky load of semen, you just can&#39;t stop fucking her. She&#39;s just as bad, cumming onto your chest without any sign of stopping.
&lt;video loop muted autoplay src=&quot;Images/Other/futa16.mp4&quot;&gt;&lt;/video&gt;

Only when the sun sets do you at last pull apart from your lover, collapsing in a sticky, sweaty heap. Your body feels empty, your cock drained.

Strangely, the staff glows where &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; left it on the ground.
&lt;&lt;WitchTalk &quot;It feeds on our lust. If we&#39;re to use it to make a woman like us, it will ned a lot of energy.&quot;&gt;&gt;\
You grin.
&lt;&lt;HeroTalk &quot;Sounds like fun.&quot;&gt;&gt;\

[[Kiss her-&gt;Witch Lewd][$p = 52]]
\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
\
&lt;&lt;elseif $p eq 52&gt;&gt;\
\
You and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; make out in the nude, rolling around in the muddy soil by the spring. Your cocks, each as long as your forearm, flop around, flaccid and sated. You love the way her penis pushes against yours, possessively and protectively, as you hold her close. Nothing feels as good as being close to the woman you love.
&lt;&lt;WitchTalk &quot;We should get some sleep... but perhaps you can call on me, if you&#39;d like?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I&#39;d like that.&quot;&gt;&gt;\

[[Leave-&gt;Outside the Cabin]] 
\
&lt;&lt;set $witchlove = 22&gt;&gt;\
&lt;&lt;set $pleasured = 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 53&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
At your request, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; enters your cabin and shuts the door. Just as the door closes, she starts to undress. She does it slowly, meaningfully, putting on a show just for you.
&lt;&lt;WitchTalk &quot;I love the way you look at my body, $name... no one else makes me feel so beautiful.&quot;&gt;&gt; \
&lt;video loop muted autoplay src=&quot;Images/Other/strip2.mp4&quot;&gt;&lt;/video&gt;

Then she pulls aside her robes, revealing her beautiful cock.
&lt;&lt;HeroTalk &quot;Come here...&quot;&gt;&gt; \

[[Get on your knees-&gt;Witch Lewd][$p = 54]]

&lt;&lt;elseif $p eq 54&gt;&gt;\
\
You take &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&#39;s&lt;/b&gt;&lt;/span&gt; stiff cock in your hands and open wide. As you suck on it with love and devotion, you stick two fingers up her dripping pussy.
&lt;video loop muted autoplay src=&quot;Images/Other/futa6.mp4&quot;&gt;&lt;/video&gt;

Then, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; raises the staff, Lilith&#39;s Kiss, above her head. 
&lt;&lt;WitchTalk &quot;Oh Lilith, our blessed Goddess and eternal mistress - give us pleasure and purpose!&quot;&gt;&gt; \

[[Your breasts start to hurt-&gt;Witch Lewd][$p = 55]]

&lt;&lt;elseif $p eq 55&gt;&gt;\
\
You pull back, moaning in a mix of pain and pleasure. Seeing what&#39;s hurting you, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;  grasps your breasts from behind and squeezes with all her might.
&lt;&lt;HeroTalk &quot;&lt;i&gt;FUUUUuuuuuck!!!&lt;/i&gt;&quot;&gt;&gt; \
&lt;video loop muted autoplay src=&quot;Images/Other/fondle5.mp4&quot;&gt;&lt;/video&gt;

As fresh milk pours from your engorged tits, your hit your climax. Reducing to a wet mass of lust and bliss, you feel your cock spurt out semen, and watch it mix with the milk already soaking the floor.

Before you have time to recover, &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; pushes you to the ground and presses her cock against your pulsing cunt.
&lt;&lt;WitchTalk &quot;My turn.&quot;&gt;&gt; \

[[Get fucked-&gt;Witch Lewd][$p = 56]]

&lt;&lt;elseif $p eq 56&gt;&gt;\
\
Covered in your own milk and cum, you let &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt; penetrate you, reducing your mind to mush as you embrace that perfect ecstasy that can only come through wet and passionate sex.
&lt;video loop muted autoplay src=&quot;Images/Other/futa14.mp4&quot;&gt;&lt;/video&gt;

You cum together, your pussy shivering in climax just as she tenses up, her orgasm splurting deep inside of your guts.

Afterwards, the two you stay like that, connected, as her cock slowly goes soft inside of you. It feels incredibly intimate. 
&lt;&lt;HeroTalk &quot;I love you, Scyllia.&quot;&gt;&gt; \
&lt;&lt;WitchTalk &quot;I love you, $name...&quot;&gt;&gt; \

And by your bed, Lilith&#39;s staff glows as it gains in power...

[[Return-&gt;Cabin]] 

&lt;&lt;set $pleasured = 1&gt;&gt;

&lt;&lt;elseif $p eq 57&gt;&gt;\
\








































































































&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="173" name="Naya Lewd" tags="" position="926,1931" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
Wandering through the Scarlet Vale, you come across a small camp, recently attacked and abandoned.
&lt;img src=&quot;Images/ScarletVale/tent1.jpg&quot; width=650 /&gt;

Judging by the overgrown thorns and red petals surrounding the tent, you&#39;re willing to bet it was attacked by the deranged guardians of the Scarlet Vale.
&lt;&lt;HeroTalk &quot;But who did this tent belong to?&quot;&gt;&gt;\

[[Investigate-&gt;Naya Lewd][$p = 1]]

&lt;&lt;set $a = 0&gt;&gt;

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
You climb into what remains of the tent. There looks to be a small bedwrap - not big enough for you or any adult human. A collection of herbs and broken potion bottles, and then you find it.

A lock of white hair. It must have belonged to &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, the elf thief!
&lt;img src=&quot;Images/ScarletVale/tower7.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;So she was here, recently. The plant creatures attacked her, but I don&#39;t see a corpse.&quot;&gt;&gt;\

[[Keep looking for clues as to her whereabouts-&gt;Naya Lewd][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
\
As you continue you search, you run across more of &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; personal things. First, a surprisingly revealing set of undergarments.
&lt;img src=&quot;Images/Other/naya2.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;I always though elves were demure. These are nearly a scandal.&quot;&gt;&gt;\

[[Put away the panties-&gt;Naya Lewd][$p = 4]]
[[Keep staring at them-&gt;Naya Lewd][$p = 3]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
\
Something about the panties causes you to linger. They feel... ever so slightly damp. Likely &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; had worn them the day before her camp was attacked, and left them here unwashed.

A sliver of lust rushes through your veins. Slowly, you raise the underwear to your nose.

One sniff has your cock stiff in your pants. They smell exactly like a woman&#39;s panties should after a day of travel and labor. Yet there&#39;s a slight shift to the scent that marks it as unique. It almost smells sweet, like a fresh pear. Perhaps elf women smell different, between their legs.

Your imagination runs with the thought. The elf thief, rubbing herself in the night. Moaning as she envisions the human she paralyzed in the goblin cave.
&lt;video loop muted autoplay src=&quot;Images/Other/solo13.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;Am I fantasizing about an elf fantasizing about &lt;i&gt;me&lt;/i&gt;? My ego knows no bounds...&quot;&gt;&gt;\

[[Smirking, you move on-&gt;Naya Lewd][$p = 4]]

&lt;&lt;set $a += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 4&gt;&gt;\
\
As you continue to search, you come across one item that you can&#39;t quite understand. It is clearly made of glass, and finely made, at that. A wide, bulb-like artifact, perhaps with imbued magical properties.
&lt;img src=&quot;Images/Other/naya4.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;I mean, I once saw a whore in the Capital use something like this, but that can&#39;t... that can&#39;t be what this is...&quot;&gt;&gt;\
You blink, wondering.
&lt;&lt;HeroTalk &quot;Is this a sex toy?&quot;&gt;&gt;\

[[It can&#39;t be-&gt;Naya Lewd][$p = 6]]
[[It could be-&gt;Naya Lewd][$p = 5]]

&lt;&lt;elseif $p eq 5&gt;&gt;\
\
You stare at the glass object in your hand, feeling your lust rise. Slowly, you raise it close to your nose.

The smell is faint, but you can there is a sense of sweat and &lt;i&gt;ass&lt;/i&gt; on the glass surface.
&lt;&lt;HeroTalk &quot;Naya, you naughty bitch. This is a buttplug.&quot;&gt;&gt;\

You&#39;ve never slept with an elf. It might be a fine form of justice to take the elf thief by her secret entrance, once you find her. That will set her right after leaving you paralyzed.
&lt;img src=&quot;Images/Other/naya3.jpg&quot; width=600 /&gt;

You cock stiffens at the thought.

[[Continue-&gt;Naya Lewd][$p = 6]]

&lt;&lt;set $a += 1&gt;&gt;\
\
&lt;&lt;elseif $p eq 6&gt;&gt;\
\
There is nothing else of interest in &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; ruined tent. You&#39;re hot on her trail, that&#39;s for sure.

You uncovered a few rather intimate objects of the runaway elf. It&#39;s not like you to find an elf so physically enthralling, and yet...

Briefly, you remember what the nymph showed you: &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, naked, bathing in a spring.
&lt;img src=&quot;Images/Other/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Keep your focus, $name. She is your enemy...&quot;&gt;&gt;\

&lt;&lt;if $a lte 1&gt;&gt;[[You supress your attraction to the elf-&gt;Naya Lewd][$p = 7]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;You supress your attraction to the elf&lt;/span&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $a gte 1 &gt;&gt;[[You embrace your attraction to the elf-&gt;Naya Lewd][$p = 8]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;grey&quot;&gt;You embrace your attraction to the elf&lt;/span&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $p eq 7&gt;&gt;\
\
Shaking your head, you leave those intrusive thoughts behind. You are a loyal $class of the Kingdom. You care nothing for elf women.

She must be found, and the gem must be retaken. That is all.

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $nayalove = 5&gt;&gt;\

&lt;&lt;elseif $p eq 8&gt;&gt;\
\
There is no point in denying it - you findly yourself oddly captivated by the elf girl. Even in those brief moments you saw her in the goblin cave, her fey beauty left its mark on you. Lithe, pale, supple and strong. Eyes of lilac, hair of frost... she&#39;s something to admire.
&lt;&lt;HeroTalk &quot;In the end, my quest overrules my heart. Still, I will make sure no harm comes to her, if I can help it. A being of such beauty deserves that much, at least...&quot;&gt;&gt;\

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $nayalove = 12&gt;&gt;\

&lt;&lt;elseif $p eq 9&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You spot &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; leaning against her tree, while staring out past the canopy to the distant sky above. You follow her gaze, and for a time admire the green vista in silence.
&lt;img src=&quot;Images/Locations/morning3.jpg&quot; width=650 /&gt;

&lt;&lt;HeroTalk &quot;Despite its darkness, the Deep Woods is not without beauty.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;This is a place warped by tragedy. Beauty is among the first victims of destruction.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Oh? Sometimes surviving destruction is the very act that makes something beautiful.&quot;&gt;&gt;\
When you say this, you look directly at her.

[[Catching your meaning, she tilts her head at you-&gt;Naya Lewd][$p = 10]]

&lt;&lt;elseif $p eq 10&gt;&gt;\
\
Just before she speaks, you pull the rose from your pouch.
&lt;img src=&quot;Images/Items/Black Rose.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;A black rose? How?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Babar&#39;s shop is not without its curiosities. These grew in Hadamshal, once.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Yes... my mother liked to wear them in her hair.&quot;&gt;&gt;\
This is the first time she&#39;s ever spoken of her family. You take a step closer.
&lt;&lt;HeroTalk &quot;May I?&quot;&gt;&gt;\
&lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; meets your stare, suspicion clear in her eyes. Then, glancing back to the rose, she relents with a nod.

[[Place the flower in her hair-&gt;Naya Lewd][$p = 11]]

&lt;&lt;elseif $p eq 11&gt;&gt;\
\
She straightens her neck and strikes a prim pose. So graceful, so stately, almost statuesque. There is little doubt in your mind that &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; truly was a princess, once. Before Hadamshal fell.

It looks perfect, on her. Meant to be.
&lt;&lt;NayaTalk &quot;$name, can I ask you a question and get an honest answer?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;How many elves did you kill?&quot;&gt;&gt;\
You blink, taken aback by the question. She folds her arms at your hesitation.
&lt;&lt;NayaTalk &quot;In Zyr&#39;s tower, you said you were there when my home was destroyed. Well, I want to know - how many of my people did you put into the ground?&quot;&gt;&gt;\
The question stings your heart, and the way she&#39;s looking at you - like an enemy, or as if you were a feral beast - stings further.

[[Be honest, to a point-&gt;Naya Lewd][$p = 12]]

&lt;&lt;elseif $p eq 12&gt;&gt;\
\
If you close your eyes, you can still see it. You can see it burning.
&lt;img src=&quot;Images/ScarletVale/hadamshal1.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;One, Naya. Just one. And I didnt even mean to.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;You killed an elf by accident?&quot;&gt;&gt;\
You stare at the dirt between your feet.
&lt;&lt;HeroTalk &quot;I was your age, maybe a touch younger. What did I know of battle? I was only trying to stay alive, swinging my sword with wild desperation. By chance, the blow struck true.&quot;&gt;&gt;\
She is quiet for a time, then takes a step towards you.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;Thank you, $name.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;For the rose?&quot;&gt;&gt;\
She touches the petals that lie just above her pointed ear.
&lt;&lt;NayaTalk &quot;For your answer.&quot;&gt;&gt;\

[[She plants a brief kiss against your cheek-&gt;Naya Lewd][$p = 13]]

&lt;&lt;elseif $p eq 13&gt;&gt;\
\
You walk away from &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, feeling like you&#39;ve been struck by lightning. Your physical attraction for the elf girl has been stirring your loins since the Goblin Cave, but now...

... it&#39;s more than physical. You find yourself charmed by her.
&lt;&lt;HeroTalk &quot;Am I... &lt;i&gt;falling for an elf&lt;/i&gt;? I might be.&quot;&gt;&gt;\
Your fingers brush against where her lips graced your cheek.
&lt;&lt;HeroTalk &quot;Fuck.&quot;&gt;&gt;\

It might be a good idea to head inside and treat yourself to some much needed stress relief.

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;set $nayalove = 15&gt;&gt;\

&lt;&lt;elseif $p eq 14&gt;&gt;\
\
As you continue to masturbate, your fantasy shifts.

Suddenly the woman before isn&#39;t a human woman at all, but an elf. She&#39;s on top of you, her surprisingly large breasts bouncing as you slam your cock up her pussy. It&#39;s almost painfully tight.
&lt;video loop muted autoplay src=&quot;Images/Other/sex8.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;NayaTalk &quot;&lt;i&gt;Oh, $name! Oh, don&#39;t stop!&lt;/i&gt;&quot;&gt;&gt;\

[[Have sex with Naya-&gt;Naya Lewd][$p = 15]]

&lt;&lt;elseif $p eq 15&gt;&gt;\
\
The fantasy of making love to &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; more or less immediately brings you to your climax. Wincing at the sudden explosion of pleasure, you cum, your semen splattering onto the wooden floor below.
&lt;&lt;HeroTalk &quot;Well, that was different...&quot;&gt;&gt;\

[[Return-&gt;Cabin]] 

&lt;&lt;set $nayalove = 16&gt;&gt;\
\
&lt;&lt;elseif $p eq 16&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You approach &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; tree, curious as to what that odd noise is. It almost sounds like someone is crying from within. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; could be hurt.
&lt;img src=&quot;Images/Locations/tree1.jpg&quot; width=550 /&gt;

[[Take a look inside-&gt;Naya Lewd][$p = 17]]

&lt;&lt;elseif $p eq 17&gt;&gt;\
\
You step up against one of the tree&#39;s rounded windows and peek inside.

It becomes rather obvious that &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; isn&#39;t crying, or in any sort of danger.
&lt;video loop muted autoplay src=&quot;Images/Other/solo14.mp4&quot;&gt;&lt;/video&gt;

She&#39;s completely nude, her ass pointed in the air, as she toys with her tight adolescent elven pussy. She&#39;s so wet, her juices her dripping down her fingers and thighs.

A private scene to trespass on, and yet you cannot bring yourself to look away.

[[Then you hear her moan-&gt;Naya Lewd][$p = 18]]

&lt;&lt;elseif $p eq 18&gt;&gt;\
\
&lt;&lt;NayaTalk &quot;&lt;i&gt;Oh... touch me just like that...&lt;/i&gt;&quot;&gt;&gt;\
You tilt your head closer to the glass, to better hear her whispers.
&lt;&lt;NayaTalk &quot;&lt;i&gt;Mmm... do you remember when you grabbed my ass? In the Tower of Zyr... just like that...&lt;/i&gt;&quot;&gt;&gt;\
You nearly choke on your tongue.
&lt;&lt;NayaTalk &quot;&lt;i&gt;Please touch me, $name... I need to be touched... I&#39;m so lonely...&lt;/i&gt;&quot;&gt;&gt;\
&lt;img src=&quot;Images/Other/babar3.jpg&quot; width=450 /&gt;

Finally, you gather the willpower to slip away before you&#39;re heard, or seen.

[[Think about what just happened-&gt;Naya Lewd][$p = 19]]

&lt;&lt;elseif $p eq 19&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;So, the attraction runs in both directions. Of course, she&#39;s too shy to do anything about it, which means it&#39;s up to me to open up to her.&quot;&gt;&gt;\
All of this feels like a distraction from your quest - and yet, not entirely so. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; is keeping the Void Gem safe. The closer the two of you are - the more you trust each other - the greater your chances of success. 

Seducing her is, in fact, in the Kingdom&#39;s best interest.
&lt;&lt;HeroTalk &quot;I mustn&#39;t fail.&quot;&gt;&gt;\

[[Return-&gt;Outside the Cabin]] 

&lt;&lt;set $nayalove = 17&gt;&gt;\

&lt;&lt;elseif $p eq 20&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You walk up to &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, curious as to how this conversation is going to play out. Your heart wants it to go one way, but you heard the cold certainty of her voice when she told you that was an impossibility.

Still, a man must hold onto hope.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Naya.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;$name. Would you come inside?&quot;&gt;&gt;\

[[Enter Naya&#39;s tree-&gt;Naya Lewd][$p = 21]]

&lt;&lt;elseif $p eq 21&gt;&gt;\
\
You follow her into her tree. It&#39;s a remarkably cozy little abode, lit by melting candles and filled with old books written in the elven tongue.
&lt;img src=&quot;Images/Locations/tree2.jpg&quot; width=650 /&gt;

&lt;&lt;NayaTalk &quot;If I led you on, $name, please know that was not my intent.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I don&#39;t know what &lt;i&gt;intent&lt;/i&gt; has to do with this. You care for me, I care for you - it&#39;s no more complicated than that.&quot;&gt;&gt;\
She smiles, but sadness fills her gaze.
&lt;&lt;NayaTalk &quot;Love is never simple.&quot;&gt;&gt;\

[[She explains-&gt;Naya Lewd][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
\
&lt;&lt;NayaTalk &quot;My home might be a ruin, but I am still a princess. Elven refugees across your kingdom look to me and my brother for leadership. I cannot marry a commoner - especially not a human commoner.&quot;&gt;&gt;\
She still isn&#39;t making any sense.
&lt;&lt;HeroTalk &quot;Who said anything about marriage?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;There can be no sex without marriage for me. My maidenhood is for my husband to take, no other.&quot;&gt;&gt;\
You&#39;ve heard of things like this. Nobility, ever-careful of their esteemed lineage, will have the groom inspect his bride&#39;s virginity on their wedding night. No maidenhood, no marriage.
&lt;img src=&quot;Images/Other/naya9.jpg&quot; width=500 /&gt;

You weren&#39;t aware it applied to elves.
&lt;&lt;HeroTalk &quot;So you&#39;re saving yourself for some elf fool? Naya, we could die tomorrow. The world could end in the next few days... does such a thing even matter anymore?&quot;&gt;&gt;\

[[She takes her time in replying-&gt;Naya Lewd][$p = 23]]

&lt;&lt;elseif $p eq 23&gt;&gt;\
\
&lt;&lt;NayaTalk &quot;You&#39;re not wrong, $name. And It would be a lie to say I wasn&#39;t attracted to you - many elf women find human men attractive. The hair, the height, the savagery and boorishness. It&#39;s terribly arousing.&quot;&gt;&gt;\
Savagery and boorishness? You almost feel slighted.
&lt;&lt;NayaTalk &quot;But I have to hold out hope. Hope that we will defeat the Redeemer. Hope for a new elven kingdom. If my brother were to die, then I would be expected to reign as queen - and I would need an elven consort of noble birth.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Other/naya10.jpg&quot; width=450 /&gt;

It kills you to admit it, but you see her point.
&lt;&lt;HeroTalk &quot;Hope is a powerful thing.&quot;&gt;&gt;\

[[Just as you mean to leave, she takes your hand-&gt;Naya Lewd][$p = 24]]

&lt;&lt;elseif $p eq 24&gt;&gt;\
\
&lt;&lt;NayaTalk &quot;I know I&#39;m in no position to ask anything of you, but...&quot;&gt;&gt;\
Her eyes fall to your waist.
&lt;&lt;NayaTalk &quot;Could you show me? I just want to know if what they say about humans is true.&quot;&gt;&gt;\
You nearly roll your eyes. Then again, maybe &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; lust might eventually overwhelm her sense of duty. There&#39;s only one way to know for sure.

[[Show off your cock-&gt;Naya Lewd][$p = 25]]

&lt;&lt;elseif $p eq 25&gt;&gt;\
\
&lt;&lt;if $penis eq 2&gt;&gt;\
\
Shrugging, you unbuckle your pants and reveal yourself.
&lt;img src=&quot;Images/Other/penis2.jpg&quot; width=450 /&gt;

The moment you do, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; cheeks go red.
&lt;&lt;NayaTalk &quot;That&#39;s... &lt;i&gt;that&#39;s it&lt;/i&gt;?&quot;&gt;&gt;\
You glance down at your cock. Even since &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&lt;/b&gt;&lt;/span&gt; cursed you, it has been rather tiny. Worse, it seems to get shy in front of women - it&#39;s even smaller than usual. In truth, it&#39;s almost inverted, pushing up into your abdomen to not even be there at all.
&lt;&lt;HeroTalk &quot;Well it&#39;s usually bigger. Just an... off day.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;My dear $name... thank you for showing me this little thing. I can truthfully say any attraction I once felt for you has completely vanished.&quot;&gt;&gt;\
Blushing, you pull up your pants.
&lt;&lt;NayaTalk &quot;Don&#39;t be hurt or anything like that - some men aren&#39;t blessed like others. I suppose I&#39;m a bit of a &lt;i&gt;size princess&lt;/i&gt;, in addition to being an actual princess.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course... would you mind if we never speak of this again?&quot;&gt;&gt;\
She nods.
&lt;&lt;NayaTalk &quot;Agreed.&quot;&gt;&gt;\

[[Leave in shame-&gt;Outside the Cabin]] 
\
&lt;&lt;set $nayalove = 5&gt;&gt;\

&lt;&lt;elseif $penis eq 1&gt;&gt;\
Shrugging, you unbuckle your pants and reveal yourself.
&lt;img src=&quot;Images/Other/penis1.jpg&quot; width=450 /&gt;
The moment you do, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; cheeks go red.
&lt;&lt;NayaTalk &quot;That&#39;s... is that really it?&quot;&gt;&gt;\
You glance down at your cock. It&#39;s a not a giant&#39;s prick, sure, but it&#39;s still a perfectly adequate tool. Unfortunately, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; gaze seems to make it shy. It&#39;s shrinking every moment.
&lt;&lt;HeroTalk &quot;It&#39;s not so much the size as what you do with it.&quot;&gt;&gt;\
She smirks and shakes her head.
&lt;&lt;NayaTalk &quot;Well, any bit of lust I might have felt has completely disappeared. Nothing is less exciting than a man with such a puny little nothing for a tool...&quot;&gt;&gt;\
Blushing, you pull up your pants.
&lt;&lt;NayaTalk &quot;Don&#39;t be hurt or anything like that - some men aren&#39;t blessed like others. I suppose I&#39;m a bit of a &lt;i&gt;size princess&lt;/i&gt;, in addition to being an actual princess.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Of course... would you mind if we never speak of this again?&quot;&gt;&gt;\
She nods.
&lt;&lt;NayaTalk &quot;Agreed.&quot;&gt;&gt;\

[[Leave in shame-&gt;Outside the Cabin]] 
\
&lt;&lt;set $nayalove = 5&gt;&gt;\

&lt;&lt;else&gt;&gt;\
Shrugging, you unbuckle your pants and reveal yourself.
&lt;img src=&quot;Images/Other/babar1.jpg&quot; width=450 /&gt;

The moment you do, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; cheeks go red.
&lt;&lt;NayaTalk &quot;It&#39;s... &lt;i&gt;gigantic&lt;/i&gt;.&quot;&gt;&gt;\
Thanks to &lt;span class=&quot;fire&quot;&gt;&lt;b&gt;Lilith&#39;s&lt;/b&gt;&lt;/span&gt; magic, it truly is a sizable tool. It must be as big as &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; forearm.

You can see the effect it&#39;s having on her. Her chest heaves as her breathing deepens. Her eyes, wide as saucer plates, can&#39;t tear themselves away from your dick. The trouble is, getting this kind of attention from a beautiful princess is making you excited.
&lt;img src=&quot;Images/Other/naya11.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;It gets even bigger? How do human woman handle something like this?&quot;&gt;&gt;\
You take a small step closer to her.
&lt;&lt;HeroTalk &quot;You like it?&quot;&gt;&gt;\
She can&#39;t help but lick her lips.
&lt;&lt;NayaTalk &quot;Well... I suppose I&#39;m a bit of a &lt;i&gt;size princess&lt;/i&gt;, in addition to being an actual princess. Could I..&quot;&gt;&gt;\

[[She touches it-&gt;Naya Lewd][$p = 26]]

&lt;&lt;/if&gt;&gt;\
&lt;&lt;elseif $p eq 26&gt;&gt;\
\
You let her take charge - you&#39;re willing to go as far as she is, after all. Despite being a self-admitted maiden, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; takes hold of your dick with a confident grip and pulls down the foreskin. She starts a slow, delicate rhythm, pulling and squeezing your swollen cock.
&lt;video loop muted autoplay src=&quot;Images/Other/handjob1.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;NayaTalk &quot;Does that feel nice?&quot;&gt;&gt;\
Her voice sounds so innocent - and the contrast of that with the lewdness of the act makes the whole thing feel twice as good.
&lt;&lt;HeroTalk &quot;So nice... but I usually like a bit of a view at the same time.&quot;&gt;&gt;\
Remarkably, she pulls down her top without a moment&#39;s hesitation.
&lt;video loop muted autoplay src=&quot;Images/Other/fondle4.mp4&quot;&gt;&lt;/video&gt;

Her perky elven tits bounce as she strokes you. Her breasts are full, pale, and stand proudly, jutting from her slender chest. Her nipples, pink as her tongue, are stiff with arousal.

[[Enjoy it-&gt;Naya Lewd][$p = 27]]

&lt;&lt;elseif $p eq 27&gt;&gt;\
\
&lt;&lt;NayaTalk &quot;It&#39;s just &lt;i&gt;so big...&lt;/i&gt; where am I to find an elf that will compare?&quot;&gt;&gt;\
&lt;video loop muted autoplay src=&quot;Images/Other/handjob2.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;Just imagine what it would feel like between your legs.&quot;&gt;&gt;\
She blushes - but the way she speeds up her pace suggests she liked the idea.
&lt;&lt;NayaTalk &quot;You&#39;d split me in half.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I can be gentle, Naya.&quot;&gt;&gt;\
She bites her lip.
&lt;&lt;NayaTalk &quot;Actually, I don&#39;t like gentle.&quot;&gt;&gt;\

[[At those very words, you cum-&gt;Naya Lewd][$p = 28]]

&lt;&lt;elseif $p eq 28&gt;&gt;\
\
You gasp as a veritable eruption of semen blows from the head of your cock. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; hair, eyes, cheeks, lips, chin, breasts... nothing is spared. 
&lt;video loop muted autoplay src=&quot;Images/Other/cum1.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;NayaTalk &quot;$name... you&#39;re a singularly impressive man.&quot;&gt;&gt;\
As she says these words, she wipes a glob of cum from her lips.
&lt;&lt;HeroTalk &quot;Then perhaps I should return here tomorrow.&quot;&gt;&gt;\
But she shakes her head.
&lt;&lt;NayaTalk &quot;I gave you my reasons, $name. This was just an exception. A lone exception. From now on, we are allies, but nothing more.&quot;&gt;&gt;\
It seems you&#39;ve been dismissed. Your love affair &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; has been cut short just after it began.

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;set $nayalove = 20&gt;&gt;

&lt;&lt;elseif $p eq 29&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You lie in your bed, not sure if you&#39;re awake or dreaming.

But after a few moments, it&#39;s clear that you&#39;re awake, and that someone is knocking on your cabin door.
&lt;&lt;HeroTalk &quot;A visitor, in the middle of night? Odd. Maybe Babar had another nightmare.&quot;&gt;&gt;\

[[Open the door-&gt;Naya Lewd][$p = 30]]

&lt;&lt;elseif $p eq 30&gt;&gt;\
\
You stare at your visitor for a moment, too dazed by sleep to remember to invite her in.

It&#39;s &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;HeroTalk &quot;Naya - what are you doing here?&quot;&gt;&gt;\
She steps inside. Her eyes are shining, bright with purpose.
&lt;&lt;HeroTalk &quot;Actually, I wanted to speak with you. I&#39;ve found the final beacon. Tomorrow, we&#39;ll-&quot;&gt;&gt;\

[[She kisses you-&gt;Naya Lewd][$p = 31]]

&lt;&lt;elseif $p eq 31&gt;&gt;\
\
Your words get lost between her lips.
&lt;video loop muted autoplay src=&quot;Images/Other/kiss2.mp4&quot;&gt;&lt;/video&gt;

After a few long, passioniate moments, she pulls back.
&lt;&lt;NayaTalk &quot;I don&#39;t want to hear about beacons or Redeemers. Tonight, I just don&#39;t want to be alone.&quot;&gt;&gt;\
Then she slips out of her clothes.
&lt;img src=&quot;Images/Other/naya12.jpg&quot; width=500 /&gt;

&lt;&lt;HeroTalk &quot;But... your maidenhood?&quot;&gt;&gt;\
She smiles, coy.
&lt;&lt;NayaTalk &quot;Be creative, $name. There are ways around that.&quot;&gt;&gt;\

[[She takes off her panties-&gt;Naya Lewd][$p = 32]]

&lt;&lt;elseif $p eq 32&gt;&gt;\
\
Now fully naked, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; bends over, giving you a sight many men would likely kill to behold. She takes hold of her ass cheeks and spreads them apart.
&lt;img src=&quot;Images/Other/naya6.jpg&quot; width=500 /&gt;

Her pussy is dripping wet. Her asshole is puffy and ever-so-slightly open, which strikes you as odd. Then you remember the toy you found in her ruined encampment.
&lt;img src=&quot;Images/Other/naya4.jpg&quot; width=400 /&gt;

&lt;&lt;HeroTalk &quot;You&#39;re not so innocent, are you?&quot;&gt;&gt;\
You cup her ass with your palms. Her asshole cletches and relaxes over and over, clearly eager for your touch.
&lt;&lt;NayaTalk &quot;A girl must be clever, if she wants sex and to remain a virgin.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;So you take it from behind?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;&lt;i&gt;Always&lt;/i&gt;.&quot;&gt;&gt;\

[[Give the princess what she wants-&gt;Naya Lewd][$p = 33]]

&lt;&lt;elseif $p eq 33&gt;&gt;\
\
You spit on your finger and then press it against &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; puckered opening. Remarkably, there&#39;s no resistance - her asshole loosens and just &lt;i&gt;swallows&lt;/i&gt; your finger down to the hilt. Inside, she feels smooth and wet and warm. 
&lt;video loop muted autoplay src=&quot;Images/Other/anal8.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;NayaTalk &quot;&lt;i&gt;Mmmm... that&#39;s good&lt;/i&gt;...&quot;&gt;&gt;\
You explore her anal cavity with your finger, stretching it to the side, then up to her tail bone, then down closer to her taint. Her asshole bends to your touch, pliant and eager to be filled.
&lt;&lt;HeroTalk &quot;How many lovers have you had, Naya?&quot;&gt;&gt;\
She pushes her hips against your finger.
&lt;&lt;NayaTalk &quot;I lost count years ago...&quot;&gt;&gt;\

[[Is that so?-&gt;Naya Lewd][$p = 99]]

&lt;&lt;elseif $p eq 99&gt;&gt;\
\
If she&#39;s a practiced anal whore, you&#39;ll need to do more to win her heart. You fall to your knees and set your tongue against her hole.
&lt;video loop muted autoplay src=&quot;Images/Other/anal1.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;NayaTalk &quot;&lt;i&gt;Oh... so naughty...&lt;/i&gt;&quot;&gt;&gt;\
You slip your tongue inside of her. She tastes exquisite. Her asshole widens to accept your tongue, letting you slide the entire length inside - soon enough, your lips are pressing against her asshole. You&#39;re making out with her ass!
&lt;&lt;NayaTalk &quot;My maid taught me about anal pleasure when I was thirteen, and kept riding my pillow at night. Then I started slipping out of hiding at night to meet elven men in the slums and offer them my ass.&quot;&gt;&gt;\
The vision of &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; whoring her little adolescent ass out to strangers is enough to get you hard as steel.
&lt;&lt;NayaTalk &quot;I&#39;ve had many lovers, but only a few knew who I was. The gold they slipped up inside me afterwards helped my brother and I stay alive. Of course, I never told him how I got it.&quot;&gt;&gt;\

[[That&#39;s it - this girl needs your cock-&gt;Naya Lewd][$p = 34]]

&lt;&lt;elseif $p eq 34&gt;&gt;\
\
You pull down your pants and set your cock against her wet hole. Then you hesitate - your tongue is only so thick, but your cock might actually hurt her.

Then &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; grabs your dick and makes the decision for you.
&lt;video loop muted autoplay src=&quot;Images/Other/anal6.mp4&quot;&gt;&lt;/video&gt;

Thick as you are, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; slutty asshole stretches out and takes you inside.
&lt;&lt;NayaTalk &quot;&lt;i&gt;Oh... fuck you&#39;re big&lt;/i&gt;...!&quot;&gt;&gt;\

[[Fuck Naya&#39;s ass-&gt;Naya Lewd][$p = 35]]

&lt;&lt;elseif $p eq 35&gt;&gt;\
\
You start thrusting into &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;, filling her eager asshole with your cock. Her moans are certainlu loud enough to wake &lt;span class=&quot;merchant&quot;&gt;&lt;b&gt;Babar&lt;/b&gt;&lt;/span&gt; and &lt;span class=&quot;plant&quot;&gt;&lt;b&gt;Scyllia&lt;/b&gt;&lt;/span&gt;.
&lt;video loop muted autoplay src=&quot;Images/Other/anal3.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;You like that, princess?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;&lt;i&gt;Yes!!! Fill me up with your dirty human cock!&lt;/i&gt;&quot;&gt;&gt;\
The elf obviously has a bit of a human fetish. It&#39;s a touch demeaning, but you get that you&#39;re an exotic thrill, for her. You may as well let her enjoy it.

It isn&#39;t long before she&#39;s shivering as an orgasm sweeps through her. It makes her asshole tense up against your cock, making you hit your own climax just moments after her.

[[Admire your work-&gt;Naya Lewd][$p = 36]]

&lt;&lt;elseif $p eq 36&gt;&gt;\
\
Once you pull out, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; once against grabs her ass cheeks and pulls them apart, giving you a fine view of your orgasm dripping out of her ass.
&lt;img src=&quot;Images/Other/naya13.jpg&quot; width=500 /&gt;

&lt;&lt;NayaTalk &quot;Look what you&#39;ve done to me, $name.&quot;&gt;&gt;\
She pushes on her abdominal muscles, squeezing out all of your cum, together with a bit of trapped air. It&#39;s a rather loud and unladylike display, but you admire how comfortable she is around you. Truly a fine contrast to the aloof elven princess she presents to the rest of the world.

In truth, it&#39;s at this very moment that you fall completely in love with her.
&lt;&lt;HeroTalk &quot;Naya... you&#39;re one of a kind.&quot;&gt;&gt;\
She turns around, her eyes lingering on your cock - flaccid, now, but still long and thick.
&lt;&lt;NayaTalk &quot;Don&#39;t you dare fall in love with me, $name. This is just sex. I&#39;m still a princess. You&#39;re still a human.&quot;&gt;&gt;\
Those things mean less and less to you with every passing moment.
&lt;&lt;HeroTalk &quot;Spend the night with me.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;I mustn&#39;t. What would Babar and Scyllia think?&quot;&gt;&gt;\

[[She leaves you. Still uncertain how you feel about the entire encounter, but very much endeared to Naya, you go to sleep-&gt;Morning]] 

&lt;&lt;set $nayalove = 21&gt;&gt;\
\
&lt;&lt;elseif $p eq 37&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
When you enter &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; tree, she is resting upon a bed of soft linens, slowly combing her hair.

She&#39;s also completely naked.
&lt;img src=&quot;Images/Other/naya15.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;In elven society, entering a home without knocking is considered rude.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You know, us humans aren&#39;t the barbarians you think we are.&quot;&gt;&gt;\
She glares at you, old anger burning in her gaze.
&lt;&lt;HeroTalk &quot;I realize with your history, that&#39;s hard to accept. But we are better than our worst moment, I swear. We can be better.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;You&#39;re... you&#39;re not wrong. Forgive me, $name. I spoke without thinking.&quot;&gt;&gt;\

[[Ask her about her feelings-&gt;Naya Lewd][$p = 38]]

&lt;&lt;elseif $p eq 38&gt;&gt;\
\
You sit beside her. For a time, you simply admire her soft, pale skin. The way the sunlight traces her curves, and shines upon her hair.
&lt;&lt;HeroTalk &quot;Do you love me, Naya&#39;driel?&quot;&gt;&gt;\
She stops combing her hair. She stops breathing, even.
&lt;&lt;NayaTalk &quot;You said my full name...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Do you?&quot;&gt;&gt;\
She blushes, then resumes her combing.
&lt;&lt;NayaTalk &quot;It doesn&#39;t matter.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Then why not say it?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;It makes no difference!&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;It does to me.&quot;&gt;&gt;\

[[She throws the comb across the room-&gt;Naya Lewd][$p = 39]]

&lt;&lt;elseif $p eq 39&gt;&gt;\
\
She stares at you, her face all flustered, her chest heaving.
&lt;&lt;NayaTalk &quot;Of course I love you, $name! You &lt;i&gt;idiot&lt;/i&gt;! Would I let a man I didn&#39;t love walk in on me naked? Would I storm his cabin in the middle of night and spread my legs for him?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Well... you&#39;ve had lovers before me.&quot;&gt;&gt;\
She groans.
&lt;&lt;NayaTalk &quot;I &lt;i&gt;lied&lt;/i&gt;, to excite you. To excite &lt;i&gt;me&lt;/i&gt;. Those were just fantasies. You&#39;re the only man I&#39;ve ever been with... and I can&#39;t even have you.&quot;&gt;&gt;\
&lt;img src=&quot;Images/Other/naya16.jpg&quot; width=600 /&gt;

She wipes hot tears from her face.
&lt;&lt;NayaTalk &quot;There, I said it. Can you leave, now?&quot;&gt;&gt;\

[[Show her you love her-&gt;Naya Lewd][$p = 40]]

&lt;&lt;elseif $p eq 40&gt;&gt;\
\
You turn her over and spread about her ass cheeks.
&lt;video loop muted autoplay src=&quot;Images/Other/anal10.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;NayaTalk &quot;You still want me? We can never be a couple, $name.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;The world might end in a few days, Naya. I&#39;m not worried about us getting married or not. I just need you.&quot;&gt;&gt;\
She reaches around and stretches her ass cheeks further.
&lt;&lt;NayaTalk &quot;I need you too. I want to feel you inside me.&quot;&gt;&gt;\

[[Do as she says-&gt;Naya Lewd][$p = 41]]

&lt;&lt;elseif $p eq 41&gt;&gt;\
\
The moment you push your cock into &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; ass, her pussy starts gushing out its juices. She truly is a slave for anal sex.
&lt;video loop muted autoplay src=&quot;Images/Other/anal4.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;NayaTalk &quot;&lt;i&gt;Ooohh... $name, you feel so good...&lt;/i&gt;.&quot;&gt;&gt;\
You push all the way inside of her, until your balls slap against her pussy lips. 
&lt;&lt;HeroTalk &quot;Fuck, I love how tight you are.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;&lt;i&gt;Fuck me like you mean it, $name. Fuck me like you love me.&lt;/i&gt;.&quot;&gt;&gt;\
You nearly cum from those words alone. Gripping her hips, you start fucking &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; fast and deep, rearranging her insides with your girthy cock. As you fuck her, she clenches her muscles in a quick rhythm, gripping and releasing your dick. It feels incredible. 

[[Reach down and play with her clit-&gt;Naya Lewd][$p = 42]]

&lt;&lt;elseif $p eq 42&gt;&gt;\
\
&lt;&lt;NayaTalk &quot;&lt;i&gt;$name! My maidenhood!&lt;/i&gt;&quot;&gt;&gt;\
You chuckle, rubbing her clit while her juices drip onto your palm.
&lt;&lt;HeroTalk &quot;I&#39;m not going inside, Naya. Just enjoy it.&quot;&gt;&gt;\
And enjoy it she does. Her ass getting fucked at the same time her clit is being teased is quickly too much for her. Screaming your name, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; cums, squirting her orgasm onto her bed. 

You&#39;re not far behind.
&lt;&lt;HeroTalk &quot;&lt;i&gt;Here I come!!!&lt;/i&gt;&quot;&gt;&gt;\
&lt;video loop muted autoplay src=&quot;Images/Other/anal5.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;NayaTalk &quot;&lt;i&gt;Mmm.... I love feeling all full of your seed...&lt;/i&gt;.&quot;&gt;&gt;\

[[Pull out-&gt;Naya Lewd][$p = 43]]

&lt;&lt;elseif $p eq 43&gt;&gt;\
\
After you pull you, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; pushes out your cum, letting it all drip out onto her bed. You admire the view - it&#39;s enough to get you hard again.
&lt;img src=&quot;Images/Other/naya14.jpg&quot; width=500 /&gt;

&lt;&lt;NayaTalk &quot;$name... am I pretty?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You are the most beautiful woman in the world.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Prettier than a human?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Elf, human, goblin... you&#39;re better than them all.&quot;&gt;&gt;\

[[She cuddles up against you-&gt;Naya Lewd][$p = 44]]

&lt;&lt;elseif $p eq 44&gt;&gt;\
\
For a long while, the two of you simply lay together. Being an elf, she&#39;s only tall enough to reach your upper torso, so having her nestled on top of you feels &lt;i&gt;a bit&lt;/i&gt; odd, like lying with a girl. 

Of course, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; hips, breasts, and &lt;i&gt;age&lt;/i&gt; all make it clear that she&#39;s fully an adult. Still, the size difference is curious. You could lift her up easily. All kinds of sex positions come to mind...
&lt;&lt;NayaTalk &quot;I&#39;ve never felt like this before, $name.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;What, in love?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Safe. You make me feel safe.&quot;&gt;&gt;\
You kiss her forehead.
&lt;&lt;HeroTalk &quot;I love you too, Naya&#39;driel.&quot;&gt;&gt;\
She shivers at the sound of her formal name.

[[What now?-&gt;Naya Lewd][$p = 45]]

&lt;&lt;set $pleasured = 1&gt;&gt;\

&lt;&lt;elseif $p eq 45&gt;&gt;\
\
Without realizing it, you drift into a gentle slumber. When you wake, the sun has set, and &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; is dressed and pacing her room.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;I feel terrible.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;You&#39;re hurt?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Even if we succeed, even if the world is saved, our time together will be short. I will marry some elven noble, and you will disappear.&quot;&gt;&gt;\
It&#39;s a fair concern, but oddly enough it doesn&#39;t bother you. Perhaps it&#39;s simply too distant to even contemplate.
&lt;&lt;HeroTalk &quot;Don&#39;t worry about the future, Naya. These things have a way of working out.&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;... you&#39;re sure?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Certain.&quot;&gt;&gt;\

[[Get dressed-&gt;Naya Lewd][$p = 46]]
\
&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
\
&lt;&lt;elseif $p eq 46&gt;&gt;\
\
Once you&#39;re dressed, you almost leave &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; tree.

Then you look back to her.
&lt;&lt;HeroTalk &quot;If I call on you again, will you answer?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;Call on me? For sex?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;... I was trying to be subtle.&quot;&gt;&gt;\
She laughs.
&lt;&lt;NayaTalk &quot;Yes, you can call on me, $name. I can never be your wife, but for now, I will be happy as your lover.&quot;&gt;&gt;\

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;set $nayalove = 23&gt;&gt;\
\
&lt;&lt;elseif $p eq 47&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
At your request, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; enters your cabin and shuts the door. Just as the door closes, she starts to undress. She does it slowly, meaningfully, putting on a show just for you.
&lt;&lt;NayaTalk &quot;Look what you do to me, $name. I have to change my underwear twice a day.&quot;&gt;&gt; \
&lt;video loop muted autoplay src=&quot;Images/Other/strip3.mp4&quot;&gt;&lt;/video&gt;

Her pussy is absolutely soaking wet. You watch, mesmerized, as it drips sweet honey onto her panties.

&lt;&lt;HeroTalk &quot;Now show me our secret place.&quot;&gt;&gt; \

[[Smiling, she turns around and bends over-&gt;Naya Lewd][$p = 48]]

&lt;&lt;elseif $p eq 48&gt;&gt;\
\
You&#39;ve never seen a set of holes quite like &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt;. While her pussy is wet and ripe and begging for cock, it is forever left alone and wanting - and that intrinsic bit of denial only makes it all the more erotic. Then there&#39;s her asshole - plump and loose and puffed out from use. It&#39;s taken on its role as a sheathe for dick, and is so puffy and pronounced that it actually looks &lt;i&gt;bigger&lt;/i&gt; than her pussy.
&lt;img src=&quot;Images/Other/naya6.jpg&quot; width=500 /&gt;

&lt;&lt;NayaTalk &quot;You like what you see?&quot;&gt;&gt; \

In answer, you kneel down and set your tongue against her holes. At this point, you probably can&#39;t ever go back to sleeping with human women. Elven pussy - and even &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; asshole - just taste perfect. There&#39;s a sweetness, almost like nectar, that drives you absolutely wild.
&lt;video loop muted autoplay src=&quot;Images/Other/anal2.mp4&quot;&gt;&lt;/video&gt;

[[Pull down your pants-&gt;Naya Lewd][$p = 49]]

&lt;&lt;elseif $p eq 49&gt;&gt;\
\
You take her from behind, slamming your hips against hers and making her breasts heave. 
&lt;video loop muted autoplay src=&quot;Images/Other/anal11.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;&lt;i&gt;You like that, Naya? You like taking my cock up your ass?&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;&lt;i&gt;Oooohhh!!! So much!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;&lt;i&gt;Tell me you love me!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;&lt;i&gt;I love you, $name! I love you and your huge cock!&lt;/i&gt;&quot;&gt;&gt; \

[[Finish her-&gt;Naya Lewd][$p = 50]]

&lt;&lt;elseif $p eq 50&gt;&gt;\
\
\
&lt;&lt;NayaTalk &quot;&lt;i&gt;Yes! - Yes! - Yes! - Yes! Oooohhh!!!&lt;/i&gt;&quot;&gt;&gt; \
You cum together, her asshole and pussy shivering in climax just as you tense up, your orgasm splurting deep inside of her guts.
&lt;video loop muted autoplay src=&quot;Images/Other/anal5.mp4&quot;&gt;&lt;/video&gt;

Afterwards, the two you stay like that, connected, as your cock slowly goes soft inside of her. It feels incredibly intimate. You take hold her white hair and gently pull on it, forcing her to crane her neck up and look at you.
&lt;&lt;HeroTalk &quot;You&#39;re mine, Naya&#39;driel.&quot;&gt;&gt; \
She swallows, knowing the words to be true, but not knowing what this will mean for her future as an elven princess.

Afterwards, the two of you dress and return to the matter at hand. The Redeemer must be stopped.

[[Return-&gt;Cabin]] 

&lt;&lt;set $pleasured = 1&gt;&gt;

&lt;&lt;elseif $p eq 51&gt;&gt;\
\
&lt;&lt;elseif $p eq 60&gt;&gt;\
\
Just before you signal for the war council to commence, someone enters the command tent.

It is &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;Is it time? Is today the day my brother dies?&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Yes - I was about to call the council together. We can delay no further.&quot;&gt;&gt; \
She takes a few steps closer to you.
&lt;&lt;NayaTalk &quot;... can&#39;t we?&quot;&gt;&gt; \

[[Ask her what she means-&gt;Naya Lewd][$p = 61]]

&lt;&lt;elseif $p eq 61&gt;&gt;\
\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;Naya, what are you...&quot;&gt;&gt; \
The words slip from your lips, forgotten. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; has climbed onto the war council table, slipped off her clothes, and spread her legs before you.
&lt;img src=&quot;Images/Other/naya5.jpg&quot; width=600 /&gt;

&lt;&lt;HeroTalk &quot;By the Gods...&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;I have sacrificed, $name. My freedom, my happiness, my love - all for my dream of restoring hope to the elven people. And today, for all my efforts, for all my sacrifice, my brother sent an assassin to kill me.&quot;&gt;&gt; \
She takes your hand and presses it against her pussy. It&#39;s as warm as it is soaking wet.
&lt;&lt;NayaTalk &quot;To the depths with sacrifice. To the depths with everything. If I die today, I want to die a woman - not just a princess, but a person.&quot;&gt;&gt; \

You understand.

[[Take Naya&#39;s maidenhood-&gt;Naya Lewd][$p = 62]]

&lt;&lt;elseif $p eq 62&gt;&gt;\
\
You pull down your pants and press your cock, already hard as a blade, against her quivering sex.
&lt;video loop muted autoplay src=&quot;Images/Other/sex1.mp4&quot;&gt;&lt;/video&gt;

Slowly, tenderly, you rub your glans against her lower lips. Soon her arousal is coating your cock.

You do not ask if she&#39;s sure, or if she&#39;s certain. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; is both thoughtful and wise - that&#39;s part of the reason you love her. If she didn&#39;t want this, she wouldn&#39;t be here.

[[Penetrate her-&gt;Naya Lewd][$p = 63]]

&lt;&lt;elseif $p eq 63&gt;&gt;\
\
As you push inside, &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; gasps at the new sensation. Likely there&#39;s some pain as her pussy for the first time stretches out and accomodates a cock. You push in and pull out, going a bit deeper with every thrust. Remarkably, you soon bottom out inside of her. &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; takes you to the hilt.

Then slowly, quietly, the two of you start having sex.
&lt;video loop muted autoplay src=&quot;Images/Other/sex9.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;HeroTalk &quot;How does it feel?&quot;&gt;&gt; \
She blushes. Soft moans escape her lips every time your balls slap against her ass.
&lt;&lt;NayaTalk &quot;It&#39;s nice... &lt;i&gt;oh!&lt;/i&gt; ... takes some getting used to.&quot;&gt;&gt; \
You can&#39;t help but smirk, most women say that about anal.
&lt;&lt;NayaTalk &quot;I&#39;m not a maiden anymore.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;No, you&#39;re not.&quot;&gt;&gt; \
She gives you a naughty smile.

[[Pick up the pace-&gt;Naya Lewd][$p = 64]]

&lt;&lt;elseif $p eq 64&gt;&gt;\
\
As you speed up, you set your forefinger and thumb against &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&#39;s&lt;/b&gt;&lt;/span&gt; clit and start rubbing it. She gasps at the new sensation.
&lt;video loop muted autoplay src=&quot;Images/Other/sex10.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;NayaTalk &quot;&lt;i&gt;Oh, $name... Oooohhh... you&#39;re going to make me cum!&lt;/i&gt;&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;I&#39;m close, too.&quot;&gt;&gt; \
&lt;&lt;NayaTalk &quot;&lt;i&gt;Do it - cum inside me!&lt;/i&gt;&quot;&gt;&gt; \

[[Cum inside her-&gt;Naya Lewd][$p = 65]]

&lt;&lt;elseif $p eq 65&gt;&gt;\
\
You hold her close, your face buried in her hair as your climax hits. Moaning, you feel semen shoot out of your cock with every pulsing burst of pleasure.
&lt;video loop muted autoplay src=&quot;Images/Other/creampie3.mp4&quot;&gt;&lt;/video&gt;

The feeling of your semen in her womb pushes &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt; over the edge. She cums, her squirting orgasm soaking your pubic hair and dripping down your thighs.

For a while, the two of you remain perfectly still. You can hear Deathguard patrolling right outside the tent. You wonder if they could hear you.
&lt;&lt;NayaTalk &quot;Whatever happens today... I will always love you, $name.&quot;&gt;&gt; \
&lt;&lt;HeroTalk &quot;Until my dying day, I&#39;m yours.&quot;&gt;&gt; \

[[Begin the assault on the Temple of Eternity-&gt;Temple1][$p = 1]]
\
&lt;&lt;set $nayalove = 30&gt;&gt;\
\
&lt;&lt;elseif $p eq 66&gt;&gt;\
\




























































































































&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="174" name="Naya Attack" tags="" position="925,2058" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;\
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;battle3_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;battle&quot;&gt;&gt;\
\
As you are wandering through the frozen hills, you suddenly hear a woman&#39;s piercing scream. 

Not just any woman - that sounds like &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;!

[[Rescue her-&gt;Naya Attack][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
It&#39;s not long before you find her. She&#39;s surrounded by the fading remains of three Voidspawn, with a fourth rapidly approaching her. Her quiver is empty of arrows.
&lt;img src=&quot;Images/ScarletVale/voidspawn1.jpg&quot; width=400 /&gt;

You charge.
&lt;&lt;HeroTalk &quot;Face me, creature!&quot;&gt;&gt;\
The Voidspawn halts just a single pace away from the downed elf, then turns to you.
&lt;&lt;VoidspawnTalk &quot;All shall fall to the Void.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Prove it.&quot;&gt;&gt;\

&lt;&lt;set $returnpassage = passage()&gt;&gt;\
&lt;&lt;set $passage = &quot;Battle1&quot;&gt;&gt;\
&lt;&lt;link &quot;To battle!&quot; $passage&gt;&gt;&lt;&lt;set $p = 10&gt;&gt;&lt;&lt;/link&gt;&gt;

&lt;&lt;VoidspawnStats&gt;&gt; 
&lt;&lt;set $flee = 0&gt;&gt;
&lt;&lt;set $battlecount = 0&gt;&gt; 
\
&lt;&lt;elseif $p eq 20&gt;&gt; \
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;romance1_bgm&quot; volume 0.5 play&gt;&gt;&lt;&lt;set $music = &quot;romance&quot;&gt;&gt;\
\
You slay the $enemyname!
&lt;&lt;HeroDisplay&gt;&gt;
\
&lt;&lt;set $enemygold = random($enemymingold, $enemymaxgold)&gt;&gt; \
&lt;&lt;set $enemyexp = random($enemyminexp, $enemymaxexp)&gt;&gt; \

You loot the corpse of your fallen foe. Good fortune - you find $enemygold gold pieces! Fine additions to your coin purse...

You feel stronger from your victory - you gain $enemyexp Experience Points!

[[Go to Naya-&gt;Naya Attack][$p = 21]] 

&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $gold += $enemygold&gt;&gt;\
&lt;&lt;set $exp += $enemyexp&gt;&gt;\
\
&lt;&lt;BattleEnd&gt;&gt;\
\
&lt;&lt;elseif $p eq 21&gt;&gt;\
\
You kneel down beside &lt;span class=&quot;naya&quot;&gt;&lt;b&gt;Naya&lt;/b&gt;&lt;/span&gt;.
&lt;&lt;HeroTalk &quot;Are you injured? Are you hurt?&quot;&gt;&gt;\
She winces as she tries to move.
&lt;&lt;NayaTalk &quot;I was a fool. I thought I&#39;d help you in the search for the Winter Palace, and then before long I was surrounded. If you came a moment later, the Void Gem would be in the Redeemer&#39;s grasp...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Forget about that - Naya, are you alright?&quot;&gt;&gt;\
At your question, she scowls.
&lt;&lt;NayaTalk &quot;Why do you even care?&quot;&gt;&gt;\

[[Confess your feelings for her-&gt;Naya Attack][$p = 22]]

&lt;&lt;elseif $p eq 22&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;Is it so strange that I might care for you?&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;But... I&#39;m an elf.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;And I&#39;m right-handed - but that isn&#39;t &lt;i&gt;all&lt;/i&gt; I am. Naya, you&#39;re a brave, capable, clever, remarkable-&quot;&gt;&gt;\
Before you can say another word, she&#39;s pulled you in for a kiss.
&lt;video loop muted autoplay src=&quot;Images/Other/kiss4.mp4&quot;&gt;&lt;/video&gt;

[[Kiss her back-&gt;Naya Attack][$p = 23]]

&lt;&lt;elseif $p eq 23&gt;&gt;\
\
Her tongue tastes like mint in midwinter. Her breath is warm and sweet. You pull her in close, all at once wanting all of her, right at this moment. Your hand finds its way up her skirt. She feels incredible - small and tight and perfect.
&lt;video loop muted autoplay src=&quot;Images/Other/fondle3.mp4&quot;&gt;&lt;/video&gt;

&lt;&lt;NayaTalk &quot;$name, I want you...&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;I want you too...&quot;&gt;&gt;\
&lt;&lt;NayaTalk &quot;... but we can&#39;t.&quot;&gt;&gt;\

She pulls back, not meeting your gaze.
&lt;&lt;HeroTalk &quot;We can&#39;t? &lt;i&gt;Why not&lt;/i&gt;?&quot;&gt;&gt;\

[[She rises on unsteady feet-&gt;Naya Attack][$p = 24]]

&lt;&lt;elseif $p eq 24&gt;&gt;\
\
She fixes her skirt, hiding her panties from sight.
&lt;img src=&quot;Images/Character/naya1.jpg&quot; width=450 /&gt;

&lt;&lt;NayaTalk &quot;Not here. I&#39;ll explain back where it&#39;s safe. I&#39;m sorry, $name.&quot;&gt;&gt;\
You watch her go, feeling lost and alone.

[[Return to the cabin-&gt;Outside the Cabin]] 

&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;\
&lt;&lt;set $nayalove = 18&gt;&gt;\
\
&lt;&lt;/if&gt;&gt;\
\</tw-passagedata><tw-passagedata pid="175" name="FinalGold" tags="" position="1806,1051" size="100,100">&lt;&lt;if $p eq 0&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;dark1_bgm&quot; volume 0.5 play loop&gt;&gt;&lt;&lt;set $music = &quot;dark&quot;&gt;&gt;\
You wander through the Dark Heart, seeking to find a path to the Dark Portal. By chance, you stumble upon what looks a treasure chest
&lt;img src=&quot;Images/DarkHeart/misc19.jpg&quot; width=450 /&gt;

You nearly open it, before something makes you hesitate. The markings on the chest, the skuls carved into its bulk, the way it seems to glow with arcane power...

This treasure chest is likely cursed.

[[Then it speaks-&gt;FinalGold][$p = 1]]

&lt;&lt;elseif $p eq 1&gt;&gt;\
\
&lt;&lt;TreasureTalk &quot;At last, after fourteen hundred years, someone has come to rescue me...&quot;&gt;&gt;\
The voice is faint, and seems to emanate from the orb atop the chest.
&lt;&lt;HeroTalk &quot;What are you? Why do you need to be rescued?&quot;&gt;&gt;\
&lt;&lt;TreasureTalk &quot;I will be honest with you, brave hero, though it brings me shame. I was an elf, once - a rich merchant in Netheryn. When the city fell, I fled with all my gold, leaving behind my family.&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Why?&quot;&gt;&gt;\
The voice in the orb sighs.
&lt;&lt;TreasureTalk &quot;Greed? I was a fool, and for my greed I was punished. My wife found me here, and in her rage cast a spell that turned me into a treasure chest. Now I am stuck with all my riches... forever.&quot;&gt;&gt;\
\
A sad tale. Though it sounds like the elf got what he deserved, you can&#39;t help but feel fourteen hundred years a long time to suffer such an imprisonment.

[[Find out how you can help the trapped soul-&gt;FinalGold][$p = 2]]

&lt;&lt;elseif $p eq 2&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;What would it take to free you from your prison?&quot;&gt;&gt;\
&lt;&lt;TreasureTalk &quot;Only Tylae&#39;s ward can undo the curse upon me. I sense you have such a ward within your heart. Give it to me, and I will finally be returned to life.&quot;&gt;&gt;\
You stare at the orb, studying it. 
&lt;&lt;HeroTalk &quot;Suppose I just shattered this orb instead?&quot;&gt;&gt;\
&lt;&lt;TreasureTalk &quot;NO! I beg you, do not. My soul will be torn apart, and my treasure along with it. If you want my riches, you must give me Tylae&#39;s ward.&quot;&gt;&gt;\
\
A difficult decision. Tylae&#39;s ward has strengthened you since you received it before assaulting the Tower of Zyr - losing it now would sting. Then again, more gold means better weapons, armor, and potions - those could aid you in the upcoming battle against the Redeemer.

Or you could just leave the elf to his misery.

[[Relinquish your ward in exchange for treasure-&gt;FinalGold][$p = 3]]
[[Shatter the orb-&gt;FinalGold][$p = 5]]
[[Just leave the cursed elf to his wretched fate-&gt;FinalGold][$p = 7]]

&lt;&lt;elseif $p eq 3&gt;&gt;\
\
You drop to one knee and shut your eyes. 
&lt;&lt;HeroTalk &quot;Oh, holy Tylae, release this soul from his wretched prison - he has suffered long enough.&quot;&gt;&gt;\
\
There is a sudden flash of light, blinding you. When your vision slowly returns, you see that the chest is gone, and in its place is an elf, wearing rather fancy but impractical robes.
&lt;img src=&quot;Images/DarkHeart/misc21.jpg&quot; width=450 /&gt;

&lt;&lt;Treasure2Talk &quot;I&#39;m free... after all these years, I&#39;m actually free!&quot;&gt;&gt;\
\
You wince, feeling Tylae&#39;s ward fade from your soul.

&lt;i&gt;Your strength decreased by 3!&lt;/i&gt;
&lt;i&gt;Your agility decreased by 3!&lt;/i&gt;
&lt;i&gt;Your willpower decreased by 3!&lt;/i&gt;

[[Ask for your treasure-&gt;FinalGold][$p = 4]]

&lt;&lt;set $basestrength -= 3&gt;&gt;\
&lt;&lt;set $baseagility -= 3&gt;&gt;\
&lt;&lt;set $basewillpower -= 3&gt;&gt;\

&lt;&lt;elseif $p eq 4&gt;&gt;\
\
&lt;&lt;HeroTalk &quot;Yes, you&#39;re free. Now, the gold.&quot;&gt;&gt;\
The elf bows, still a bit unsteady of his feet, and steps aside. Behind him you find a massive pile of gold.
&lt;img src=&quot;Images/DarkHeart/misc23.jpg&quot; width=450 /&gt;

&lt;&lt;Treasure2Talk &quot;It&#39;s all yours. Now, I&#39;m getting out of here. I&#39;ve missed the taste of wine. Oh, and honey! I must get my hands on some honey...&quot;&gt;&gt;\
The restored elf flees. You can only hope he makes it out of the Deep Woods unscathed. Then you set to counting the gold. Six thousand coins, in total. A worthy trade.

&lt;i&gt;You gained 6000 gold!&lt;/i&gt;

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;set $gold += 6000&gt;&gt;\
&lt;&lt;set $finalgold = 2&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\
\
&lt;&lt;elseif $p eq 5&gt;&gt;\
\
You decide to free the elf - by shattering his prison.

As you raise your $weapon, the elf senses your intent.
&lt;&lt;TreasureTalk &quot;No! Please I don&#39;t want to die! &lt;i&gt;NOOOOO!!!&lt;/i&gt;&quot;&gt;&gt;\

You smash the orb to pieces, release a blast of magical energy!
&lt;img src=&quot;Images/Outskirts/soulstone2.jpg&quot; width=650 /&gt;

[[...-&gt;FinalGold][$p = 6]]

&lt;&lt;elseif $p eq 6&gt;&gt;\
\
When the light fades, the orb is gone... and so is the treasure chest.
&lt;&lt;HeroTalk &quot;You&#39;re free now, elf. Enjoy the afterlife. I&#39;m sure your wife is looking forward to seeing you again.&quot;&gt;&gt;\
Your work complete, you leave.

&lt;i&gt;The Gods accept your righteous judgement! You gain 1 strength and 1 willpower!&lt;/i&gt;

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;set $basestrength += 1&gt;&gt;\
&lt;&lt;set $basewillpower += 1&gt;&gt;\
&lt;&lt;set $finalgold = 2&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\

&lt;&lt;elseif $p eq 7&gt;&gt;\
\
You stare at the chest a moment longer, then turn around.

&lt;&lt;TreasureTalk &quot;Wait... where are you going?&quot;&gt;&gt;\
&lt;&lt;HeroTalk &quot;Away. I have much to do. Farewell.&quot;&gt;&gt;\
&lt;&lt;TreasureTalk &quot;... no! No! Don&#39;t leave me! I can&#39;t wait another fourteen hundred years! No! &lt;i&gt;NOOOOOO!&lt;/i&gt;&quot;&gt;&gt;\
The elf&#39;s screams grow distant as you leave the chest behind.

[[Leave-&gt;Outside the Cabin]] 

&lt;&lt;set $finalgold = 2&gt;&gt;\
&lt;&lt;if $time eq &quot;Morning&quot;&gt;&gt;&lt;&lt;set $time = &quot;Afternoon&quot;&gt;&gt;&lt;&lt;elseif $time eq &quot;Afternoon&quot;&gt;&gt;&lt;&lt;set $time = &quot;Night&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;\


&lt;&lt;/if&gt;&gt;\
\
\
\
\</tw-passagedata></tw-storydata>
	<script id="script-sugarcube" type="text/javascript">
	/*! SugarCube JS */
	if(document.documentElement.getAttribute("data-init")==="loading"){(function(window,document,jQuery,undefined){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}var errorPrologRegExp=/^(?:(?:uncaught\s+(?:exception:\s+)?)?\w*(?:error|exception|_err):\s+)+/i,Alert=function(){function mesg(where,error,isFatal,isUncaught){var mesg="Error",nice="A".concat(isFatal?" fatal":"n"," error has occurred.");nice+=isFatal?" Aborting.":" You may be able to continue, but some parts may not work properly.";var isObject=null!==error&&"object"===_typeof(error),what=(isObject&&"message"in error?String(error.message).replace(errorPrologRegExp,""):String(error)).trim()||"unknown error";null!=where&&(mesg+=" [".concat(where,"]")),mesg+=": ".concat(what,"."),isObject&&"stack"in error&&(mesg+="\n\nStack Trace:\n".concat(error.stack)),mesg&&(nice+="\n\n".concat(mesg)),isUncaught||console[isFatal?"error":"warn"](mesg),window.alert(nice)}var origOnError;return origOnError=window.onerror,window.onerror=function(what,source,lineNum,colNum,error){"complete"===document.readyState?mesg(null,null!=error?error:what,!1,!0):(mesg(null,null!=error?error:what,!0,!0),window.onerror=origOnError,"function"==typeof window.onerror&&window.onerror.apply(this,arguments))},Object.freeze(Object.defineProperties({},{error:{value:function(where,error){mesg(where,error)}},fatal:{value:function(where,error){mesg(where,error,!0)}}}))}(),Patterns=(wsMap=new Map([[" ","\\u0020"],["\f","\\f"],["\n","\\n"],["\r","\\r"],["\t","\\t"],["\v","\\v"],[" ","\\u00a0"],[" ","\\u1680"],["᠎","\\u180e"],[" ","\\u2000"],[" ","\\u2001"],[" ","\\u2002"],[" ","\\u2003"],[" ","\\u2004"],[" ","\\u2005"],[" ","\\u2006"],[" ","\\u2007"],[" ","\\u2008"],[" ","\\u2009"],[" ","\\u200a"],["\u2028","\\u2028"],["\u2029","\\u2029"],[" ","\\u202f"],[" ","\\u205f"],["　","\\u3000"],["\ufeff","\\ufeff"]]),wsRe=/^\s$/,missing="",wsMap.forEach((function(pat,char){wsRe.test(char)||(missing+=pat)})),space=missing?"[\\s".concat(missing,"]"):"\\s",spaceNoTerminator="[\\u0020\\f\\t\\v\\u00a0\\u1680\\u180e\\u2000-\\u200a\\u202f\\u205f\\u3000\\ufeff]",notSpace="\\s"===space?"\\S":space.replace(/^\[/,"[^"),anyChar="(?:.|".concat("[\\n\\r\\u2028\\u2029]",")"),anyLetter="[0-9A-Z_a-z\\-\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u00ff\\u0150\\u0170\\u0151\\u0171]",anyLetterStrict=anyLetter.replace("\\-",""),identifier="".concat("[$A-Z_a-z]").concat("[$0-9A-Z_a-z]","*"),variable="[$_]"+identifier,htmlTagName="[A-Za-z](?:".concat(cENChar="(?:[\\x2D.0-9A-Z_a-z\\xB7\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u037D\\u037F-\\u1FFF\\u200C\\u200D\\u203F\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]|[\\uD800-\\uDB7F][\\uDC00-\\uDFFF])","*-").concat(cENChar,"*|[0-9A-Za-z]*)"),twStyle="(".concat(anyLetter,"+)\\(([^\\)\\|\\n]+)\\):"),cssStyle="".concat(spaceNoTerminator,"*(").concat(anyLetter,"+)").concat(spaceNoTerminator,"*:([^;\\|\\n]+);"),idOrClass="".concat(spaceNoTerminator,"*((?:").concat("[#.]").concat(anyLetter,"+").concat(spaceNoTerminator,"*)+);"),inlineCss="".concat(twStyle,"|").concat(cssStyle,"|").concat(idOrClass),Object.freeze({space:space,spaceNoTerminator:spaceNoTerminator,lineTerminator:"[\\n\\r\\u2028\\u2029]",notSpace:notSpace,anyChar:anyChar,anyLetter:anyLetter,anyLetterStrict:anyLetterStrict,identifierFirstChar:"[$A-Z_a-z]",identifierNextChar:"[$0-9A-Z_a-z]",identifier:identifier,variableSigil:"[$_]",variable:variable,macroName:"[A-Za-z][\\w-]*|[=-]",templateName:"[A-Za-z][\\w-]*",htmlTagName:htmlTagName,cssIdOrClassSigil:"[#.]",cssImage:"\\[[<>]?[Ii][Mm][Gg]\\[(?:\\s|\\S)*?\\]\\]+",inlineCss:inlineCss,url:"(?:file|https?|mailto|ftp|javascript|irc|news|data):[^\\s'\"]+"})),wsMap,wsRe,missing,cENChar,twStyle,cssStyle,idOrClass,space,spaceNoTerminator,notSpace,anyChar,anyLetter,anyLetterStrict,identifier,variable,htmlTagName,inlineCss;!function(){var startWSRe,endWSRe,_trimString=(startWSRe=new RegExp("^".concat(Patterns.space).concat(Patterns.space,"*")),endWSRe=new RegExp("".concat(Patterns.space).concat(Patterns.space,"*$")),function(str,where){var val=String(str);if(!val)return val;switch(where){case"start":return startWSRe.test(val)?val.replace(startWSRe,""):val;case"end":return endWSRe.test(val)?val.replace(endWSRe,""):val;default:throw new Error('_trimString called with incorrect where parameter value: "'.concat(where,'"'))}});function _createPadString(length,padding){var targetLength=Number.parseInt(length,10)||0;if(targetLength<1)return"";var padString=void 0===padding?"":String(padding);for(""===padString&&(padString=" ");padString.length<targetLength;){var curPadLength=padString.length,remainingLength=targetLength-curPadLength;padString+=curPadLength>remainingLength?padString.slice(0,remainingLength):padString}return padString.length>targetLength&&(padString=padString.slice(0,targetLength)),padString}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,writable:!0,value:function flat(){if(null==this)throw new TypeError("Array.prototype.flat called on null or undefined");var depth=0===arguments.length?1:Number(arguments[0])||0;return depth<1?Array.prototype.slice.call(this):Array.prototype.reduce.call(this,(function(acc,cur){return cur instanceof Array?acc.push.apply(acc,_toConsumableArray(flat.call(cur,depth-1))):acc.push(cur),acc}),[])}}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatMap called on null or undefined");return Array.prototype.map.apply(this,arguments).flat()}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");if(0===arguments.length)return!1;var length=this.length>>>0;if(0===length)return!1;var needle=arguments[0],i=Number(arguments[1])||0;for(i<0&&(i=Math.max(0,length+i));i<length;++i){var value=this[i];if(value===needle||value!=value&&needle!=needle)return!0}return!1}}),Object.entries||Object.defineProperty(Object,"entries",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.entries object parameter must be an object");return Object.keys(obj).map((function(key){return[key,obj[key]]}))}}),Object.fromEntries||Object.defineProperty(Object,"fromEntries",{configurable:!0,writable:!0,value:function(iter){return Array.from(iter).reduce((function(acc,pair){if(Object(pair)!==pair)throw new TypeError("Object.fromEntries iterable parameter must yield objects");return pair[0]in acc?Object.defineProperty(acc,pair[0],{configurable:!0,enumerable:!0,writable:!0,value:pair[1]}):acc[pair[0]]=pair[1],acc}),{})}}),Object.getOwnPropertyDescriptors||Object.defineProperty(Object,"getOwnPropertyDescriptors",{configurable:!0,writable:!0,value:function(obj){if(null==obj)throw new TypeError("Object.getOwnPropertyDescriptors object parameter is null or undefined");var O=Object(obj);return Reflect.ownKeys(O).reduce((function(acc,key){var desc=Object.getOwnPropertyDescriptor(O,key);return void 0!==desc&&(key in acc?Object.defineProperty(acc,key,{configurable:!0,enumerable:!0,writable:!0,value:desc}):acc[key]=desc),acc}),{})}}),Object.values||Object.defineProperty(Object,"values",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.values object parameter must be an object");return Object.keys(obj).map((function(key){return obj[key]}))}}),String.prototype.padStart||Object.defineProperty(String.prototype,"padStart",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padStart called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:_createPadString(targetLength-baseLength,padding)+baseString}}),String.prototype.padEnd||Object.defineProperty(String.prototype,"padEnd",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padEnd called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:baseString+_createPadString(targetLength-baseLength,padding)}}),String.prototype.trimStart||Object.defineProperty(String.prototype,"trimStart",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimStart called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimLeft||Object.defineProperty(String.prototype,"trimLeft",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimLeft called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimEnd||Object.defineProperty(String.prototype,"trimEnd",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimEnd called on null or undefined");return _trimString(this,"end")}}),String.prototype.trimRight||Object.defineProperty(String.prototype,"trimRight",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimRight called on null or undefined");return _trimString(this,"end")}})}(),function(){var _nativeMathRandom=Math.random,_regExpMetaCharsRe,_hasRegExpMetaCharsRe,_formatRegExp,_hasFormatRegExp;function _random(){var min,max;switch(arguments.length){case 0:throw new Error("_random called with insufficient parameters");case 1:min=0,max=arguments[0];break;default:min=arguments[0],max=arguments[1]}if(min>max){var _ref=[max,min];min=_ref[0],max=_ref[1]}return Math.floor(_nativeMathRandom()*(max-min+1))+min}function _randomIndex(length,boundsArgs){var min,max;switch(boundsArgs.length){case 1:min=0,max=length-1;break;case 2:min=0,max=Math.trunc(boundsArgs[1]);break;default:min=Math.trunc(boundsArgs[1]),max=Math.trunc(boundsArgs[2])}return Number.isNaN(min)?min=0:!Number.isFinite(min)||min>=length?min=length-1:min<0&&(min=length+min)<0&&(min=0),Number.isNaN(max)?max=0:(!Number.isFinite(max)||max>=length||max<0&&(max=length+max)<0)&&(max=length-1),_random(min,max)}function _getCodePointStartAndEnd(str,pos){var code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};if(code<55296||code>57343)return{char:str.charAt(pos),start:pos,end:pos};if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)throw new Error("high surrogate without trailing low surrogate");var nextCode=str.charCodeAt(nextPos);if(nextCode<56320||nextCode>57343)throw new Error("high surrogate without trailing low surrogate");return{char:str.charAt(pos)+str.charAt(nextPos),start:pos,end:nextPos}}if(0===pos)throw new Error("low surrogate without leading high surrogate");var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);if(prevCode<55296||prevCode>56319)throw new Error("low surrogate without leading high surrogate");return{char:str.charAt(prevPos)+str.charAt(pos),start:prevPos,end:pos}}Object.defineProperty(Array,"random",{configurable:!0,writable:!0,value:function(array){if("object"!==_typeof(array)||null===array||!Object.prototype.hasOwnProperty.call(array,"length"))throw new TypeError("Array.random array parameter must be an array or array-lke object");var length=array.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments,1));return array[index]}}}),Object.defineProperty(Array.prototype,"concatUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.concatUnique called on null or undefined");var result=Array.from(this);if(0===arguments.length)return result;var items=Array.prototype.reduce.call(arguments,(function(prev,cur){return prev.concat(cur)}),[]),addSize=items.length;if(0===addSize)return result;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=items[i];-1===indexOf.call(result,value)&&push.call(result,value)}return result}}),Object.defineProperty(Array.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.count called on null or undefined");for(var indexOf=Array.prototype.indexOf,needle=arguments[0],pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,++pos;return count}}),Object.defineProperty(Array.prototype,"countWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.countWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.countWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return 0;for(var count=0,i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&++count;return count}}),Object.defineProperty(Array.prototype,"delete",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.delete called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var needles=Array.prototype.concat.apply([],arguments),needlesLength=needles.length,indices=[],i=0;i<length;++i)for(var value=this[i],j=0;j<needlesLength;++j){var needle=needles[j];if(value===needle||value!=value&&needle!=needle){indices.push(i);break}}for(var result=[],_i=0,iend=indices.length;_i<iend;++_i)result[_i]=this[indices[_i]];for(var splice=Array.prototype.splice,_i2=indices.length-1;_i2>=0;--_i2)splice.call(this,indices[_i2],1);return result}}),Object.defineProperty(Array.prototype,"deleteAt",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.deleteAt called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,cpyIndices=_toConsumableArray(new Set(Array.prototype.concat.apply([],arguments).map((function(x){return x<0?Math.max(0,length+x):x}))).values()),delIndices=_toConsumableArray(cpyIndices).sort((function(a,b){return b-a})),result=[],i=0,iend=cpyIndices.length;i<iend;++i)result[i]=this[cpyIndices[i]];for(var _i3=0,_iend=delIndices.length;_i3<_iend;++_i3)splice.call(this,delIndices[_i3],1);return result}}),Object.defineProperty(Array.prototype,"deleteWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.deleteWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.deleteWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,indices=[],result=[],i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&(result.push(this[i]),indices.push(i));for(var _i4=indices.length-1;_i4>=0;--_i4)splice.call(this,indices[_i4],1);return result}}),Object.defineProperty(Array.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.first called on null or undefined");if(0!==this.length>>>0)return this[0]}}),Object.defineProperty(Array.prototype,"includesAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAll called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAll.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(!Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!1;return!0}}),Object.defineProperty(Array.prototype,"includesAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAny called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAny.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!0;return!1}}),Object.defineProperty(Array.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.last called on null or undefined");var length=this.length>>>0;if(0!==length)return this[length-1]}}),Object.defineProperty(Array.prototype,"pluck",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pluck called on null or undefined");var length=this.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments));return Array.prototype.splice.call(this,index,1)[0]}}}),Object.defineProperty(Array.prototype,"pluckMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.pluckMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.pluckMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var splice=Array.prototype.splice,result=[],max=length-1;do{result.push(splice.call(this,_random(0,max--),1)[0])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"pushUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pushUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&push.call(this,value)}return this.length>>>0}}),Object.defineProperty(Array.prototype,"random",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.random called on null or undefined");var length=this.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments));return this[index]}}}),Object.defineProperty(Array.prototype,"randomMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.randomMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.randomMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var picked=new Map,result=[],max=length-1;do{var i=void 0;do{i=_random(0,max)}while(picked.has(i));picked.set(i,!0),result.push(this[i])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"shuffle",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.shuffle called on null or undefined");var length=this.length>>>0;if(0===length)return this;for(var i=length-1;i>0;--i){var j=Math.floor(_nativeMathRandom()*(i+1));if(i!==j){var swap=this[i];this[i]=this[j],this[j]=swap}}return this}}),Object.defineProperty(Array.prototype,"unshiftUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.unshiftUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,unshift=Array.prototype.unshift,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&unshift.call(this,value)}return this.length>>>0}}),Object.defineProperty(Function.prototype,"partial",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Function.prototype.partial called on null or undefined");var slice=Array.prototype.slice,fn=this,bound=slice.call(arguments,0);return function(){for(var applied=[],argc=0,i=0;i<bound.length;++i)applied.push(bound[i]===undefined?arguments[argc++]:bound[i]);return fn.apply(this,applied.concat(slice.call(arguments,argc)))}}}),Object.defineProperty(Math,"clamp",{configurable:!0,writable:!0,value:function(num,min,max){var value=Number(num);return Number.isNaN(value)?NaN:value.clamp(min,max)}}),Object.defineProperty(Math,"easeInOut",{configurable:!0,writable:!0,value:function(num){return 1-(Math.cos(Number(num)*Math.PI)+1)/2}}),Object.defineProperty(Number.prototype,"clamp",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Number.prototype.clamp called on null or undefined");if(2!==arguments.length)throw new Error("Number.prototype.clamp called with an incorrect number of parameters");var min=Number(arguments[0]),max=Number(arguments[1]);if(min>max){var _ref2=[max,min];min=_ref2[0],max=_ref2[1]}return Math.min(Math.max(this,min),max)}}),RegExp.escape||(_regExpMetaCharsRe=/[\\^$*+?.()|[\]{}]/g,_hasRegExpMetaCharsRe=new RegExp(_regExpMetaCharsRe.source),Object.defineProperty(RegExp,"escape",{configurable:!0,writable:!0,value:function(str){var val=String(str);return val&&_hasRegExpMetaCharsRe.test(val)?val.replace(_regExpMetaCharsRe,"\\$&"):val}})),_formatRegExp=/{(\d+)(?:,([+-]?\d+))?}/g,_hasFormatRegExp=new RegExp(_formatRegExp.source),Object.defineProperty(String,"format",{configurable:!0,writable:!0,value:function(format){function padString(str,align,pad){if(!align)return str;var plen=Math.abs(align)-str.length;if(plen<1)return str;var padding=String(pad).repeat(plen);return align<0?str+padding:padding+str}if(arguments.length<2)return 0===arguments.length?"":format;var args=2===arguments.length&&Array.isArray(arguments[1])?_toConsumableArray(arguments[1]):Array.prototype.slice.call(arguments,1);return 0===args.length?format:_hasFormatRegExp.test(format)?(_formatRegExp.lastIndex=0,format.replace(_formatRegExp,(function(match,index,align){var retval=args[index];if(null==retval)return"";for(;"function"==typeof retval;)retval=retval();switch(_typeof(retval)){case"string":break;case"object":retval=JSON.stringify(retval);break;default:retval=String(retval)}return padString(retval,align?Number.parseInt(align,10):0," ")}))):format}}),Object.defineProperty(String.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.contains called on null or undefined");return-1!==String.prototype.indexOf.apply(this,arguments)}}),Object.defineProperty(String.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.count called on null or undefined");var needle=String(arguments[0]||"");if(""===needle)return 0;for(var indexOf=String.prototype.indexOf,step=needle.length,pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,pos+=step;return count}}),Object.defineProperty(String.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.first called on null or undefined");return _getCodePointStartAndEnd(String(this),0).char}}),Object.defineProperty(String.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.last called on null or undefined");var str=String(this);return _getCodePointStartAndEnd(str,str.length-1).char}}),Object.defineProperty(String.prototype,"splice",{configurable:!0,writable:!0,value:function(startAt,delCount,replacement){if(null==this)throw new TypeError("String.prototype.splice called on null or undefined");var length=this.length>>>0;if(0===length)return"";var start=Number(startAt);Number.isSafeInteger(start)?start<0&&(start+=length)<0&&(start=0):start=0,start>length&&(start=length);var count=Number(delCount);(!Number.isSafeInteger(count)||count<0)&&(count=0);var res=this.slice(0,start);return void 0!==replacement&&(res+=replacement),start+count<length&&(res+=this.slice(start+count)),res}}),Object.defineProperty(String.prototype,"splitOrEmpty",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.splitOrEmpty called on null or undefined");return""===String(this)?[]:String.prototype.split.apply(this,arguments)}}),Object.defineProperty(String.prototype,"toLocaleUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toLocaleUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd3=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd3.char,end=_getCodePointStartAnd3.end;return-1===end?"":char.toLocaleUpperCase()+str.slice(end+1)}}),Object.defineProperty(String.prototype,"toUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd4=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd4.char,end=_getCodePointStartAnd4.end;return-1===end?"":char.toUpperCase()+str.slice(end+1)}}),Object.defineProperty(Date.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:date)",this.toISOString()]}}),Object.defineProperty(Function.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)","(".concat(this.toString(),")")]}}),Object.defineProperty(Map.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:map)",_toConsumableArray(this)]}}),Object.defineProperty(RegExp.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)",this.toString()]}}),Object.defineProperty(Set.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:set)",_toConsumableArray(this)]}}),Object.defineProperty(JSON,"reviveWrapper",{configurable:!0,writable:!0,value:function(code,data){if("string"!=typeof code)throw new TypeError("JSON.reviveWrapper code parameter must be a string");return["(revive:eval)",[code,data]]}}),Object.defineProperty(JSON,"_real_stringify",{value:JSON.stringify}),Object.defineProperty(JSON,"stringify",{configurable:!0,writable:!0,value:function(_value,replacer,space){return JSON._real_stringify(_value,(function(key,val){var value=val;if("function"==typeof replacer)try{value=replacer(key,value)}catch(ex){}return void 0===value&&(value=["(revive:eval)","undefined"]),value}),space)}}),Object.defineProperty(JSON,"_real_parse",{value:JSON.parse}),Object.defineProperty(JSON,"parse",{configurable:!0,writable:!0,value:function value(text,reviver){return JSON._real_parse(text,(function(key,val){var value=val;if(Array.isArray(value)&&2===value.length)switch(value[0]){case"(revive:set)":value=new Set(value[1]);break;case"(revive:map)":value=new Map(value[1]);break;case"(revive:date)":value=new Date(value[1]);break;case"(revive:eval)":try{if(Array.isArray(value[1])){var $ReviveData$=value[1][1];value=eval(value[1][0])}else value=eval(value[1])}catch(ex){}}else if("string"==typeof value&&"@@revive@@"===value.slice(0,10))try{value=eval(value.slice(10))}catch(ex){}if("function"==typeof reviver)try{value=reviver(key,value)}catch(ex){}return value}))}}),Object.defineProperty(Array.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.contains called on null or undefined");return Array.prototype.includes.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAll called on null or undefined");return Array.prototype.includesAll.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAny called on null or undefined");return Array.prototype.includesAny.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"flatten",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatten called on null or undefined");return Array.prototype.flat.call(this,1/0)}}),Object.defineProperty(String.prototype,"readBracketedList",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.readBracketedList called on null or undefined");for(var match,re=new RegExp("(?:\\[\\[((?:\\s|\\S)*?)\\]\\])|([^\"'\\s]\\S*)","gm"),names=[];null!==(match=re.exec(this));)match[1]?names.push(match[1]):match[2]&&names.push(match[2]);return names}})}();var Browser=(userAgent=navigator.userAgent.toLowerCase(),winPhone=userAgent.includes("windows phone"),isMobile=Object.freeze({Android:!winPhone&&userAgent.includes("android"),BlackBerry:/blackberry|bb10/.test(userAgent),iOS:!winPhone&&/ip(?:hone|ad|od)/.test(userAgent),Opera:!winPhone&&("object"===_typeof(window.operamini)||userAgent.includes("opera mini")),Windows:winPhone||/iemobile|wpdesktop/.test(userAgent),any:function(){return isMobile.Android||isMobile.BlackBerry||isMobile.iOS||isMobile.Opera||isMobile.Windows}}),isGecko=!isMobile.Windows&&!/khtml|trident|edge/.test(userAgent)&&userAgent.includes("gecko"),isIE=!userAgent.includes("opera")&&/msie|trident/.test(userAgent),ieVersion=isIE?(ver=/(?:msie\s+|rv:)(\d+\.\d)/.exec(userAgent))?Number(ver[1]):0:null,isOpera=userAgent.includes("opera")||userAgent.includes(" opr/"),operaVersion=isOpera?function(){var ver=new RegExp("".concat(/khtml|chrome/.test(userAgent)?"opr":"version","\\/(\\d+\\.\\d+)")).exec(userAgent);return ver?Number(ver[1]):0}():null,isVivaldi=userAgent.includes("vivaldi"),Object.freeze({userAgent:userAgent,isMobile:isMobile,isGecko:isGecko,isIE:isIE,ieVersion:ieVersion,isOpera:isOpera,operaVersion:operaVersion,isVivaldi:isVivaldi})),ver,userAgent,winPhone,isMobile,isGecko,isIE,ieVersion,isOpera,operaVersion,isVivaldi,Has=(hasAudioElement=function(){try{return"function"==typeof document.createElement("audio").canPlayType}catch(ex){}return!1}(),hasFile=function(){try{return"Blob"in window&&"File"in window&&"FileList"in window&&"FileReader"in window&&(!Browser.isOpera||Browser.operaVersion>=15)}catch(ex){}return!1}(),hasGeolocation=function(){try{return"geolocation"in navigator&&"function"==typeof navigator.geolocation.getCurrentPosition&&"function"==typeof navigator.geolocation.watchPosition}catch(ex){}return!1}(),hasMutationObserver=function(){try{return"MutationObserver"in window&&"function"==typeof window.MutationObserver}catch(ex){}return!1}(),hasPerformance=function(){try{return"performance"in window&&"function"==typeof window.performance.now}catch(ex){}return!1}(),hasTouch=function(){try{return"ontouchstart"in window||!!window.DocumentTouch&&document instanceof window.DocumentTouch||!!navigator.maxTouchPoints||!!navigator.msMaxTouchPoints}catch(ex){}return!1}(),hasTransitionEndEvent=function(){try{for(var teMap=new Map([["transition","transitionend"],["MSTransition","msTransitionEnd"],["WebkitTransition","webkitTransitionEnd"],["MozTransition","transitionend"]]),teKeys=_toConsumableArray(teMap.keys()),el=document.createElement("div"),i=0;i<teKeys.length;++i)if(el.style[teKeys[i]]!==undefined)return teMap.get(teKeys[i])}catch(ex){}return!1}(),Object.freeze({audio:hasAudioElement,fileAPI:hasFile,geolocation:hasGeolocation,mutationObserver:hasMutationObserver,performance:hasPerformance,touch:hasTouch,transitionEndEvent:hasTransitionEndEvent})),hasAudioElement,hasFile,hasGeolocation,hasMutationObserver,hasPerformance,hasTouch,hasTransitionEndEvent,Visibility=(vendor=function(){try{return Object.freeze([{hiddenProperty:"hidden",stateProperty:"visibilityState",changeEvent:"visibilitychange"},{hiddenProperty:"webkitHidden",stateProperty:"webkitVisibilityState",changeEvent:"webkitvisibilitychange"},{hiddenProperty:"mozHidden",stateProperty:"mozVisibilityState",changeEvent:"mozvisibilitychange"},{hiddenProperty:"msHidden",stateProperty:"msVisibilityState",changeEvent:"msvisibilitychange"}].find((function(vnd){return vnd.hiddenProperty in document})))}catch(ex){}return undefined}(),Object.freeze(Object.defineProperties({},{vendor:{get:function(){return vendor}},state:{get:function(){return vendor&&document[vendor.stateProperty]||"visible"}},isEnabled:{value:function(){return Boolean(vendor)}},isHidden:{value:function(){return Boolean(vendor&&document[vendor.hiddenProperty])}},hiddenProperty:{value:vendor&&vendor.hiddenProperty},stateProperty:{value:vendor&&vendor.stateProperty},changeEvent:{value:vendor&&vendor.changeEvent}}))),vendor,Fullscreen=function(){var _hasPromise,vendor=function(){try{return Object.freeze([{isEnabled:"fullscreenEnabled",element:"fullscreenElement",requestFn:"requestFullscreen",exitFn:"exitFullscreen",changeEvent:"fullscreenchange",errorEvent:"fullscreenerror"},{isEnabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",requestFn:"webkitRequestFullscreen",exitFn:"webkitExitFullscreen",changeEvent:"webkitfullscreenchange",errorEvent:"webkitfullscreenerror"},{isEnabled:"mozFullScreenEnabled",element:"mozFullScreenElement",requestFn:"mozRequestFullScreen",exitFn:"mozCancelFullScreen",changeEvent:"mozfullscreenchange",errorEvent:"mozfullscreenerror"},{isEnabled:"msFullscreenEnabled",element:"msFullscreenElement",requestFn:"msRequestFullscreen",exitFn:"msExitFullscreen",changeEvent:"MSFullscreenChange",errorEvent:"MSFullscreenError"}].find((function(vnd){return vnd.isEnabled in document})))}catch(ex){}return undefined}(),_returnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,vendor)try{var value=document.exitFullscreen();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise});function _selectElement(requestedEl){var selectedEl=requestedEl||document.documentElement;return selectedEl===document.documentElement&&("msRequestFullscreen"===vendor.requestFn||Browser.isOpera&&Browser.operaVersion<15)&&(selectedEl=document.body),selectedEl}function isFullscreen(){return Boolean(vendor&&document[vendor.element])}function requestFullscreen(options,requestedEl){var _this=this;if(!vendor)return Promise.reject(new Error("fullscreen not supported"));var element=_selectElement(requestedEl);if("function"!=typeof element[vendor.requestFn])return Promise.reject(new Error("fullscreen not supported"));if(isFullscreen())return Promise.resolve();if(_returnsPromise())return element[vendor.requestFn](options);var namespace=".Fullscreen_requestFullscreen";return new Promise((function(resolve,reject){jQuery(element).off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){jQuery(_this).off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen request error")):resolve()})),element[vendor.requestFn](options)}))}function exitFullscreen(){var _this2=this;if(!vendor||"function"!=typeof document[vendor.exitFn])return Promise.reject(new TypeError("fullscreen not supported"));if(!isFullscreen())return Promise.reject(new TypeError("fullscreen mode not active"));if(_returnsPromise())return document[vendor.exitFn]();var namespace=".Fullscreen_exitFullscreen";return new Promise((function(resolve,reject){jQuery(document).off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){jQuery(_this2).off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen exit error")):resolve()})),document[vendor.exitFn]()}))}return Object.freeze(Object.defineProperties({},{vendor:{get:function(){return vendor}},element:{get:function(){return vendor?document[vendor.element]:null}},isEnabled:{value:function(){return Boolean(vendor&&document[vendor.isEnabled])}},isFullscreen:{value:isFullscreen},request:{value:requestFullscreen},exit:{value:exitFullscreen},toggle:{value:function(options,requestedEl){return isFullscreen()?exitFullscreen():requestFullscreen(options,requestedEl)}},onChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);$(element).on(vendor.changeEvent,handlerFn)}}},offChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?$(element).off(vendor.changeEvent,handlerFn):$(element).off(vendor.changeEvent)}}},onError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);$(element).on(vendor.errorEvent,handlerFn)}}},offError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?$(element).off(vendor.errorEvent,handlerFn):$(element).off(vendor.errorEvent)}}}}))}(),_ref3=Object.freeze(Object.defineProperties({},{clone:{value:function clone(orig){return"object"!==_typeof(orig)||null===orig?orig:orig instanceof String?String(orig):orig instanceof Number?Number(orig):orig instanceof Boolean?Boolean(orig):"function"==typeof orig.clone?orig.clone(!0):orig.nodeType&&"function"==typeof orig.cloneNode?orig.cloneNode(!0):(orig instanceof Array?copy=new Array(orig.length):orig instanceof Date?copy=new Date(orig.getTime()):orig instanceof Map?(copy=new Map,orig.forEach((function(val,key){return copy.set(key,clone(val))}))):orig instanceof RegExp?copy=new RegExp(orig):orig instanceof Set?(copy=new Set,orig.forEach((function(val){return copy.add(clone(val))}))):copy=Object.create(Object.getPrototypeOf(orig)),Object.keys(orig).forEach((function(name){return copy[name]=clone(orig[name])})),copy);var copy}},convertBreaks:{value:function(source){for(var node,output=document.createDocumentFragment(),para=document.createElement("p");null!==(node=source.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":if(null!==node.nextSibling&&node.nextSibling.nodeType===Node.ELEMENT_NODE&&"BR"===node.nextSibling.nodeName.toUpperCase()){source.removeChild(node.nextSibling),source.removeChild(node),output.appendChild(para),para=document.createElement("p");continue}if(!para.hasChildNodes()){source.removeChild(node);continue}break;case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":para.hasChildNodes()&&(output.appendChild(para),para=document.createElement("p")),output.appendChild(node);continue}para.appendChild(node)}para.hasChildNodes()&&output.appendChild(para),source.appendChild(output)}},safeActiveElement:{value:function(){try{return document.activeElement||null}catch(ex){return null}}},setDisplayTitle:{value:function(title){if("string"!=typeof title)throw new TypeError("story display title must be a string (received: ".concat(Util.getType(title),")"));var render=document.createDocumentFragment();new Wikifier(render,title);var text=function(source){for(var node,copy=source.cloneNode(!0),frag=document.createDocumentFragment();null!==(node=copy.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":case"DIV":case"P":frag.appendChild(document.createTextNode(" "))}frag.appendChild(node)}return frag.textContent}(render).trim();document.title=Config.passages.displayTitles&&""!==State.passage&&State.passage!==Config.passages.start?"".concat(State.passage," | ").concat(text):text;var storyTitle=document.getElementById("story-title");null!==storyTitle&&jQuery(storyTitle).empty().append(render)}},setPageElement:{value:function(idOrElement,titles,defaultText){var el="object"===_typeof(idOrElement)?idOrElement:document.getElementById(idOrElement);if(null==el)return null;var ids=Array.isArray(titles)?titles:[titles];jQuery(el).empty();for(var i=0,iend=ids.length;i<iend;++i)if(Story.has(ids[i]))return new Wikifier(el,Story.get(ids[i]).processText().trim()),el;if(null!=defaultText){var text=String(defaultText).trim();""!==text&&new Wikifier(el,text)}return el}},throwError:{value:function(place,message,source){var $wrapper=jQuery(document.createElement("div")),$toggle=jQuery(document.createElement("button")),$source=jQuery(document.createElement("pre")),mesg="".concat(L10n.get("errorTitle"),": ").concat(message||"unknown error");return $toggle.addClass("error-toggle").ariaClick({label:L10n.get("errorToggle")},(function(){$toggle.hasClass("enabled")?($toggle.removeClass("enabled"),$source.attr({"aria-hidden":!0,hidden:"hidden"})):($toggle.addClass("enabled"),$source.removeAttr("aria-hidden hidden"))})).appendTo($wrapper),jQuery(document.createElement("span")).addClass("error").text(mesg).appendTo($wrapper),jQuery(document.createElement("code")).text(source).appendTo($source),$source.addClass("error-source").attr({"aria-hidden":!0,hidden:"hidden"}).appendTo($wrapper),$wrapper.addClass("error-view").appendTo(place),console.warn("".concat(mesg,"\n\t").concat(source.replace(/\n/g,"\n\t"))),!1}},stringFrom:{value:function stringFrom(value){switch(_typeof(value)){case"function":return"[function]";case"number":if(Number.isNaN(value))return"[number NaN]";break;case"object":if(null===value)return"[null]";if(value instanceof Array)return value.map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Set)return Array.from(value).map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Map){var result=Array.from(value).map((function(_ref4){var _ref5=_slicedToArray(_ref4,2),key=_ref5[0],val=_ref5[1];return"".concat(stringFrom(key)," → ").concat(stringFrom(val))}));return"{ ".concat(result.join(", ")," }")}if(value instanceof Date)return value.toLocaleString();if(value instanceof Element){if(value===document.documentElement||value===document.head||value===document.body)throw new Error("illegal operation; attempting to convert the <html>, <head>, or <body> tags to string is not allowed");return value.outerHTML}return value instanceof Node?value.textContent:"function"==typeof value.toString?value.toString():Object.prototype.toString.call(value);case"symbol":var desc=void 0!==value.description?' "'.concat(value.description,'"'):"";return"[symbol".concat(desc,"]");case"undefined":return"[undefined]"}return String(value)}}})),clone=_ref3.clone,convertBreaks=_ref3.convertBreaks,safeActiveElement=_ref3.safeActiveElement,setDisplayTitle=_ref3.setDisplayTitle,setPageElement=_ref3.setPageElement,throwError=_ref3.throwError,stringFrom=_ref3.stringFrom;!function(){function onKeypressFn(ev){13!==ev.which&&32!==ev.which||(ev.preventDefault(),jQuery(safeActiveElement()||this).trigger("click"))}function onClickFnWrapper(fn){return function(){var $this=jQuery(this);$this.ariaIsDisabled()||($this.is("[aria-pressed]")&&$this.attr("aria-pressed","true"===$this.attr("aria-pressed")?"false":"true"),fn.apply(this,arguments))}}function oneClickFnWrapper(fn){return onClickFnWrapper((function(){jQuery(this).off(".aria-clickable").removeAttr("role tabindex aria-controls aria-pressed").filter("button").prop("disabled",!0),fn.apply(this,arguments)}))}jQuery.fn.extend({ariaClick:function(options,handler){if(0===this.length||0===arguments.length)return this;var opts=options,fn=handler;return null==fn&&(fn=opts,opts=undefined),"string"!=typeof(opts=jQuery.extend({namespace:undefined,one:!1,selector:undefined,data:undefined,role:undefined,controls:undefined,pressed:undefined,label:undefined},opts)).namespace?opts.namespace="":"."!==opts.namespace[0]&&(opts.namespace=".".concat(opts.namespace)),"boolean"==typeof opts.pressed&&(opts.pressed=opts.pressed?"true":"false"),this.filter("button").prop("type","button"),null!=opts.role?this.attr("role",opts.role):this.not("[role]").filter("a,[data-passage]").attr("role","link").end().not("a").not("[data-passage]").attr("role","button").end().end().end(),this.attr("tabindex",0),null!=opts.controls&&this.attr("aria-controls",opts.controls),null!=opts.pressed&&this.attr("aria-pressed",opts.pressed),null!=opts.label&&this.attr({"aria-label":opts.label,title:opts.label}),this.not("button").on("keypress.aria-clickable".concat(opts.namespace),opts.selector,onKeypressFn),this.on("click.aria-clickable".concat(opts.namespace),opts.selector,opts.data,opts.one?oneClickFnWrapper(fn):onClickFnWrapper(fn)),this},ariaDisabled:function(disable){if(0===this.length||0===arguments.length)return this;var $nonDisableable=this.not("button,fieldset,input,menuitem,optgroup,option,select,textarea"),$disableable=this.filter("button,fieldset,input,menuitem,optgroup,option,select,textarea");return disable?($nonDisableable.each((function(){this.setAttribute("disabled",""),this.setAttribute("aria-disabled","true")})),$disableable.each((function(){this.disabled=!0,this.setAttribute("aria-disabled","true")}))):($nonDisableable.each((function(){this.removeAttribute("disabled"),this.removeAttribute("aria-disabled")})),$disableable.each((function(){this.disabled=!1,this.removeAttribute("aria-disabled")}))),this},ariaIsDisabled:function(){return this.is("[disabled]")}})}(),jQuery.extend({wikiWithOptions:function(options){for(var _len=arguments.length,sources=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)sources[_key-1]=arguments[_key];if(0!==sources.length){var frag=document.createDocumentFragment();sources.forEach((function(content){return new Wikifier(frag,content,options)}));var errors=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "))}},wiki:function(){for(var _len2=arguments.length,sources=new Array(_len2),_key2=0;_key2<_len2;_key2++)sources[_key2]=arguments[_key2];this.wikiWithOptions.apply(this,[undefined].concat(sources))}}),jQuery.fn.extend({wikiWithOptions:function(options){for(var _len3=arguments.length,sources=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)sources[_key3-1]=arguments[_key3];if(0===this.length||0===sources.length)return this;var frag=document.createDocumentFragment();return sources.forEach((function(content){return new Wikifier(frag,content,options)})),this.append(frag),this},wiki:function(){for(var _len4=arguments.length,sources=new Array(_len4),_key4=0;_key4<_len4;_key4++)sources[_key4]=arguments[_key4];return this.wikiWithOptions.apply(this,[undefined].concat(sources))}});var Util=function(){var toString,utilGetType="[object Object]"===(toString=Object.prototype.toString).call(new Map)?function(O){if(null===O)return"null";if(O instanceof Map)return"Map";if(O instanceof Set)return"Set";var baseType=_typeof(O);return"object"===baseType?toString.call(O).slice(8,-1):baseType}:function(O){if(null===O)return"null";var baseType=_typeof(O);return"object"===baseType?toString.call(O).slice(8,-1):baseType};function utilToEnum(obj){var pEnum=Object.create(null);if(obj instanceof Array)obj.forEach((function(val,i){return pEnum[String(val)]=i}));else if(obj instanceof Set)Array.from(obj).forEach((function(val,i){return pEnum[String(val)]=i}));else if(obj instanceof Map)obj.forEach((function(val,key){return pEnum[String(key)]=val}));else{if("object"!==_typeof(obj)||null===obj||Object.getPrototypeOf(obj)!==Object.prototype)throw new TypeError("Util.toEnum obj parameter must be an Array, Map, Set, or generic object");Object.assign(pEnum,obj)}return Object.freeze(pEnum)}function utilToStringTag(obj){return Object.prototype.toString.call(obj).slice(8,-1)}var _illegalSlugCharsRe=/[\x00-\x20!-/:-@[-^`{-\x9f]+/g,_isInvalidSlugRe=/^-*$/;var _illegalFilenameCharsRE=/[\x00-\x1f"#$%&'*+,/:;<=>?\\^`|\x7f-\x9f]+/g;var _markupCharsRe=/[!"#$&'*\-/<=>?@[\\\]^_`{|}~]/g,_hasMarkupCharsRe=new RegExp(_markupCharsRe.source),_markupCharsMap=utilToEnum({"!":"&#33;",'"':"&quot;","#":"&#35;",$:"&#36;","&":"&amp;","'":"&#39;","*":"&#42;","-":"&#45;","/":"&#47;","<":"&lt;","=":"&#61;",">":"&gt;","?":"&#63;","@":"&#64;","[":"&#91;","\\":"&#92;","]":"&#93;","^":"&#94;",_:"&#95;","`":"&#96;","{":"&#123;","|":"&#124;","}":"&#125;","~":"&#126;"});var _htmlCharsRe=/[&<>"'`]/g,_hasHtmlCharsRe=new RegExp(_htmlCharsRe.source),_htmlCharsMap=utilToEnum({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"});function utilEscape(str){if(null==str)return"";var val=String(str);return val&&_hasHtmlCharsRe.test(val)?val.replace(_htmlCharsRe,(function(ch){return _htmlCharsMap[ch]})):val}var _escapedHtmlRe=/&(?:amp|#38|#x26|lt|#60|#x3c|gt|#62|#x3e|quot|#34|#x22|apos|#39|#x27|#96|#x60);/gi,_hasEscapedHtmlRe=new RegExp(_escapedHtmlRe.source,"i"),_escapedHtmlMap=utilToEnum({"&amp;":"&","&#38;":"&","&#x26;":"&","&lt;":"<","&#60;":"<","&#x3c;":"<","&gt;":">","&#62;":">","&#x3e;":">","&quot;":'"',"&#34;":'"',"&#x22;":'"',"&apos;":"'","&#39;":"'","&#x27;":"'","&#96;":"`","&#x60;":"`"});function utilUnescape(str){if(null==str)return"";var val=String(str);return val&&_hasEscapedHtmlRe.test(val)?val.replace(_escapedHtmlRe,(function(entity){return _escapedHtmlMap[entity.toLowerCase()]})):val}var _nowSource=Has.performance?performance:Date;var _cssTimeRe=/^([+-]?(?:\d*\.)?\d+)([Mm]?[Ss])$/;var utilScrubEventKey=function(){var separatorKey,decimalKey;if("undefined"!=typeof Intl&&"function"==typeof Intl.NumberFormat){var match=(new Intl.NumberFormat).format(111111.5).match(/(\D*)\d+(\D*)/);match&&(separatorKey=match[1],decimalKey=match[2])}return separatorKey||decimalKey||(separatorKey=",",decimalKey="."),function(key){switch(key){case"Scroll":return"ScrollLock";case"Spacebar":return" ";case"Left":return"ArrowLeft";case"Right":return"ArrowRight";case"Up":return"ArrowUp";case"Down":return"ArrowDown";case"Del":return"Delete";case"Crsel":return"CrSel";case"Exsel":return"ExSel";case"Esc":return"Escape";case"Apps":return"ContextMenu";case"Nonconvert":return"NonConvert";case"MediaNextTrack":return"MediaTrackNext";case"MediaPreviousTrack":return"MediaTrackPrevious";case"VolumeUp":return"AudioVolumeUp";case"VolumeDown":return"AudioVolumeDown";case"VolumeMute":return"AudioVolumeMute";case"Zoom":return"ZoomToggle";case"SelectMedia":case"MediaSelect":return"LaunchMediaPlayer";case"Add":return"+";case"Divide":return"/";case"Multiply":return"*";case"Subtract":return"-";case"Decimal":return decimalKey;case"Separator":return separatorKey}return key}}(),utilHasMediaQuery="function"!=typeof window.matchMedia?function(){return!1}:function(mediaQuery){return window.matchMedia(mediaQuery).matches};return Object.freeze(Object.defineProperties({},{getType:{value:utilGetType},isBoolean:{value:function(obj){return"boolean"==typeof obj||"string"==typeof obj&&("true"===obj||"false"===obj)}},isIterable:{value:function(obj){return null!=obj&&"function"==typeof obj[Symbol.iterator]}},isNumeric:{value:function(obj){var num;switch(_typeof(obj)){case"number":num=obj;break;case"string":num=Number(obj);break;default:return!1}return!Number.isNaN(num)&&Number.isFinite(num)}},sameValueZero:{value:function(a,b){return a===b||a!=a&&b!=b}},toEnum:{value:utilToEnum},toStringTag:{value:utilToStringTag},slugify:{value:function(str){var base=String(str).trim(),_legacy=base.replace(/[^\w\s\u2013\u2014-]+/g,"").replace(/[_\s\u2013\u2014-]+/g,"-").toLocaleLowerCase();return _isInvalidSlugRe.test(_legacy)?base.replace(_illegalSlugCharsRe,"").replace(/[_\s\u2013\u2014-]+/g,"-"):_legacy}},sanitizeFilename:{value:function(str){return String(str).trim().replace(_illegalFilenameCharsRE,"")}},escapeMarkup:{value:function(str){if(null==str)return"";var val=String(str);return val&&_hasMarkupCharsRe.test(val)?val.replace(_markupCharsRe,(function(ch){return _markupCharsMap[ch]})):val}},escape:{value:utilEscape},unescape:{value:utilUnescape},charAndPosAt:{value:function(text,position){var str=String(text),pos=Math.trunc(position),code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};var retval={char:str.charAt(pos),start:pos,end:pos};if(code<55296||code>57343)return retval;if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)return retval;var nextCode=str.charCodeAt(nextPos);return nextCode<56320||nextCode>57343||(retval.char=retval.char+str.charAt(nextPos),retval.end=nextPos),retval}if(0===pos)return retval;var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);return prevCode<55296||prevCode>56319||(retval.char=str.charAt(prevPos)+retval.char,retval.start=prevPos),retval}},now:{value:function(){return _nowSource.now()}},fromCssTime:{value:function(cssTime){var match=_cssTimeRe.exec(String(cssTime));if(null===match)throw new SyntaxError('invalid time value syntax: "'.concat(cssTime,'"'));var msec=Number(match[1]);if(1===match[2].length&&(msec*=1e3),Number.isNaN(msec)||!Number.isFinite(msec))throw new RangeError('invalid time value: "'.concat(cssTime,'"'));return msec}},toCssTime:{value:function(msec){if("number"!=typeof msec||Number.isNaN(msec)||!Number.isFinite(msec)){var what;switch(_typeof(msec)){case"string":what='"'.concat(msec,'"');break;case"number":what=String(msec);break;default:what=utilToStringTag(msec)}throw new Error("invalid milliseconds: ".concat(what))}return"".concat(msec,"ms")}},fromCssProperty:{value:function(cssName){if(!cssName.includes("-"))switch(cssName){case"bgcolor":return"backgroundColor";case"float":return"cssFloat";default:return cssName}return("-ms-"===cssName.slice(0,4)?cssName.slice(1):cssName).split("-").map((function(part,i){return 0===i?part:part.toUpperFirst()})).join("")}},parseUrl:{value:function(url){var el=document.createElement("a"),queryObj=Object.create(null);el.href=url,el.search&&el.search.replace(/^\?/,"").splitOrEmpty(/(?:&(?:amp;)?|;)/).forEach((function(query){var _query$split2=_slicedToArray(query.split("="),2),key=_query$split2[0],value=_query$split2[1];queryObj[key]=value}));var pathname=el.host&&"/"!==el.pathname[0]?"/".concat(el.pathname):el.pathname;return{href:el.href,protocol:el.protocol,host:el.host,hostname:el.hostname,port:el.port,path:"".concat(pathname).concat(el.search),pathname:pathname,query:el.search,search:el.search,queries:queryObj,searches:queryObj,hash:el.hash}}},newExceptionFrom:{value:function(original,exceptionType,override){if("object"!==_typeof(original)||null===original)throw new Error("Util.newExceptionFrom original parameter must be an object");if("function"!=typeof exceptionType)throw new Error("Util.newExceptionFrom exceptionType parameter must be an error type constructor");var ex=new exceptionType(original.message);void 0!==original.name&&(ex.name=original.name),void 0!==original.code&&(ex.code=original.code),void 0!==original.columnNumber&&(ex.columnNumber=original.columnNumber),void 0!==original.description&&(ex.description=original.description),void 0!==original.fileName&&(ex.fileName=original.fileName),void 0!==original.lineNumber&&(ex.lineNumber=original.lineNumber),void 0!==original.number&&(ex.number=original.number),void 0!==original.stack&&(ex.stack=original.stack);var overrideType=_typeof(override);if("undefined"!==overrideType)if("object"===overrideType&&null!==override)Object.assign(ex,override);else{if("string"!==overrideType)throw new Error("Util.newExceptionFrom override parameter must be an object or string");ex.message=override}return ex}},scrubEventKey:{value:utilScrubEventKey},hasMediaQuery:{value:utilHasMediaQuery},random:{value:Math.random},entityEncode:{value:utilEscape},entityDecode:{value:utilUnescape},evalExpression:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),SimpleStore=(_adapters=[],_initialized=null,Object.freeze(Object.defineProperties({},{adapters:{value:_adapters},create:{value:function(storageId,persistent){if(_initialized)return _initialized.create(storageId,persistent);for(var i=0;i<_adapters.length;++i)if(_adapters[i].init(storageId,persistent))return(_initialized=_adapters[i]).create(storageId,persistent);throw new Error("no valid storage adapters found")}}}))),_adapters,_initialized,_ok,_WebStorageAdapter;SimpleStore.adapters.push((_ok=!1,_WebStorageAdapter=function(){function _WebStorageAdapter(storageId,persistent){_classCallCheck(this,_WebStorageAdapter);var prefix="".concat(storageId,"."),engine=null,name=null;persistent?(engine=window.localStorage,name="localStorage"):(engine=window.sessionStorage,name="sessionStorage"),Object.defineProperties(this,{_engine:{value:engine},_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:name},id:{value:storageId},persistent:{value:!!persistent}})}return _createClass(_WebStorageAdapter,[{key:"length",get:function(){return this.keys().length}},{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function(){for(var keys=[],i=0;i<this._engine.length;++i){var key=this._engine.key(i);this._prefixRe.test(key)&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&this._engine.hasOwnProperty(this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=this._engine.getItem(this._prefix+key);return null==value?null:_WebStorageAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{this._engine.setItem(this._prefix+key,_WebStorageAdapter._serialize(value))}catch(ex){if(/quota.?(?:exceeded|reached)/i.test(ex.name+ex.message))throw Util.newExceptionFrom(ex,Error,"".concat(this.name," quota exceeded"));throw ex}return!0}},{key:"delete",value:function(key){return!("string"!=typeof key||!key||(this._engine.removeItem(this._prefix+key),0))}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,iend=keys.length;i<iend;++i)this.delete(keys[i]);return!0}}],[{key:"_serialize",value:function(obj){return LZString.compressToUTF16(JSON.stringify(obj))}},{key:"_deserialize",value:function(str){return JSON.parse(LZString.decompressFromUTF16(str))}}]),_WebStorageAdapter}(),Object.freeze(Object.defineProperties({},{init:{value:function(){function hasWebStorage(storeId){try{var store=window[storeId],tid="_sc_".concat(String(Date.now()));store.setItem(tid,tid);var result=store.getItem(tid)===tid;return store.removeItem(tid),result}catch(ex){}return!1}return _ok=hasWebStorage("localStorage")&&hasWebStorage("sessionStorage")}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new _WebStorageAdapter(storageId,persistent)}}})))),SimpleStore.adapters.push(function(){var _MAX_EXPIRY="Tue, 19 Jan 2038 03:14:07 GMT",_MIN_EXPIRY="Thu, 01 Jan 1970 00:00:00 GMT",_ok=!1,_CookieAdapter=function(){function _CookieAdapter(storageId,persistent){_classCallCheck(this,_CookieAdapter);var prefix="".concat(storageId).concat(persistent?"!":"*",".");Object.defineProperties(this,{_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:"cookie"},id:{value:storageId},persistent:{value:!!persistent}})}return _createClass(_CookieAdapter,[{key:"length",get:function(){return this.keys().length}},{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function(){if(""===document.cookie)return[];for(var cookies=document.cookie.split(/;\s*/),keys=[],i=0;i<cookies.length;++i){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);if(this._prefixRe.test(key))""!==decodeURIComponent(kvPair[1])&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&null!==_CookieAdapter._getCookie(this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=_CookieAdapter._getCookie(this._prefix+key);return null===value?null:_CookieAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{if(_CookieAdapter._setCookie(this._prefix+key,_CookieAdapter._serialize(value),this.persistent?"Tue, 19 Jan 2038 03:14:07 GMT":undefined),!this.has(key))throw new Error("unknown validation error during set")}catch(ex){throw Util.newExceptionFrom(ex,Error,"cookie error: ".concat(ex.message))}return!0}},{key:"delete",value:function(key){if("string"!=typeof key||!key||!this.has(key))return!1;try{if(_CookieAdapter._setCookie(this._prefix+key,undefined,_MIN_EXPIRY),this.has(key))throw new Error("unknown validation error during delete")}catch(ex){throw Util.newExceptionFrom(ex,Error,"cookie error: ".concat(ex.message))}return!0}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,iend=keys.length;i<iend;++i)this.delete(keys[i]);return!0}}],[{key:"_getCookie",value:function(prefixedKey){if(!prefixedKey||""===document.cookie)return null;for(var cookies=document.cookie.split(/;\s*/),i=0;i<cookies.length;++i){var kvPair=cookies[i].split("=");if(prefixedKey===decodeURIComponent(kvPair[0]))return decodeURIComponent(kvPair[1])||null}return null}},{key:"_setCookie",value:function(prefixedKey,value,expiry){if(prefixedKey){var payload="".concat(encodeURIComponent(prefixedKey),"=");null!=value&&(payload+=encodeURIComponent(value)),null!=expiry&&(payload+="; expires=".concat(expiry)),payload+="; path=/",document.cookie=payload}}},{key:"_serialize",value:function(obj){return LZString.compressToBase64(JSON.stringify(obj))}},{key:"_deserialize",value:function(str){return JSON.parse(LZString.decompressFromBase64(str))}}]),_CookieAdapter}();return Object.freeze(Object.defineProperties({},{init:{value:function(storageId){try{var tid="_sc_".concat(String(Date.now()));_CookieAdapter._setCookie(tid,_CookieAdapter._serialize(tid),undefined),_ok=_CookieAdapter._deserialize(_CookieAdapter._getCookie(tid))===tid,_CookieAdapter._setCookie(tid,undefined,_MIN_EXPIRY)}catch(ex){_ok=!1}return _ok&&function(storageId){if(""===document.cookie)return;for(var oldPrefix="".concat(storageId,"."),oldPrefixRe=new RegExp("^".concat(RegExp.escape(oldPrefix))),persistPrefix="".concat(storageId,"!."),sessionPrefix="".concat(storageId,"*."),sessionTestRe=/\.(?:state|rcWarn)$/,cookies=document.cookie.split(/;\s*/),i=0;i<cookies.length;++i){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);if(oldPrefixRe.test(key)){var value=decodeURIComponent(kvPair[1]);""!==value&&function(){var persist=!sessionTestRe.test(key);_CookieAdapter._setCookie(key,undefined,_MIN_EXPIRY),_CookieAdapter._setCookie(key.replace(oldPrefixRe,(function(){return persist?persistPrefix:sessionPrefix})),value,persist?_MAX_EXPIRY:undefined)}()}}}(storageId),_ok}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new _CookieAdapter(storageId,persistent)}}}))}());var DebugView=function(){function DebugView(parent,type,name,title){_classCallCheck(this,DebugView),Object.defineProperties(this,{parent:{value:parent},view:{value:document.createElement("span")},break:{value:document.createElement("wbr")}}),jQuery(this.view).attr({title:title,"aria-label":title,"data-type":null!=type?type:"","data-name":null!=name?name:""}).addClass("debug"),jQuery(this.break).addClass("debug hidden"),this.parent.appendChild(this.view),this.parent.appendChild(this.break)}return _createClass(DebugView,[{key:"output",get:function(){return this.view}},{key:"type",get:function(){return this.view.getAttribute("data-type")},set:function(type){this.view.setAttribute("data-type",null!=type?type:"")}},{key:"name",get:function(){return this.view.getAttribute("data-name")},set:function(name){this.view.setAttribute("data-name",null!=name?name:"")}},{key:"title",get:function(){return this.view.title},set:function(title){this.view.title=title}},{key:"append",value:function(el){return jQuery(this.view).append(el),this}},{key:"modes",value:function(options){if(null==options){var current={};return this.view.className.splitOrEmpty(/\s+/).forEach((function(name){"debug"!==name&&(current[name]=!0)})),current}if("object"===_typeof(options))return Object.keys(options).forEach((function(name){this[options[name]?"addClass":"removeClass"](name)}),jQuery(this.view)),this;throw new Error("DebugView.prototype.modes options parameter must be an object or null/undefined")}},{key:"remove",value:function(){var $view=jQuery(this.view);this.view.hasChildNodes()&&$view.contents().appendTo(this.parent),$view.remove(),jQuery(this.break).remove()}}],[{key:"isEnabled",value:function(){return"enabled"===jQuery(document.documentElement).attr("data-debug-view")}},{key:"enable",value:function(){jQuery(document.documentElement).attr("data-debug-view","enabled"),jQuery.event.trigger(":debugviewupdate")}},{key:"disable",value:function(){jQuery(document.documentElement).removeAttr("data-debug-view"),jQuery.event.trigger(":debugviewupdate")}},{key:"toggle",value:function(){"enabled"===jQuery(document.documentElement).attr("data-debug-view")?DebugView.disable():DebugView.enable()}}]),DebugView}(),NodeTyper=function(){var NodeTyper=function(){function NodeTyper(config){if(_classCallCheck(this,NodeTyper),"object"!==_typeof(config)||null===config)throw new Error("config parameter must be an object (received: ".concat(Util.getType(config),")"));if(!(config.hasOwnProperty("targetNode")&&config.targetNode instanceof Node))throw new Error('config parameter object "targetNode" property must be a node');Object.defineProperties(this,{node:{value:config.targetNode},childNodes:{value:[]},nodeValue:{writable:!0,value:""},appendTo:{writable:!0,value:config.parentNode||null},classNames:{writable:!0,value:config.classNames||null},finished:{writable:!0,value:!1}});var childNode,node=this.node;for(node.nodeValue&&(this.nodeValue=node.nodeValue,node.nodeValue="");null!==(childNode=node.firstChild);)this.childNodes.push(new NodeTyper({targetNode:childNode,parentNode:node,classNames:this.classNames})),node.removeChild(childNode)}return _createClass(NodeTyper,[{key:"finish",value:function(){for(;this.type(!0););return!1}},{key:"type",value:function(flush){if(this.finished)return!1;if(this.appendTo){if(this.appendTo.appendChild(this.node),this.appendTo=null,this.node.nodeType!==Node.ELEMENT_NODE&&this.node.nodeType!==Node.TEXT_NODE||"none"===jQuery(this.node.parentNode).css("display"))return this.finish();this.node.parentNode&&this.classNames&&jQuery(this.node.parentNode).addClass(this.classNames)}if(this.nodeValue){if(flush)this.node.nodeValue+=this.nodeValue,this.nodeValue="";else{var _Util$charAndPosAt=Util.charAndPosAt(this.nodeValue,0),char=_Util$charAndPosAt.char,start=_Util$charAndPosAt.start,end=_Util$charAndPosAt.end;this.node.nodeValue+=char,this.nodeValue=this.nodeValue.slice(1+end-start)}return!0}this.classNames&&(jQuery(this.node.parentNode).removeClass(this.classNames),this.classNames=null);for(var childNodes=this.childNodes;childNodes.length>0;){if(childNodes[0].type())return!0;childNodes.shift()}return this.finished=!0,!1}}]),NodeTyper}();return NodeTyper}(),PRNGWrapper=function(){function PRNGWrapper(seed,useEntropy){_classCallCheck(this,PRNGWrapper),Object.defineProperties(this,new Math.seedrandom(seed,useEntropy,(function(prng,seed){return{_prng:{value:prng},seed:{writable:!0,value:seed},pull:{writable:!0,value:0},random:{value:function(){return++this.pull,this._prng()}}}})))}return _createClass(PRNGWrapper,null,[{key:"marshal",value:function(prng){if(!prng||!prng.hasOwnProperty("seed")||!prng.hasOwnProperty("pull"))throw new Error("PRNG is missing required data");return{seed:prng.seed,pull:prng.pull}}},{key:"unmarshal",value:function(prngObj){if(!prngObj||!prngObj.hasOwnProperty("seed")||!prngObj.hasOwnProperty("pull"))throw new Error("PRNG object is missing required data");for(var prng=new PRNGWrapper(prngObj.seed,!1),i=prngObj.pull;i>0;--i)prng.random();return prng}}]),PRNGWrapper}(),StyleWrapper=(_imageMarkupRe=new RegExp(Patterns.cssImage,"g"),_hasImageMarkupRe=new RegExp(Patterns.cssImage),function(){function StyleWrapper(style){if(_classCallCheck(this,StyleWrapper),null==style)throw new TypeError("StyleWrapper style parameter must be an HTMLStyleElement object");Object.defineProperties(this,{style:{value:style}})}return _createClass(StyleWrapper,[{key:"isEmpty",value:function(){return 0===this.style.cssRules.length}},{key:"set",value:function(rawCss){this.clear(),this.add(rawCss)}},{key:"add",value:function(rawCss){var css=rawCss;_hasImageMarkupRe.test(css)&&(_imageMarkupRe.lastIndex=0,css=css.replace(_imageMarkupRe,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(markup.hasOwnProperty("error")||markup.pos<wikiImage.length)return wikiImage;var source=markup.source;if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text.trim())}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),this.style.styleSheet?this.style.styleSheet.cssText+=css:this.style.appendChild(document.createTextNode(css))}},{key:"clear",value:function(){this.style.styleSheet?this.style.styleSheet.cssText="":jQuery(this.style).empty()}}]),StyleWrapper}()),_imageMarkupRe,_hasImageMarkupRe,Diff=(Op=Util.toEnum({Delete:0,SpliceArray:1,Copy:2,CopyDate:3}),Object.freeze(Object.defineProperties({},{Op:{value:Op},diff:{value:function diff(orig,dest){for(var aOpRef,objToString=Object.prototype.toString,origIsArray=orig instanceof Array,keys=[].concat(Object.keys(orig),Object.keys(dest)).sort().filter((function(val,i,arr){return 0===i||arr[i-1]!==val})),diffed={},keyIsAOpRef=function(key){return key===aOpRef},i=0,klen=keys.length;i<klen;++i){var key=keys[i],origP=orig[key],destP=dest[key];if(orig.hasOwnProperty(key))if(dest.hasOwnProperty(key)){if(origP===destP)continue;if(_typeof(origP)===_typeof(destP))if("function"==typeof origP)origP.toString()!==destP.toString()&&(diffed[key]=[Op.Copy,destP]);else if("object"!==_typeof(origP)||null===origP)diffed[key]=[Op.Copy,destP];else{var origPType=objToString.call(origP);if(origPType===objToString.call(destP))if(origP instanceof Date)Number(origP)!==Number(destP)&&(diffed[key]=[Op.Copy,clone(destP)]);else if(origP instanceof Map)diffed[key]=[Op.Copy,clone(destP)];else if(origP instanceof RegExp)origP.toString()!==destP.toString()&&(diffed[key]=[Op.Copy,clone(destP)]);else if(origP instanceof Set)diffed[key]=[Op.Copy,clone(destP)];else if("[object Object]"!==origPType)diffed[key]=[Op.Copy,clone(destP)];else{var recurse=diff(origP,destP);null!==recurse&&(diffed[key]=recurse)}else diffed[key]=[Op.Copy,clone(destP)]}else diffed[key]=[Op.Copy,"object"!==_typeof(destP)||null===destP?destP:clone(destP)]}else if(origIsArray&&Util.isNumeric(key)){var nKey=Number(key);if(!aOpRef){aOpRef="";do{aOpRef+="~"}while(keys.some(keyIsAOpRef));diffed[aOpRef]=[Op.SpliceArray,nKey,nKey]}nKey<diffed[aOpRef][1]&&(diffed[aOpRef][1]=nKey),nKey>diffed[aOpRef][2]&&(diffed[aOpRef][2]=nKey)}else diffed[key]=Op.Delete;else diffed[key]=[Op.Copy,"object"!==_typeof(destP)||null===destP?destP:clone(destP)]}return Object.keys(diffed).length>0?diffed:null}},patch:{value:function patch(orig,diffed){for(var keys=Object.keys(diffed||{}),patched=clone(orig),i=0,klen=keys.length;i<klen;++i){var key=keys[i],diffedP=diffed[key];if(diffedP===Op.Delete)delete patched[key];else if(diffedP instanceof Array)switch(diffedP[0]){case Op.SpliceArray:patched.splice(diffedP[1],diffedP[2]-diffedP[1]+1);break;case Op.Copy:patched[key]=clone(diffedP[1]);break;case Op.CopyDate:patched[key]=new Date(diffedP[1])}else patched[key]=patch(patched[key],diffedP)}return patched}}}))),Op,L10n=(_patternRe=/\{\w+\}/g,_hasPatternRe=new RegExp(_patternRe.source),Object.freeze(Object.defineProperties({},{init:{value:function(){strings&&Object.keys(strings).length>0&&Object.keys(l10nStrings).forEach((function(id){try{var value;switch(id){case"identity":value=strings.identity;break;case"aborting":value=strings.aborting;break;case"cancel":value=strings.cancel;break;case"close":value=strings.close;break;case"ok":value=strings.ok;break;case"errorTitle":value=strings.errors.title;break;case"errorNonexistentPassage":value=strings.errors.nonexistentPassage;break;case"errorSaveMissingData":value=strings.errors.saveMissingData;break;case"errorSaveIdMismatch":value=strings.errors.saveIdMismatch;break;case"warningDegraded":value=strings.warnings.degraded;break;case"debugViewTitle":value=strings.debugView.title;break;case"debugViewToggle":value=strings.debugView.toggle;break;case"uiBarToggle":value=strings.uiBar.toggle;break;case"uiBarBackward":value=strings.uiBar.backward;break;case"uiBarForward":value=strings.uiBar.forward;break;case"uiBarJumpto":value=strings.uiBar.jumpto;break;case"jumptoTitle":value=strings.jumpto.title;break;case"jumptoTurn":value=strings.jumpto.turn;break;case"jumptoUnavailable":value=strings.jumpto.unavailable;break;case"savesTitle":value=strings.saves.title;break;case"savesDisallowed":value=strings.saves.disallowed;break;case"savesIncapable":value=strings.saves.incapable;break;case"savesLabelAuto":value=strings.saves.labelAuto;break;case"savesLabelDelete":value=strings.saves.labelDelete;break;case"savesLabelExport":value=strings.saves.labelExport;break;case"savesLabelImport":value=strings.saves.labelImport;break;case"savesLabelLoad":value=strings.saves.labelLoad;break;case"savesLabelClear":value=strings.saves.labelClear;break;case"savesLabelSave":value=strings.saves.labelSave;break;case"savesLabelSlot":value=strings.saves.labelSlot;break;case"savesUnavailable":value=strings.saves.unavailable;break;case"savesUnknownDate":value=strings.saves.unknownDate;break;case"settingsTitle":value=strings.settings.title;break;case"settingsOff":value=strings.settings.off;break;case"settingsOn":value=strings.settings.on;break;case"settingsReset":value=strings.settings.reset;break;case"restartTitle":value=strings.restart.title;break;case"restartPrompt":value=strings.restart.prompt;break;case"shareTitle":value=strings.share.title;break;case"alertTitle":break;case"autoloadTitle":value=strings.autoload.title;break;case"autoloadCancel":value=strings.autoload.cancel;break;case"autoloadOk":value=strings.autoload.ok;break;case"autoloadPrompt":value=strings.autoload.prompt;break;case"macroBackText":value=strings.macros.back.text;break;case"macroReturnText":value=strings.macros.return.text}value&&(l10nStrings[id]=value.replace(/%\w+%/g,(function(pat){return"{".concat(pat.slice(1,-1),"}")})))}catch(ex){}}))}},get:{value:function(ids,overrides){if(!ids)return"";var selectedId,id=((Array.isArray(ids)?ids:[ids]).some((function(id){return!!l10nStrings.hasOwnProperty(id)&&(selectedId=id,!0)})),selectedId);if(!id)return"";for(var processed=l10nStrings[id],iteration=0;_hasPatternRe.test(processed);){if(++iteration>50)throw new Error("L10n.get exceeded maximum replacement iterations, probable infinite loop");_patternRe.lastIndex=0,processed=processed.replace(_patternRe,(function(pat){var subId=pat.slice(1,-1);return overrides&&overrides.hasOwnProperty(subId)?overrides[subId]:l10nStrings.hasOwnProperty(subId)?l10nStrings[subId]:void 0}))}return processed}}}))),_patternRe,_hasPatternRe,strings={errors:{},warnings:{},debugView:{},uiBar:{},jumpto:{},saves:{},settings:{},restart:{},share:{},autoload:{},macros:{back:{},return:{}}},l10nStrings={identity:"game",aborting:"Aborting",cancel:"Cancel",close:"Close",ok:"OK",errorTitle:"Error",errorToggle:"Toggle the error view",errorNonexistentPassage:'the passage "{passage}" does not exist',errorSaveDiskLoadFailed:"failed to load save file from disk",errorSaveMissingData:"save is missing required data. Either the loaded file is not a save or the save has become corrupted",errorSaveIdMismatch:"save is from the wrong {identity}",_warningIntroLacking:"Your browser either lacks or has disabled",_warningOutroDegraded:", so this {identity} is running in a degraded mode. You may be able to continue, however, some parts may not work properly.",warningNoWebStorage:"{_warningIntroLacking} the Web Storage API{_warningOutroDegraded}",warningDegraded:"{_warningIntroLacking} some of the capabilities required by this {identity}{_warningOutroDegraded}",debugBarToggle:"Toggle the debug bar",debugBarNoWatches:"— no watches set —",debugBarAddWatch:"Add watch",debugBarDeleteWatch:"Delete watch",debugBarWatchAll:"Watch all",debugBarWatchNone:"Delete all",debugBarLabelAdd:"Add",debugBarLabelWatch:"Watch",debugBarLabelTurn:"Turn",debugBarLabelViews:"Views",debugBarViewsToggle:"Toggle the debug views",debugBarWatchToggle:"Toggle the watch panel",uiBarToggle:"Toggle the UI bar",uiBarBackward:"Go backward within the {identity} history",uiBarForward:"Go forward within the {identity} history",uiBarJumpto:"Jump to a specific point within the {identity} history",jumptoTitle:"Jump To",jumptoTurn:"Turn",jumptoUnavailable:"No jump points currently available…",savesTitle:"Saves",savesDisallowed:"Saving has been disallowed on this passage.",savesIncapable:"{_warningIntroLacking} the capabilities required to support saves, so saves have been disabled for this session.",savesLabelAuto:"Autosave",savesLabelDelete:"Delete",savesLabelExport:"Save to Disk…",savesLabelImport:"Load from Disk…",savesLabelLoad:"Load",savesLabelClear:"Delete All",savesLabelSave:"Save",savesLabelSlot:"Slot",savesUnavailable:"No save slots found…",savesUnknownDate:"unknown",settingsTitle:"Settings",settingsOff:"Off",settingsOn:"On",settingsReset:"Reset to Defaults",restartTitle:"Restart",restartPrompt:"Are you sure that you want to restart? Unsaved progress will be lost.",shareTitle:"Share",alertTitle:"Alert",autoloadTitle:"Autoload",autoloadCancel:"Go to start",autoloadOk:"Load autosave",autoloadPrompt:"An autosave exists. Load it now or go to the start?",macroBackText:"Back",macroReturnText:"Return"},Config=(_debug=!1,_addVisitedLinkClass=!1,_cleanupWikifierOutput=!1,_loadDelay=0,_audioPauseOnFadeToZero=!0,_audioPreloadMetadata=!0,_historyControls=!0,_historyMaxStates=40,_macrosIfAssignmentError=!0,_macrosMaxLoopIterations=1e3,_macrosTypeSkipKey=" ",_macrosTypeVisitedPassages=!0,_passagesDisplayTitles=!1,_passagesNobr=!1,_savesId="untitled-story",_savesSlots=8,_savesTryDiskOnMobile=!0,_uiStowBarInitially=800,_uiUpdateStoryElements=!0,_errHistoryModeDeprecated="Config.history.mode has been deprecated and is no longer used by SugarCube, please remove it from your code",Object.freeze({get debug(){return _debug},set debug(value){_debug=Boolean(value)},get addVisitedLinkClass(){return _addVisitedLinkClass},set addVisitedLinkClass(value){_addVisitedLinkClass=Boolean(value)},get cleanupWikifierOutput(){return _cleanupWikifierOutput},set cleanupWikifierOutput(value){_cleanupWikifierOutput=Boolean(value)},get loadDelay(){return _loadDelay},set loadDelay(value){if(!Number.isSafeInteger(value)||value<0)throw new RangeError("Config.loadDelay must be a non-negative integer");_loadDelay=value},audio:Object.freeze({get pauseOnFadeToZero(){return _audioPauseOnFadeToZero},set pauseOnFadeToZero(value){_audioPauseOnFadeToZero=Boolean(value)},get preloadMetadata(){return _audioPreloadMetadata},set preloadMetadata(value){_audioPreloadMetadata=Boolean(value)}}),history:Object.freeze({get controls(){return _historyControls},set controls(value){var controls=Boolean(value);if(1===_historyMaxStates&&controls)throw new Error("Config.history.controls must be false when Config.history.maxStates is 1");_historyControls=controls},get maxStates(){return _historyMaxStates},set maxStates(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.history.maxStates must be a positive integer");_historyMaxStates=value,_historyControls&&1===value&&(_historyControls=!1)},get mode(){throw new Error(_errHistoryModeDeprecated)},set mode(_){throw new Error(_errHistoryModeDeprecated)},get tracking(){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")},set tracking(_){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")}}),macros:Object.freeze({get ifAssignmentError(){return _macrosIfAssignmentError},set ifAssignmentError(value){_macrosIfAssignmentError=Boolean(value)},get maxLoopIterations(){return _macrosMaxLoopIterations},set maxLoopIterations(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.macros.maxLoopIterations must be a positive integer");_macrosMaxLoopIterations=value},get typeSkipKey(){return _macrosTypeSkipKey},set typeSkipKey(value){_macrosTypeSkipKey=String(value)},get typeVisitedPassages(){return _macrosTypeVisitedPassages},set typeVisitedPassages(value){_macrosTypeVisitedPassages=Boolean(value)}}),navigation:Object.freeze({get override(){return _navigationOverride},set override(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.navigation.override must be a function or null/undefined (received: ".concat(Util.getType(value),")"));_navigationOverride=value}}),passages:Object.freeze({get descriptions(){return _passagesDescriptions},set descriptions(value){if(null!=value){var valueType=Util.getType(value);if("boolean"!==valueType&&"Object"!==valueType&&"function"!==valueType)throw new TypeError("Config.passages.descriptions must be a boolean, object, function, or null/undefined (received: ".concat(valueType,")"))}_passagesDescriptions=value},get displayTitles(){return _passagesDisplayTitles},set displayTitles(value){_passagesDisplayTitles=Boolean(value)},get nobr(){return _passagesNobr},set nobr(value){_passagesNobr=Boolean(value)},get onProcess(){return _passagesOnProcess},set onProcess(value){if(null!=value){var valueType=Util.getType(value);if("function"!==valueType)throw new TypeError("Config.passages.onProcess must be a function or null/undefined (received: ".concat(valueType,")"))}_passagesOnProcess=value},get start(){return _passagesStart},set start(value){if(null!=value){var valueType=Util.getType(value);if("string"!==valueType)throw new TypeError("Config.passages.start must be a string or null/undefined (received: ".concat(valueType,")"))}_passagesStart=value},get transitionOut(){return _passagesTransitionOut},set transitionOut(value){if(null!=value){var valueType=Util.getType(value);if("string"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.passages.transitionOut must be a string, non-negative integer, or null/undefined (received: ".concat(valueType,")"))}_passagesTransitionOut=value}}),saves:Object.freeze({get autoload(){return _savesAutoload},set autoload(value){if(null!=value){var valueType=Util.getType(value);if("boolean"!==valueType&&"string"!==valueType&&"function"!==valueType)throw new TypeError("Config.saves.autoload must be a boolean, string, function, or null/undefined (received: ".concat(valueType,")"))}_savesAutoload=value},get autosave(){return _savesAutosave},set autosave(value){if(null!=value){var valueType=Util.getType(value);if("string"===valueType)return void(_savesAutosave=[value]);if("boolean"!==valueType&&("Array"!==valueType||!value.every((function(item){return"string"==typeof item})))&&"function"!==valueType)throw new TypeError("Config.saves.autosave must be a boolean, Array<string>, function, or null/undefined (received: ".concat(valueType).concat("Array"===valueType?"<any>":"",")"))}_savesAutosave=value},get id(){return _savesId},set id(value){if("string"!=typeof value||""===value)throw new TypeError("Config.saves.id must be a non-empty string (received: ".concat(Util.getType(value),")"));_savesId=value},get isAllowed(){return _savesIsAllowed},set isAllowed(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.saves.isAllowed must be a function or null/undefined (received: ".concat(Util.getType(value),")"));_savesIsAllowed=value},get slots(){return _savesSlots},set slots(value){if(!Number.isSafeInteger(value)||value<0)throw new TypeError("Config.saves.slots must be a non-negative integer (received: ".concat(Util.getType(value),")"));_savesSlots=value},get tryDiskOnMobile(){return _savesTryDiskOnMobile},set tryDiskOnMobile(value){_savesTryDiskOnMobile=Boolean(value)},get version(){return _savesVersion},set version(value){_savesVersion=value},get onLoad(){throw new Error("Config.saves.onLoad has been deprecated, use the Save.onLoad API instead")},set onLoad(value){console.warn("Config.saves.onLoad has been deprecated, use the Save.onLoad API instead"),Save.onLoad.add(value)},get onSave(){throw new Error("Config.saves.onSave has been deprecated, use the Save.onSave API instead")},set onSave(value){console.warn("Config.saves.onSave has been deprecated, use the Save.onSave API instead"),Save.onSave.add(value)}}),ui:Object.freeze({get stowBarInitially(){return _uiStowBarInitially},set stowBarInitially(value){var valueType=Util.getType(value);if("boolean"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.ui.stowBarInitially must be a boolean or non-negative integer (received: ".concat(valueType,")"));_uiStowBarInitially=value},get updateStoryElements(){return _uiUpdateStoryElements},set updateStoryElements(value){_uiUpdateStoryElements=Boolean(value)}})})),_navigationOverride,_passagesDescriptions,_passagesStart,_passagesOnProcess,_passagesTransitionOut,_savesAutoload,_savesAutosave,_savesIsAllowed,_savesVersion,_debug,_addVisitedLinkClass,_cleanupWikifierOutput,_loadDelay,_audioPauseOnFadeToZero,_audioPreloadMetadata,_historyControls,_historyMaxStates,_macrosIfAssignmentError,_macrosMaxLoopIterations,_macrosTypeSkipKey,_macrosTypeVisitedPassages,_passagesDisplayTitles,_passagesNobr,_savesId,_savesSlots,_savesTryDiskOnMobile,_uiStowBarInitially,_uiUpdateStoryElements,_errHistoryModeDeprecated,SimpleAudio=function(){var _hasPromise,_gestureEventNames=Object.freeze(["click","contextmenu","dblclick","keyup","mouseup","pointerup","touchend"]),_specialIds=Object.freeze([":not",":all",":looped",":muted",":paused",":playing"]),_formatSpecRe=/^([\w-]+)\s*\|\s*(\S.*)$/,_badIdRe=/[:\s]/,_tracks=new Map,_groups=new Map,_lists=new Map,_subscribers=new Map,_masterRate=1,_masterVolume=1,_masterMute=!1,_masterMuteOnHidden=!1,_playReturnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,Has.audio)try{var audio=document.createElement("audio");audio.muted=!0;var value=audio.play();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise}),AudioTrack=function(){function AudioTrack(obj){if(_classCallCheck(this,AudioTrack),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioTrack))throw new Error("sources parameter must be either an array, of URIs or source objects, or an AudioTrack instance");this._copy(obj)}}return _createClass(AudioTrack,[{key:"_create",value:function(sourceList){var dataUriRe=/^data:\s*audio\/(?:x-)?([^;,]+)\s*[;,]/i,extRe=/\.([^./\\]+)$/,formats=AudioTrack.formats,usedSources=[],audio=document.createElement("audio");audio.preload="none",sourceList.forEach((function(src){var srcUri=null;switch(_typeof(src)){case"string":var match;if("data:"===src.slice(0,5)){if(null===(match=dataUriRe.exec(src)))throw new Error("source data URI missing media type")}else if(null===(match=extRe.exec(Util.parseUrl(src).pathname)))throw new Error("source URL missing file extension");formats[match[1]]&&(srcUri=src);break;case"object":if(null===src)throw new Error("source object cannot be null");if(!src.hasOwnProperty("src"))throw new Error('source object missing required "src" property');if(!src.hasOwnProperty("format"))throw new Error('source object missing required "format" property');formats[src.format]&&(srcUri=src.src);break;default:throw new Error("invalid source value (type: ".concat(_typeof(src),")"))}if(null!==srcUri){var source=document.createElement("source");source.src=srcUri,audio.appendChild(source),usedSources.push(srcUri)}})),audio.hasChildNodes()&&Config.audio.preloadMetadata&&(audio.preload="metadata"),this._finalize(audio,usedSources,clone(sourceList))}},{key:"_copy",value:function(obj){this._finalize(obj.audio.cloneNode(!0),clone(obj.sources),clone(obj.originals))}},{key:"_finalize",value:function(audio,sources,originals){var _this3=this;Object.defineProperties(this,{audio:{configurable:!0,value:audio},sources:{value:Object.freeze(sources)},originals:{value:Object.freeze(originals)},_error:{writable:!0,value:!1},_faderId:{writable:!0,value:null},_mute:{writable:!0,value:!1},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1}}),jQuery(this.audio).on("loadstart.AudioTrack",(function(){return _this3._error=!1})).on("error.AudioTrack",(function(){return _this3._error=!0})).find("source:last-of-type").on("error.AudioTrack",(function(){return _this3._trigger("error")})),function(id,callback){if("function"!=typeof callback)throw new Error("callback parameter must be a function");_subscribers.set(id,callback)}(this,(function(mesg){if(_this3.audio)switch(mesg){case"loadwithscreen":if(_this3.hasSource()){var lockId=LoadScreen.lock();_this3.one("canplaythrough.AudioTrack_loadwithscreen error.AudioTrack_loadwithscreen",(function(){jQuery(this).off(".AudioTrack_loadwithscreen"),LoadScreen.unlock(lockId)})).load()}break;case"load":_this3.load();break;case"mute":_this3._updateAudioMute();break;case"rate":_this3._updateAudioRate();break;case"stop":_this3.stop();break;case"volume":_this3._updateAudioVolume();break;case"unload":_this3.unload()}else unsubscribe(_this3)})),this._updateAudioMute(),this._updateAudioRate(),this._updateAudioVolume()}},{key:"_trigger",value:function(eventName){jQuery(this.audio).triggerHandler(eventName)}},{key:"_destroy",value:function(){unsubscribe(this),this.audio&&(jQuery(this.audio).off(),this.unload(),this._error=!0,delete this.audio)}},{key:"clone",value:function(){return new AudioTrack(this)}},{key:"load",value:function(){var _this4=this;if(this.fadeStop(),this.audio.pause(),!this.audio.hasChildNodes()){if(0===this.sources.length)return;this.sources.forEach((function(srcUri){var source=document.createElement("source");source.src=srcUri,_this4.audio.appendChild(source)}))}"auto"!==this.audio.preload&&(this.audio.preload="auto"),this.isLoading()||this.audio.load()}},{key:"unload",value:function(){this.fadeStop(),this.stop();var audio=this.audio;for(audio.preload="none";audio.hasChildNodes();)audio.removeChild(audio.firstChild);audio.load()}},{key:"play",value:function(){var _this5=this;if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));"auto"!==this.audio.preload&&(this.audio.preload="auto");var namespace=".AudioTrack_play";return _playReturnsPromise()?this.audio.play():new Promise((function(resolve,reject){_this5.isPlaying()?resolve():(jQuery(_this5.audio).off(namespace).one("error".concat(namespace," playing").concat(namespace," timeupdate").concat(namespace),(function(ev){jQuery(_this5).off(namespace),"error"===ev.type?reject(new Error("unknown audio play error")):resolve()})),_this5.audio.play())}))}},{key:"playWhenAllowed",value:function(){var _this6=this;this.play().catch((function(){var gestures=_gestureEventNames.map((function(name){return"".concat(name,".AudioTrack_playWhenAllowed")})).join(" ");jQuery(document).one(gestures,(function(){jQuery(document).off(".AudioTrack_playWhenAllowed"),_this6.audio.play()}))}))}},{key:"pause",value:function(){this.audio.pause()}},{key:"stop",value:function(){this.audio.pause(),this.time(0),this._trigger(":stopped")}},{key:"fade",value:function(duration,toVol,fromVol){var _this7=this;if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));this.fadeStop();var from=Math.clamp(null==fromVol?this.volume():fromVol,0,1),to=Math.clamp(toVol,0,1);return from!==to?(this.volume(from),jQuery(this.audio).off("timeupdate.AudioTrack_fade").one("timeupdate.AudioTrack_fade",(function(){var min,max;from<to?(min=from,max=to):(min=to,max=from);var time=Math.max(duration,1),delta=(to-from)/(time/.025);_this7._trigger(":fading"),_this7._faderId=setInterval((function(){_this7.isPlaying()?(_this7.volume(Math.clamp(_this7.volume()+delta,min,max)),Config.audio.pauseOnFadeToZero&&0===_this7.volume()&&_this7.pause(),_this7.volume()===to&&(_this7.fadeStop(),_this7._trigger(":faded"))):_this7.fadeStop()}),25)})),this.play()):void 0}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this._faderId&&(clearInterval(this._faderId),this._faderId=null)}},{key:"loop",value:function(_loop){return null==_loop?this.audio.loop:(this.audio.loop=!!_loop,this)}},{key:"mute",value:function(_mute){return null==_mute?this._mute:(this._mute=!!_mute,this._updateAudioMute(),this)}},{key:"_updateAudioMute",value:function(){this.audio.muted=this._mute||_masterMute}},{key:"rate",value:function(_rate){if(null==_rate)return this._rate;if("number"!=typeof _rate)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate,.2,5),this._updateAudioRate(),this}},{key:"_updateAudioRate",value:function(){this.audio.playbackRate=Math.clamp(this._rate*_masterRate,.2,5)}},{key:"time",value:function(_time){var _this8=this;if(null==_time)return this.audio.currentTime;if("number"!=typeof _time)throw new TypeError("time parameter must be a number");return this.hasMetadata()?this.audio.currentTime=_time:jQuery(this.audio).off("loadedmetadata.AudioTrack_time").one("loadedmetadata.AudioTrack_time",(function(){return _this8.audio.currentTime=_time})),this}},{key:"volume",value:function(_volume){if(null==_volume)return this._volume;if("number"!=typeof _volume)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume,0,1),this._updateAudioVolume(),this}},{key:"_updateAudioVolume",value:function(){this.audio.volume=Math.clamp(this._volume*_masterVolume,0,1)}},{key:"duration",value:function(){return this.audio.duration}},{key:"remaining",value:function(){return this.audio.duration-this.audio.currentTime}},{key:"isFailed",value:function(){return this._error}},{key:"isLoading",value:function(){return this.audio.networkState===HTMLMediaElement.NETWORK_LOADING}},{key:"isUnloaded",value:function(){return!this.audio.hasChildNodes()}},{key:"isUnavailable",value:function(){return!this.hasSource()||this.isUnloaded()||this.isFailed()}},{key:"isPlaying",value:function(){return!this.audio.paused&&this.hasSomeData()}},{key:"isPaused",value:function(){return this.audio.paused&&(this.audio.duration===1/0||this.audio.currentTime>0)&&!this.audio.ended}},{key:"isStopped",value:function(){return this.audio.paused&&0===this.audio.currentTime}},{key:"isEnded",value:function(){return this.audio.ended}},{key:"isFading",value:function(){return null!==this._faderId}},{key:"isSeeking",value:function(){return this.audio.seeking}},{key:"hasSource",value:function(){return this.sources.length>0}},{key:"hasNoData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_NOTHING}},{key:"hasMetadata",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_METADATA}},{key:"hasSomeData",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA}},{key:"hasData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA}},{key:"on",value:function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return jQuery.fn.on.apply(jQuery(this.audio),args),this}},{key:"one",value:function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return jQuery.fn.one.apply(jQuery(this.audio),args),this}},{key:"off",value:function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return jQuery.fn.off.apply(jQuery(this.audio),args),this}}]),AudioTrack}();Object.defineProperties(AudioTrack,{formats:{value:function(){var audio=document.createElement("audio"),types=new Map;function canPlay(mimeType){return types.has(mimeType)||types.set(mimeType,""!==audio.canPlayType(mimeType).replace(/^no$/i,"")),types.get(mimeType)}return Object.assign(Object.create(null),{aac:canPlay("audio/aac"),caf:canPlay("audio/x-caf")||canPlay("audio/caf"),flac:canPlay("audio/x-flac")||canPlay("audio/flac"),mp3:canPlay('audio/mpeg; codecs="mp3"')||canPlay("audio/mpeg")||canPlay("audio/mp3")||canPlay("audio/mpa"),mpeg:canPlay("audio/mpeg"),m4a:canPlay("audio/x-m4a")||canPlay("audio/m4a")||canPlay("audio/aac"),mp4:canPlay("audio/x-mp4")||canPlay("audio/mp4")||canPlay("audio/aac"),ogg:canPlay("audio/ogg"),oga:canPlay("audio/ogg"),opus:canPlay('audio/ogg; codecs="opus"')||canPlay("audio/opus"),wav:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),wave:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),weba:canPlay("audio/webm"),webm:canPlay("audio/webm")})}()}});var AudioList=function(){function AudioList(obj){if(_classCallCheck(this,AudioList),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioList))throw new Error("tracks parameter must be either an array, of track objects, or an AudioTrack instance");this._copy(obj)}}return _createClass(AudioList,[{key:"_create",value:function(trackList){var _this9=this;this._finalize(trackList.map((function(trackObj){if("object"!==_typeof(trackObj))throw new Error("tracks parameter array members must be objects");var own,rate,track,volume;if(trackObj instanceof AudioTrack)own=!0,rate=trackObj.rate(),track=trackObj.clone(),volume=trackObj.volume();else{if(!trackObj.hasOwnProperty("track"))throw new Error('track object missing required "track" property');if(!(trackObj.track instanceof AudioTrack))throw new Error('track object\'s "track" property must be an AudioTrack object');own=trackObj.hasOwnProperty("own")&&trackObj.own,rate=trackObj.hasOwnProperty("rate")?trackObj.rate:trackObj.track.rate(),track=trackObj.track,volume=trackObj.hasOwnProperty("volume")?trackObj.volume:trackObj.track.volume()}return track.stop(),track.loop(!1),track.mute(!1),track.rate(rate),track.volume(volume),track.on("ended.AudioList",(function(){return _this9._onEnd()})),{own:own,track:track,volume:volume,rate:rate}})))}},{key:"_copy",value:function(obj){this._finalize(clone(obj.tracks))}},{key:"_finalize",value:function(tracks){Object.defineProperties(this,{tracks:{configurable:!0,value:Object.freeze(tracks)},queue:{configurable:!0,value:[]},current:{writable:!0,value:null},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1},_mute:{writable:!0,value:!1},_loop:{writable:!0,value:!1},_shuffle:{writable:!0,value:!1}})}},{key:"_destroy",value:function(){this.stop(),this.tracks.filter((function(trackObj){return trackObj.own})).forEach((function(trackObj){return trackObj.track._destroy()})),delete this.tracks,delete this.queue}},{key:"load",value:function(){this.tracks.forEach((function(trackObj){return trackObj.track.load()}))}},{key:"unload",value:function(){this.stop(),this.tracks.forEach((function(trackObj){return trackObj.track.unload()}))}},{key:"play",value:function(){return null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||(0===this.queue.length&&this._fillQueue(),this._next())?this.current.track.play():Promise.reject(new Error("no tracks were available"))}},{key:"playWhenAllowed",value:function(){var _this10=this;this.play().catch((function(){var gestures=_gestureEventNames.map((function(name){return"".concat(name,".AudioList_playWhenAllowed")})).join(" ");jQuery(document).one(gestures,(function(){jQuery(document).off(".AudioList_playWhenAllowed"),_this10.play()}))}))}},{key:"pause",value:function(){null!==this.current&&this.current.track.pause()}},{key:"stop",value:function(){null!==this.current&&(this.current.track.stop(),this.current=null),this._drainQueue()}},{key:"skip",value:function(){this._next()?this.current.track.play():this._loop&&this.play()}},{key:"fade",value:function(duration,toVol,fromVol){if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(0===this.queue.length&&this._fillQueue(),null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||this._next()){var adjFromVol,adjToVol=Math.clamp(toVol,0,1)*this.current.volume;return null!=fromVol&&(adjFromVol=Math.clamp(fromVol,0,1)*this.current.volume),this._volume=toVol,this.current.track.fade(duration,adjToVol,adjFromVol)}}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this.current&&this.current.track.fadeStop()}},{key:"loop",value:function(_loop2){return null==_loop2?this._loop:(this._loop=!!_loop2,this)}},{key:"mute",value:function(_mute2){return null==_mute2?this._mute:(this._mute=!!_mute2,null!==this.current&&this.current.track.mute(this._mute),this)}},{key:"rate",value:function(_rate2){if(null==_rate2)return this._rate;if("number"!=typeof _rate2)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate2,.2,5),null!==this.current&&this.current.track.rate(this._rate*this.current.rate),this}},{key:"shuffle",value:function(_shuffle){var _this11=this;if(null==_shuffle)return this._shuffle;if(this._shuffle=!!_shuffle,this.queue.length>0&&(this._fillQueue(),!this._shuffle&&null!==this.current&&this.queue.length>1)){var _this$queue,firstIdx=this.queue.findIndex((function(trackObj){return trackObj===_this11.current}));if(-1!==firstIdx)(_this$queue=this.queue).push.apply(_this$queue,_toConsumableArray(this.queue.splice(0,firstIdx+1)))}return this}},{key:"volume",value:function(_volume2){if(null==_volume2)return this._volume;if("number"!=typeof _volume2)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume2,0,1),null!==this.current&&this.current.track.volume(this._volume*this.current.volume),this}},{key:"duration",value:function(){if(arguments.length>0)throw new Error("duration takes no parameters");return this.tracks.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0)}},{key:"remaining",value:function(){if(arguments.length>0)throw new Error("remaining takes no parameters");var remainingTime=this.queue.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0);return null!==this.current&&(remainingTime+=this.current.track.remaining()),remainingTime}},{key:"time",value:function(){if(arguments.length>0)throw new Error("time takes no parameters");return this.duration()-this.remaining()}},{key:"isPlaying",value:function(){return null!==this.current&&this.current.track.isPlaying()}},{key:"isPaused",value:function(){return null===this.current||this.current.track.isPaused()}},{key:"isStopped",value:function(){return 0===this.queue.length&&null===this.current}},{key:"isEnded",value:function(){return 0===this.queue.length&&(null===this.current||this.current.track.isEnded())}},{key:"isFading",value:function(){return null!==this.current&&this.current.track.isFading()}},{key:"_next",value:function(){var nextTrack;for(null!==this.current&&(this.current.track.stop(),this.current=null);nextTrack=this.queue.shift();)if(!nextTrack.track.isUnavailable()){this.current=nextTrack;break}return null!==this.current&&(this.current.track.mute(this._mute),this.current.track.rate(this._rate*this.current.rate),this.current.track.volume(this._volume*this.current.volume),this.current.track.loop(!1),!0)}},{key:"_onEnd",value:function(){if(0===this.queue.length){if(!this._loop)return;this._fillQueue()}this._next()&&this.current.track.play()}},{key:"_drainQueue",value:function(){this.queue.splice(0)}},{key:"_fillQueue",value:function(){var _this$queue2;this._drainQueue(),(_this$queue2=this.queue).push.apply(_this$queue2,_toConsumableArray(this.tracks.filter((function(trackObj){return!trackObj.track.isUnavailable()})))),0!==this.queue.length&&this._shuffle&&(this.queue.shuffle(),this.queue.length>1&&this.queue[0]===this.current&&this.queue.push(this.queue.shift()))}}]),AudioList}(),AudioRunner=function(){function AudioRunner(list){if(_classCallCheck(this,AudioRunner),!(list instanceof Set||list instanceof AudioRunner))throw new TypeError("list parameter must be a Set or a AudioRunner instance");Object.defineProperties(this,{trackIds:{value:new Set(list instanceof AudioRunner?list.trackIds:list)}})}return _createClass(AudioRunner,[{key:"load",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.load)}},{key:"unload",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.unload)}},{key:"play",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.play)}},{key:"playWhenAllowed",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.playWhenAllowed)}},{key:"pause",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.pause)}},{key:"stop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.stop)}},{key:"fade",value:function(duration,toVol,fromVol){if(null==duration||null==toVol)throw new Error("fade requires parameters");AudioRunner._run(this.trackIds,AudioTrack.prototype.fade,duration,toVol,fromVol)}},{key:"fadeIn",value:function(duration,fromVol){if(null==duration)throw new Error("fadeIn requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeIn,duration,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){if(null==duration)throw new Error("fadeOut requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeOut,duration,fromVol)}},{key:"fadeStop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeStop)}},{key:"loop",value:function(_loop3){if(null==_loop3)throw new Error("loop requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.loop,_loop3),this}},{key:"mute",value:function(_mute3){if(null==_mute3)throw new Error("mute requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.mute,_mute3),this}},{key:"rate",value:function(_rate3){if(null==_rate3)throw new Error("rate requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.rate,_rate3),this}},{key:"time",value:function(_time2){if(null==_time2)throw new Error("time requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.time,_time2),this}},{key:"volume",value:function(_volume3){if(null==_volume3)throw new Error("volume requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.volume,_volume3),this}},{key:"on",value:function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.on].concat(args)),this}},{key:"one",value:function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.one].concat(args)),this}},{key:"off",value:function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.off].concat(args)),this}}],[{key:"_run",value:function(ids,fn){for(var _len11=arguments.length,args=new Array(_len11>2?_len11-2:0),_key11=2;_key11<_len11;_key11++)args[_key11-2]=arguments[_key11];ids.forEach((function(id){var track=_tracks.get(id);track&&fn.apply(track,args)}))}}]),AudioRunner}();var _runnerParseSelector=function(){var notWsRe=/\S/g,parenRe=/[()]/g;function processNegation(str,startPos){var match;if(notWsRe.lastIndex=startPos,null===(match=notWsRe.exec(str))||"("!==match[0])throw new Error('invalid ":not()" syntax: missing parentheticals');parenRe.lastIndex=notWsRe.lastIndex;for(var start=notWsRe.lastIndex,result={str:"",nextMatch:-1},depth=1;null!==(match=parenRe.exec(str));)if("("===match[0]?++depth:--depth,depth<1){result.nextMatch=parenRe.lastIndex,result.str=str.slice(start,result.nextMatch-1);break}return result}return function parseSelector(idArg){for(var match,ids=[],idRe=/:?[^\s:()]+/g;null!==(match=idRe.exec(idArg));){var id=match[0];if(":not"===id){if(0===ids.length)throw new Error('invalid negation: no group ID preceded ":not()"');var parent=ids[ids.length-1];if(":"!==parent.id[0])throw new Error('invalid negation of track "'.concat(parent.id,'": only groups may be negated with ":not()"'));var negation=processNegation(idArg,idRe.lastIndex);if(-1===negation.nextMatch)throw new Error('unknown error parsing ":not()"');idRe.lastIndex=negation.nextMatch,parent.not=parseSelector(negation.str)}else ids.push({id:id})}return ids}}();function masterMute(mute){if(null==mute)return _masterMute;publish("mute",_masterMute=!!mute)}function unsubscribe(id){_subscribers.delete(id)}function publish(mesg,data){_subscribers.forEach((function(fn){return fn(mesg,data)}))}function _newTrack(sources){return new AudioTrack(sources.map((function(source){if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);if(passage.tags.includes("Twine.audio"))return passage.text.trim()}var match=_formatSpecRe.exec(source);return null===match?source:{format:match[1],src:match[2]}})))}return Object.freeze(Object.defineProperties({},{tracks:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("track ID"),arguments.length<2&&errors.push("sources"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='track ID "'.concat(id,'"');if(_badIdRe.test(id))throw new Error("invalid ".concat(what,": track IDs must not contain colons or whitespace"));var track,sources=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{track=_newTrack(sources)}catch(ex){throw new Error("".concat(what,": error during track initialization: ").concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("".concat(what,": no supported audio sources found"));_tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.set(id,track)}},delete:{value:function(id){return _tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.delete(id)}},clear:{value:function(){_tracks.forEach((function(track){return track._destroy()})),_tracks.clear()}},has:{value:function(id){return _tracks.has(id)}},get:{value:function(id){return _tracks.get(id)||null}}}))},groups:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("group ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='group ID "'.concat(id,'"');if(":"!==id[0]||_badIdRe.test(id.slice(1)))throw new Error("invalid ".concat(what,": group IDs must start with a colon and must not contain colons or whitespace"));if(_specialIds.includes(id))throw new Error("cannot clobber special ".concat(what));var group,trackIds=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{group=new Set(trackIds.map((function(trackId){if(!_tracks.has(trackId))throw new Error('track "'.concat(trackId,'" does not exist'));return trackId})))}catch(ex){throw new Error("".concat(what,": error during group initialization: ").concat(ex.message))}_groups.set(id,Object.freeze(Array.from(group)))}},delete:{value:function(id){return _groups.delete(id)}},clear:{value:function(){_groups.clear()}},has:{value:function(id){return _groups.has(id)}},get:{value:function(id){return _groups.get(id)||null}}}))},lists:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("list ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='list ID "'.concat(id,'"');if(_badIdRe.test(id))return this.error("invalid ".concat(what,": list IDs must not contain colons or whitespace"));var list,descriptors=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{list=new AudioList(descriptors.map((function(desc){if(null===desc)throw new Error("track descriptor must be a string or object (type: null)");switch(_typeof(desc)){case"string":desc={id:desc};break;case"object":if(!desc.hasOwnProperty("id")&&!desc.hasOwnProperty("sources"))throw new Error('track descriptor must contain one of either an "id" or a "sources" property');if(desc.hasOwnProperty("id")&&desc.hasOwnProperty("sources"))throw new Error('track descriptor must contain either an "id" or a "sources" property, not both');break;default:throw new Error("track descriptor must be a string or object (type: ".concat(_typeof(desc),")"))}var own,track,volume;if(desc.hasOwnProperty("id")){if("string"!=typeof desc.id)throw new Error('"id" property must be a string');if(!_tracks.has(desc.id))throw new Error('track "'.concat(desc.id,'" does not exist'));track=_tracks.get(desc.id)}else if(desc.hasOwnProperty("sources")){if(!Array.isArray(desc.sources)||0===desc.sources.length)throw new Error('"sources" property must be a non-empty array');if(desc.hasOwnProperty("own"))throw new Error('"own" property is not allowed with the "sources" property');try{track=_newTrack(desc.sources),own=!0}catch(ex){throw new Error("error during track initialization: ".concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("no supported audio sources found")}if(desc.hasOwnProperty("own")){if("boolean"!=typeof desc.own)throw new Error('"own" property must be a boolean');(own=desc.own)&&(track=track.clone())}if(desc.hasOwnProperty("volume")){if("number"!=typeof desc.volume||Number.isNaN(desc.volume)||!Number.isFinite(desc.volume)||desc.volume<0)throw new Error('"volume" property must be a non-negative finite number');volume=desc.volume}return{own:null!=own&&own,track:track,volume:null!=volume?volume:track.volume()}})))}catch(ex){throw new Error("".concat(what,": error during playlist initialization: ").concat(ex.message))}_lists.has(id)&&_lists.get(id)._destroy(),_lists.set(id,list)}},delete:{value:function(id){return _lists.has(id)&&_lists.get(id)._destroy(),_lists.delete(id)}},clear:{value:function(){_lists.forEach((function(list){return list._destroy()})),_lists.clear()}},has:{value:function(id){return _lists.has(id)}},get:{value:function(id){return _lists.get(id)||null}}}))},select:{value:function(){if(0===arguments.length)throw new Error("no track selector specified");var selector=String(arguments[0]).trim(),trackIds=new Set;try{var renderIds=function renderIds(idObj){var ids,id=idObj.id;switch(id){case":all":ids=allIds;break;case":looped":ids=allIds.filter((function(id){return _tracks.get(id).loop()}));break;case":muted":ids=allIds.filter((function(id){return _tracks.get(id).mute()}));break;case":paused":ids=allIds.filter((function(id){return _tracks.get(id).isPaused()}));break;case":playing":ids=allIds.filter((function(id){return _tracks.get(id).isPlaying()}));break;default:ids=":"===id[0]?_groups.get(id):[id]}if(idObj.hasOwnProperty("not")){var negated=idObj.not.map((function(idObj){return renderIds(idObj)})).flat(1/0);ids=ids.filter((function(id){return!negated.includes(id)}))}return ids},allIds=Array.from(_tracks.keys());_runnerParseSelector(selector).forEach((function(idObj){return renderIds(idObj).forEach((function(id){if(!_tracks.has(id))throw new Error('track "'.concat(id,'" does not exist'));trackIds.add(id)}))}))}catch(ex){throw new Error("error during runner initialization: ".concat(ex.message))}return new AudioRunner(trackIds)}},load:{value:function(){publish("load")}},loadWithScreen:{value:function(){publish("loadwithscreen")}},mute:{value:masterMute},muteOnHidden:{value:function(mute){if(!Visibility.isEnabled())return!1;if(null==mute)return _masterMuteOnHidden;var namespace=".SimpleAudio_masterMuteOnHidden";if(_masterMuteOnHidden=!!mute){var visibilityChange="".concat(Visibility.changeEvent).concat(namespace);jQuery(document).off(namespace).on(visibilityChange,(function(){return masterMute(Visibility.isHidden())})),Visibility.isHidden()&&masterMute(!0)}else jQuery(document).off(namespace)}},rate:{value:function(rate){if(null==rate)return _masterRate;if("number"!=typeof rate||Number.isNaN(rate)||!Number.isFinite(rate))throw new Error("rate must be a finite number");publish("rate",_masterRate=Math.clamp(rate,.2,5))}},stop:{value:function(){publish("stop")}},unload:{value:function(){publish("unload")}},volume:{value:function(volume){if(null==volume)return _masterVolume;if("number"!=typeof volume||Number.isNaN(volume)||!Number.isFinite(volume))throw new Error("volume must be a finite number");publish("volume",_masterVolume=Math.clamp(volume,0,1))}}}))}(),State=function(){var _history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null,_tempVariables={};function stateMarshal(noDelta){var stateObj={index:_activeIndex};return noDelta?stateObj.history=clone(_history):stateObj.delta=historyDeltaEncode(_history),_expired.length>0&&(stateObj.expired=_toConsumableArray(_expired)),null!==_prng&&(stateObj.seed=_prng.seed),stateObj}function stateUnmarshal(stateObj,noDelta){if(null==stateObj)throw new Error("state object is null or undefined");if(!stateObj.hasOwnProperty(noDelta?"history":"delta")||0===stateObj[noDelta?"history":"delta"].length)throw new Error("state object has no history or history is empty");if(!stateObj.hasOwnProperty("index"))throw new Error("state object has no index");if(null!==_prng&&!stateObj.hasOwnProperty("seed"))throw new Error("state object has no seed, but PRNG is enabled");if(null===_prng&&stateObj.hasOwnProperty("seed"))throw new Error("state object has seed, but PRNG is disabled");_history=noDelta?clone(stateObj.history):historyDeltaDecode(stateObj.delta),_activeIndex=stateObj.index,_expired=stateObj.hasOwnProperty("expired")?_toConsumableArray(stateObj.expired):[],stateObj.hasOwnProperty("seed")&&(_prng.seed=stateObj.seed),momentActivate(_activeIndex)}function momentCreate(title,variables){return{title:null==title?"":String(title),variables:null==variables?{}:clone(variables)}}function momentActivate(moment){if(null==moment)throw new Error("moment activation attempted with null or undefined");switch(_typeof(moment)){case"object":_active=clone(moment);break;case"number":if(historyIsEmpty())throw new Error("moment activation attempted with index on empty history");if(moment<0||moment>=historySize())throw new RangeError("moment activation attempted with out-of-bounds index; need [0, ".concat(historySize()-1,"], got ").concat(moment));_active=clone(_history[moment]);break;default:throw new TypeError('moment activation attempted with a "'.concat(_typeof(moment),'"; must be an object or valid history stack index'))}return null!==_prng&&(_prng=PRNGWrapper.unmarshal({seed:_prng.seed,pull:_active.pull})),session.set("state",stateMarshal()),jQuery.event.trigger(":historyupdate"),_active}function historyLength(){return _activeIndex+1}function historySize(){return _history.length}function historyIsEmpty(){return 0===_history.length}function historyTop(){return _history.length>0?_history[_history.length-1]:null}function historyGoTo(index){return!(null==index||index<0||index>=historySize()||index===_activeIndex)&&(momentActivate(_activeIndex=index),!0)}function historyDeltaEncode(historyArr){if(!Array.isArray(historyArr))return null;if(0===historyArr.length)return[];for(var delta=[historyArr[0]],i=1,iend=historyArr.length;i<iend;++i)delta.push(Diff.diff(historyArr[i-1],historyArr[i]));return delta}function historyDeltaDecode(delta){if(!Array.isArray(delta))return null;if(0===delta.length)return[];for(var historyArr=[clone(delta[0])],i=1,iend=delta.length;i<iend;++i)historyArr.push(Diff.patch(historyArr[i-1],delta[i]));return historyArr}function prngInit(seed,useEntropy){var scriptSection;if(!historyIsEmpty())throw scriptSection="the Story JavaScript",new Error("State.prng.init must be called during initialization, within either ".concat(scriptSection," or the StoryInit special passage"));_prng=new PRNGWrapper(seed,useEntropy),_active.pull=_prng.pull}function metadataDelete(key){if("string"!=typeof key)throw new TypeError("State.metadata.delete key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");store&&store.hasOwnProperty(key)&&(1===Object.keys(store).length?storage.delete("metadata"):(delete store[key],storage.set("metadata",store)))}return Object.freeze(Object.defineProperties({},{reset:{value:function(){session.delete("state"),_history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null===_prng?null:new PRNGWrapper(_prng.seed,!1)}},restore:{value:function(){if(session.has("state")){var stateObj=session.get("state");return null!=stateObj&&(stateUnmarshal(stateObj),!0)}return!1}},marshalForSave:{value:function(){return stateMarshal(!0)}},unmarshalForSave:{value:function(stateObj){return stateUnmarshal(stateObj,!0)}},expired:{get:function(){return _expired}},turns:{get:function(){return _expired.length+historyLength()}},passages:{get:function(){return _expired.concat(_history.slice(0,historyLength()).map((function(moment){return moment.title})))}},hasPlayed:{value:function(title){return null!=title&&""!==title&&(!!_expired.includes(title)||!!_history.slice(0,historyLength()).some((function(moment){return moment.title===title})))}},active:{get:function(){return _active}},activeIndex:{get:function(){return _activeIndex}},passage:{get:function(){return _active.title}},variables:{get:function(){return _active.variables}},history:{get:function(){return _history}},length:{get:historyLength},size:{get:historySize},isEmpty:{value:historyIsEmpty},current:{get:function(){return _history.length>0?_history[_activeIndex]:null}},top:{get:historyTop},bottom:{get:function(){return _history.length>0?_history[0]:null}},index:{value:function(index){return historyIsEmpty()||index<0||index>_activeIndex?null:_history[index]}},peek:{value:function(offset){if(historyIsEmpty())return null;var lengthOffset=1+(offset?Math.abs(offset):0);return lengthOffset>historyLength()?null:_history[historyLength()-lengthOffset]}},has:{value:function(title){if(historyIsEmpty()||null==title||""===title)return!1;for(var i=_activeIndex;i>=0;--i)if(_history[i].title===title)return!0;return!1}},create:{value:function(title){for(0,historyLength()<historySize()&&_history.splice(historyLength(),historySize()-historyLength()),_history.push(momentCreate(title,_active.variables)),_prng&&(historyTop().pull=_prng.pull);historySize()>Config.history.maxStates;)_expired.push(_history.shift().title);return momentActivate(_activeIndex=historySize()-1),historyLength()}},goTo:{value:historyGoTo},go:{value:function(offset){return null!=offset&&0!==offset&&historyGoTo(_activeIndex+offset)}},deltaEncode:{value:historyDeltaEncode},deltaDecode:{value:historyDeltaDecode},prng:{value:Object.freeze(Object.defineProperties({},{init:{value:prngInit},isEnabled:{value:function(){return null!==_prng}},pull:{get:function(){return _prng?_prng.pull:NaN}},seed:{get:function(){return _prng?_prng.seed:null}}}))},random:{value:function(){return _prng?_prng.random():Math.random()}},clearTemporary:{value:function(){TempVariables=_tempVariables={}}},temporary:{get:function(){return _tempVariables}},getVar:{value:function(varExpression){try{return Scripting.evalTwineScript(varExpression)}catch(ex){}}},setVar:{value:function(varExpression,value){try{return Scripting.evalTwineScript("".concat(varExpression," = evalTwineScript$Data$"),null,value),!0}catch(ex){}return!1}},metadata:{value:Object.freeze(Object.defineProperties({},{clear:{value:function(){storage.delete("metadata")}},delete:{value:metadataDelete},entries:{value:function(){var store=storage.get("metadata");return store&&Object.entries(store)}},get:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.get key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");return store&&store.hasOwnProperty(key)?store[key]:undefined}},has:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.has key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");return store&&store.hasOwnProperty(key)}},keys:{value:function(){var store=storage.get("metadata");return store&&Object.keys(store)}},set:{value:function(key,value){if("string"!=typeof key)throw new TypeError("State.metadata.set key parameter must be a string (received: ".concat(_typeof(key),")"));if(void 0===value)metadataDelete(key);else{var store=storage.get("metadata")||{};store[key]=value,storage.set("metadata",store)}}},size:{get:function(){var store=storage.get("metadata");return store?Object.keys(store).length:0}}}))},initPRNG:{value:prngInit},restart:{value:function(){return Engine.restart()}},backward:{value:function(){return Engine.backward()}},forward:{value:function(){return Engine.forward()}},display:{value:function(){return Engine.display.apply(Engine,arguments)}},show:{value:function(){return Engine.show.apply(Engine,arguments)}},play:{value:function(){return Engine.play.apply(Engine,arguments)}}}))}(),Scripting=function(){function addAccessibleClickHandler(targets,selector,handler,one,namespace){if(arguments.length<2)throw new Error("addAccessibleClickHandler insufficient number of parameters");var fn,opts;if("function"==typeof selector?(fn=selector,opts={namespace:one,one:!!handler}):(fn=handler,opts={namespace:namespace,one:!!one,selector:selector}),"function"!=typeof fn)throw new TypeError("addAccessibleClickHandler handler parameter must be a function");return jQuery(targets).ariaClick(opts,fn)}function insertElement(place,type,id,classNames,text,title){var $el=jQuery(document.createElement(type));return id&&$el.attr("id",id),classNames&&$el.addClass(classNames),title&&$el.attr("title",title),text&&$el.text(text),place&&$el.appendTo(place),$el[0]}function insertText(place,text){jQuery(place).append(document.createTextNode(text))}function removeChildren(node){jQuery(node).empty()}function removeElement(node){jQuery(node).remove()}function fade(el,options){var current,intervalId,direction="in"===options.fade?1:-1,proxy=el.cloneNode(!0);function setOpacity(el,opacity){el.style.zoom=1,el.style.filter="alpha(opacity=".concat(Math.floor(100*opacity),")"),el.style.opacity=opacity}el.parentNode.replaceChild(proxy,el),"in"===options.fade?(current=0,proxy.style.visibility="visible"):current=1,setOpacity(proxy,current),intervalId=window.setInterval((function(){current+=.05*direction,setOpacity(proxy,Math.easeInOut(current)),(1===direction&&current>=1||-1===direction&&current<=0)&&(el.style.visibility="in"===options.fade?"visible":"hidden",proxy.parentNode.replaceChild(el,proxy),proxy=null,window.clearInterval(intervalId),options.onComplete&&options.onComplete())}),25)}function scrollWindowTo(el,incrementBy){var increment=null!=incrementBy?Number(incrementBy):.1;Number.isNaN(increment)||!Number.isFinite(increment)||increment<0?increment=.1:increment>1&&(increment=1);var intervalId,start=window.scrollY?window.scrollY:document.body.scrollTop,end=function(el){var posTop=function(el){var curtop=0;for(;el.offsetParent;)curtop+=el.offsetTop,el=el.offsetParent;return curtop}(el),posBottom=posTop+el.offsetHeight,winTop=window.scrollY?window.scrollY:document.body.scrollTop,winHeight=window.innerHeight?window.innerHeight:document.body.clientHeight,winBottom=winTop+winHeight;return posTop>=winTop&&posBottom>winBottom&&el.offsetHeight<winHeight?posTop-(winHeight-el.offsetHeight)+20:posTop}(el),distance=Math.abs(start-end),direction=start>end?-1:1,progress=0;intervalId=window.setInterval((function(){progress+=increment,window.scroll(0,start+direction*(distance*Math.easeInOut(progress))),progress>=1&&window.clearInterval(intervalId)}),25)}function toStringOrDefault(value){return stringFrom(value)}function either(){if(0!==arguments.length)return Array.prototype.concat.apply([],arguments).random()}function forget(key){if("string"!=typeof key)throw new TypeError("forget key parameter must be a string (received: ".concat(Util.getType(key),")"));State.metadata.delete(key)}function hasVisited(){if(0===arguments.length)throw new Error("hasVisited called with insufficient parameters");if(State.isEmpty())return!1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,i=0,iend=needles.length;i<iend;++i)if(!played.includes(needles[i]))return!1;return!0}function lastVisited(){if(0===arguments.length)throw new Error("lastVisited called with insufficient parameters");if(State.isEmpty())return-1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,uBound=played.length-1,turns=State.turns,i=0,iend=needles.length;i<iend&&turns>-1;++i){var lastIndex=played.lastIndexOf(needles[i]);turns=Math.min(turns,-1===lastIndex?-1:uBound-lastIndex)}return turns}function memorize(key,value){if("string"!=typeof key)throw new TypeError("memorize key parameter must be a string (received: ".concat(Util.getType(key),")"));State.metadata.set(key,value)}function passage(){return State.passage}function previous(){var passages=State.passages;if(arguments.length>0){var offset=Number(arguments[0]);if(!Number.isSafeInteger(offset)||offset<1)throw new RangeError("previous offset parameter must be a positive integer greater than zero");return passages.length>offset?passages[passages.length-1-offset]:""}for(var i=passages.length-2;i>=0;--i)if(passages[i]!==State.passage)return passages[i];return""}function random(){var min,max;switch(arguments.length){case 0:throw new Error("random called with insufficient parameters");case 1:min=0,max=Math.trunc(arguments[0]);break;default:min=Math.trunc(arguments[0]),max=Math.trunc(arguments[1])}if(!Number.isInteger(min))throw new Error("random min parameter must be an integer");if(!Number.isInteger(max))throw new Error("random max parameter must be an integer");if(min>max){var _ref6=[max,min];min=_ref6[0],max=_ref6[1]}return Math.floor(State.random()*(max-min+1))+min}function randomFloat(){var min,max;switch(arguments.length){case 0:throw new Error("randomFloat called with insufficient parameters");case 1:min=0,max=Number(arguments[0]);break;default:min=Number(arguments[0]),max=Number(arguments[1])}if(Number.isNaN(min)||!Number.isFinite(min))throw new Error("randomFloat min parameter must be a number");if(Number.isNaN(max)||!Number.isFinite(max))throw new Error("randomFloat max parameter must be a number");if(min>max){var _ref7=[max,min];min=_ref7[0],max=_ref7[1]}return State.random()*(max-min)+min}function recall(key,defaultValue){if("string"!=typeof key)throw new TypeError("recall key parameter must be a string (received: ".concat(Util.getType(key),")"));return State.metadata.has(key)?State.metadata.get(key):defaultValue}function tags(){if(0===arguments.length)return Story.get(State.passage).tags.slice(0);for(var passages=Array.prototype.concat.apply([],arguments),tags=[],i=0,iend=passages.length;i<iend;++i)tags=tags.concat(Story.get(passages[i]).tags);return tags}function temporary(){return State.temporary}function time(){return null===Engine.lastPlay?0:Util.now()-Engine.lastPlay}function turns(){return State.turns}function variables(){return State.variables}function visited(){if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],0===arguments.length?[State.passage]:arguments),played=State.passages,count=State.turns,i=0,iend=needles.length;i<iend&&count>0;++i)count=Math.min(count,played.count(needles[i]));return count}function visitedTags(){if(0===arguments.length)throw new Error("visitedTags called with insufficient parameters");if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],arguments),nLength=needles.length,played=State.passages,seen=new Map,count=0,i=0,iend=played.length;i<iend;++i){var title=played[i];if(seen.has(title))seen.get(title)&&++count;else{var _tags2=Story.get(title).tags;if(_tags2.length>0){for(var found=0,j=0;j<nLength;++j)_tags2.includes(needles[j])&&++found;found===nLength?(++count,seen.set(title,!0)):seen.set(title,!1)}}}return count}var _ref8=function(){function slugifyUrl(url){return Util.parseUrl(url).path.replace(/^[^\w]+|[^\w]+$/g,"").replace(/[^\w]+/g,"-").toLocaleLowerCase()}function addScript(url){return new Promise((function(resolve,reject){jQuery(document.createElement("script")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importScripts failed to load the script "'.concat(url,'".')))})).appendTo(document.head).attr({id:"script-imported-".concat(slugifyUrl(url)),type:"text/javascript",src:url})}))}function addStyle(url){return new Promise((function(resolve,reject){jQuery(document.createElement("link")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importStyles failed to load the stylesheet "'.concat(url,'".')))})).appendTo(document.head).attr({id:"style-imported-".concat(slugifyUrl(url)),rel:"stylesheet",href:url})}))}function sequence(callbacks){return callbacks.reduce((function(seq,fn){return seq.then(fn)}),Promise.resolve())}return{importScripts:function(){for(var _len12=arguments.length,urls=new Array(_len12),_key12=0;_key12<_len12;_key12++)urls[_key12]=arguments[_key12];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addScript(url)}}))):addScript(oneOrSeries)})))},importStyles:function(){for(var _len13=arguments.length,urls=new Array(_len13),_key13=0;_key13<_len13;_key13++)urls[_key13]=arguments[_key13];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addStyle(url)}}))):addStyle(oneOrSeries)})))}}}(),importScripts=_ref8.importScripts,importStyles=_ref8.importStyles,parse=function(){var tokenTable=Util.toEnum({$:"State.variables.",_:"State.temporary.",to:"=",eq:"==",neq:"!=",is:"===",isnot:"!==",gt:">",gte:">=",lt:"<",lte:"<=",and:"&&",or:"||",not:"!",def:'"undefined" !== typeof',ndef:'"undefined" === typeof'}),parseRe=new RegExp(["(?:\"\"|''|``)",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(`(?:\\\\.|[^`\\\\])+`)","(?:[=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}]+)","([^\"'=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}\\s]+)"].join("|"),"g"),notSpaceRe=/\S/,varTest=new RegExp("^".concat(Patterns.variable)),withColonTestRe=/^\s*:/,withNotTestRe=/^\s+not\b/;function parse(rawCodeString){if(0!==parseRe.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start");for(var match,code=rawCodeString;null!==(match=parseRe.exec(code));)if(match[1]){var rawTemplate=match[1],parsedTemplate=parseTemplate(rawTemplate);parsedTemplate!==rawTemplate&&(code=code.splice(match.index,rawTemplate.length,parsedTemplate),parseRe.lastIndex+=parsedTemplate.length-rawTemplate.length)}else if(match[2]){var token=match[2];if("$"===token||"_"===token)continue;if(varTest.test(token))token=token[0];else if("is"===token){var start=parseRe.lastIndex,ahead=code.slice(start);withNotTestRe.test(ahead)&&(code=code.splice(start,ahead.search(notSpaceRe)),token="isnot")}else{var _ahead=code.slice(parseRe.lastIndex);if(withColonTestRe.test(_ahead))continue}tokenTable[token]&&(code=code.splice(match.index,token.length,tokenTable[token]),parseRe.lastIndex+=tokenTable[token].length-token.length)}return code}var templateGroupStartRe=/\$\{/g,templateGroupParseRe=new RegExp(["(?:\"\"|'')",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(\\{)","(\\})"].join("|"),"g");function parseTemplate(rawTemplateLiteral){if(0!==templateGroupStartRe.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start of template literal");for(var startMatch,template=rawTemplateLiteral;null!==(startMatch=templateGroupStartRe.exec(template));){var startIdx=startMatch.index+2,endIdx=startIdx,depth=1,endMatch=void 0;for(templateGroupParseRe.lastIndex=startIdx;null!==(endMatch=templateGroupParseRe.exec(template));)if(endMatch[1]?++depth:endMatch[2]&&--depth,0===depth){endIdx=endMatch.index;break}if(endIdx>startIdx){var parseIndex=parseRe.lastIndex,rawGroup=template.slice(startIdx,endIdx);parseRe.lastIndex=0;var parsedGroup=parse(rawGroup);parseRe.lastIndex=parseIndex,template=template.splice(startIdx,rawGroup.length,parsedGroup),templateGroupStartRe.lastIndex+=parsedGroup.length-rawGroup.length}}return template}return parse}();function evalJavaScript(code,output,data){return function(code,output,evalJavaScript$Data$){return eval(code)}.call(output?{output:output}:null,String(code),output,data)}function evalTwineScript(code,output,data){return function(code,output,evalTwineScript$Data$){return eval(code)}.call(output?{output:output}:null,parse(String(code)),output,data)}return Object.freeze(Object.defineProperties({},{parse:{value:parse},evalJavaScript:{value:evalJavaScript},evalTwineScript:{value:evalTwineScript}}))}(),_ref9=function(){var Lexer=function(){function Lexer(source,initialState){if(_classCallCheck(this,Lexer),arguments.length<2)throw new Error("Lexer constructor called with too few parameters (source:string , initialState:function)");Object.defineProperties(this,{source:{value:source},initial:{value:initialState},state:{writable:!0,value:initialState},start:{writable:!0,value:0},pos:{writable:!0,value:0},depth:{writable:!0,value:0},items:{writable:!0,value:[]},data:{writable:!0,value:{}}})}return _createClass(Lexer,[{key:"reset",value:function(){this.state=this.initial,this.start=0,this.pos=0,this.depth=0,this.items=[],this.data={}}},{key:"run",value:function(){for(;null!==this.state;)this.state=this.state(this);return this.items}},{key:"nextItem",value:function(){for(;0===this.items.length&&null!==this.state;)this.state=this.state(this);return this.items.shift()}},{key:"next",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos++]}},{key:"peek",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos]}},{key:"backup",value:function(num){this.pos-=num||1}},{key:"forward",value:function(num){this.pos+=num||1}},{key:"ignore",value:function(){this.start=this.pos}},{key:"accept",value:function(valid){var ch=this.next();return-1!==ch&&(!!valid.includes(ch)||(this.backup(),!1))}},{key:"acceptRe",value:function(validRe){var ch=this.next();return-1!==ch&&(!!validRe.test(ch)||(this.backup(),!1))}},{key:"acceptRun",value:function(valid){for(;;){var ch=this.next();if(-1===ch)return;if(!valid.includes(ch))break}this.backup()}},{key:"acceptRunRe",value:function(validRe){for(;;){var ch=this.next();if(-1===ch)return;if(!validRe.test(ch))break}this.backup()}},{key:"emit",value:function(type){this.items.push({type:type,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),this.start=this.pos}},{key:"error",value:function(type,message){if(arguments.length<2)throw new Error("Lexer.prototype.error called with too few parameters (type:number , message:string)");return this.items.push({type:type,message:message,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),null}}],[{key:"enumFromNames",value:function(names){var obj=names.reduce((function(obj,name,i){return obj[name]=i,obj}),{});return Object.freeze(Object.assign(Object.create(null),obj))}}]),Lexer}();return{EOF:-1,Lexer:Lexer}}(),EOF=_ref9.EOF,Lexer=_ref9.Lexer,Wikifier=function(){var _optionsStack,lookaheadRe,idOrClassRe,_callDepth=0,Wikifier=function(){function Wikifier(destination,source,options){_classCallCheck(this,Wikifier),Wikifier.Parser.Profile.isEmpty()&&Wikifier.Parser.Profile.compile(),Object.defineProperties(this,{source:{value:String(source)},options:{writable:!0,value:Object.assign({profile:"all"},options)},nextMatch:{writable:!0,value:0},output:{writable:!0,value:null},_rawArgs:{writable:!0,value:""}}),null==destination?this.output=document.createDocumentFragment():destination.jquery?this.output=destination[0]:this.output=destination;try{++_callDepth,this.subWikify(this.output),1===_callDepth&&Config.cleanupWikifierOutput&&convertBreaks(this.output)}finally{--_callDepth}}return _createClass(Wikifier,[{key:"subWikify",value:function(output,terminator,options){var newOptions,oldOptions,oldOutput=this.output;this.output=output,Wikifier.Option.length>0&&(newOptions=Object.assign(newOptions||{},Wikifier.Option.options)),null!==options&&"object"===_typeof(options)&&(newOptions=Object.assign(newOptions||{},options)),newOptions&&(oldOptions=this.options,this.options=Object.assign({},this.options,newOptions));var terminatorMatch,parserMatch,parsersProfile=Wikifier.Parser.Profile.get(this.options.profile),terminatorRegExp=terminator?new RegExp("(?:".concat(terminator,")"),this.options.ignoreTerminatorCase?"gim":"gm"):null;do{if(parsersProfile.parserRegExp.lastIndex=this.nextMatch,terminatorRegExp&&(terminatorRegExp.lastIndex=this.nextMatch),parserMatch=parsersProfile.parserRegExp.exec(this.source),(terminatorMatch=terminatorRegExp?terminatorRegExp.exec(this.source):null)&&(!parserMatch||terminatorMatch.index<=parserMatch.index))return terminatorMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,terminatorMatch.index),this.matchStart=terminatorMatch.index,this.matchLength=terminatorMatch[0].length,this.matchText=terminatorMatch[0],this.nextMatch=terminatorRegExp.lastIndex,this.output=oldOutput,void(oldOptions&&(this.options=oldOptions));if(parserMatch){parserMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,parserMatch.index),this.matchStart=parserMatch.index,this.matchLength=parserMatch[0].length,this.matchText=parserMatch[0],this.nextMatch=parsersProfile.parserRegExp.lastIndex;for(var matchingParser=void 0,i=1,iend=parserMatch.length;i<iend;++i)if(parserMatch[i]){matchingParser=i-1;break}if(parsersProfile.parsers[matchingParser].handler(this),null!=TempState.break)break}}while(terminatorMatch||parserMatch);null==TempState.break?this.nextMatch<this.source.length&&(this.outputText(this.output,this.nextMatch,this.source.length),this.nextMatch=this.source.length):this.output.lastChild&&this.output.lastChild.nodeType===Node.ELEMENT_NODE&&"BR"===this.output.lastChild.nodeName.toUpperCase()&&jQuery(this.output.lastChild).remove(),this.output=oldOutput,oldOptions&&(this.options=oldOptions)}},{key:"outputText",value:function(destination,startPos,endPos){jQuery(destination).append(document.createTextNode(this.source.substring(startPos,endPos)))}},{key:"rawArgs",value:function(){return this._rawArgs}},{key:"fullArgs",value:function(){return Scripting.parse(this._rawArgs)}}],[{key:"wikifyEval",value:function(text){var output=document.createDocumentFragment();new Wikifier(output,text);var errors=output.querySelector(".error");if(null!==errors)throw new Error(errors.textContent.replace(errorPrologRegExp,""));return output}},{key:"createInternalLink",value:function(destination,passage,text,callback){var $link=jQuery(document.createElement("a"));return null!=passage&&($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken"),$link.ariaClick({one:!0},(function(){"function"==typeof callback&&callback(),Engine.play(passage)}))),text&&$link.append(document.createTextNode(text)),destination&&$link.appendTo(destination),$link[0]}},{key:"createExternalLink",value:function(destination,url,text){var $link=jQuery(document.createElement("a")).attr("target","_blank").addClass("link-external").text(text).appendTo(destination);return null!=url&&$link.attr({href:url,tabindex:0}),$link[0]}},{key:"isExternalLink",value:function(link){return!Story.has(link)&&(new RegExp("^".concat(Patterns.url),"gim").test(link)||/[/.?#]/.test(link))}}]),Wikifier}();return Object.defineProperty(Wikifier,"Option",{value:(_optionsStack=[],Object.freeze(Object.defineProperties({},{length:{get:function(){return _optionsStack.length}},options:{get:function(){return Object.assign.apply(Object,[{}].concat(_toConsumableArray(_optionsStack)))}},clear:{value:function(){_optionsStack=[]}},get:{value:function(idx){return _optionsStack[idx]}},pop:{value:function(){return _optionsStack.pop()}},push:{value:function(options){if("object"!==_typeof(options)||null===options)throw new TypeError("Wikifier.Option.push options parameter must be an object (received: ".concat(Util.getType(options),")"));return _optionsStack.push(options)}}})))}),Object.defineProperty(Wikifier,"Parser",{value:function(){var _profiles,_parsers=[];function parsersHas(name){return!!_parsers.find((function(parser){return parser.name===name}))}return Object.freeze(Object.defineProperties({},{parsers:{get:function(){return _parsers}},add:{value:function(parser){if("object"!==_typeof(parser))throw new Error("Wikifier.Parser.add parser parameter must be an object");if(!parser.hasOwnProperty("name"))throw new Error('parser object missing required "name" property');if("string"!=typeof parser.name)throw new Error('parser object "name" property must be a string');if(!parser.hasOwnProperty("match"))throw new Error('parser object missing required "match" property');if("string"!=typeof parser.match)throw new Error('parser object "match" property must be a string');if(!parser.hasOwnProperty("handler"))throw new Error('parser object missing required "handler" property');if("function"!=typeof parser.handler)throw new Error('parser object "handler" property must be a function');if(parser.hasOwnProperty("profiles")&&!Array.isArray(parser.profiles))throw new Error('parser object "profiles" property must be an array');if(parsersHas(parser.name))throw new Error('cannot clobber existing parser "'.concat(parser.name,'"'));_parsers.push(parser)}},delete:{value:function(name){var parser=_parsers.find((function(parser){return parser.name===name}));parser&&_parsers.delete(parser)}},isEmpty:{value:function(){return 0===_parsers.length}},has:{value:parsersHas},get:{value:function(name){return _parsers.find((function(parser){return parser.name===name}))||null}},Profile:{value:Object.freeze(Object.defineProperties({},{profiles:{get:function(){return _profiles}},compile:{value:function(){var all=_parsers,core=all.filter((function(parser){return!Array.isArray(parser.profiles)||parser.profiles.includes("core")}));return _profiles=Object.freeze({all:{parsers:all,parserRegExp:new RegExp(all.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")},core:{parsers:core,parserRegExp:new RegExp(core.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")}})}},isEmpty:{value:function(){return"object"!==_typeof(_profiles)||0===Object.keys(_profiles).length}},has:{value:function(profile){return"object"===_typeof(_profiles)&&_profiles.hasOwnProperty(profile)}},get:{value:function(profile){if("object"!==_typeof(_profiles)||!_profiles.hasOwnProperty(profile))throw new Error('nonexistent parser profile "'.concat(profile,'"'));return _profiles[profile]}}}))}}))}()}),Object.defineProperties(Wikifier,{helpers:{value:{}},getValue:{value:State.getVar},setValue:{value:State.setVar},parse:{value:Scripting.parse},evalExpression:{value:Scripting.evalTwineScript},evalStatements:{value:Scripting.evalTwineScript},textPrimitives:{value:Patterns}}),Object.defineProperties(Wikifier.helpers,{inlineCss:{value:(lookaheadRe=new RegExp(Patterns.inlineCss,"gm"),idOrClassRe=new RegExp("(".concat(Patterns.cssIdOrClassSigil,")(").concat(Patterns.anyLetter,"+)"),"g"),function(w){var matched,css={classes:[],id:"",styles:{}};do{lookaheadRe.lastIndex=w.nextMatch;var match=lookaheadRe.exec(w.source);if(matched=match&&match.index===w.nextMatch){if(match[1])css.styles[Util.fromCssProperty(match[1])]=match[2].trim();else if(match[3])css.styles[Util.fromCssProperty(match[3])]=match[4].trim();else if(match[5]){var subMatch=void 0;for(idOrClassRe.lastIndex=0;null!==(subMatch=idOrClassRe.exec(match[5]));)"."===subMatch[1]?css.classes.push(subMatch[2]):css.id=subMatch[2]}w.nextMatch=lookaheadRe.lastIndex}}while(matched);return css})},evalText:{value:function(text){var result;try{switch(_typeof(result=Scripting.evalTwineScript(text))){case"string":""===result.trim()&&(result=text);break;case"number":result=String(result);break;default:result=text}}catch(ex){result=text}return result}},evalPassageId:{value:function(passage){return null==passage||Story.has(passage)?passage:Wikifier.helpers.evalText(passage)}},hasBlockContext:{value:function(nodes){for(var hasGCS="function"==typeof window.getComputedStyle,i=nodes.length-1;i>=0;--i){var node=nodes[i];switch(node.nodeType){case Node.ELEMENT_NODE:var tagName=node.nodeName.toUpperCase();if("BR"===tagName)return!0;var styles=hasGCS?window.getComputedStyle(node,null):node.currentStyle;if(styles&&styles.display){if("none"===styles.display)continue;return"block"===styles.display}switch(tagName){case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":return!0}return!1;case Node.COMMENT_NODE:continue;default:return!1}}return!0}},createShadowSetterCallback:{value:function(){var macroParser=null;function getMacroContextShadowView(){for(var macro=macroParser||function(){if(!macroParser&&!(macroParser=Wikifier.Parser.get("macro")))throw new Error('cannot find "macro" parser');return macroParser}(),view=new Set,context=macro.context;null!==context;context=context.parent)context._shadows&&context._shadows.forEach((function(name){return view.add(name)}));return _toConsumableArray(view)}return function(code){var shadowStore={};return getMacroContextShadowView().forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]})),function(){var shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null;try{return shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),Scripting.evalJavaScript(code)}finally{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}}}()},parseSquareBracketedMarkup:{value:function(){var Item=Lexer.enumFromNames(["Error","DelimLTR","DelimRTL","InnerMeta","ImageMeta","LinkMeta","Link","RightMeta","Setter","Source","Text"]),Delim=Lexer.enumFromNames(["None","LTR","RTL"]);function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexLeftMeta(lexer){if(!lexer.accept("["))return lexer.error(Item.Error,"malformed square-bracketed markup");if(lexer.accept("["))lexer.data.isLink=!0,lexer.emit(Item.LinkMeta);else{if(lexer.accept("<>"),!(lexer.accept("Ii")&&lexer.accept("Mm")&&lexer.accept("Gg")&&lexer.accept("[")))return lexer.error(Item.Error,"malformed square-bracketed markup");lexer.data.isLink=!1,lexer.emit(Item.ImageMeta)}return lexer.depth=2,lexCoreComponents}function lexCoreComponents(lexer){for(var what=lexer.data.isLink?"link":"image",delim=Delim.None;;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup"));break;case"|":delim===Delim.None&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(),lexer.emit(Item.DelimLTR));break;case"-":delim===Delim.None&&">"===lexer.peek()&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(2),lexer.emit(Item.DelimLTR));break;case"<":delim===Delim.None&&"-"===lexer.peek()&&(delim=Delim.RTL,lexer.backup(),lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.DelimRTL));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.InnerMeta),lexer.data.isLink?lexSetter:lexImageLink;case"]":return--lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexImageLink(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup link component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.InnerMeta),lexSetter;case"]":return--lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexSetter(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup setter component"));break;case"'":if(slurpQuote(lexer,"'")===EOF)return lexer.error(Item.Error,"unterminated single quoted string in ".concat(what," markup setter component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)return"]"!==lexer.peek()?lexer.error(Item.Error,"malformed ".concat(what," markup")):(--lexer.depth,lexer.backup(),lexer.emit(Item.Setter),lexer.forward(2),lexer.emit(Item.RightMeta),null)}}return function(w){var lexer=new Lexer(w.source,lexLeftMeta);lexer.start=lexer.pos=w.matchStart;var markup={},items=lexer.run(),last=items.last();return last&&last.type===Item.Error?markup.error=last.message:items.forEach((function(item){var text=item.text.trim();switch(item.type){case Item.ImageMeta:markup.isImage=!0,"<"===text[1]?markup.align="left":">"===text[1]&&(markup.align="right");break;case Item.LinkMeta:markup.isLink=!0;break;case Item.Link:"~"===text[0]?(markup.forceInternal=!0,markup.link=text.slice(1)):markup.link=text;break;case Item.Setter:markup.setter=text;break;case Item.Source:markup.source=text;break;case Item.Text:markup.text=text}})),markup.pos=lexer.pos,markup}}()}}),Wikifier}();!function(){function _verbatimTagHandler(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createDocumentFragment()).append(match[1]).appendTo(w.output))}Wikifier.Parser.add({name:"quoteByBlock",profiles:["block"],match:"^<<<\\n",terminator:"^<<<\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("blockquote")).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"quoteByLine",profiles:["block"],match:"^>+",lookahead:/^>+/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,i,destStack=[w.output],curLevel=0,newLevel=w.matchLength;do{if(newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement("blockquote")).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();curLevel=newLevel,w.subWikify(destStack[destStack.length-1],this.terminator),jQuery(document.createElement("br")).appendTo(destStack[destStack.length-1]),this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);(matched=match&&match.index===w.nextMatch)&&(newLevel=match[0].length,w.nextMatch+=match[0].length)}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"macro",profiles:["core"],match:"<<",lookahead:new RegExp("<<(/?".concat(Patterns.macroName,")(?:\\s*)((?:(?:/\\*[^*]*\\*+(?:[^/*][^*]*\\*+)*/)|(?://.*\\n)|(?:`(?:\\\\.|[^`\\\\])*`)|(?:\"(?:\\\\.|[^\"\\\\])*\")|(?:'(?:\\\\.|[^'\\\\])*')|(?:\\[(?:[<>]?[Ii][Mm][Gg])?\\[[^\\r\\n]*?\\]\\]+)|[^>]|(?:>(?!>)))*)>>"),"gm"),working:{source:"",name:"",arguments:"",index:0},context:null,handler:function(w){var matchStart=this.lookahead.lastIndex=w.matchStart;if(this.parseTag(w)){var macro,nextMatch=w.nextMatch,name=this.working.name,rawArgs=this.working.arguments;try{if(!(macro=Macro.get(name))){if(Macro.tags.has(name)){var tags=Macro.tags.get(name);return throwError(w.output,"child tag <<".concat(name,">> was found outside of a call to its parent macro").concat(1===tags.length?"":"s"," <<").concat(tags.join(">>, <<"),">>"),w.source.slice(matchStart,w.nextMatch))}return throwError(w.output,"macro <<".concat(name,">> does not exist"),w.source.slice(matchStart,w.nextMatch))}var payload=null;if(void 0!==macro.tags&&!(payload=this.parseBody(w,macro)))return w.nextMatch=nextMatch,throwError(w.output,"cannot find a closing tag for macro <<".concat(name,">>"),"".concat(w.source.slice(matchStart,w.nextMatch),"…"));if("function"!=typeof macro.handler)return throwError(w.output,"macro <<".concat(name,">> handler function ").concat(void 0===macro.handler?"does not exist":"is not a function"),w.source.slice(matchStart,w.nextMatch));var args=payload?payload[0].args:this.createArgs(rawArgs,this.skipArgs(macro,macro.name));if(void 0!==macro._MACRO_API){this.context=new MacroContext({macro:macro,name:name,args:args,payload:payload,source:w.source.slice(matchStart,w.nextMatch),parent:this.context,parser:w});try{macro.handler.call(this.context)}finally{this.context=this.context.parent}}else{var prevRawArgs=w._rawArgs;w._rawArgs=rawArgs;try{macro.handler(w.output,name,args,w,payload)}finally{w._rawArgs=prevRawArgs}}}catch(ex){return throwError(w.output,"cannot execute ".concat(macro&&macro.isWidget?"widget":"macro"," <<").concat(name,">>: ").concat(ex.message),w.source.slice(matchStart,w.nextMatch))}finally{this.working.source="",this.working.name="",this.working.arguments="",this.working.index=0}}else w.outputText(w.output,w.matchStart,w.nextMatch)},parseTag:function(w){var match=this.lookahead.exec(w.source);return!(!match||match.index!==w.matchStart||!match[1])&&(w.nextMatch=this.lookahead.lastIndex,this.working.source=w.source.slice(match.index,this.lookahead.lastIndex),this.working.name=match[1],this.working.arguments=match[2],this.working.index=match.index,!0)},parseBody:function(w,macro){for(var openTag=this.working.name,closeTag="/".concat(openTag),closeAlt="end".concat(openTag),bodyTags=!!Array.isArray(macro.tags)&&macro.tags,payload=[],end=-1,opened=1,curSource=this.working.source,curTag=this.working.name,curArgument=this.working.arguments,contentStart=w.nextMatch;-1!==(w.matchStart=w.source.indexOf(this.match,w.nextMatch));)if(this.parseTag(w)){var tagSource=this.working.source,tagName=this.working.name,tagArgs=this.working.arguments,tagBegin=this.working.index,tagEnd=w.nextMatch,hasArgs=""!==tagArgs.trim();switch(tagName){case openTag:++opened;break;case closeAlt:case closeTag:if(hasArgs)throw w.nextMatch=tagBegin+2+tagName.length,new Error('malformed closing tag: "'.concat(tagSource,'"'));--opened;break;default:if(hasArgs&&(tagName.startsWith("/")||tagName.startsWith("end"))){this.lookahead.lastIndex=w.nextMatch=tagBegin+2+tagName.length;continue}if(1===opened&&bodyTags)for(var i=0,iend=bodyTags.length;i<iend;++i)tagName===bodyTags[i]&&(payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),curSource=tagSource,curTag=tagName,curArgument=tagArgs,contentStart=tagEnd)}if(0===opened){payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),end=tagEnd;break}}else this.lookahead.lastIndex=w.nextMatch=w.matchStart+this.match.length;return-1!==end?(w.nextMatch=end,payload):null},createArgs:function(rawArgsString,skipArgs){var args=skipArgs?[]:this.parseArgs(rawArgsString);return Object.defineProperties(args,{raw:{value:rawArgsString},full:{value:Scripting.parse(rawArgsString)}}),args},skipArgs:function(macro,tagName){if(void 0!==macro.skipArgs){var sa=macro.skipArgs;return"boolean"==typeof sa&&sa||Array.isArray(sa)&&sa.includes(tagName)}return void 0!==macro.skipArg0&&(macro.skipArg0&&macro.name===tagName)},parseArgs:function(){var Item=Lexer.enumFromNames(["Error","Bareword","Expression","String","SquareBracket"]),spaceRe=new RegExp(Patterns.space),notSpaceRe=new RegExp(Patterns.notSpace),varTest=new RegExp("^".concat(Patterns.variable));function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexSpace(lexer){var offset=lexer.source.slice(lexer.pos).search(notSpaceRe);if(offset===EOF)return null;switch(0!==offset&&(lexer.pos+=offset,lexer.ignore()),lexer.next()){case"`":return lexExpression;case'"':return lexDoubleQuote;case"'":return lexSingleQuote;case"[":return lexSquareBracket;default:return lexBareword}}function lexExpression(lexer){return slurpQuote(lexer,"`")===EOF?lexer.error(Item.Error,"unterminated backquote expression"):(lexer.emit(Item.Expression),lexSpace)}function lexDoubleQuote(lexer){return slurpQuote(lexer,'"')===EOF?lexer.error(Item.Error,"unterminated double quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSingleQuote(lexer){return slurpQuote(lexer,"'")===EOF?lexer.error(Item.Error,"unterminated single quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSquareBracket(lexer){var what;if(lexer.accept("<>IiMmGg")?(what="image",lexer.acceptRun("<>IiMmGg")):what="link",!lexer.accept("["))return lexer.error(Item.Error,"malformed ".concat(what," markup"));lexer.depth=2;loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case"[":++lexer.depth;break;case"]":if(--lexer.depth,lexer.depth<0)return lexer.error(Item.Error,"unexpected right square bracket ']'");if(1===lexer.depth){if("]"===lexer.next()){--lexer.depth;break loop}lexer.backup()}}return lexer.emit(Item.SquareBracket),lexSpace}function lexBareword(lexer){var offset=lexer.source.slice(lexer.pos).search(spaceRe);return lexer.pos=offset===EOF?lexer.source.length:lexer.pos+offset,lexer.emit(Item.Bareword),offset===EOF?null:lexSpace}return function(rawArgsString){var lexer=new Lexer(rawArgsString,lexSpace),args=[];return lexer.run().forEach((function(item){var arg=item.text;switch(item.type){case Item.Error:throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(item.message));case Item.Bareword:if(varTest.test(arg))arg=State.getVar(arg);else if(/^(?:settings|setup)[.[]/.test(arg))try{arg=Scripting.evalTwineScript(arg)}catch(ex){throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(ex.message))}else if("null"===arg)arg=null;else if("undefined"===arg)arg=undefined;else if("true"===arg)arg=!0;else if("false"===arg)arg=!1;else if("NaN"===arg)arg=NaN;else{var argAsNum=Number(arg);Number.isNaN(argAsNum)||(arg=argAsNum)}break;case Item.Expression:if(""===(arg=arg.slice(1,-1).trim()))arg=undefined;else try{arg=Scripting.evalTwineScript("(".concat(arg,")"))}catch(ex){throw new Error('unable to parse macro argument expression "'.concat(arg,'": ').concat(ex.message))}break;case Item.String:try{arg=Scripting.evalJavaScript(arg)}catch(ex){throw new Error('unable to parse macro argument string "'.concat(arg,'": ').concat(ex.message))}break;case Item.SquareBracket:var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:arg,matchStart:0});if(markup.hasOwnProperty("error"))throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(markup.error));if(markup.pos<arg.length)throw new Error('unable to parse macro argument "'.concat(arg,'": unexpected character(s) "').concat(arg.slice(markup.pos),'" (pos: ').concat(markup.pos,")"));markup.isLink?((arg={isLink:!0}).count=markup.hasOwnProperty("text")?2:1,arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.text=markup.hasOwnProperty("text")?Wikifier.helpers.evalText(markup.text):arg.link,arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link),arg.setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null):markup.isImage&&(arg=function(source){var imgObj={source:source,isImage:!0};if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(imgObj.source=passage.text,imgObj.passage=passage.title)}return imgObj}(Wikifier.helpers.evalPassageId(markup.source)),markup.hasOwnProperty("align")&&(arg.align=markup.align),markup.hasOwnProperty("text")&&(arg.title=Wikifier.helpers.evalText(markup.text)),markup.hasOwnProperty("link")&&(arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link)),arg.setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null)}args.push(arg)})),args}}()}),Wikifier.Parser.add({name:"link",profiles:["core"],match:"\\[\\[[^[]",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(markup.hasOwnProperty("error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{w.nextMatch=markup.pos;var link=Wikifier.helpers.evalPassageId(markup.link),text=markup.hasOwnProperty("text")?Wikifier.helpers.evalText(markup.text):link,setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null,output=(Config.debug?new DebugView(w.output,"link-markup","[[link]]",w.source.slice(w.matchStart,w.nextMatch)):w).output;markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(output,link,text,setFn):Wikifier.createExternalLink(output,link,text)}}}),Wikifier.Parser.add({name:"urlLink",profiles:["core"],match:Patterns.url,handler:function(w){w.outputText(Wikifier.createExternalLink(w.output,w.matchText),w.matchStart,w.nextMatch)}}),Wikifier.Parser.add({name:"image",profiles:["core"],match:"\\[[<>]?[Ii][Mm][Gg]\\[",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(markup.hasOwnProperty("error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{var debugView;w.nextMatch=markup.pos,Config.debug&&(debugView=new DebugView(w.output,"image-markup",markup.hasOwnProperty("link")?"[img[][link]]":"[img[]]",w.source.slice(w.matchStart,w.nextMatch))).modes({block:!0});var source,setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null,el=(Config.debug?debugView:w).output;if(markup.hasOwnProperty("link")){var link=Wikifier.helpers.evalPassageId(markup.link);(el=markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(el,link,null,setFn):Wikifier.createExternalLink(el,link)).classList.add("link-image")}if(el=jQuery(document.createElement("img")).appendTo(el).get(0),"data:"!==(source=Wikifier.helpers.evalPassageId(markup.source)).slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(el.setAttribute("data-passage",passage.title),source=passage.text.trim())}el.src=source,markup.hasOwnProperty("text")&&(el.title=Wikifier.helpers.evalText(markup.text)),markup.hasOwnProperty("align")&&(el.align=markup.align)}}}),Wikifier.Parser.add({name:"monospacedByBlock",profiles:["block"],match:"^\\{\\{\\{\\n",lookahead:/^\{\{\{\n((?:^[^\n]*\n)+?)(^\}\}\}$\n?)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){var pre=jQuery(document.createElement("pre"));jQuery(document.createElement("code")).text(match[1]).appendTo(pre),pre.appendTo(w.output),w.nextMatch=this.lookahead.lastIndex}}}),Wikifier.Parser.add({name:"formatByChar",profiles:["core"],match:"''|//|__|\\^\\^|~~|==|\\{\\{\\{",handler:function(w){switch(w.matchText){case"''":w.subWikify(jQuery(document.createElement("strong")).appendTo(w.output).get(0),"''");break;case"//":w.subWikify(jQuery(document.createElement("em")).appendTo(w.output).get(0),"//");break;case"__":w.subWikify(jQuery(document.createElement("u")).appendTo(w.output).get(0),"__");break;case"^^":w.subWikify(jQuery(document.createElement("sup")).appendTo(w.output).get(0),"\\^\\^");break;case"~~":w.subWikify(jQuery(document.createElement("sub")).appendTo(w.output).get(0),"~~");break;case"==":w.subWikify(jQuery(document.createElement("s")).appendTo(w.output).get(0),"==");break;case"{{{":var lookahead=/\{\{\{((?:.|\n)*?)\}\}\}/gm;lookahead.lastIndex=w.matchStart;var match=lookahead.exec(w.source);match&&match.index===w.matchStart&&(jQuery(document.createElement("code")).text(match[1]).appendTo(w.output),w.nextMatch=lookahead.lastIndex)}}}),Wikifier.Parser.add({name:"customStyle",profiles:["core"],match:"@@",terminator:"@@",blockRe:/\s*\n/gm,handler:function(w){var css=Wikifier.helpers.inlineCss(w);this.blockRe.lastIndex=w.nextMatch;var blockMatch=this.blockRe.exec(w.source),blockLevel=blockMatch&&blockMatch.index===w.nextMatch,$el=jQuery(document.createElement(blockLevel?"div":"span")).appendTo(w.output);0===css.classes.length&&""===css.id&&0===Object.keys(css.styles).length?$el.addClass("marked"):(css.classes.forEach((function(className){return $el.addClass(className)})),""!==css.id&&$el.attr("id",css.id),$el.css(css.styles)),blockLevel?(w.nextMatch+=blockMatch[0].length,w.subWikify($el[0],"\\n?".concat(this.terminator))):w.subWikify($el[0],this.terminator)}}),Wikifier.Parser.add({name:"verbatimText",profiles:["core"],match:'"{3}|<[Nn][Oo][Ww][Ii][Kk][Ii]>',lookahead:/(?:"{3}((?:.|\n)*?)"{3})|(?:<[Nn][Oo][Ww][Ii][Kk][Ii]>((?:.|\n)*?)<\/[Nn][Oo][Ww][Ii][Kk][Ii]>)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createElement("span")).addClass("verbatim").text(match[1]||match[2]).appendTo(w.output))}}),Wikifier.Parser.add({name:"horizontalRule",profiles:["core"],match:"^----+$\\n?|<[Hh][Rr]\\s*/?>\\n?",handler:function(w){jQuery(document.createElement("hr")).appendTo(w.output)}}),Wikifier.Parser.add({name:"emdash",profiles:["core"],match:"--",handler:function(w){jQuery(document.createTextNode("—")).appendTo(w.output)}}),Wikifier.Parser.add({name:"doubleDollarSign",profiles:["core"],match:"\\${2}",handler:function(w){jQuery(document.createTextNode("$")).appendTo(w.output)}}),Wikifier.Parser.add({name:"nakedVariable",profiles:["core"],match:"".concat(Patterns.variable,"(?:(?:\\.").concat(Patterns.identifier,")|(?:\\[\\d+\\])|(?:\\[\"(?:\\\\.|[^\"\\\\])+\"\\])|(?:\\['(?:\\\\.|[^'\\\\])+'\\])|(?:\\[").concat(Patterns.variable,"\\]))*"),handler:function(w){var result=State.getVar(w.matchText);null==result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"variable",w.matchText,w.matchText):w).output,stringFrom(result))}}),Wikifier.Parser.add({name:"template",profiles:["core"],match:"\\?".concat(Patterns.templateName),handler:function(w){var name=w.matchText.slice(1),template=Template.get(name),result=null;switch(template instanceof Array&&(template=template.random()),_typeof(template)){case"function":try{result=stringFrom(template.call({name:name}))}catch(ex){return throwError(w.output,"cannot execute function template ?".concat(name,": ").concat(ex.message),w.source.slice(w.matchStart,w.nextMatch))}break;case"string":result=template}null===result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"template",w.matchText,w.matchText):w).output,result)}}),Wikifier.Parser.add({name:"heading",profiles:["block"],match:"^!{1,6}",terminator:"\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("h".concat(w.matchLength))).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"table",profiles:["block"],match:"^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",lookahead:/^\|([^\n]*)\|([fhck]?)$/gm,rowTerminator:"\\|(?:[cfhk]?)$\\n?",cellPattern:"(?:\\|([^\\n\\|]*)\\|)|(\\|[cfhk]?$\\n?)",cellTerminator:"(?:\\u0020*)\\|",rowTypes:{c:"caption",f:"tfoot",h:"thead","":"tbody"},handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,table=jQuery(document.createElement("table")).appendTo(w.output).get(0),prevColumns=[],curRowType=null,$rowContainer=null,rowCount=0;w.nextMatch=w.matchStart;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var nextRowType=match[2];"k"===nextRowType?(table.className=match[1],w.nextMatch+=match[0].length+1):(nextRowType!==curRowType&&(curRowType=nextRowType,$rowContainer=jQuery(document.createElement(this.rowTypes[nextRowType])).appendTo(table)),"c"===curRowType?($rowContainer.css("caption-side",0===rowCount?"top":"bottom"),w.nextMatch+=1,w.subWikify($rowContainer[0],this.rowTerminator)):this.rowHandler(w,jQuery(document.createElement("tr")).appendTo($rowContainer).get(0),prevColumns),++rowCount)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))},rowHandler:function(w,rowEl,prevColumns){var matched,_this12=this,cellRe=new RegExp(this.cellPattern,"gm"),col=0,curColCount=1;do{cellRe.lastIndex=w.nextMatch;var cellMatch=cellRe.exec(w.source);if(matched=cellMatch&&cellMatch.index===w.nextMatch){if("~"===cellMatch[1]){var last=prevColumns[col];last&&(++last.rowCount,last.$element.attr("rowspan",last.rowCount).css("vertical-align","middle")),w.nextMatch=cellMatch.index+cellMatch[0].length-1}else if(">"===cellMatch[1])++curColCount,w.nextMatch=cellMatch.index+cellMatch[0].length-1;else{if(cellMatch[2]){w.nextMatch=cellMatch.index+cellMatch[0].length;break}!function(){++w.nextMatch;for(var css=Wikifier.helpers.inlineCss(w),spaceLeft=!1,spaceRight=!1,$cell=void 0;" "===w.source.substr(w.nextMatch,1);)spaceLeft=!0,++w.nextMatch;"!"===w.source.substr(w.nextMatch,1)?($cell=jQuery(document.createElement("th")).appendTo(rowEl),++w.nextMatch):$cell=jQuery(document.createElement("td")).appendTo(rowEl),prevColumns[col]={rowCount:1,$element:$cell},curColCount>1&&($cell.attr("colspan",curColCount),curColCount=1),w.subWikify($cell[0],_this12.cellTerminator)," "===w.matchText.substr(w.matchText.length-2,1)&&(spaceRight=!0),css.classes.forEach((function(className){return $cell.addClass(className)})),""!==css.id&&$cell.attr("id",css.id),spaceLeft&&spaceRight?css.styles["text-align"]="center":spaceLeft?css.styles["text-align"]="right":spaceRight&&(css.styles["text-align"]="left"),$cell.css(css.styles),w.nextMatch=w.nextMatch-1}()}++col}}while(matched)}}),Wikifier.Parser.add({name:"list",profiles:["block"],match:"^(?:(?:\\*+)|(?:#+))",lookahead:/^(?:(\*+)|(#+))/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){w.nextMatch=w.matchStart;var matched,i,destStack=[w.output],curType=null,curLevel=0;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var newType=match[2]?"ol":"ul",newLevel=match[0].length;if(w.nextMatch+=match[0].length,newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();else newLevel===curLevel&&newType!==curType&&(destStack.pop(),destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0)));curLevel=newLevel,curType=newType,w.subWikify(jQuery(document.createElement("li")).appendTo(destStack[destStack.length-1]).get(0),this.terminator)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"commentByBlock",profiles:["core"],match:"(?:/(?:%|\\*))|(?:\x3c!--)",lookahead:/(?:\/(%|\*)(?:(?:.|\n)*?)\1\/)|(?:<!--(?:(?:.|\n)*?)-->)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex)}}),Wikifier.Parser.add({name:"lineContinuation",profiles:["core"],match:"\\\\".concat(Patterns.spaceNoTerminator,"*\\n|\\n").concat(Patterns.spaceNoTerminator,"*\\\\|\\n?\\\\").concat(Patterns.spaceNoTerminator,"*$|^").concat(Patterns.spaceNoTerminator,"*\\\\\\n?"),handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"lineBreak",profiles:["core"],match:"\\n|<[Bb][Rr]\\s*/?>",handler:function(w){w.options.nobr||jQuery(document.createElement("br")).appendTo(w.output)}}),Wikifier.Parser.add({name:"htmlCharacterReference",profiles:["core"],match:"(?:(?:&#?[0-9A-Za-z]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9A-Fa-f]|1D[C-Fc-f][0-9A-Fa-f]|20[D-Fd-f][0-9A-Fa-f]|FE2[0-9A-Fa-f])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[0-9A-Za-z]{2,8};)",handler:function(w){jQuery(document.createDocumentFragment()).append(w.matchText).appendTo(w.output)}}),Wikifier.Parser.add({name:"xmlProlog",profiles:["core"],match:"<\\?[Xx][Mm][Ll][^>]*\\?>",handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"verbatimHtml",profiles:["core"],match:"<[Hh][Tt][Mm][Ll]>",lookahead:/<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"verbatimScriptTag",profiles:["core"],match:"<[Ss][Cc][Rr][Ii][Pp][Tt][^>]*>",lookahead:/(<[Ss][Cc][Rr][Ii][Pp][Tt]*>(?:.|\n)*?<\/[Ss][Cc][Rr][Ii][Pp][Tt]>)/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"styleTag",profiles:["core"],match:"<[Ss][Tt][Yy][Ll][Ee][^>]*>",lookahead:/(<[Ss][Tt][Yy][Ll][Ee]*>)((?:.|\n)*?)(<\/[Ss][Tt][Yy][Ll][Ee]>)/gm,imageMarkup:new RegExp(Patterns.cssImage,"g"),hasImageMarkup:new RegExp(Patterns.cssImage),handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){w.nextMatch=this.lookahead.lastIndex;var css=match[2];this.hasImageMarkup.test(css)&&(this.imageMarkup.lastIndex=0,css=css.replace(this.imageMarkup,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(markup.hasOwnProperty("error")||markup.pos<wikiImage.length)return wikiImage;var source=markup.source;if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text)}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),jQuery(document.createDocumentFragment()).append(match[1]+css+match[3]).appendTo(w.output)}}}),Wikifier.Parser.add({name:"svgTag",profiles:["core"],match:"<[Ss][Vv][Gg][^>]*>",lookahead:/<(\/?)[Ss][Vv][Gg][^>]*>/gm,namespace:"http://www.w3.org/2000/svg",handler:function(w){var _this13=this;this.lookahead.lastIndex=w.nextMatch;for(var match,depth=1;depth>0&&null!==(match=this.lookahead.exec(w.source));)depth+="/"===match[1]?-1:1;if(0===depth){w.nextMatch=this.lookahead.lastIndex;var svgTag=w.source.slice(w.matchStart,this.lookahead.lastIndex),$frag=jQuery(document.createDocumentFragment()).append(svgTag);$frag.find("a[data-passage],image[data-passage]").each((function(_,el){var tagName=el.tagName.toLowerCase();try{_this13.processAttributeDirectives(el)}catch(ex){return throwError(w.output,"svg|<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}el.hasAttribute("data-passage")&&_this13.processDataAttributes(el,tagName)})),$frag.appendTo(w.output)}},processAttributeDirectives:function(el){_toConsumableArray(el.attributes).forEach((function(_ref10){var name=_ref10.name,value=_ref10.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if("image"===tagName)"data:"!==passage.slice(0,5)&&Story.has(passage)&&(passage=Story.get(passage)).tags.includes("Twine.image")&&el.setAttribute("href",passage.text.trim());else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.createShadowSetterCallback(Scripting.parse(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}}),Wikifier.Parser.add({name:"htmlTag",profiles:["core"],match:"<".concat(Patterns.htmlTagName,"(?:\\s+[^\\u0000-\\u001F\\u007F-\\u009F\\s\"'>\\/=]+(?:\\s*=\\s*(?:\"[^\"]*?\"|'[^']*?'|[^\\s\"'=<>`]+))?)*\\s*\\/?>"),tagRe:new RegExp("^<(".concat(Patterns.htmlTagName,")")),mediaTags:["audio","img","source","track","video"],nobrTags:["audio","colgroup","datalist","dl","figure","meter","ol","optgroup","picture","progress","ruby","select","table","tbody","tfoot","thead","tr","ul","video"],voidTags:["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],handler:function(w){var tagMatch=this.tagRe.exec(w.matchText),tag=tagMatch&&tagMatch[1],tagName=tag&&tag.toLowerCase();if(tagName){var terminator,terminatorMatch,isVoid=this.voidTags.includes(tagName)||w.matchText.endsWith("/>"),isNobr=this.nobrTags.includes(tagName);if(!isVoid){terminator="<\\/".concat(tagName,"\\s*>");var terminatorRe=new RegExp(terminator,"gim");terminatorRe.lastIndex=w.matchStart,terminatorMatch=terminatorRe.exec(w.source)}if(!isVoid&&!terminatorMatch)return throwError(w.output,"cannot find a closing tag for HTML <".concat(tag,">"),"".concat(w.matchText,"…"));var debugView,output=w.output,el=document.createElement(w.output.tagName);for(el.innerHTML=w.matchText;el.firstChild;)el=el.firstChild;try{this.processAttributeDirectives(el)}catch(ex){return throwError(w.output,"<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}if(el.hasAttribute("data-passage")&&(this.processDataAttributes(el,tagName),Config.debug&&((debugView=new DebugView(w.output,"html-".concat(tagName),tagName,w.matchText)).modes({block:"img"===tagName,nonvoid:terminatorMatch}),output=debugView.output)),terminatorMatch){try{Wikifier.Option.push({nobr:isNobr}),w.subWikify(el,terminator,{ignoreTerminatorCase:!0})}finally{Wikifier.Option.pop()}debugView&&jQuery(el).find(".debug.block").length>0&&debugView.modes({block:!0})}output.appendChild("track"===tagName?el.cloneNode(!0):el)}},processAttributeDirectives:function(el){_toConsumableArray(el.attributes).forEach((function(_ref11){var name=_ref11.name,value=_ref11.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if(this.mediaTags.includes(tagName)){if("data:"!==passage.slice(0,5)&&Story.has(passage)){var parentName,twineTag;switch(passage=Story.get(passage),tagName){case"audio":case"video":twineTag="Twine.".concat(tagName);break;case"img":twineTag="Twine.image";break;case"track":twineTag="Twine.vtt";break;case"source":var $parent=$(el).closest("audio,picture,video");$parent.length&&(parentName=$parent.get(0).tagName.toLowerCase(),twineTag="Twine.".concat("picture"===parentName?"image":parentName))}passage.tags.includes(twineTag)&&(el["picture"===parentName?"srcset":"src"]=passage.text.trim())}}else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.createShadowSetterCallback(Scripting.parse(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}})}();var Template=(_templates=new Map,_validNameRe=new RegExp("^(?:".concat(Patterns.templateName,")$")),_validType=function(template){var templateType=_typeof(template);return"function"===templateType||"string"===templateType},Object.freeze(Object.defineProperties({},{add:{value:function(name,template){if(!(_validType(template)||template instanceof Array&&template.length>0&&template.every(_validType)))throw new TypeError("invalid template type (".concat(name,"); templates must be: functions, strings, or an array of either"));(name instanceof Array?name:[name]).forEach((function(name){if(!_validNameRe.test(name))throw new Error('invalid template name "'.concat(name,'"'));if(_templates.has(name))throw new Error("cannot clobber existing template ?".concat(name));_templates.set(name,template)}))}},delete:{value:function(name){(name instanceof Array?name:[name]).forEach((function(name){return _templates.delete(name)}))}},get:{value:function(name){return _templates.has(name)?_templates.get(name):null}},has:{value:function(name){return _templates.has(name)}},size:{get:function(){return _templates.size}}}))),_templates,_validNameRe,_validType,Macro=function(){var _macros={},_tags={},_validNameRe=new RegExp("^(?:".concat(Patterns.macroName,")$"));function macrosHas(name){return _macros.hasOwnProperty(name)}function tagsRegister(parent,bodyTags){if(!parent)throw new Error("no parent specified");for(var endTags=["/".concat(parent),"end".concat(parent)],allTags=[].concat(endTags,Array.isArray(bodyTags)?bodyTags:[]),i=0;i<allTags.length;++i){var tag=allTags[i];if(macrosHas(tag))throw new Error("cannot register tag for an existing macro");tagsHas(tag)?_tags[tag].includes(parent)||(_tags[tag].push(parent),_tags[tag].sort()):_tags[tag]=[parent]}}function tagsUnregister(parent){if(!parent)throw new Error("no parent specified");Object.keys(_tags).forEach((function(tag){var i=_tags[tag].indexOf(parent);-1!==i&&(1===_tags[tag].length?delete _tags[tag]:_tags[tag].splice(i,1))}))}function tagsHas(name){return _tags.hasOwnProperty(name)}return Object.freeze(Object.defineProperties({},{add:{value:function macrosAdd(name,def){if(Array.isArray(name))name.forEach((function(name){return macrosAdd(name,def)}));else{if(!_validNameRe.test(name))throw new Error('invalid macro name "'.concat(name,'"'));if(macrosHas(name))throw new Error("cannot clobber existing macro <<".concat(name,">>"));if(tagsHas(name))throw new Error("cannot clobber child tag <<".concat(name,">> of parent macro").concat(1===_tags[name].length?"":"s"," <<").concat(_tags[name].join(">>, <<"),">>"));try{if("object"===_typeof(def))_macros[name]=Object.assign(Object.create(null),def,{_MACRO_API:!0});else{if(!macrosHas(def))throw new Error("cannot create alias of nonexistent macro <<".concat(def,">>"));_macros[name]=Object.create(_macros[def],{_ALIAS_OF:{enumerable:!0,value:def}})}Object.defineProperty(_macros,name,{writable:!1})}catch(ex){throw"TypeError"===ex.name?new Error("cannot clobber protected macro <<".concat(name,">>")):new Error("unknown error when attempting to add macro <<".concat(name,">>: [").concat(ex.name,"] ").concat(ex.message))}if(void 0!==_macros[name].tags)if(null==_macros[name].tags)tagsRegister(name);else{if(!Array.isArray(_macros[name].tags))throw new Error('bad value for "tags" property of macro <<'.concat(name,">>"));tagsRegister(name,_macros[name].tags)}}}},delete:{value:function macrosDelete(name){if(Array.isArray(name))name.forEach((function(name){return macrosDelete(name)}));else if(macrosHas(name)){void 0!==_macros[name].tags&&tagsUnregister(name);try{Object.defineProperty(_macros,name,{writable:!0}),delete _macros[name]}catch(ex){throw new Error("unknown error removing macro <<".concat(name,">>: ").concat(ex.message))}}else if(tagsHas(name))throw new Error("cannot remove child tag <<".concat(name,">> of parent macro <<").concat(_tags[name],">>"))}},isEmpty:{value:function(){return 0===Object.keys(_macros).length}},has:{value:macrosHas},get:{value:function(name){var macro=null;return macrosHas(name)&&"function"==typeof _macros[name].handler?macro=_macros[name]:macros.hasOwnProperty(name)&&"function"==typeof macros[name].handler&&(macro=macros[name]),macro}},init:{value:function(){var handler=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"init";Object.keys(_macros).forEach((function(name){"function"==typeof _macros[name][handler]&&_macros[name][handler](name)})),Object.keys(macros).forEach((function(name){"function"==typeof macros[name][handler]&&macros[name][handler](name)}))}},tags:{value:Object.freeze(Object.defineProperties({},{register:{value:tagsRegister},unregister:{value:tagsUnregister},has:{value:tagsHas},get:{value:function(name){return tagsHas(name)?_tags[name]:null}}}))},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),MacroContext=function(){var MacroContext=function(){function MacroContext(contextData){_classCallCheck(this,MacroContext);var context=Object.assign({parent:null,macro:null,name:"",displayName:"",args:null,payload:null,parser:null,source:""},contextData);if(null===context.macro||""===context.name||null===context.parser)throw new TypeError("context object missing required properties");Object.defineProperties(this,{self:{value:context.macro},name:{value:void 0===context.macro._ALIAS_OF?context.name:context.macro._ALIAS_OF},displayName:{value:context.name},args:{value:context.args},payload:{value:context.payload},source:{value:context.source},parent:{value:context.parent},parser:{value:context.parser},_output:{value:context.parser.output},_shadows:{writable:!0,value:null},_debugView:{writable:!0,value:null},_debugViewEnabled:{writable:!0,value:Config.debug}})}return _createClass(MacroContext,[{key:"output",get:function(){return this._debugViewEnabled?this.debugView.output:this._output}},{key:"shadows",get:function(){return _toConsumableArray(this._shadows)}},{key:"shadowView",get:function(){var view=new Set;return this.contextSelectAll((function(ctx){return ctx._shadows})).forEach((function(ctx){return ctx._shadows.forEach((function(name){return view.add(name)}))})),_toConsumableArray(view)}},{key:"debugView",get:function(){return this._debugViewEnabled?null!==this._debugView?this._debugView:this.createDebugView():null}},{key:"contextHas",value:function(filter){for(var context=this;null!==(context=context.parent);)if(filter(context))return!0;return!1}},{key:"contextSelect",value:function(filter){for(var context=this;null!==(context=context.parent);)if(filter(context))return context;return null}},{key:"contextSelectAll",value:function(filter){for(var result=[],context=this;null!==(context=context.parent);)filter(context)&&result.push(context);return result}},{key:"addShadow",value:function(){var _this14=this;this._shadows||(this._shadows=new Set);for(var varRe=new RegExp("^".concat(Patterns.variable,"$")),_len14=arguments.length,names=new Array(_len14),_key14=0;_key14<_len14;_key14++)names[_key14]=arguments[_key14];names.flat(1/0).forEach((function(name){if("string"!=typeof name)throw new TypeError("variable name must be a string; type: ".concat(_typeof(name)));if(!varRe.test(name))throw new Error('invalid variable name "'.concat(name,'"'));_this14._shadows.add(name)}))}},{key:"createShadowWrapper",value:function(callback,doneCallback,startCallback){var shadowStore,shadowContext=this;return"function"==typeof callback&&(shadowStore={},this.shadowView.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]}))),function(){for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++)args[_key15]=arguments[_key15];if("function"==typeof startCallback&&startCallback.apply(this,args),"function"==typeof callback){var contextCache,shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null,macroParser=Wikifier.Parser.get("macro");try{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),contextCache=macroParser.context,macroParser.context=shadowContext,callback.apply(this,args)}finally{contextCache!==undefined&&(macroParser.context=contextCache),shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}"function"==typeof doneCallback&&doneCallback.apply(this,args)}}},{key:"createDebugView",value:function(name,title){return this._debugView=new DebugView(this._output,"macro",name||this.displayName,title||this.source),null!==this.payload&&this.payload.length>0&&this._debugView.modes({nonvoid:!0}),this._debugViewEnabled=!0,this._debugView}},{key:"removeDebugView",value:function(){null!==this._debugView&&(this._debugView.remove(),this._debugView=null),this._debugViewEnabled=!1}},{key:"error",value:function(message,source){return throwError(this._output,"<<".concat(this.displayName,">>: ").concat(message),source||this.source)}}]),MacroContext}();return MacroContext}();!function(){if(Macro.add("capture",{skipArgs:!0,tags:null,tsVarRe:new RegExp("(".concat(Patterns.variable,")"),"g"),handler:function(){if(0===this.args.raw.length)return this.error("no story/temporary variable list specified");var valueCache={};try{for(var match,tsVarRe=this.self.tsVarRe;null!==(match=tsVarRe.exec(this.args.raw));){var varName=match[1],varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),this.addShadow(varName)}new Wikifier(this.output,this.payload[0].contents)}finally{this.shadows.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}}),Macro.add("set",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("unset",{skipArgs:!0,jsVarRe:new RegExp("State\\.(variables|temporary)\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no story/temporary variable list specified");for(var match,jsVarRe=this.self.jsVarRe;null!==(match=jsVarRe.exec(this.args.full));){var store=State[match[1]],name=match[2];store.hasOwnProperty(name)&&delete store[name]}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remember",{skipArgs:!0,jsVarRe:new RegExp("State\\.variables\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}for(var match,remember=storage.get("remember")||{},jsVarRe=this.self.jsVarRe;null!==(match=jsVarRe.exec(this.args.full));){var name=match[1];remember[name]=State.variables[name]}if(!storage.set("remember",remember))return this.error("unknown error, cannot remember: ".concat(this.args.raw));Config.debug&&this.debugView.modes({hidden:!0})},init:function(){var remember=storage.get("remember");remember&&Object.keys(remember).forEach((function(name){return State.variables[name]=remember[name]}))}}),Macro.add("forget",{skipArgs:!0,jsVarRe:new RegExp("State\\.variables\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no story variable list specified");for(var match,remember=storage.get("remember"),jsVarRe=this.self.jsVarRe,needStore=!1;null!==(match=jsVarRe.exec(this.args.full));){var name=match[1];State.variables.hasOwnProperty(name)&&delete State.variables[name],remember&&remember.hasOwnProperty(name)&&(needStore=!0,delete remember[name])}if(needStore)if(0===Object.keys(remember).length){if(!storage.delete("remember"))return this.error("unknown error, cannot update remember store")}else if(!storage.set("remember",remember))return this.error("unknown error, cannot update remember store");Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("run","set"),Macro.add("script",{skipArgs:!0,tags:null,handler:function(){var output=document.createDocumentFragment();try{Scripting.evalJavaScript(this.payload[0].contents,output)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}Config.debug&&this.createDebugView(),output.hasChildNodes()&&this.output.appendChild(output)}}),Macro.add("include",{handler:function(){return 0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?(Config.debug&&this.debugView.modes({block:!0}),passage=Story.get(passage),void(this.args[1]?jQuery(document.createElement(this.args[1])).addClass("".concat(passage.domId," macro-").concat(this.name)).attr("data-passage",passage.title).appendTo(this.output):jQuery(this.output)).wiki(passage.processText())):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add("nobr",{skipArgs:!0,tags:null,handler:function(){new Wikifier(this.output,this.payload[0].contents.replace(/^\n+|\n+$/g,"").replace(/\n+/g," "))}}),Macro.add(["print","=","-"],{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{var result=stringFrom(Scripting.evalJavaScript(this.args.full));null!==result&&new Wikifier(this.output,"-"===this.name?Util.escape(result):result)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}}}),Macro.add("silently",{skipArgs:!0,tags:null,handler:function(){var frag=document.createDocumentFragment();if(new Wikifier(frag,this.payload[0].contents.trim()),Config.debug)this.debugView.modes({block:!0,hidden:!0}),this.output.appendChild(frag);else{var errList=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent}));if(errList.length>0)return this.error("error".concat(1===errList.length?"":"s"," within contents (").concat(errList.join("; "),")"))}}}),Macro.add("type",{isAsync:!0,tags:null,typeId:0,handler:function(){if(0===this.args.length)return this.error("no speed specified");var cursor,speed=Util.fromCssTime(this.args[0]);if(speed<0)return this.error("speed time value must be non-negative (received: ".concat(this.args[0],")"));for(var elClass="",elId="",elTag="div",skipKey=Config.macros.typeSkipKey,start=400,options=this.args.slice(1);options.length>0;){var option=options.shift();switch(option){case"class":if(0===options.length)return this.error("class option missing required class name(s)");if(""===(elClass=options.shift()))throw new Error('class option class name(s) must be non-empty (received: "")');break;case"element":if(0===options.length)return this.error("element option missing required element tag name");if(""===(elTag=options.shift()))throw new Error('element option tag name must be non-empty (received: "")');break;case"id":if(0===options.length)return this.error("id option missing required ID");if(""===(elId=options.shift()))throw new Error('id option ID must be non-empty (received: "")');break;case"keep":cursor="keep";break;case"none":cursor="none";break;case"skipkey":if(0===options.length)return this.error("skipkey option missing required key value");if(""===(skipKey=options.shift()))throw new Error('skipkey option key value must be non-empty (received: "")');break;case"start":if(0===options.length)return this.error("start option missing required time value");var value=options.shift();if((start=Util.fromCssTime(value))<0)throw new Error("start option time value must be non-negative (received: ".concat(value,")"));break;default:return this.error("unknown option: ".concat(option))}}var contents=this.payload[0].contents;if(""!==contents.trim()){Config.debug&&this.debugView.modes({block:!0});var className="macro-".concat(this.name),namespace=".".concat(className),$target=jQuery(document.createElement(elTag)).addClass("".concat(className," ").concat(className,"-target")).appendTo(this.output);TempState.macroTypeQueue||(TempState.macroTypeQueue=[],$(document).off(namespace).one(":passageinit".concat(namespace),(function(){return $(document).off(namespace)})));var startTyping=0===TempState.macroTypeQueue.length,selfId=++this.self.typeId;TempState.macroTypeQueue.push({id:selfId,handler:function(){var $wrapper=jQuery(document.createElement(elTag)).addClass(className);elId&&$wrapper.attr("id",elId),elClass&&$wrapper.addClass(elClass),new Wikifier($wrapper,contents);var passage=State.passage,turn=State.turns;if(!Config.macros.typeVisitedPassages&&State.passages.slice(0,-1).some((function(title){return title===passage}))||$wrapper.find(".error").length>0)return $target.replaceWith($wrapper),TempState.macroTypeQueue.shift(),void(TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().handler());var typer=new NodeTyper({targetNode:$wrapper.get(0),classNames:"none"===cursor?null:"".concat(className,"-cursor")});$target.replaceWith($wrapper);var keydownAndNS="keydown".concat(namespace),typingStopAndNS="".concat(":typingstop").concat(namespace);$(document).off(keydownAndNS).on(keydownAndNS,(function(ev){Util.scrubEventKey(ev.key)!==skipKey||ev.target!==document.body&&ev.target!==document.documentElement||(ev.preventDefault(),$(document).off(keydownAndNS),typer.finish())})).one(typingStopAndNS,(function(){TempState.macroTypeQueue&&(0===TempState.macroTypeQueue.length?jQuery.event.trigger(":typingcomplete"):TempState.macroTypeQueue.first().handler())}));var typeNode=function(){var typeNodeMember=function(typeIntervalId){State.passage===passage&&State.turns===turn&&typer.type()||(typeIntervalId&&clearInterval(typeIntervalId),TempState.macroTypeQueue&&TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().id===selfId&&TempState.macroTypeQueue.shift(),$wrapper.trigger(":typingstop"),$wrapper.addClass("".concat(className,"-done")),"keep"===cursor&&$wrapper.addClass("".concat(className,"-cursor")))};$wrapper.trigger(":typingstart"),typeNodeMember();var typeNodeMemberId=setInterval((function(){return typeNodeMember(typeNodeMemberId)}),speed)};start?setTimeout(typeNode,start):typeNode()}}),startTyping&&(Engine.isPlaying()?$(document).one(":passageend".concat(namespace),(function(){return TempState.macroTypeQueue.first().handler()})):TempState.macroTypeQueue.first().handler())}}}),Macro.add("display","include"),Macro.add("if",{skipArgs:!0,tags:["elseif","else"],elseifWsRe:/^\s*if\b/i,ifAssignRe:/[^!=&^|<>*/%+-]=[^=>]/,handler:function(){var i;try{var len=this.payload.length,elseifWsRe=this.self.elseifWsRe,ifAssignRe=this.self.ifAssignRe;for(i=0;i<len;++i)if("else"===this.payload[i].name){if(this.payload[i].args.raw.length>0)return elseifWsRe.test(this.payload[i].args.raw)?this.error('whitespace is not allowed between the "else" and "if" in <<elseif>> clause'.concat(i>0?" (#"+i+")":"")):this.error("<<else>> does not accept a conditional expression (perhaps you meant to use <<elseif>>), invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<else>> must be the final clause")}else{if(0===this.payload[i].args.full.length)return this.error("no conditional expression specified for <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#"+i+")":""));if(Config.macros.ifAssignmentError&&ifAssignRe.test(this.payload[i].args.full))return this.error("assignment operator found within <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#"+i+")":""," (perhaps you meant to use an equality operator: ==, ===, eq, is), invalid: ").concat(this.payload[i].args.raw))}var evalJavaScript=Scripting.evalJavaScript,success=!1;for(i=0;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"else"===this.payload[i].name||evalJavaScript(this.payload[i].args.full)){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!success,invalid:!success})}}catch(ex){return this.error("bad conditional expression in <<".concat(0===i?"if":"elseif",">> clause").concat(i>0?" (#"+i+")":"",": ").concat("object"===_typeof(ex)?ex.message:ex))}}}),Macro.add("switch",{skipArgs:["switch"],tags:["case","default"],handler:function(){if(0===this.args.full.length)return this.error("no expression specified");var i,result,len=this.payload.length;if(1===len)return this.error("no cases specified");for(i=1;i<len;++i)if("default"===this.payload[i].name){if(this.payload[i].args.length>0)return this.error("<<default>> does not accept values, invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<default>> must be the final case")}else if(0===this.payload[i].args.length)return this.error("no value(s) specified for <<".concat(this.payload[i].name,">> (#").concat(i,")"));try{result=Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}var debugView=this.debugView,success=!1;for(Config.debug&&debugView.modes({nonvoid:!1,hidden:!0}),i=1;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"default"===this.payload[i].name||this.payload[i].args.some((function(val){return val===result}))){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});debugView.modes({nonvoid:!1,hidden:!0,invalid:!success}),this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0,invalid:!success})}}}),Macro.add("for",{skipArgs:!0,tags:null,hasRangeRe:new RegExp("^\\S".concat(Patterns.anyChar,"*?\\s+range\\s+\\S").concat(Patterns.anyChar,"*?$")),rangeRe:new RegExp("^(?:State\\.(variables|temporary)\\.(".concat(Patterns.identifier,")\\s*,\\s*)?State\\.(variables|temporary)\\.(").concat(Patterns.identifier,")\\s+range\\s+(\\S").concat(Patterns.anyChar,"*?)$")),threePartRe:/^([^;]*?)\s*;\s*([^;]*?)\s*;\s*([^;]*?)$/,forInRe:/^\S+\s+in\s+\S+/i,forOfRe:/^\S+\s+of\s+\S+/i,handler:function(){var argsStr=this.args.full.trim(),payload=this.payload[0].contents.replace(/\n$/,"");if(0===argsStr.length)this.self.handleFor.call(this,payload,null,!0,null);else if(this.self.hasRangeRe.test(argsStr)){var parts=argsStr.match(this.self.rangeRe);if(null===parts)return this.error("invalid range form syntax, format: [index ,] value range collection");this.self.handleForRange.call(this,payload,{type:parts[1],name:parts[2]},{type:parts[3],name:parts[4]},parts[5])}else{var init,condition,post;if(-1===argsStr.indexOf(";")){if(this.self.forInRe.test(argsStr))return this.error("invalid syntax, for…in is not supported; see: for…range");if(this.self.forOfRe.test(argsStr))return this.error("invalid syntax, for…of is not supported; see: for…range");condition=argsStr}else{var _parts=argsStr.match(this.self.threePartRe);if(null===_parts)return this.error("invalid 3-part conditional form syntax, format: [init] ; [condition] ; [post]");init=_parts[1],condition=_parts[2].trim(),post=_parts[3],0===condition.length&&(condition=!0)}this.self.handleFor.call(this,payload,init,condition,post)}},handleFor:function(payload,init,condition,post){var evalJavaScript=Scripting.evalJavaScript,first=!0,safety=Config.macros.maxLoopIterations;Config.debug&&this.debugView.modes({block:!0});try{if(TempState.break=null,init)try{evalJavaScript(init)}catch(ex){return this.error("bad init expression: ".concat("object"===_typeof(ex)?ex.message:ex))}for(;evalJavaScript(condition);){if(--safety<0)return this.error("exceeded configured maximum loop iterations (".concat(Config.macros.maxLoopIterations,")"));if(new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}if(post)try{evalJavaScript(post)}catch(ex){return this.error("bad post expression: ".concat("object"===_typeof(ex)?ex.message:ex))}}}catch(ex){return this.error("bad conditional expression: ".concat("object"===_typeof(ex)?ex.message:ex))}finally{TempState.break=null}},handleForRange:function(payload,indexVar,valueVar,rangeExp){var rangeList,first=!0;try{rangeList=this.self.toRangeList(rangeExp)}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});try{TempState.break=null;for(var i=0;i<rangeList.length;++i)if(indexVar.name&&(State[indexVar.type][indexVar.name]=rangeList[i][0]),State[valueVar.type][valueVar.name]=rangeList[i][1],new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}}catch(ex){return this.error("object"===_typeof(ex)?ex.message:ex)}finally{TempState.break=null}},toRangeList:function(rangeExp){var value,list,evalJavaScript=Scripting.evalJavaScript;try{value=evalJavaScript("{"===rangeExp[0]?"(".concat(rangeExp,")"):rangeExp)}catch(ex){if("object"!==_typeof(ex))throw new Error("bad range expression: ".concat(ex));throw ex.message="bad range expression: ".concat(ex.message),ex}switch(_typeof(value)){case"string":list=[];for(var i=0;i<value.length;){var obj=Util.charAndPosAt(value,i);list.push([i,obj.char]),i=1+obj.end}break;case"object":if(Array.isArray(value))list=value.map((function(val,i){return[i,val]}));else if(value instanceof Set)list=_toConsumableArray(value).map((function(val,i){return[i,val]}));else if(value instanceof Map)list=_toConsumableArray(value.entries());else{if("Object"!==Util.toStringTag(value))throw new Error("unsupported range expression type: ".concat(Util.toStringTag(value)));list=Object.keys(value).map((function(key){return[key,value[key]]}))}break;default:throw new Error("unsupported range expression type: ".concat(_typeof(value)))}return list}}),Macro.add(["break","continue"],{skipArgs:!0,handler:function(){if(!this.contextHas((function(ctx){return"for"===ctx.name})))return this.error("must only be used in conjunction with its parent macro <<for>>");TempState.break="continue"===this.name?1:2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["button","link"],{isAsync:!0,tags:null,handler:function(){var _this15=this;if(0===this.args.length)return this.error("no ".concat("button"===this.name?"button":"link"," text specified"));var passage,$link=jQuery(document.createElement("button"===this.name?"button":"a"));if("object"===_typeof(this.args[0]))if(this.args[0].isImage){var $image=jQuery(document.createElement("img")).attr("src",this.args[0].source).appendTo($link);$link.addClass("link-image"),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link}else $link.append(document.createTextNode(this.args[0].text)),passage=this.args[0].link;else $link.wikiWithOptions({profile:"core"},this.args[0]),passage=this.args.length>1?this.args[1]:undefined;null!=passage?($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken")):$link.addClass("link-internal"),$link.addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:null!=passage?"link":"button",one:null!=passage},this.createShadowWrapper(""!==this.payload[0].contents?function(){return Wikifier.wikifyEval(_this15.payload[0].contents.trim())}:null,null!=passage?function(){return Engine.play(passage)}:null)).appendTo(this.output)}}),Macro.add("checkbox",{isAsync:!0,handler:function(){if(this.args.length<3){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("unchecked value"),this.args.length<3&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),uncheckValue=this.args[1],checkValue=this.args[2],el=document.createElement("input");switch(jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:"checkbox",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,this.checked?checkValue:uncheckValue)}))).appendTo(this.output),this.args[3]){case"autocheck":State.getVar(varName)===checkValue?el.checked=!0:State.setVar(varName,uncheckValue);break;case"checked":el.checked=!0,State.setVar(varName,checkValue);break;default:State.setVar(varName,uncheckValue)}}}),Macro.add(["cycle","listbox"],{isAsync:!0,skipArgs:["optionsfrom"],tags:["option","optionsfrom"],handler:function(){var _this16=this;if(0===this.args.length)return this.error("no variable name specified");if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),len=this.payload.length;if(1===len)return this.error("no options specified");for(var config={autoselect:!1,once:!1},i=1;i<this.args.length;++i){var arg=this.args[i];switch(arg){case"once":config.once=!0;break;case"autoselect":config.autoselect=!0;break;default:return this.error("unknown argument: ".concat(arg))}}for(var options=[],tagCount={option:0,optionsfrom:0},selectedIdx=-1,_i5=1;_i5<len;++_i5){var payload=this.payload[_i5];if("option"===payload.name){if(++tagCount.option,0===payload.args.length)return this.error("no arguments specified for <<".concat(payload.name,">> (#").concat(tagCount.option,")"));var option={label:String(payload.args[0])},isSelected=!1;switch(payload.args.length){case 1:option.value=payload.args[0];break;case 2:"selected"===payload.args[1]?(option.value=payload.args[0],isSelected=!0):option.value=payload.args[1];break;default:option.value=payload.args[1],"selected"===payload.args[2]&&(isSelected=!0)}if(options.push(option),isSelected){if(config.autoselect)return this.error("cannot specify both the autoselect and selected keywords");if(-1!==selectedIdx)return this.error("multiple selected keywords specified for <<".concat(payload.name,">> (#").concat(selectedIdx+1," & #").concat(tagCount.option,")"));selectedIdx=options.length-1}}else{var _ret=function(){if(++tagCount.optionsfrom,0===payload.args.full.length)return{v:_this16.error("no expression specified for <<".concat(payload.name,">> (#").concat(tagCount.optionsfrom,")"))};var result=void 0;try{var exp=payload.args.full;result=Scripting.evalJavaScript("{"===exp[0]?"(".concat(exp,")"):exp)}catch(ex){return{v:_this16.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}}if("object"!==_typeof(result)||null===result)return{v:_this16.error("expression must yield a supported collection or generic object (type: ".concat(null===result?"null":_typeof(result),")"))};if(result instanceof Array||result instanceof Set)result.forEach((function(val){return options.push({label:String(val),value:val})}));else if(result instanceof Map)result.forEach((function(val,key){return options.push({label:String(key),value:val})}));else{var oType=Util.toStringTag(result);if("Object"!==oType)return{v:_this16.error("expression must yield a supported collection or generic object (object type: ".concat(oType,")"))};Object.keys(result).forEach((function(key){return options.push({label:key,value:result[key]})}))}}();if("object"===_typeof(_ret))return _ret.v}}if(-1===selectedIdx)if(config.autoselect){var sameValueZero=Util.sameValueZero,curValue=State.getVar(varName),curValueIdx=options.findIndex((function(opt){return sameValueZero(opt.value,curValue)}));selectedIdx=-1===curValueIdx?0:curValueIdx}else selectedIdx=0;if("cycle"===this.name){var lastIdx=options.length-1;if(config.once&&selectedIdx===lastIdx)jQuery(this.output).wikiWithOptions({profile:"core"},options[selectedIdx].label);else{var cycleIdx=selectedIdx;jQuery(document.createElement("a")).wikiWithOptions({profile:"core"},options[selectedIdx].label).attr("id","".concat(this.name,"-").concat(varId)).addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:"button"},this.createShadowWrapper((function(){var $this=$(this);cycleIdx=(cycleIdx+1)%options.length,State.setVar(varName,options[cycleIdx].value),$this.empty().wikiWithOptions({profile:"core"},options[cycleIdx].label),config.once&&cycleIdx===lastIdx&&$this.off().contents().unwrap()}))).appendTo(this.output)}}else{var $select=jQuery(document.createElement("select"));options.forEach((function(opt,i){jQuery(document.createElement("option")).val(i).text(opt.label).appendTo($select)})),$select.attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),tabindex:0}).addClass("macro-".concat(this.name)).val(selectedIdx).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,options[Number(this.value)].value)}))).appendTo(this.output)}State.setVar(varName,options[selectedIdx].value)}}),Macro.add(["linkappend","linkprepend","linkreplace"],{isAsync:!0,tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this17=this;if(0===this.args.length)return this.error("no link text specified");var $link=jQuery(document.createElement("a")),$insert=jQuery(document.createElement("span")),transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]);$link.wikiWithOptions({profile:"core"},this.args[0]).addClass("link-internal macro-".concat(this.name)).ariaClick({namespace:".macros",one:!0},this.createShadowWrapper((function(){if("linkreplace"===_this17.name?$link.remove():$link.wrap('<span class="macro-'.concat(_this17.name,'"></span>')).replaceWith((function(){return $link.html()})),""!==_this17.payload[0].contents){var frag=document.createDocumentFragment();new Wikifier(frag,_this17.payload[0].contents),$insert.append(frag)}transition&&setTimeout((function(){return $insert.removeClass("macro-".concat(_this17.name,"-in"))}),Engine.minDomActionDelay)}))).appendTo(this.output),$insert.addClass("macro-".concat(this.name,"-insert")),transition&&$insert.addClass("macro-".concat(this.name,"-in")),"linkprepend"===this.name?$insert.insertBefore($link):$insert.insertAfter($link)}}),Macro.add(["numberbox","textbox"],{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var asNumber="numberbox"===this.name,defaultValue=asNumber?Number(this.args[1]):this.args[1];if(asNumber&&Number.isNaN(defaultValue))return this.error('default value "'.concat(this.args[1],'" is neither a number nor can it be parsed into a number'));var passage,varId=Util.slugify(varName),el=document.createElement("input"),autofocus=!1;this.args.length>3?(passage=this.args[2],autofocus="autofocus"===this.args[3]):this.args.length>2&&("autofocus"===this.args[2]?autofocus=!0:passage=this.args[2]),"object"===_typeof(passage)&&(passage=passage.link),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:asNumber?"number":"text",inputmode:asNumber?"decimal":"text",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,asNumber?Number(this.value):this.value)}))).on("keypress.macros",this.createShadowWrapper((function(ev){13===ev.which&&(ev.preventDefault(),State.setVar(varName,asNumber?Number(this.value):this.value),null!=passage&&Engine.play(passage))}))).appendTo(this.output),asNumber&&(el.step="any"),State.setVar(varName,defaultValue),el.value=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:".concat(el.id)]=function(task){delete postdisplay[task],setTimeout((function(){return el.focus()}),Engine.minDomActionDelay)})}}),Macro.add("radiobutton",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),checkValue=this.args[1],el=document.createElement("input");switch(TempState.hasOwnProperty(this.name)||(TempState[this.name]={}),TempState[this.name].hasOwnProperty(varId)||(TempState[this.name][varId]=0),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId,"-").concat(TempState[this.name][varId]++),name:"".concat(this.name,"-").concat(varId),type:"radio",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){this.checked&&State.setVar(varName,checkValue)}))).appendTo(this.output),this.args[2]){case"autocheck":State.getVar(varName)===checkValue&&(el.checked=!0);break;case"checked":el.checked=!0,State.setVar(varName,checkValue)}}}),Macro.add("textarea",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var varId=Util.slugify(varName),defaultValue=this.args[1],autofocus="autofocus"===this.args[2],el=document.createElement("textarea");jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),rows:4,tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,this.value)}))).appendTo(this.output),State.setVar(varName,defaultValue),el.textContent=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:".concat(el.id)]=function(task){delete postdisplay[task],setTimeout((function(){return el.focus()}),Engine.minDomActionDelay)})}}),Macro.add("click","link"),Macro.add("actions",{handler:function(){for(var $list=jQuery(document.createElement("ul")).addClass(this.name).appendTo(this.output),i=0;i<this.args.length;++i){var passage=void 0,text=void 0,$image=void 0,setFn=void 0;if("object"===_typeof(this.args[i])?this.args[i].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[i].source),this.args[i].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[i].passage),this.args[i].hasOwnProperty("title")&&$image.attr("title",this.args[i].title),this.args[i].hasOwnProperty("align")&&$image.attr("align",this.args[i].align),passage=this.args[i].link,setFn=this.args[i].setFn):(text=this.args[i].text,passage=this.args[i].link,setFn=this.args[i].setFn):text=passage=this.args[i],!(State.variables.hasOwnProperty("#actions")&&State.variables["#actions"].hasOwnProperty(passage)&&State.variables["#actions"][passage])){var $link=jQuery(Wikifier.createInternalLink(jQuery(document.createElement("li")).appendTo($list),passage,null,function(passage,fn){return function(){State.variables.hasOwnProperty("#actions")||(State.variables["#actions"]={}),State.variables["#actions"][passage]=!0,"function"==typeof fn&&fn()}}(passage,setFn))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text));$image&&$link.addClass("link-image")}}}}),Macro.add(["back","return"],{handler:function(){if(this.args.length>1)return this.error("too many arguments specified, check the documentation for details");var passage,text,$image,$link,momentIndex=-1;if(1===this.args.length&&("object"===_typeof(this.args[0])?this.args[0].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),this.args[0].hasOwnProperty("link")&&(passage=this.args[0].link)):(1===this.args[0].count||(text=this.args[0].text),passage=this.args[0].link):1===this.args.length&&(text=this.args[0])),null==passage){for(var i=State.length-2;i>=0;--i)if(State.history[i].title!==State.passage){momentIndex=i,passage=State.history[i].title;break}if(null==passage&&"return"===this.name)for(var _i6=State.expired.length-1;_i6>=0;--_i6)if(State.expired[_i6]!==State.passage){passage=State.expired[_i6];break}}else{if(!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));if("back"===this.name){for(var _i7=State.length-2;_i7>=0;--_i7)if(State.history[_i7].title===passage){momentIndex=_i7;break}if(-1===momentIndex)return this.error('cannot find passage "'.concat(passage,'" in the current story history'))}}if(null==passage)return this.error("cannot find passage");"back"!==this.name||-1!==momentIndex?($link=jQuery(document.createElement("a")).addClass("link-internal").ariaClick({one:!0},"return"===this.name?function(){return Engine.play(passage)}:function(){return Engine.goTo(momentIndex)}),$image&&$link.addClass("link-image")):$link=jQuery(document.createElement("span")).addClass("link-disabled"),$link.addClass("macro-".concat(this.name)).append($image||document.createTextNode(text||L10n.get("macro".concat(this.name.toUpperFirst(),"Text")))).appendTo(this.output)}}),Macro.add("choice",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var passage,text,$image,setFn,$link,choiceId=State.passage;if(1===this.args.length?"object"===_typeof(this.args[0])?this.args[0].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link,setFn=this.args[0].setFn):(text=this.args[0].text,passage=this.args[0].link,setFn=this.args[0].setFn):text=passage=this.args[0]:(passage=this.args[0],text=this.args[1]),State.variables.hasOwnProperty("#choice")&&State.variables["#choice"].hasOwnProperty(choiceId)&&State.variables["#choice"][choiceId])return $link=jQuery(document.createElement("span")).addClass("link-disabled macro-".concat(this.name)).attr("tabindex",-1).append($image||document.createTextNode(text)).appendTo(this.output),void($image&&$link.addClass("link-image"));$link=jQuery(Wikifier.createInternalLink(this.output,passage,null,(function(){State.variables.hasOwnProperty("#choice")||(State.variables["#choice"]={}),State.variables["#choice"][choiceId]=!0,"function"==typeof setFn&&setFn()}))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text)),$image&&$link.addClass("link-image")}}),Macro.add(["addclass","toggleclass"],{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("selector"),this.args.length<2&&errors.push("class names"),this.error("no ".concat(errors.join(" or ")," specified"))}var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));switch(this.name){case"addclass":$targets.addClass(this.args[1].trim());break;case"toggleclass":$targets.toggleClass(this.args[1].trim())}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeclass",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));this.args.length>1?$targets.removeClass(this.args[1].trim()):$targets.removeClass(),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("copy",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));jQuery(this.output).append($targets.html()),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["append","prepend","replace"],{tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this18=this;if(0===this.args.length)return this.error("no selector specified");var $insert,$targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));if(""!==this.payload[0].contents)switch(this.args.length>1&&this.self.t8nRe.test(this.args[1])?(($insert=jQuery(document.createElement("span"))).addClass("macro-".concat(this.name,"-insert macro-").concat(this.name,"-in")),setTimeout((function(){return $insert.removeClass("macro-".concat(_this18.name,"-in"))}),Engine.minDomActionDelay)):$insert=jQuery(document.createDocumentFragment()),$insert.wiki(this.payload[0].contents),this.name){case"replace":$targets.empty();case"append":$targets.append($insert);break;case"prepend":$targets.prepend($insert)}else"replace"===this.name&&$targets.empty();Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remove",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));$targets.remove(),Config.debug&&this.debugView.modes({hidden:!0})}}),Has.audio){var errorOnePlaybackAction=function(cur,prev){return'only one playback action allowed per invocation, "'.concat(cur,'" cannot be combined with "').concat(prev,'"')};Macro.add("audio",{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track and/or group IDs"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var selected;try{selected=SimpleAudio.select(this.args[0])}catch(ex){return this.error(ex.message)}for(var action,fadeTo,loop,mute,passage,time,volume,args=this.args.slice(1),fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors=[];return args.length<1&&_errors.push("seconds"),args.length<2&&_errors.push("level"),this.error("fadeoverto missing required ".concat(_errors.join(" and ")," value").concat(_errors.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"time":if(0===args.length)return this.error("time missing required seconds value");if(raw=args.shift(),time=Number.parseFloat(raw),Number.isNaN(time)||!Number.isFinite(time))return this.error("cannot parse time: ".concat(raw));break;case"loop":case"unloop":loop="loop"===arg;break;case"goto":if(0===args.length)return this.error("goto missing required passage title");if(raw=args.shift(),passage="object"===_typeof(raw)?raw.link:raw,!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));break;default:return this.error("unknown action: ".concat(arg))}}try{if(null!=volume&&selected.volume(volume),null!=time&&selected.time(time),null!=mute&&selected.mute(mute),null!=loop&&selected.loop(loop),null!=passage){var nsEnded="ended.macros.macro-".concat(this.name,"_goto");selected.off(nsEnded).one(nsEnded,(function(){selected.off(nsEnded),Engine.play(passage)}))}switch(action){case"fade":selected.fade(fadeOver,fadeTo);break;case"load":selected.load();break;case"pause":selected.pause();break;case"play":selected.playWhenAllowed();break;case"stop":selected.stop();break;case"unload":selected.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("cacheaudio",{handler:function(){var _this19=this;if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track ID"),this.args.length<2&&errors.push("sources"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim(),oldFmtRe=/^format:\s*([\w-]+)\s*;\s*/i;try{SimpleAudio.tracks.add(id,this.args.slice(1).map((function(source){if(oldFmtRe.test(source)){if(Config.debug)return _this19.error('track ID "'.concat(id,'": format specifier migration required, "format:formatId;" → "formatId|"'));source=source.replace(oldFmtRe,"$1|")}return source})))}catch(ex){return this.error(ex.message)}if(Config.debug&&!SimpleAudio.tracks.get(id).hasSource())return this.error('track ID "'.concat(id,'": no supported audio sources found'));Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("createaudiogroup",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no group ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var groupId=String(this.args[0]).trim(),trackIds=[],i=1,len=this.payload.length;i<len;++i){if(this.payload[i].args.length<1)return this.error("no track ID specified");trackIds.push(String(this.payload[i].args[0]).trim()),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.groups.add(groupId,trackIds)}catch(ex){return this.error(ex.message)}Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("createplaylist",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no list ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");var playlist=Macro.get("playlist");if(null!==playlist.from&&"createplaylist"!==playlist.from)return this.error("a playlist has already been defined with <<setplaylist>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var listId=String(this.args[0]).trim(),trackObjs=[],i=1,len=this.payload.length;i<len;++i){if(0===this.payload[i].args.length)return this.error("no track ID specified");for(var trackObj={id:String(this.payload[i].args[0]).trim()},args=this.payload[i].args.slice(1);args.length>0;){var arg=args.shift(),raw=void 0,parsed=void 0;switch(arg){case"copy":case"own":trackObj.own=!0;break;case"rate":args.length>0&&args.shift();break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),parsed=Number.parseFloat(raw),Number.isNaN(parsed)||!Number.isFinite(parsed))return this.error("cannot parse volume: ".concat(raw));trackObj.volume=parsed;break;default:return this.error("unknown action: ".concat(arg))}}trackObjs.push(trackObj),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.lists.add(listId,trackObjs)}catch(ex){return this.error(ex.message)}null===playlist.from&&(playlist.from="createplaylist"),Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("masteraudio",{handler:function(){if(0===this.args.length)return this.error("no actions specified");for(var action,mute,muteOnHide,volume,args=this.args.slice(0);args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"mute":case"unmute":mute="mute"===arg;break;case"muteonhide":case"nomuteonhide":muteOnHide="muteonhide"===arg;break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=mute&&SimpleAudio.mute(mute),null!=muteOnHide&&SimpleAudio.muteOnHidden(muteOnHide),null!=volume&&SimpleAudio.volume(volume),action){case"load":SimpleAudio.load();break;case"stop":SimpleAudio.stop();break;case"unload":SimpleAudio.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("playlist",{from:null,handler:function(){var list,args,action,from=this.self.from;if(null===from)return this.error("no playlists have been created");if("createplaylist"===from){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("list ID"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));list=SimpleAudio.lists.get(id),args=this.args.slice(1)}else{if(0===this.args.length)return this.error("no actions specified");list=SimpleAudio.lists.get("setplaylist"),args=this.args.slice(0)}for(var fadeTo,loop,mute,shuffle,volume,fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"skip":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors2=[];return args.length<1&&_errors2.push("seconds"),args.length<2&&_errors2.push("level"),this.error("fadeoverto missing required ".concat(_errors2.join(" and ")," value").concat(_errors2.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"loop":case"unloop":loop="loop"===arg;break;case"shuffle":case"unshuffle":shuffle="shuffle"===arg;break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=volume&&list.volume(volume),null!=mute&&list.mute(mute),null!=loop&&list.loop(loop),null!=shuffle&&list.shuffle(shuffle),action){case"fade":list.fade(fadeOver,fadeTo);break;case"load":list.load();break;case"pause":list.pause();break;case"play":list.playWhenAllowed();break;case"skip":list.skip();break;case"stop":list.stop();break;case"unload":list.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("removeaudiogroup",{handler:function(){if(0===this.args.length)return this.error("no group ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.groups.has(id))return this.error('group "'.concat(id,'" does not exist'));SimpleAudio.groups.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeplaylist",{handler:function(){if(0===this.args.length)return this.error("no list ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));SimpleAudio.lists.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("waitforaudio",{skipArgs:!0,handler:function(){SimpleAudio.loadWithScreen()}}),Macro.add("setplaylist",{handler:function(){if(0===this.args.length)return this.error("no track ID(s) specified");var playlist=Macro.get("playlist");if(null!==playlist.from&&"setplaylist"!==playlist.from)return this.error("playlists have already been defined with <<createplaylist>>");try{SimpleAudio.lists.add("setplaylist",this.args.slice(0))}catch(ex){return this.error(ex.message)}null===playlist.from&&(playlist.from="setplaylist"),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("stopallaudio",{skipArgs:!0,handler:function(){SimpleAudio.select(":all").stop(),Config.debug&&this.debugView.modes({hidden:!0})}})}else Macro.add(["audio","cacheaudio","createaudiogroup","createplaylist","masteraudio","playlist","removeaudiogroup","removeplaylist","waitforaudio","setplaylist","stopallaudio"],{skipArgs:!0,handler:function(){Config.debug&&this.debugView.modes({hidden:!0})}});Macro.add("done",{skipArgs:!0,tags:null,handler:function(){var contents=this.payload[0].contents.trim();""!==contents&&setTimeout(this.createShadowWrapper((function(){return $.wiki(contents)})),Engine.minDomActionDelay)}}),Macro.add("goto",{handler:function(){return 0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?void setTimeout((function(){return Engine.play(passage)}),Engine.minDomActionDelay):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add("repeat",{isAsync:!0,tags:null,timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){var delay,_this20=this;if(0===this.args.length)return this.error("no time value specified");try{delay=Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0]))}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerInterval(this.createShadowWrapper((function(){var frag=document.createDocumentFragment();new Wikifier(frag,_this20.payload[0].contents);var $output=$wrapper;transition&&($output=jQuery(document.createElement("span")).addClass("macro-repeat-insert macro-repeat-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-repeat-in")}),Engine.minDomActionDelay)})),delay)},registerInterval:function(callback,delay){var _this21=this;if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null;timerId=setInterval((function(){if(State.passage!==passage||State.turns!==turn)return clearInterval(timerId),void timers.delete(timerId);var timerIdCache;try{TempState.break=null,TempState.hasOwnProperty("repeatTimerId")&&(timerIdCache=TempState.repeatTimerId),TempState.repeatTimerId=timerId,callback.call(_this21)}finally{void 0!==timerIdCache?TempState.repeatTimerId=timerIdCache:delete TempState.repeatTimerId,TempState.break=null}}),delay),timers.add(timerId),prehistory.hasOwnProperty("#repeat-timers-cleanup")||(prehistory["#repeat-timers-cleanup"]=function(task){delete prehistory[task],timers.forEach((function(timerId){return clearInterval(timerId)})),timers.clear()})}}),Macro.add("stop",{skipArgs:!0,handler:function(){if(!TempState.hasOwnProperty("repeatTimerId"))return this.error("must only be used in conjunction with its parent macro <<repeat>>");var timers=Macro.get("repeat").timers,timerId=TempState.repeatTimerId;clearInterval(timerId),timers.delete(timerId),TempState.break=2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("timed",{isAsync:!0,tags:["next"],timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){if(0===this.args.length)return this.error("no time value specified in <<timed>>");var i,items=[];try{items.push({name:this.name,source:this.source,delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0])),content:this.payload[0].contents})}catch(ex){return this.error("".concat(ex.message," in <<timed>>"))}if(this.payload.length>1)try{var len;for(i=1,len=this.payload.length;i<len;++i)items.push({name:this.payload[i].name,source:this.payload[i].source,delay:0===this.payload[i].args.length?items[items.length-1].delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.payload[i].args[0])),content:this.payload[i].contents})}catch(ex){return this.error("".concat(ex.message," in <<next>> (#").concat(i,")"))}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerTimeout(this.createShadowWrapper((function(item){var frag=document.createDocumentFragment();new Wikifier(frag,item.content);var $output=$wrapper;Config.debug&&"next"===item.name&&($output=jQuery(new DebugView($output[0],"macro",item.name,item.source).output)),transition&&($output=jQuery(document.createElement("span")).addClass("macro-timed-insert macro-timed-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-timed-in")}),Engine.minDomActionDelay)})),items)},registerTimeout:function(callback,items){if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null,nextItem=items.shift();timerId=setTimeout((function worker(){if(timers.delete(timerId),State.passage===passage&&State.turns===turn){var curItem=nextItem;null!=(nextItem=items.shift())&&(timerId=setTimeout(worker,nextItem.delay),timers.add(timerId)),callback.call(this,curItem)}}),nextItem.delay),timers.add(timerId),prehistory.hasOwnProperty("#timed-timers-cleanup")||(prehistory["#timed-timers-cleanup"]=function(task){delete prehistory[task],timers.forEach((function(timerId){return clearTimeout(timerId)})),timers.clear()})}}),Macro.add("widget",{tags:null,handler:function(){if(0===this.args.length)return this.error("no widget name specified");var widgetCode,widgetName=this.args[0],isNonVoid=this.args.length>1&&"container"===this.args[1];if(Macro.has(widgetName)){if(!Macro.get(widgetName).isWidget)return this.error('cannot clobber existing macro "'.concat(widgetName,'"'));Macro.delete(widgetName)}try{var widgetDef={isWidget:!0,handler:(widgetCode=this.payload[0].contents,function(){var shadowStore={};State.temporary.hasOwnProperty("args")&&(shadowStore._args=State.temporary.args),State.temporary.args=_toConsumableArray(this.args),State.temporary.args.raw=this.args.raw,State.temporary.args.full=this.args.full,this.addShadow("_args"),isNonVoid&&(State.temporary.hasOwnProperty("contents")&&(shadowStore._contents=State.temporary.contents),State.temporary.contents=this.payload[0].contents,this.addShadow("_contents")),State.variables.hasOwnProperty("args")&&(shadowStore.$args=State.variables.args),State.variables.args=State.temporary.args,this.addShadow("$args");try{var resFrag=document.createDocumentFragment(),errList=[];if(new Wikifier(resFrag,widgetCode),Array.from(resFrag.querySelectorAll(".error")).forEach((function(errEl){errList.push(errEl.textContent)})),0!==errList.length)return this.error("error".concat(errList.length>1?"s":""," within widget code (").concat(errList.join("; "),")"));this.output.appendChild(resFrag)}catch(ex){return this.error("cannot execute widget: ".concat(ex.message))}finally{shadowStore.hasOwnProperty("_args")?State.temporary.args=shadowStore._args:delete State.temporary.args,isNonVoid&&(shadowStore.hasOwnProperty("_contents")?State.temporary.contents=shadowStore._contents:delete State.temporary.contents),shadowStore.hasOwnProperty("$args")?State.variables.args=shadowStore.$args:delete State.variables.args}})};isNonVoid&&(widgetDef.tags=[]),Macro.add(widgetName,widgetDef),Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error('cannot create widget macro "'.concat(widgetName,'": ').concat(ex.message))}}})}();var Dialog=function(){var _$overlay=null,_$dialog=null,_$dialogTitle=null,_$dialogBody=null,_lastActive=null,_scrollbarWidth=0,_dialogObserver=null;function dialogClose(ev){return _$dialogBody.trigger(":dialogclosing"),jQuery(document).off(".dialog-close"),_dialogObserver?(_dialogObserver.disconnect(),_dialogObserver=null):_$dialogBody.off(".dialog-resize"),jQuery(window).off(".dialog-resize"),_$dialog.removeClass("open").css({left:"",right:"",top:"",bottom:""}),jQuery("#ui-bar,#story").find("[tabindex=-2]").removeAttr("aria-hidden").attr("tabindex",0),jQuery("body>[tabindex=-3]").removeAttr("aria-hidden").removeAttr("tabindex"),_$overlay.removeClass("open"),jQuery(document.documentElement).removeAttr("data-dialog"),_$dialogTitle.empty(),_$dialogBody.empty().removeClass(),null!==_lastActive&&(jQuery(_lastActive).focus(),_lastActive=null),ev&&ev.data&&"function"==typeof ev.data.closeFn&&ev.data.closeFn(ev),_$dialogBody.trigger(":dialogclose"),_$dialogBody.trigger(":dialogclosed"),Dialog}function dialogIsOpen(classNames){return _$dialog.hasClass("open")&&(!classNames||classNames.splitOrEmpty(/\s+/).every((function(cn){return _$dialogBody.hasClass(cn)})))}function dialogOpen(options,closeFn){_$dialogBody.trigger(":dialogopening");var top=jQuery.extend({top:50},options).top;return dialogIsOpen()||(_lastActive=safeActiveElement()),jQuery(document.documentElement).attr("data-dialog","open"),_$overlay.addClass("open"),null!==_$dialogBody[0].querySelector("img")&&_$dialogBody.imagesLoaded().always((function(){return _resizeHandler({data:{top:top}})})),jQuery("body>:not(script,#store-area,tw-storydata,#ui-bar,#ui-overlay,#ui-dialog)").attr("tabindex",-3).attr("aria-hidden",!0),jQuery("#ui-bar,#story").find("[tabindex]:not([tabindex^=-])").attr("tabindex",-2).attr("aria-hidden",!0),_$dialog.css(_calcPosition(top)).addClass("open").focus(),jQuery(window).on("resize.dialog-resize",null,{top:top},jQuery.throttle(40,_resizeHandler)),Has.mutationObserver?(_dialogObserver=new MutationObserver((function(mutations){for(var i=0;i<mutations.length;++i)if("childList"===mutations[i].type){_resizeHandler({data:{top:top}});break}}))).observe(_$dialogBody[0],{childList:!0,subtree:!0}):_$dialogBody.on("DOMNodeInserted.dialog-resize DOMNodeRemoved.dialog-resize",null,{top:top},jQuery.throttle(40,_resizeHandler)),jQuery(document).one("click.dialog-close",".ui-close",{closeFn:closeFn},(function(ev){dialogClose(ev)})).one("keypress.dialog-close",".ui-close",(function(ev){13!==ev.which&&32!==ev.which||jQuery(this).trigger("click")})),_$dialogBody.trigger(":dialogopen"),_$dialogBody.trigger(":dialogopened"),Dialog}function _calcPosition(topPos){var top=null!=topPos?topPos:50,$parent=jQuery(window),dialogPos={left:"",right:"",top:"",bottom:""};_$dialog.css(dialogPos);var horzSpace=$parent.width()-_$dialog.outerWidth(!0)-1,vertSpace=$parent.height()-_$dialog.outerHeight(!0)-1;return horzSpace<=32+_scrollbarWidth&&(vertSpace-=_scrollbarWidth),vertSpace<=32+_scrollbarWidth&&(horzSpace-=_scrollbarWidth),dialogPos.left=dialogPos.right=horzSpace<=32?16:horzSpace/2>>0,dialogPos.top=vertSpace<=32?dialogPos.bottom=16:vertSpace/2>top?top:dialogPos.bottom=vertSpace/2>>0,Object.keys(dialogPos).forEach((function(key){""!==dialogPos[key]&&(dialogPos[key]+="px")})),dialogPos}function _resizeHandler(ev){var top=ev&&ev.data&&void 0!==ev.data.top?ev.data.top:50;"block"===_$dialog.css("display")&&(_$dialog.css({display:"none"}),_$dialog.css(jQuery.extend({display:""},_calcPosition(top))))}return Object.freeze(Object.defineProperties({},{append:{value:function(){var _$dialogBody2;return(_$dialogBody2=_$dialogBody).append.apply(_$dialogBody2,arguments),Dialog}},body:{value:function(){return _$dialogBody.get(0)}},close:{value:dialogClose},init:{value:function(){if(!document.getElementById("ui-dialog")){_scrollbarWidth=function(){var scrollbarWidth;try{var inner=document.createElement("p"),outer=document.createElement("div");inner.style.width="100%",inner.style.height="200px",outer.style.position="absolute",outer.style.left="0px",outer.style.top="0px",outer.style.width="100px",outer.style.height="100px",outer.style.visibility="hidden",outer.style.overflow="hidden",outer.appendChild(inner),document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow="auto";var w2=inner.offsetWidth;w1===w2&&(w2=outer.clientWidth),document.body.removeChild(outer),scrollbarWidth=w1-w2}catch(ex){}return scrollbarWidth||17}();var $elems=jQuery(document.createDocumentFragment()).append('<div id="ui-overlay" class="ui-close"></div><div id="ui-dialog" tabindex="0" role="dialog" aria-labelledby="ui-dialog-title"><div id="ui-dialog-titlebar"><h1 id="ui-dialog-title"></h1>'+'<button id="ui-dialog-close" class="ui-close" tabindex="0" aria-label="'.concat(L10n.get("close"),'"></button>')+'</div><div id="ui-dialog-body"></div></div>');_$overlay=jQuery($elems.find("#ui-overlay").get(0)),_$dialog=jQuery($elems.find("#ui-dialog").get(0)),_$dialogTitle=jQuery($elems.find("#ui-dialog-title").get(0)),_$dialogBody=jQuery($elems.find("#ui-dialog-body").get(0)),$elems.insertBefore("body>script#script-sugarcube")}}},isOpen:{value:dialogIsOpen},open:{value:dialogOpen},resize:{value:function(data){return _resizeHandler("object"===_typeof(data)?{data:data}:undefined)}},setup:{value:function(title,classNames){return _$dialogBody.empty().removeClass(),null!=classNames&&_$dialogBody.addClass(classNames),_$dialogTitle.empty().append((null!=title?String(title):"")||" "),_$dialogBody.get(0)}},wiki:{value:function(){var _$dialogBody3;return(_$dialogBody3=_$dialogBody).wiki.apply(_$dialogBody3,arguments),Dialog}},addClickHandler:{value:function(targets,options,startFn,doneFn,closeFn){return jQuery(targets).ariaClick((function(ev){ev.preventDefault(),"function"==typeof startFn&&startFn(ev),dialogOpen(options,closeFn),"function"==typeof doneFn&&doneFn(ev)}))}}}))}(),Engine=function(){var States=Util.toEnum({Idle:"idle",Playing:"playing",Rendering:"rendering"}),_initDebugViews=[],_state=States.Idle,_lastPlay=null,_outlinePatch=null,_updating=null;function engineGo(offset){var succeded=State.go(offset);return succeded&&engineShow(),succeded}function engineShow(){return enginePlay(State.passage,!0)}function enginePlay(title,noHistory){var passageReadyOutput,passageDoneOutput,passageTitle=title;if(_state=States.Playing,TempState={},State.clearTemporary(),"function"==typeof Config.navigation.override)try{var overrideTitle=Config.navigation.override(passageTitle);overrideTitle&&(passageTitle=overrideTitle)}catch(ex){}var passage=Story.get(passageTitle);if(jQuery.event.trigger({type:":passageinit",passage:passage}),Object.keys(prehistory).forEach((function(task){"function"==typeof prehistory[task]&&prehistory[task].call(passage,task)})),noHistory||State.create(passage.title),document.body.className&&(document.body.className=""),_lastPlay=Util.now(),Object.keys(predisplay).forEach((function(task){"function"==typeof predisplay[task]&&predisplay[task].call(passage,task)})),Story.has("PassageReady"))try{passageReadyOutput=Wikifier.wikifyEval(Story.get("PassageReady").text)}catch(ex){console.error(ex),Alert.error("PassageReady",ex.message)}_state=States.Rendering;var dataTags=passage.tags.length>0?passage.tags.join(" "):null,passageEl=document.createElement("div");jQuery(passageEl).attr({id:passage.domId,"data-passage":passage.title,"data-tags":dataTags}).addClass("passage ".concat(passage.className)),jQuery(document.body).attr("data-tags",dataTags).addClass(passage.className),jQuery(document.documentElement).attr("data-tags",dataTags),jQuery.event.trigger({type:":passagestart",content:passageEl,passage:passage}),Object.keys(prerender).forEach((function(task){"function"==typeof prerender[task]&&prerender[task].call(passage,passageEl,task)})),Story.has("PassageHeader")&&new Wikifier(passageEl,Story.get("PassageHeader").processText()),passageEl.appendChild(passage.render()),Story.has("PassageFooter")&&new Wikifier(passageEl,Story.get("PassageFooter").processText()),jQuery.event.trigger({type:":passagerender",content:passageEl,passage:passage}),Object.keys(postrender).forEach((function(task){"function"==typeof postrender[task]&&postrender[task].call(passage,passageEl,task)}));var debugView,containerEl=document.getElementById("passages");if(containerEl.hasChildNodes()&&("number"==typeof Config.passages.transitionOut||"string"==typeof Config.passages.transitionOut&&""!==Config.passages.transitionOut&&Has.transitionEndEvent?_toConsumableArray(containerEl.childNodes).forEach((function(outgoing){var $outgoing=jQuery(outgoing);if(outgoing.nodeType===Node.ELEMENT_NODE&&$outgoing.hasClass("passage")){if($outgoing.hasClass("passage-out"))return;$outgoing.attr({id:"out-".concat($outgoing.attr("id")),"aria-live":"off"}).addClass("passage-out"),"string"==typeof Config.passages.transitionOut?$outgoing.on(Has.transitionEndEvent,(function(ev){ev.propertyName===Config.passages.transitionOut&&$outgoing.remove()})):setTimeout((function(){return $outgoing.remove()}),Math.max(40,Config.passages.transitionOut))}else $outgoing.remove()})):jQuery(containerEl).empty()),jQuery(passageEl).addClass("passage-in").appendTo(containerEl),setTimeout((function(){return jQuery(passageEl).removeClass("passage-in")}),40),Story.has("StoryDisplayTitle")?null===_updating&&Config.ui.updateStoryElements||setDisplayTitle(Story.get("StoryDisplayTitle").processText()):Config.passages.displayTitles&&passage.title!==Config.passages.start&&(document.title="".concat(passage.title," | ").concat(Story.title)),window.scroll(0,0),_state=States.Playing,Story.has("PassageDone"))try{passageDoneOutput=Wikifier.wikifyEval(Story.get("PassageDone").text)}catch(ex){console.error(ex),Alert.error("PassageDone",ex.message)}(jQuery.event.trigger({type:":passagedisplay",content:passageEl,passage:passage}),Object.keys(postdisplay).forEach((function(task){"function"==typeof postdisplay[task]&&postdisplay[task].call(passage,task)})),null!==_updating?_updating.forEach((function(pair){jQuery(pair.element).empty(),new Wikifier(pair.element,Story.get(pair.passage).processText().trim())})):Config.ui.updateStoryElements&&UIBar.update(),Config.debug)&&(null!=passageReadyOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageReady","PassageReady")).modes({hidden:!0}),debugView.append(passageReadyOutput),jQuery(passageEl).prepend(debugView.output)),null!=passageDoneOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageDone","PassageDone")).modes({hidden:!0}),debugView.append(passageDoneOutput),jQuery(passageEl).append(debugView.output)),1===State.turns&&_initDebugViews.length>0&&jQuery(passageEl).prepend(_initDebugViews));switch(jQuery("#story").find("a[href]:not(.link-external)").addClass("link-external").end().find("a,link,button,input,select,textarea").not("[tabindex]").attr("tabindex",0),_typeof(Config.saves.autosave)){case"boolean":Config.saves.autosave&&Save.autosave.save();break;case"object":passage.tags.some((function(tag){return Config.saves.autosave.includes(tag)}))&&Save.autosave.save();break;case"function":Config.saves.autosave()&&Save.autosave.save()}return jQuery.event.trigger({type:":passageend",content:passageEl,passage:passage}),_state=States.Idle,_lastPlay=Util.now(),passageEl}function _hideOutlines(){_outlinePatch.set("*:focus{outline:none;}")}return Object.freeze(Object.defineProperties({},{States:{value:States},minDomActionDelay:{value:40},init:{value:function(){var _lastOutlineEvent;jQuery("#init-no-js,#init-lacking").remove(),function(){var $elems=jQuery(document.createDocumentFragment()),markup=Story.has("StoryInterface")&&Story.get("StoryInterface").text.trim();if(markup){UIBar.destroy(),jQuery(document.head).find("#style-core-display").remove(),$elems.append(markup);var $passages=$elems.find("#passages");if(0===$passages.length)throw new Error('no element with ID "passages" found within "StoryInterface" special passage');$passages.empty().not("[aria-live]").attr("aria-live","polite").end(),$elems.find("[data-init-passage]").each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-init-passage" content attribute'));var passage=el.getAttribute("data-init-passage").trim();if(el.hasAttribute("data-passage"))throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> must not contain a "data-passage" content attribute'));if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&jQuery(el).empty().wiki(Story.get(passage).processText().trim())}));var updating=[];$elems.find("[data-passage]").each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-passage" content attribute'));var passage=el.getAttribute("data-passage").trim();if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&updating.push({passage:passage,element:el})})),updating.length>0&&(_updating=updating),Config.ui.updateStoryElements=!1}else $elems.append('<div id="story" role="main"><div id="passages" aria-live="polite"></div></div>');$elems.insertBefore("body>script#script-sugarcube")}(),_outlinePatch=new StyleWrapper(jQuery(document.createElement("style")).attr({id:"style-aria-outlines",type:"text/css"}).appendTo(document.head).get(0)),_hideOutlines(),jQuery(document).on("mousedown.aria-outlines keydown.aria-outlines",(function(ev){ev.type!==_lastOutlineEvent&&(_lastOutlineEvent=ev.type,"keydown"===ev.type?_outlinePatch.clear():_hideOutlines())}))}},start:{value:function(){if(Story.getAllInit().forEach((function(passage){try{var debugBuffer=Wikifier.wikifyEval(passage.text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","".concat(passage.title," [init-tagged]"),"".concat(passage.title," [init-tagged]"));debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("".concat(passage.title," [init-tagged]"),"object"===_typeof(ex)?ex.message:ex)}})),Story.has("StoryInit"))try{var debugBuffer=Wikifier.wikifyEval(Story.get("StoryInit").text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","StoryInit","StoryInit");debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("StoryInit","object"===_typeof(ex)?ex.message:ex)}if(null==Config.passages.start)throw new Error("starting passage not selected");if(!Story.has(Config.passages.start))throw new Error('starting passage ("'.concat(Config.passages.start,'") not found'));if(jQuery(document.documentElement).focus(),State.restore())engineShow();else{var loadStart=!0;switch(_typeof(Config.saves.autoload)){case"boolean":Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(loadStart=!Save.autosave.load());break;case"string":"prompt"===Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(loadStart=!1,UI.buildAutoload(),Dialog.open());break;case"function":Save.autosave.ok()&&Save.autosave.has()&&Config.saves.autoload()&&(loadStart=!Save.autosave.load())}loadStart&&enginePlay(Config.passages.start)}}},restart:{value:function(){LoadScreen.show(),window.scroll(0,0),State.reset(),jQuery.event.trigger(":enginerestart"),window.location.reload()}},state:{get:function(){return _state}},isIdle:{value:function(){return _state===States.Idle}},isPlaying:{value:function(){return _state!==States.Idle}},isRendering:{value:function(){return _state===States.Rendering}},lastPlay:{get:function(){return _lastPlay}},goTo:{value:function(idx){var succeded=State.goTo(idx);return succeded&&engineShow(),succeded}},go:{value:engineGo},backward:{value:function(){return engineGo(-1)}},forward:{value:function(){return engineGo(1)}},show:{value:engineShow},play:{value:enginePlay},display:{value:function(title,link,option){var noHistory=!1;switch(option){case undefined:break;case"replace":case"back":noHistory=!0;break;default:throw new Error('Engine.display option parameter called with obsolete value "'.concat(option,'"; please notify the developer'))}enginePlay(title,noHistory)}}}))}(),Passage=(_tagsToSkip=/^(?:debug|nobr|passage|widget|twine\..*)$/i,function(){function Passage(title,el){var _this22=this;_classCallCheck(this,Passage),Object.defineProperties(this,{title:{value:Util.unescape(title)},element:{value:el||null},tags:{value:Object.freeze(el&&el.hasAttribute("tags")?Array.from(new Set(el.getAttribute("tags").trim().splitOrEmpty(/\s+/))):[])},_excerpt:{writable:!0,value:null}}),Object.defineProperties(this,{domId:{value:"passage-".concat(Util.slugify(this.title))},classes:{value:Object.freeze(0===this.tags.length?[]:_this22.tags.filter((function(tag){return!_tagsToSkip.test(tag)})).map((function(tag){return Util.slugify(tag)})))}})}return _createClass(Passage,[{key:"className",get:function(){return this.classes.join(" ")}},{key:"text",get:function(){if(null==this.element){var passage=Util.escapeMarkup(this.title),mesg="".concat(L10n.get("errorTitle"),": ").concat(L10n.get("errorNonexistentPassage",{passage:passage}));return'<div class="error-view"><span class="error">'.concat(mesg,"</span></div>")}return this.element.textContent.replace(/\r/g,"")}},{key:"description",value:function(){var descriptions=Config.passages.descriptions;switch(_typeof(descriptions)){case"boolean":if(descriptions)return this.title;break;case"object":if(descriptions.hasOwnProperty(this.title))return descriptions[this.title];break;case"function":var result=descriptions.call(this);if(result)return result}return null===this._excerpt&&(this._excerpt=Passage.getExcerptFromText(this.text)),this._excerpt}},{key:"processText",value:function(){if(null==this.element)return this.text;if(this.tags.includes("Twine.image"))return"[img[".concat(this.text,"]]");var processed=this.text;return Config.passages.onProcess&&(processed=Config.passages.onProcess.call(null,{title:this.title,tags:this.tags,text:processed})),(Config.passages.nobr||this.tags.includes("nobr"))&&(processed=processed.replace(/^\n+|\n+$/g,"").replace(/\n+/g," ")),processed}},{key:"render",value:function(options){var frag=document.createDocumentFragment();return new Wikifier(frag,this.processText(),options),this._excerpt=Passage.getExcerptFromNode(frag),frag}}],[{key:"getExcerptFromNode",value:function(node,count){if(!node.hasChildNodes())return"";var excerpt=node.textContent.trim();if(""!==excerpt){var excerptRe=new RegExp("(\\S+(?:\\s+\\S+){0,".concat(count>0?count-1:7,"})"));excerpt=excerpt.replace(/\s+/g," ").match(excerptRe)}return excerpt?"".concat(excerpt[1],"…"):"…"}},{key:"getExcerptFromText",value:function(text,count){if(""===text)return"";var excerptRe=new RegExp("(\\S+(?:\\s+\\S+){0,".concat(count>0?count-1:7,"})")),excerpt=text.replace(/<<.*?>>/g," ").replace(/<.*?>/g," ").trim().replace(/^\s*\|.*\|.*?$/gm,"").replace(/\[[<>]?img\[[^\]]*\]\]/g,"").replace(/\[\[([^|\]]*?)(?:(?:\||->|<-)[^\]]*)?\]\]/g,"$1").replace(/^\s*!+(.*?)$/gm,"$1").replace(/'{2}|\/{2}|_{2}|@{2}/g,"").trim().replace(/\s+/g," ").match(excerptRe);return excerpt?"".concat(excerpt[1],"…"):"…"}}]),Passage}()),_tagsToSkip,Save=function(){var Type=Util.toEnum({Autosave:"autosave",Disk:"disk",Serialize:"serialize",Slot:"slot"}),_slotsUBound=-1,_onLoadHandlers=new Set,_onSaveHandlers=new Set;function savesObjGet(){var saves=storage.get("saves");return null===saves?{autosave:null,slots:_appendSlots([],Config.saves.slots)}:saves}function savesObjClear(){return storage.delete("saves"),!0}function autosaveOk(){return"cookie"!==storage.name&&void 0!==Config.saves.autosave}function slotsOk(){return"cookie"!==storage.name&&-1!==_slotsUBound}function slotsCount(){if(!slotsOk())return 0;for(var saves=savesObjGet(),count=0,i=0,iend=saves.slots.length;i<iend;++i)null!==saves.slots[i]&&++count;return count}function _appendSlots(array,num){for(var i=0;i<num;++i)array.push(null);return array}function _savesObjIsEmpty(saves){for(var slots=saves.slots,isSlotsEmpty=!0,i=0,iend=slots.length;i<iend;++i)if(null!==slots[i]){isSlotsEmpty=!1;break}return null===saves.autosave&&isSlotsEmpty}function _savesObjSave(saves){return _savesObjIsEmpty(saves)?(storage.delete("saves"),!0):storage.set("saves",saves)}function _savesObjUpdate(saveObj){if(null==saveObj||"object"!==_typeof(saveObj))return!1;var updated=!1;return saveObj.hasOwnProperty("state")&&saveObj.state.hasOwnProperty("delta")&&saveObj.state.hasOwnProperty("index")||(saveObj.hasOwnProperty("data")?(delete saveObj.mode,saveObj.state={delta:State.deltaEncode(saveObj.data)},delete saveObj.data):saveObj.state.hasOwnProperty("delta")?saveObj.state.hasOwnProperty("index")||delete saveObj.state.mode:(delete saveObj.state.mode,saveObj.state.delta=State.deltaEncode(saveObj.state.history),delete saveObj.state.history),saveObj.state.index=saveObj.state.delta.length-1,updated=!0),saveObj.state.hasOwnProperty("rseed")&&(saveObj.state.seed=saveObj.state.rseed,delete saveObj.state.rseed,saveObj.state.delta.forEach((function(_,i,delta){delta[i].hasOwnProperty("rcount")&&(delta[i].pull=delta[i].rcount,delete delta[i].rcount)})),updated=!0),(saveObj.state.hasOwnProperty("expired")&&"number"==typeof saveObj.state.expired||saveObj.state.hasOwnProperty("unique")||saveObj.state.hasOwnProperty("last"))&&(saveObj.state.hasOwnProperty("expired")&&"number"==typeof saveObj.state.expired&&delete saveObj.state.expired,(saveObj.state.hasOwnProperty("unique")||saveObj.state.hasOwnProperty("last"))&&(saveObj.state.expired=[],saveObj.state.hasOwnProperty("unique")&&(saveObj.state.expired.push(saveObj.state.unique),delete saveObj.state.unique),saveObj.state.hasOwnProperty("last")&&(saveObj.state.expired.push(saveObj.state.last),delete saveObj.state.last)),updated=!0),updated}function _marshal(supplemental,details){if(null!=supplemental&&"object"!==_typeof(supplemental))throw new Error("supplemental parameter must be an object");var saveObj=Object.assign({},supplemental,{id:Config.saves.id,state:State.marshalForSave()});return Config.saves.version&&(saveObj.version=Config.saves.version),_onSaveHandlers.forEach((function(fn){return fn(saveObj,details)})),saveObj.state.delta=State.deltaEncode(saveObj.state.history),delete saveObj.state.history,saveObj}function _unmarshal(saveObj){try{if(_savesObjUpdate(saveObj),!saveObj||!saveObj.hasOwnProperty("id")||!saveObj.hasOwnProperty("state"))throw new Error(L10n.get("errorSaveMissingData"));if(saveObj.state.history=State.deltaDecode(saveObj.state.delta),delete saveObj.state.delta,_onLoadHandlers.forEach((function(fn){return fn(saveObj)})),saveObj.id!==Config.saves.id)throw new Error(L10n.get("errorSaveIdMismatch"));State.unmarshalForSave(saveObj.state),Engine.show()}catch(ex){return UI.alert("".concat(ex.message.toUpperFirst(),".</p><p>").concat(L10n.get("aborting"),".")),!1}return!0}return Object.freeze(Object.defineProperties({},{init:{value:function(){if("cookie"===storage.name)return savesObjClear(),Config.saves.autoload=undefined,Config.saves.autosave=undefined,Config.saves.slots=0,!1;var saves=savesObjGet(),updated=!1;Array.isArray(saves)&&(saves={autosave:null,slots:saves},updated=!0),Config.saves.slots!==saves.slots.length&&(Config.saves.slots<saves.slots.length?(saves.slots.reverse(),saves.slots=saves.slots.filter((function(val){return!(null===val&&this.count>0)||(--this.count,!1)}),{count:saves.slots.length-Config.saves.slots}),saves.slots.reverse()):Config.saves.slots>saves.slots.length&&_appendSlots(saves.slots,Config.saves.slots-saves.slots.length),updated=!0),_savesObjUpdate(saves.autosave)&&(updated=!0);for(var i=0;i<saves.slots.length;++i)_savesObjUpdate(saves.slots[i])&&(updated=!0);return _savesObjIsEmpty(saves)&&(storage.delete("saves"),updated=!1),updated&&_savesObjSave(saves),_slotsUBound=saves.slots.length-1,!0}},get:{value:savesObjGet},clear:{value:savesObjClear},ok:{value:function(){return autosaveOk()||slotsOk()}},autosave:{value:Object.freeze(Object.defineProperties({},{ok:{value:autosaveOk},has:{value:function(){return null!==savesObjGet().autosave}},get:{value:function(){return savesObjGet().autosave}},load:{value:function(){var saves=savesObjGet();return null!==saves.autosave&&_unmarshal(saves.autosave)}},save:{value:function(title,metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return!1;var saves=savesObjGet(),supplemental={title:title||Story.get(State.passage).description(),date:Date.now()};return null!=metadata&&(supplemental.metadata=metadata),saves.autosave=_marshal(supplemental,{type:Type.Autosave}),_savesObjSave(saves)}},delete:{value:function(){var saves=savesObjGet();return saves.autosave=null,_savesObjSave(saves)}}}))},slots:{value:Object.freeze(Object.defineProperties({},{ok:{value:slotsOk},length:{get:function(){return _slotsUBound+1}},isEmpty:{value:function(){return 0===slotsCount()}},count:{value:slotsCount},has:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length||null===saves.slots[slot])}},get:{value:function(slot){if(slot<0||slot>_slotsUBound)return null;var saves=savesObjGet();return slot>=saves.slots.length?null:saves.slots[slot]}},load:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length||null===saves.slots[slot])&&_unmarshal(saves.slots[slot])}},save:{value:function(slot,title,metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed")),!1;if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();if(slot>=saves.slots.length)return!1;var supplemental={title:title||Story.get(State.passage).description(),date:Date.now()};return null!=metadata&&(supplemental.metadata=metadata),saves.slots[slot]=_marshal(supplemental,{type:Type.Slot}),_savesObjSave(saves)}},delete:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length)&&(saves.slots[slot]=null,_savesObjSave(saves))}}}))},export:{value:function(filename,metadata){if("function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed()){var str,now,MM,DD,hh,mm,ss,baseName=null==filename?Story.domId:(str=filename,Util.sanitizeFilename(str).replace(/[_\s\u2013\u2014-]+/g,"-")),saveName="".concat(baseName,"-").concat((now=new Date,MM=now.getMonth()+1,DD=now.getDate(),hh=now.getHours(),mm=now.getMinutes(),ss=now.getSeconds(),MM<10&&(MM="0".concat(MM)),DD<10&&(DD="0".concat(DD)),hh<10&&(hh="0".concat(hh)),mm<10&&(mm="0".concat(mm)),ss<10&&(ss="0".concat(ss)),"".concat(now.getFullYear()).concat(MM).concat(DD,"-").concat(hh).concat(mm).concat(ss)),".save"),supplemental=null==metadata?{}:{metadata:metadata},saveObj=LZString.compressToBase64(JSON.stringify(_marshal(supplemental,{type:Type.Disk})));saveAs(new Blob([saveObj],{type:"text/plain;charset=UTF-8"}),saveName)}else Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed"))}},import:{value:function(event){var file=event.target.files[0],reader=new FileReader;jQuery(reader).one("loadend",(function(){if(reader.error){var ex=reader.error;UI.alert("".concat(L10n.get("errorSaveDiskLoadFailed").toUpperFirst()," (").concat(ex.name,": ").concat(ex.message,").</p><p>").concat(L10n.get("aborting"),"."))}else{var saveObj;try{saveObj=JSON.parse(/\.json$/i.test(file.name)||/^\{/.test(reader.result)?reader.result:LZString.decompressFromBase64(reader.result))}catch(ex){}_unmarshal(saveObj)}})),reader.readAsText(file)}},serialize:{value:function(metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed")),null;var supplemental=null==metadata?{}:{metadata:metadata};return LZString.compressToBase64(JSON.stringify(_marshal(supplemental,{type:Type.Serialize})))}},deserialize:{value:function(base64Str){var saveObj;try{saveObj=JSON.parse(LZString.decompressFromBase64(base64Str))}catch(ex){}return _unmarshal(saveObj)?saveObj.metadata:null}},onLoad:{value:Object.freeze(Object.defineProperties({},{add:{value:function(handler){var valueType=Util.getType(handler);if("function"!==valueType)throw new TypeError("Save.onLoad.add handler parameter must be a function (received: ".concat(valueType,")"));_onLoadHandlers.add(handler)}},clear:{value:function(){_onLoadHandlers.clear()}},delete:{value:function(handler){return _onLoadHandlers.delete(handler)}},size:{get:function(){return _onLoadHandlers.size}}}))},onSave:{value:Object.freeze(Object.defineProperties({},{add:{value:function(handler){var valueType=Util.getType(handler);if("function"!==valueType)throw new TypeError("Save.onSave.add handler parameter must be a function (received: ".concat(valueType,")"));_onSaveHandlers.add(handler)}},clear:{value:function(){_onSaveHandlers.clear()}},delete:{value:function(handler){return _onSaveHandlers.delete(handler)}},size:{get:function(){return _onSaveHandlers.size}}}))}}))}(),Setting=function(){var Types=Util.toEnum({Header:0,Toggle:1,List:2,Range:3}),_definitions=[];function settingsCreate(){return Object.create(null)}function settingsSave(){var savedSettings=settingsCreate();return Object.keys(settings).length>0&&_definitions.filter((function(def){return def.type!==Types.Header&&settings[def.name]!==def.default})).forEach((function(def){return savedSettings[def.name]=settings[def.name]})),0===Object.keys(savedSettings).length?(storage.delete("settings"),!0):storage.set("settings",savedSettings)}function settingsLoad(){var defaultSettings=settingsCreate(),loadedSettings=storage.get("settings")||settingsCreate();_definitions.filter((function(def){return def.type!==Types.Header})).forEach((function(def){return defaultSettings[def.name]=def.default})),window.SugarCube.settings=settings=Object.assign(defaultSettings,loadedSettings)}function settingsClear(){return window.SugarCube.settings=settings=settingsCreate(),storage.delete("settings"),!0}function definitionsAdd(type,name,def){if(arguments.length<3){var errors=[];throw arguments.length<1&&errors.push("type"),arguments.length<2&&errors.push("name"),arguments.length<3&&errors.push("definition"),new Error("missing parameters, no ".concat(errors.join(" or ")," specified"))}if("object"!==_typeof(def))throw new TypeError("definition parameter must be an object");if(definitionsHas(name))throw new Error('cannot clobber existing setting "'.concat(name,'"'));var str,pos,definition={type:type,name:name,label:"string"==typeof def.label?def.label.trim():""};if("string"==typeof def.desc){var desc=def.desc.trim();""!==desc&&(definition.desc=desc)}switch(type){case Types.Header:break;case Types.Toggle:definition.default=!!def.default;break;case Types.List:if(!def.hasOwnProperty("list"))throw new Error("no list specified");if(!Array.isArray(def.list))throw new TypeError("list must be an array");if(0===def.list.length)throw new Error("list must not be empty");if(definition.list=Object.freeze(def.list),null==def.default)definition.default=def.list[0];else{var defaultIndex=def.list.indexOf(def.default);if(-1===defaultIndex)throw new Error("list does not contain default");definition.default=def.list[defaultIndex]}break;case Types.Range:if(!def.hasOwnProperty("min"))throw new Error("no min specified");if("number"!=typeof def.min||Number.isNaN(def.min)||!Number.isFinite(def.min))throw new TypeError("min must be a finite number");if(!def.hasOwnProperty("max"))throw new Error("no max specified");if("number"!=typeof def.max||Number.isNaN(def.max)||!Number.isFinite(def.max))throw new TypeError("max must be a finite number");if(!def.hasOwnProperty("step"))throw new Error("no step specified");if("number"!=typeof def.step||Number.isNaN(def.step)||!Number.isFinite(def.step)||def.step<=0)throw new TypeError("step must be a finite number greater than zero");var stepValidate=function(value){if(fracDigits>0){var ma=Number("".concat(def.min,"e").concat(fracDigits)),sa=Number("".concat(def.step,"e").concat(fracDigits)),_va=Number("".concat(value,"e").concat(fracDigits))-ma;return Number("".concat(_va-_va%sa+ma,"e-").concat(fracDigits))}var va=value-def.min;return va-va%def.step+def.min},fracDigits=(str=String(def.step),-1===(pos=str.lastIndexOf("."))?0:str.length-pos-1);if(stepValidate(def.max)!==def.max)throw new RangeError("max (".concat(def.max,") is not a multiple of the step (").concat(def.step,") plus the min (").concat(def.min,")"));if(definition.max=def.max,definition.min=def.min,definition.step=def.step,null==def.default)definition.default=def.max;else{if("number"!=typeof def.default||Number.isNaN(def.default)||!Number.isFinite(def.default))throw new TypeError("default must be a finite number");if(def.default<def.min)throw new RangeError("default (".concat(def.default,") is less than min (").concat(def.min,")"));if(def.default>def.max)throw new RangeError("default (".concat(def.default,") is greater than max (").concat(def.max,")"));definition.default=def.default}break;default:throw new Error("unknown Setting type: ".concat(type))}"function"==typeof def.onInit&&(definition.onInit=Object.freeze(def.onInit)),"function"==typeof def.onChange&&(definition.onChange=Object.freeze(def.onChange)),_definitions.push(Object.freeze(definition))}function definitionsHas(name){return _definitions.some((function(definition){return definition.name===name}))}function definitionsGet(name){return _definitions.find((function(definition){return definition.name===name}))}return Object.freeze(Object.defineProperties({},{Types:{value:Types},init:{value:function(){if(storage.has("options")){var old=storage.get("options");null!==old&&(window.SugarCube.settings=settings=Object.assign(settingsCreate(),old)),settingsSave(),storage.delete("options")}settingsLoad(),_definitions.forEach((function(def){if(def.hasOwnProperty("onInit")){var thisArg={name:def.name,value:settings[def.name],default:def.default};def.hasOwnProperty("list")&&(thisArg.list=def.list),def.onInit.call(thisArg)}}))}},create:{value:settingsCreate},save:{value:settingsSave},load:{value:settingsLoad},clear:{value:settingsClear},reset:{value:function(name){if(0===arguments.length)settingsClear(),settingsLoad();else{if(null==name||!definitionsHas(name))throw new Error('nonexistent setting "'.concat(name,'"'));var def=definitionsGet(name);def.type!==Types.Header&&(settings[name]=def.default)}return settingsSave()}},forEach:{value:function(callback,thisArg){_definitions.forEach(callback,thisArg)}},add:{value:definitionsAdd},addHeader:{value:function(name,desc){definitionsAdd(Types.Header,name,{desc:desc})}},addToggle:{value:function(){for(var _len16=arguments.length,args=new Array(_len16),_key16=0;_key16<_len16;_key16++)args[_key16]=arguments[_key16];definitionsAdd.apply(void 0,[Types.Toggle].concat(args))}},addList:{value:function(){for(var _len17=arguments.length,args=new Array(_len17),_key17=0;_key17<_len17;_key17++)args[_key17]=arguments[_key17];definitionsAdd.apply(void 0,[Types.List].concat(args))}},addRange:{value:function(){for(var _len18=arguments.length,args=new Array(_len18),_key18=0;_key18<_len18;_key18++)args[_key18]=arguments[_key18];definitionsAdd.apply(void 0,[Types.Range].concat(args))}},isEmpty:{value:function(){return 0===_definitions.length}},has:{value:definitionsHas},get:{value:definitionsGet},delete:{value:function definitionsDelete(name){definitionsHas(name)&&delete settings[name];for(var i=0;i<_definitions.length;++i)if(_definitions[i].name===name){_definitions.splice(i,1),definitionsDelete(name);break}}}}))}(),Story=function(){var _passages={},_inits=[],_scripts=[],_styles=[],_widgets=[],_title="",_ifId="",_domId="";function _storySetTitle(rawTitle){if(null==rawTitle)throw new Error("story title must not be null or undefined");var title=Util.unescape(String(rawTitle)).trim();if(""===title)throw new Error("story title must not be empty or consist solely of whitespace");if(document.title=_title=title,""===(_domId=Util.slugify(_title)))if(""!==_ifId)_domId=_ifId;else for(var i=0,len=_title.length;i<len;++i){var _Util$charAndPosAt2=Util.charAndPosAt(_title,i),char=_Util$charAndPosAt2.char,start=_Util$charAndPosAt2.start,end=_Util$charAndPosAt2.end;_domId+=char.codePointAt(0).toString(16),i+=end-start}}return Object.freeze(Object.defineProperties({},{load:{value:function(){var validationCodeTags=["init","widget"],validationNoCodeTagPassages=["PassageDone","PassageFooter","PassageHeader","PassageReady","StoryAuthor","StoryBanner","StoryCaption","StoryInit","StoryMenu","StoryShare","StorySubtitle"];function validateStartingPassage(passage){if(passage.tags.includesAny(validationCodeTags))throw new Error('starting passage "'.concat(passage.title,'" contains special tags; invalid: "').concat(passage.tags.filter((function(tag){return validationCodeTags.includes(tag)})).sort().join('", "'),'"'))}function validateSpecialPassages(passage){if(validationNoCodeTagPassages.includes(passage.title)){for(var _len19=arguments.length,tags=new Array(_len19>1?_len19-1:0),_key19=1;_key19<_len19;_key19++)tags[_key19-1]=arguments[_key19];throw new Error('special passage "'.concat(passage.title,'" contains special tags; invalid: "').concat(tags.sort().join('", "'),'"'))}var codeTags=[].concat(validationCodeTags),foundTags=[];if(passage.tags.forEach((function(tag){codeTags.includes(tag)&&foundTags.push.apply(foundTags,_toConsumableArray(codeTags.delete(tag)))})),foundTags.length>1)throw new Error('passage "'.concat(passage.title,'" contains multiple special tags; invalid: "').concat(foundTags.sort().join('", "'),'"'))}var $storydata=jQuery("tw-storydata"),startNode=$storydata.attr("startnode")||"";Config.passages.start=null,Config.debug=/\bdebug\b/.test($storydata.attr("options")),$storydata.children("style").each((function(i){_styles.push(new Passage("tw-user-style-".concat(i),this))})),$storydata.children("script").each((function(i){_scripts.push(new Passage("tw-user-script-".concat(i),this))})),$storydata.children('tw-passagedata:not([tags~="Twine.private"],[tags~="annotation"])').each((function(){var $this=jQuery(this),pid=$this.attr("pid")||"",passage=new Passage($this.attr("name"),this);pid===startNode&&""!==startNode?(Config.passages.start=passage.title,validateStartingPassage(passage),_passages[passage.title]=passage):passage.tags.includes("init")?(validateSpecialPassages(passage,"init"),_inits.push(passage)):passage.tags.includes("widget")?(validateSpecialPassages(passage,"widget"),_widgets.push(passage)):_passages[passage.title]=passage})),_ifId=$storydata.attr("ifid"),_storySetTitle("Battle Quest"),Config.saves.id=Story.domId}},init:{value:function(){var storyStyle;storyStyle=document.createElement("style"),new StyleWrapper(storyStyle).add(_styles.map((function(style){return style.text.trim()})).join("\n")),jQuery(storyStyle).appendTo(document.head).attr({id:"style-story",type:"text/css"});for(var i=0;i<_scripts.length;++i)try{Scripting.evalJavaScript(_scripts[i].text)}catch(ex){console.error(ex),Alert.error(_scripts[i].title,"object"===_typeof(ex)?ex.message:ex)}for(var _i8=0;_i8<_widgets.length;++_i8)try{Wikifier.wikifyEval(_widgets[_i8].processText())}catch(ex){console.error(ex),Alert.error(_widgets[_i8].title,"object"===_typeof(ex)?ex.message:ex)}}},title:{get:function(){return _title}},domId:{get:function(){return _domId}},ifId:{get:function(){return _ifId}},add:{value:function(passage){if(!(passage instanceof Passage))throw new TypeError("Story.add passage parameter must be an instance of Passage");var title=passage.title;return!_passages.hasOwnProperty(title)&&(_passages[title]=passage,!0)}},has:{value:function(title){var type=_typeof(title);switch(type){case"number":case"string":return _passages.hasOwnProperty(String(title));case"undefined":break;case"object":type=null===title?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.has title parameter cannot be ".concat(type))}},get:{value:function(title){var type=_typeof(title);switch(type){case"number":case"string":var id=String(title);return _passages.hasOwnProperty(id)?_passages[id]:new Passage(id||"(unknown)");case"undefined":break;case"object":type=null===title?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.get title parameter cannot be ".concat(type))}},getAllInit:{value:function(){return Object.freeze(Array.from(_inits))}},getAllRegular:{value:function(){return Object.freeze(Object.assign({},_passages))}},getAllScript:{value:function(){return Object.freeze(Array.from(_scripts))}},getAllStylesheet:{value:function(){return Object.freeze(Array.from(_styles))}},getAllWidget:{value:function(){return Object.freeze(Array.from(_widgets))}},lookup:{value:function(key,value){var sortKey=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"title",results=[];return Object.keys(_passages).forEach((function(name){var passage=_passages[name];"object"===_typeof(passage[key])&&null!==passage[key]?passage[key]instanceof Array&&passage[key].some((function(m){return Util.sameValueZero(m,value)}))&&results.push(passage):Util.sameValueZero(passage[key],value)&&results.push(passage)})),results.sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1})),results}},lookupWith:{value:function(predicate){var sortKey=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"title";if("function"!=typeof predicate)throw new TypeError("Story.lookupWith predicate parameter must be a function");var results=[];return Object.keys(_passages).forEach((function(name){var passage=_passages[name];predicate(passage)&&results.push(passage)})),results.sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1})),results}}}))}(),UI=function(){function uiAssembleLinkList(passage,listEl){var list=listEl,debugState=Config.debug,cleanState=Config.cleanupWikifierOutput;Config.debug=!1,Config.cleanupWikifierOutput=!1;try{null==list&&(list=document.createElement("ul"));var frag=document.createDocumentFragment();new Wikifier(frag,Story.get(passage).processText().trim());var errors=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "));for(;frag.hasChildNodes();){var node=frag.firstChild;if(node.nodeType===Node.ELEMENT_NODE&&"A"===node.nodeName.toUpperCase()){var li=document.createElement("li");list.appendChild(li),li.appendChild(node)}else frag.removeChild(node)}}finally{Config.cleanupWikifierOutput=cleanState,Config.debug=debugState}return list}function uiOpenAlert(message){jQuery(Dialog.setup(L10n.get("alertTitle"),"alert")).append("<p>".concat(message,'</p><ul class="buttons">')+'<li><button id="alert-ok" class="ui-close">'.concat(L10n.get(["alertOk","ok"]),"</button></li>")+"</ul>");for(var _len20=arguments.length,args=new Array(_len20>1?_len20-1:0),_key20=1;_key20<_len20;_key20++)args[_key20-1]=arguments[_key20];Dialog.open.apply(Dialog,args)}function uiBuildAutoload(){return jQuery(Dialog.setup(L10n.get("autoloadTitle"),"autoload")).append("<p>".concat(L10n.get("autoloadPrompt"),'</p><ul class="buttons">')+'<li><button id="autoload-ok" class="ui-close">'.concat(L10n.get(["autoloadOk","ok"]),"</button></li>")+'<li><button id="autoload-cancel" class="ui-close">'.concat(L10n.get(["autoloadCancel","cancel"]),"</button></li>")+"</ul>"),jQuery(document).one("click.autoload",".ui-close",(function(ev){var isAutoloadOk="autoload-ok"===ev.target.id;jQuery(document).one(":dialogclosed",(function(){isAutoloadOk&&Save.autosave.load()||Engine.play(Config.passages.start)}))})),!0}function uiBuildJumpto(){var list=document.createElement("ul");jQuery(Dialog.setup(L10n.get("jumptoTitle"),"jumpto list")).append(list);for(var expired=State.expired.length,i=State.size-1;i>=0;--i)if(i!==State.activeIndex){var passage=Story.get(State.history[i].title);passage&&passage.tags.includes("bookmark")&&jQuery(document.createElement("li")).append(jQuery(document.createElement("a")).ariaClick({one:!0},function(idx){return function(){return jQuery(document).one(":dialogclosed",(function(){return Engine.goTo(idx)}))}}(i)).addClass("ui-close").text("".concat(L10n.get("jumptoTurn")," ").concat(expired+i+1,": ").concat(passage.description()))).appendTo(list)}list.hasChildNodes()||jQuery(list).append("<li><a><em>".concat(L10n.get("jumptoUnavailable"),"</em></a></li>"))}function uiBuildRestart(){return jQuery(Dialog.setup(L10n.get("restartTitle"),"restart")).append("<p>".concat(L10n.get("restartPrompt"),'</p><ul class="buttons">')+'<li><button id="restart-ok">'.concat(L10n.get(["restartOk","ok"]),"</button></li>")+'<li><button id="restart-cancel" class="ui-close">'.concat(L10n.get(["restartCancel","cancel"]),"</button></li>")+"</ul>").find("#restart-ok").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){return Engine.restart()})),Dialog.close()})),!0}function uiBuildSaves(){var savesAllowed="function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed();function createActionItem(bId,bClass,bText,bAction){var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(bId)).html(bText);return bClass&&$btn.addClass(bClass),bAction?$btn.ariaClick(bAction):$btn.ariaDisabled(!0),jQuery(document.createElement("li")).append($btn)}var $dialogBody=jQuery(Dialog.setup(L10n.get("savesTitle"),"saves")),savesOk=Save.ok(),fileOk=Has.fileAPI&&(Config.saves.tryDiskOnMobile||!Browser.isMobile.any());if(savesOk&&$dialogBody.append(function(){function createButton(bId,bClass,bText,bSlot,bAction){var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(bId,"-").concat(bSlot)).addClass(bId).html(bText);return bClass&&$btn.addClass(bClass),bAction?"auto"===bSlot?$btn.ariaClick({label:"".concat(bText," ").concat(L10n.get("savesLabelAuto"))},(function(){return bAction()})):$btn.ariaClick({label:"".concat(bText," ").concat(L10n.get("savesLabelSlot")," ").concat(bSlot+1)},(function(){return bAction(bSlot)})):$btn.ariaDisabled(!0),$btn}var saves=Save.get(),$tbody=jQuery(document.createElement("tbody"));if(Save.autosave.ok()){var $tdSlot=jQuery(document.createElement("td")),$tdLoad=jQuery(document.createElement("td")),$tdDesc=jQuery(document.createElement("td")),$tdDele=jQuery(document.createElement("td"));jQuery(document.createElement("b")).attr({title:L10n.get("savesLabelAuto"),"aria-label":L10n.get("savesLabelAuto")}).text("A").appendTo($tdSlot),saves.autosave?($tdLoad.append(createButton("load","ui-close",L10n.get("savesLabelLoad"),"auto",(function(){jQuery(document).one(":dialogclosed",(function(){return Save.autosave.load()}))}))),jQuery(document.createElement("div")).text(saves.autosave.title).appendTo($tdDesc),jQuery(document.createElement("div")).addClass("datestamp").html(saves.autosave.date?"".concat(new Date(saves.autosave.date).toLocaleString()):"<em>".concat(L10n.get("savesUnknownDate"),"</em>")).appendTo($tdDesc),$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),"auto",(function(){Save.autosave.delete(),uiBuildSaves()})))):($tdLoad.append(createButton("load",null,L10n.get("savesLabelLoad"),"auto")),$tdDesc.addClass("empty").text("•  •  •"),$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),"auto"))),jQuery(document.createElement("tr")).append($tdSlot).append($tdLoad).append($tdDesc).append($tdDele).appendTo($tbody)}for(var i=0,iend=saves.slots.length;i<iend;++i){var _$tdSlot=jQuery(document.createElement("td")),_$tdLoad=jQuery(document.createElement("td")),_$tdDesc=jQuery(document.createElement("td")),_$tdDele=jQuery(document.createElement("td"));_$tdSlot.append(document.createTextNode(i+1)),saves.slots[i]?(_$tdLoad.append(createButton("load","ui-close",L10n.get("savesLabelLoad"),i,(function(slot){jQuery(document).one(":dialogclosed",(function(){return Save.slots.load(slot)}))}))),jQuery(document.createElement("div")).text(saves.slots[i].title).appendTo(_$tdDesc),jQuery(document.createElement("div")).addClass("datestamp").html(saves.slots[i].date?"".concat(new Date(saves.slots[i].date).toLocaleString()):"<em>".concat(L10n.get("savesUnknownDate"),"</em>")).appendTo(_$tdDesc),_$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),i,(function(slot){Save.slots.delete(slot),uiBuildSaves()})))):(_$tdLoad.append(createButton("save","ui-close",L10n.get("savesLabelSave"),i,savesAllowed?Save.slots.save:null)),_$tdDesc.addClass("empty").text("•  •  •"),_$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),i))),jQuery(document.createElement("tr")).append(_$tdSlot).append(_$tdLoad).append(_$tdDesc).append(_$tdDele).appendTo($tbody)}return jQuery(document.createElement("table")).attr("id","saves-list").append($tbody)}()),savesOk||fileOk){var $btnBar=jQuery(document.createElement("ul")).addClass("buttons").appendTo($dialogBody);return fileOk&&($btnBar.append(createActionItem("export","ui-close",L10n.get("savesLabelExport"),savesAllowed?function(){return Save.export()}:null)),$btnBar.append(createActionItem("import",null,L10n.get("savesLabelImport"),(function(){return $dialogBody.find("#saves-import-file").trigger("click")}))),jQuery(document.createElement("input")).css({display:"block",visibility:"hidden",position:"fixed",left:"-9999px",top:"-9999px",width:"1px",height:"1px"}).attr({type:"file",id:"saves-import-file",tabindex:-1,"aria-hidden":!0}).on("change",(function(ev){jQuery(document).one(":dialogclosed",(function(){return Save.import(ev)})),Dialog.close()})).appendTo($dialogBody)),savesOk&&$btnBar.append(createActionItem("clear",null,L10n.get("savesLabelClear"),Save.autosave.has()||!Save.slots.isEmpty()?function(){Save.clear(),uiBuildSaves()}:null)),!0}return uiOpenAlert(L10n.get("savesIncapable")),!1}function uiBuildSettings(){var $dialogBody=jQuery(Dialog.setup(L10n.get("settingsTitle"),"settings"));return Setting.forEach((function(control){if(control.type===Setting.Types.Header){var _name=control.name,_id=Util.slugify(_name),$header=jQuery(document.createElement("div")),$heading=jQuery(document.createElement("h2"));return $header.attr("id","header-body-".concat(_id)).append($heading).appendTo($dialogBody),$heading.attr("id","header-heading-".concat(_id)).wiki(_name),void(control.desc&&jQuery(document.createElement("p")).attr("id","header-desc-".concat(_id)).wiki(control.desc).appendTo($header))}var $control,name=control.name,id=Util.slugify(name),$setting=jQuery(document.createElement("div")),$label=jQuery(document.createElement("label")),$controlBox=jQuery(document.createElement("div"));switch(jQuery(document.createElement("div")).append($label).append($controlBox).appendTo($setting),control.desc&&jQuery(document.createElement("p")).attr("id","setting-desc-".concat(id)).wiki(control.desc).appendTo($setting),$label.attr({id:"setting-label-".concat(id),for:"setting-control-".concat(id)}).wiki(control.label),null==settings[name]&&(settings[name]=control.default),control.type){case Setting.Types.Toggle:$control=jQuery(document.createElement("button")),settings[name]?$control.addClass("enabled").text(L10n.get("settingsOn")):$control.text(L10n.get("settingsOff")),$control.ariaClick((function(){settings[name]?(jQuery(this).removeClass("enabled").text(L10n.get("settingsOff")),settings[name]=!1):(jQuery(this).addClass("enabled").text(L10n.get("settingsOn")),settings[name]=!0),Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default})}));break;case Setting.Types.List:$control=jQuery(document.createElement("select"));for(var i=0,iend=control.list.length;i<iend;++i)jQuery(document.createElement("option")).val(i).text(control.list[i]).appendTo($control);$control.val(control.list.indexOf(settings[name])).attr("tabindex",0).on("change",(function(){settings[name]=control.list[Number(this.value)],Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default,list:control.list})}));break;case Setting.Types.Range:($control=jQuery(document.createElement("input"))).attr({type:"range",min:control.min,max:control.max,step:control.step,value:settings[name],tabindex:0}).on("change input",(function(){settings[name]=Number(this.value),Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default,min:control.min,max:control.max,step:control.step})})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),$control.trigger("change"))}))}$control.attr("id","setting-control-".concat(id)).appendTo($controlBox),$setting.attr("id","setting-body-".concat(id)).appendTo($dialogBody)})),$dialogBody.append('<ul class="buttons">'+'<li><button id="settings-ok" class="ui-close">'.concat(L10n.get(["settingsOk","ok"]),"</button></li>")+'<li><button id="settings-reset">'.concat(L10n.get("settingsReset"),"</button></li>")+"</ul>").find("#settings-reset").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){Setting.reset(),window.location.reload()})),Dialog.close()})),!0}function uiBuildShare(){try{jQuery(Dialog.setup(L10n.get("shareTitle"),"share list")).append(uiAssembleLinkList("StoryShare"))}catch(ex){return console.error(ex),Alert.error("StoryShare",ex.message),!1}return!0}return Object.freeze(Object.defineProperties({},{assembleLinkList:{value:uiAssembleLinkList},alert:{value:uiOpenAlert},jumpto:{value:function(){uiBuildJumpto(),Dialog.open.apply(Dialog,arguments)}},restart:{value:function(){uiBuildRestart(),Dialog.open.apply(Dialog,arguments)}},saves:{value:function(){uiBuildSaves(),Dialog.open.apply(Dialog,arguments)}},settings:{value:function(){uiBuildSettings(),Dialog.open.apply(Dialog,arguments)}},share:{value:function(){uiBuildShare(),Dialog.open.apply(Dialog,arguments)}},buildAutoload:{value:uiBuildAutoload},buildJumpto:{value:uiBuildJumpto},buildRestart:{value:uiBuildRestart},buildSaves:{value:uiBuildSaves},buildSettings:{value:uiBuildSettings},buildShare:{value:uiBuildShare},stow:{value:function(){return UIBar.stow()}},unstow:{value:function(){return UIBar.unstow()}},setStoryElements:{value:function(){return UIBar.update()}},isOpen:{value:function(){return Dialog.isOpen.apply(Dialog,arguments)}},body:{value:function(){return Dialog.body()}},setup:{value:function(){return Dialog.setup.apply(Dialog,arguments)}},addClickHandler:{value:function(){return Dialog.addClickHandler.apply(Dialog,arguments)}},open:{value:function(){return Dialog.open.apply(Dialog,arguments)}},close:{value:function(){return Dialog.close.apply(Dialog,arguments)}},resize:{value:function(){return Dialog.resize()}},buildDialogAutoload:{value:uiBuildAutoload},buildDialogJumpto:{value:uiBuildJumpto},buildDialogRestart:{value:uiBuildRestart},buildDialogSaves:{value:uiBuildSaves},buildDialogSettings:{value:uiBuildSettings},buildDialogShare:{value:uiBuildShare},buildLinkListFromPassage:{value:uiAssembleLinkList}}))}(),UIBar=function(){var _$uiBar=null;function uiBarStow(noAnimation){var $story;_$uiBar&&!_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.addClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.minDomActionDelay));return this}function uiBarUpdate(){if(Story.has("StoryDisplayTitle")&&setDisplayTitle(Story.get("StoryDisplayTitle").processText()),_$uiBar){setPageElement("story-banner","StoryBanner"),setPageElement("story-subtitle","StorySubtitle"),setPageElement("story-author","StoryAuthor"),setPageElement("story-caption","StoryCaption");var menuStory=document.getElementById("menu-story");if(null!==menuStory&&(jQuery(menuStory).empty(),Story.has("StoryMenu")))try{UI.assembleLinkList("StoryMenu",menuStory)}catch(ex){console.error(ex),Alert.error("StoryMenu",ex.message)}}}return Object.freeze(Object.defineProperties({},{destroy:{value:function(){_$uiBar&&(_$uiBar.hide(),jQuery(document).off(".ui-bar"),jQuery(document.head).find("#style-ui-bar").remove(),_$uiBar.remove(),_$uiBar=null)}},hide:{value:function(){return _$uiBar&&_$uiBar.hide(),this}},init:{value:function(){if(!document.getElementById("ui-bar")){var toggleLabel,backwardLabel,jumptoLabel,forwardLabel,$backward,$forward,$elems=(toggleLabel=L10n.get("uiBarToggle"),backwardLabel=L10n.get("uiBarBackward"),jumptoLabel=L10n.get("uiBarJumpto"),forwardLabel=L10n.get("uiBarForward"),jQuery(document.createDocumentFragment()).append('<div id="ui-bar" aria-live="polite"><div id="ui-bar-tray">'+'<button id="ui-bar-toggle" tabindex="0" title="'.concat(toggleLabel,'" aria-label="').concat(toggleLabel,'"></button>')+'<div id="ui-bar-history">'+'<button id="history-backward" tabindex="0" title="'.concat(backwardLabel,'" aria-label="').concat(backwardLabel,'"></button>')+'<button id="history-jumpto" tabindex="0" title="'.concat(jumptoLabel,'" aria-label="').concat(jumptoLabel,'"></button>')+'<button id="history-forward" tabindex="0" title="'.concat(forwardLabel,'" aria-label="').concat(forwardLabel,'"></button>')+'</div></div><div id="ui-bar-body"><header id="title" role="banner"><div id="story-banner"></div><h1 id="story-title"></h1><div id="story-subtitle"></div><div id="story-title-separator"></div><p id="story-author"></p></header><div id="story-caption"></div><nav id="menu" role="navigation"><ul id="menu-story"></ul><ul id="menu-core">'+'<li id="menu-item-saves"><a tabindex="0">'.concat(L10n.get("savesTitle"),"</a></li>")+'<li id="menu-item-settings"><a tabindex="0">'.concat(L10n.get("settingsTitle"),"</a></li>")+'<li id="menu-item-restart"><a tabindex="0">'.concat(L10n.get("restartTitle"),"</a></li>")+'<li id="menu-item-share"><a tabindex="0">'.concat(L10n.get("shareTitle"),"</a></li>")+"</ul></nav></div></div>"));_$uiBar=jQuery($elems.find("#ui-bar").get(0)),$elems.insertBefore("body>script#script-sugarcube"),jQuery(document).on(":historyupdate.ui-bar",($backward=jQuery("#history-backward"),$forward=jQuery("#history-forward"),function(){$backward.ariaDisabled(State.length<2),$forward.ariaDisabled(State.length===State.size)}))}}},isHidden:{value:function(){return _$uiBar&&"none"===_$uiBar.css("display")}},isStowed:{value:function(){return _$uiBar&&_$uiBar.hasClass("stowed")}},show:{value:function(){return _$uiBar&&_$uiBar.show(),this}},start:{value:function(){_$uiBar&&(("boolean"==typeof Config.ui.stowBarInitially?Config.ui.stowBarInitially:jQuery(window).width()<=Config.ui.stowBarInitially)&&uiBarStow(!0),jQuery("#ui-bar-toggle").ariaClick({label:L10n.get("uiBarToggle")},(function(){return _$uiBar.toggleClass("stowed")})),Config.history.controls?(jQuery("#history-backward").ariaDisabled(State.length<2).ariaClick({label:L10n.get("uiBarBackward")},(function(){return Engine.backward()})),Story.lookup("tags","bookmark").length>0?jQuery("#history-jumpto").ariaClick({label:L10n.get("uiBarJumpto")},(function(){return UI.jumpto()})):jQuery("#history-jumpto").remove(),jQuery("#history-forward").ariaDisabled(State.length===State.size).ariaClick({label:L10n.get("uiBarForward")},(function(){return Engine.forward()}))):jQuery("#ui-bar-history").remove(),Story.has("StoryDisplayTitle")?setDisplayTitle(Story.get("StoryDisplayTitle").processText()):jQuery("#story-title").text(Story.title),Story.has("StoryCaption")||jQuery("#story-caption").remove(),Story.has("StoryMenu")||jQuery("#menu-story").remove(),Config.ui.updateStoryElements||uiBarUpdate(),jQuery("#menu-item-saves a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSaves(),Dialog.open()})).text(L10n.get("savesTitle")),Setting.isEmpty()?jQuery("#menu-item-settings").remove():jQuery("#menu-item-settings a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSettings(),Dialog.open()})).text(L10n.get("settingsTitle")),jQuery("#menu-item-restart a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildRestart(),Dialog.open()})).text(L10n.get("restartTitle")),Story.has("StoryShare")?jQuery("#menu-item-share a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildShare(),Dialog.open()})).text(L10n.get("shareTitle")):jQuery("#menu-item-share").remove())}},stow:{value:uiBarStow},unstow:{value:function(noAnimation){var $story;return _$uiBar&&_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.removeClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.minDomActionDelay)),this}},update:{value:uiBarUpdate},setStoryElements:{value:uiBarUpdate}}))}(),DebugBar=function(){var _variableRe=new RegExp("^".concat(Patterns.variable,"$")),_numericKeyRe=/^\d+$/,_watchList=[],_$debugBar=null,_$watchBody=null,_$watchList=null,_$turnSelect=null,_stowed=!0;function debugBarStow(){_$debugBar.css("right","-".concat(_$debugBar.outerWidth(),"px")),_stowed=!0,_updateSession()}function debugBarUnstow(){_$debugBar.css("right",0),_stowed=!1,_updateSession()}function debugBarToggle(){_stowed?debugBarUnstow():debugBarStow()}function debugBarWatchAdd(varName){_variableRe.test(varName)&&(_watchList.pushUnique(varName),_watchList.sort(),_updateWatchBody(),_updateWatchList(),_updateSession())}function debugBarWatchAddAll(){Object.keys(State.variables).map((function(name){return _watchList.pushUnique("$".concat(name))})),Object.keys(State.temporary).map((function(name){return _watchList.pushUnique("_".concat(name))})),_watchList.sort(),_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchClear(){for(var i=_watchList.length-1;i>=0;--i)_watchList.pop();_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchDelete(varName){_watchList.delete(varName),_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchDisable(){_debugBarWatchDisableNoUpdate(),_updateSession()}function debugBarWatchEnable(){_debugBarWatchEnableNoUpdate(),_updateSession()}function debugBarWatchIsEnabled(){return!_$watchBody.attr("hidden")}function debugBarWatchToggle(){_$watchBody.attr("hidden")?debugBarWatchEnable():debugBarWatchDisable()}function _debugBarWatchDisableNoUpdate(){_$watchBody.attr({"aria-hidden":!0,hidden:"hidden"})}function _debugBarWatchEnableNoUpdate(){_$watchBody.removeAttr("aria-hidden hidden")}function _clearSession(){session.delete("debugState")}function _hasSession(){return session.has("debugState")}function _updateSession(){session.set("debugState",{stowed:_stowed,watchList:_watchList,watchEnabled:debugBarWatchIsEnabled(),viewsEnabled:DebugView.isEnabled()})}function _updateWatchBody(){if(0!==_watchList.length){for(var delLabel=L10n.get("debugBarDeleteWatch"),$table=jQuery(document.createElement("table")),$tbody=jQuery(document.createElement("tbody")),_loop4=function(i,len){var varName=_watchList[i],varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary,$row=jQuery(document.createElement("tr")),$delBtn=jQuery(document.createElement("button")),$code=jQuery(document.createElement("code"));$delBtn.addClass("watch-delete").attr("data-name",varName).ariaClick({one:!0,label:delLabel},(function(){return debugBarWatchDelete(varName)})),$code.text(_toWatchString(store[varKey])),jQuery(document.createElement("td")).append($delBtn).appendTo($row),jQuery(document.createElement("td")).text(varName).appendTo($row),jQuery(document.createElement("td")).append($code).appendTo($row),$row.appendTo($tbody)},i=0,len=_watchList.length;i<len;++i)_loop4(i);$table.append($tbody),_$watchBody.empty().append($table)}else _$watchBody.empty().append("<div>".concat(L10n.get("debugBarNoWatches"),"</div>"))}function _updateWatchList(){var svn=Object.keys(State.variables),tvn=Object.keys(State.temporary);if(0!==svn.length||0!==tvn.length){var names=[].concat(_toConsumableArray(svn.map((function(name){return"$".concat(name)}))),_toConsumableArray(tvn.map((function(name){return"_".concat(name)})))).sort(),options=document.createDocumentFragment();names.delete(_watchList);for(var i=0,len=names.length;i<len;++i)jQuery(document.createElement("option")).val(names[i]).appendTo(options);_$watchList.empty().append(options)}else _$watchList.empty()}function _updateTurnSelect(){for(var histLen=State.size,expLen=State.expired.length,options=document.createDocumentFragment(),i=0;i<histLen;++i)jQuery(document.createElement("option")).val(i).text("".concat(expLen+i+1,". ").concat(Util.escape(State.history[i].title))).appendTo(options);_$turnSelect.empty().ariaDisabled(histLen<2).append(options).val(State.activeIndex)}function _toWatchString(value){if(null===value)return"null";switch(_typeof(value)){case"number":if(Number.isNaN(value))return"NaN";if(!Number.isFinite(value))return"Infinity";case"boolean":case"symbol":case"undefined":return String(value);case"string":return JSON.stringify(value);case"function":return"Function"}var objType=Util.toStringTag(value);if("Date"===objType)return"Date {".concat(value.toLocaleString(),"}");if("RegExp"===objType)return"RegExp ".concat(value.toString());var result=[];if(value instanceof Array||value instanceof Set){for(var list=value instanceof Array?value:Array.from(value),i=0,len=list.length;i<len;++i)result.push(list.hasOwnProperty(i)?_toWatchString(list[i]):"<empty>");return Object.keys(list).filter((function(key){return!_numericKeyRe.test(key)})).forEach((function(key){return result.push("".concat(_toWatchString(key),": ").concat(_toWatchString(list[key])))})),"".concat(objType,"(").concat(list.length,") [").concat(result.join(", "),"]")}return value instanceof Map?(value.forEach((function(val,key){return result.push("".concat(_toWatchString(key)," → ").concat(_toWatchString(val)))})),"".concat(objType,"(").concat(value.size,") {").concat(result.join(", "),"}")):(Object.keys(value).forEach((function(key){return result.push("".concat(_toWatchString(key),": ").concat(_toWatchString(value[key])))})),"".concat(objType," {").concat(result.join(", "),"}"))}return Object.freeze(Object.defineProperties({},{init:{value:function(){var barToggleLabel=L10n.get("debugBarToggle"),watchAddLabel=L10n.get("debugBarAddWatch"),watchAllLabel=L10n.get("debugBarWatchAll"),watchNoneLabel=L10n.get("debugBarWatchNone"),watchToggleLabel=L10n.get("debugBarWatchToggle"),viewsToggleLabel=L10n.get("debugBarViewsToggle");jQuery(document.createDocumentFragment()).append('<div id="debug-bar"><div id="debug-bar-watch">'+"<div>".concat(L10n.get("debugBarNoWatches"),"</div>>")+"</div><div>"+'<button id="debug-bar-watch-toggle" tabindex="0" title="'.concat(watchToggleLabel,'" aria-label="').concat(watchToggleLabel,'">').concat(L10n.get("debugBarLabelWatch"),"</button>")+'<label id="debug-bar-watch-label" for="debug-bar-watch-input">'.concat(L10n.get("debugBarLabelAdd"),"</label>")+'<input id="debug-bar-watch-input" name="debug-bar-watch-input" type="text" list="debug-bar-watch-list" tabindex="0"><datalist id="debug-bar-watch-list" aria-hidden="true" hidden="hidden"></datalist>'+'<button id="debug-bar-watch-add" tabindex="0" title="'.concat(watchAddLabel,'" aria-label="').concat(watchAddLabel,'"></button>')+'<button id="debug-bar-watch-all" tabindex="0" title="'.concat(watchAllLabel,'" aria-label="').concat(watchAllLabel,'"></button>')+'<button id="debug-bar-watch-none" tabindex="0" title="'.concat(watchNoneLabel,'" aria-label="').concat(watchNoneLabel,'"></button>')+"</div><div>"+'<button id="debug-bar-views-toggle" tabindex="0" title="'.concat(viewsToggleLabel,'" aria-label="').concat(viewsToggleLabel,'">').concat(L10n.get("debugBarLabelViews"),"</button>")+'<label id="debug-bar-turn-label" for="debug-bar-turn-select">'.concat(L10n.get("debugBarLabelTurn"),"</label>")+'<select id="debug-bar-turn-select" tabindex="0"></select></div>'+'<button id="debug-bar-toggle" tabindex="0" title="'.concat(barToggleLabel,'" aria-label="').concat(barToggleLabel,'"></button>')+'</div><div id="debug-bar-hint"></div>').appendTo("body"),_$debugBar=jQuery("#debug-bar"),_$watchBody=jQuery(_$debugBar.find("#debug-bar-watch").get(0)),_$watchList=jQuery(_$debugBar.find("#debug-bar-watch-list").get(0)),_$turnSelect=jQuery(_$debugBar.find("#debug-bar-turn-select").get(0));var $barToggle=jQuery(_$debugBar.find("#debug-bar-toggle").get(0)),$watchToggle=jQuery(_$debugBar.find("#debug-bar-watch-toggle").get(0)),$watchInput=jQuery(_$debugBar.find("#debug-bar-watch-input").get(0)),$watchAdd=jQuery(_$debugBar.find("#debug-bar-watch-add").get(0)),$watchAll=jQuery(_$debugBar.find("#debug-bar-watch-all").get(0)),$watchNone=jQuery(_$debugBar.find("#debug-bar-watch-none").get(0)),$viewsToggle=jQuery(_$debugBar.find("#debug-bar-views-toggle").get(0));$barToggle.ariaClick(debugBarToggle),$watchToggle.ariaClick(debugBarWatchToggle),$watchInput.on(":addwatch",(function(){debugBarWatchAdd(this.value.trim()),this.value=""})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),$watchInput.trigger(":addwatch"))})),$watchAdd.ariaClick((function(){return $watchInput.trigger(":addwatch")})),$watchAll.ariaClick(debugBarWatchAddAll),$watchNone.ariaClick(debugBarWatchClear),_$turnSelect.on("change",(function(){Engine.goTo(Number(this.value))})),$viewsToggle.ariaClick((function(){DebugView.toggle(),_updateSession()})),jQuery(document).on(":historyupdate.debug-bar",_updateTurnSelect).on(":passageend.debug-bar",(function(){_updateWatchBody(),_updateWatchList()})).on(":enginerestart.debug-bar",_clearSession),_hasSession()||DebugView.enable()}},isStowed:{value:function(){return _stowed}},start:{value:function(){(function(){if(!_hasSession())return!1;var debugState=session.get("debugState");_stowed=debugState.stowed,_watchList.push.apply(_watchList,_toConsumableArray(debugState.watchList)),debugState.watchEnabled?_debugBarWatchEnableNoUpdate():_debugBarWatchDisableNoUpdate();debugState.viewsEnabled?DebugView.enable():DebugView.disable()})(),_stowed?debugBarStow():debugBarUnstow(),_updateTurnSelect(),_updateWatchBody(),_updateWatchList()}},stow:{value:debugBarStow},toggle:{value:debugBarToggle},unstow:{value:debugBarUnstow},watch:{value:Object.freeze(Object.defineProperties({},{add:{value:debugBarWatchAdd},all:{value:debugBarWatchAddAll},clear:{value:debugBarWatchClear},delete:{value:debugBarWatchDelete},disable:{value:debugBarWatchDisable},enable:{value:debugBarWatchEnable},isEnabled:{value:debugBarWatchIsEnabled},toggle:{value:debugBarWatchToggle}}))}}))}(),LoadScreen=function(){var _locks=new Set,_autoId=0;function loadScreenHide(){jQuery(document.documentElement).removeAttr("data-init")}function loadScreenShow(){jQuery(document.documentElement).attr("data-init","loading")}return Object.freeze(Object.defineProperties({},{init:{value:function(){jQuery(document).on("readystatechange.SugarCube",(function(){_locks.size>0||("complete"===document.readyState?"loading"===jQuery(document.documentElement).attr("data-init")&&(Config.loadDelay>0?setTimeout((function(){0===_locks.size&&loadScreenHide()}),Math.max(Engine.minDomActionDelay,Config.loadDelay)):loadScreenHide()):loadScreenShow())}))}},clear:{value:function(){jQuery(document).off("readystatechange.SugarCube"),_locks.clear(),loadScreenHide()}},hide:{value:loadScreenHide},show:{value:loadScreenShow},lock:{value:function(){return++_autoId,_locks.add(_autoId),loadScreenShow(),_autoId}},unlock:{value:function(id){if(null==id)throw new Error("LoadScreen.unlock called with a null or undefined ID");_locks.has(id)&&_locks.delete(id),0===_locks.size&&jQuery(document).trigger("readystatechange")}}}))}(),version=Object.freeze({title:"SugarCube",major:2,minor:36,patch:1,prerelease:null,build:9717,date:new Date("2021-12-22T05:37:33.467Z"),extensions:{},toString:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,"+").concat(this.build)},short:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.title," (v").concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,")")},long:function(){return"".concat(this.title," v").concat(this.toString()," (").concat(this.date.toUTCString(),")")}}),TempState={},macros={},postdisplay={},postrender={},predisplay={},prehistory={},prerender={},session=null,settings={},setup={},storage=null,browser=Browser,config=Config,has=Has,History=State,state=State,tale=Story,TempVariables=State.temporary;window.SugarCube={},jQuery((function(){try{var lockId=LoadScreen.lock();LoadScreen.init(),document.normalize&&document.normalize(),Story.load(),storage=SimpleStore.create(Story.domId,!0),session=SimpleStore.create(Story.domId,!1),Dialog.init(),UIBar.init(),Engine.init(),Story.init(),L10n.init(),session.has("rcWarn")||"cookie"!==storage.name||(session.set("rcWarn",1),window.alert(L10n.get("warningNoWebStorage"))),Save.init(),Setting.init(),Macro.init(),Engine.start(),Config.debug&&DebugBar.init();var $window=$(window),vprCheckId=setInterval((function(){$window.width()&&(clearInterval(vprCheckId),UIBar.start(),Config.debug&&DebugBar.start(),jQuery.event.trigger({type:":storyready"}),setTimeout((function(){return LoadScreen.unlock(lockId)}),2*Engine.minDomActionDelay))}),Engine.minDomActionDelay);Object.defineProperty(window,"SugarCube",{value:Object.seal(Object.assign(Object.create(null),{Browser:Browser,Config:Config,Dialog:Dialog,Engine:Engine,Fullscreen:Fullscreen,Has:Has,L10n:L10n,Macro:Macro,Passage:Passage,Save:Save,Scripting:Scripting,Setting:Setting,SimpleAudio:SimpleAudio,State:State,Story:Story,UI:UI,UIBar:UIBar,DebugBar:DebugBar,Util:Util,Visibility:Visibility,Wikifier:Wikifier,session:session,settings:settings,setup:setup,storage:storage,version:version}))})}catch(ex){return console.error(ex),LoadScreen.clear(),Alert.fatal(null,ex.message,ex)}}))})(window,window.document,jQuery);}
	</script>
</body>
</html>
